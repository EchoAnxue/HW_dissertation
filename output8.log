nohup: ignoring input
/root/miniconda3/lib/python3.12/site-packages/torch_geometric/graphgym/config.py:19: UserWarning: Could not define global config object. Please install 'yacs' via 'pip install yacs' in order to use GraphGym
  warnings.warn("Could not define global config object. Please install "
/root/miniconda3/lib/python3.12/site-packages/torch_geometric/graphgym/imports.py:14: UserWarning: Please install 'pytorch_lightning' via  'pip install pytorch_lightning' in order to use GraphGym
  warnings.warn("Please install 'pytorch_lightning' via  "
/root/miniconda3/lib/python3.12/site-packages/torch_geometric/sampler/neighbor_sampler.py:61: UserWarning: Using 'NeighborSampler' without a 'pyg-lib' installation is deprecated and will be removed soon. Please install 'pyg-lib' for accelerated neighborhood sampling
  warnings.warn(f"Using '{self.__class__.__name__}' without a "
========== Running baseline 1/3 ==========
Training GAT with 3 layers...
可训练参数: 707363_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.8147
Epoch 0, accuracy: 0.7370
Epoch 0, Train Loss: 1.9505, Val Loss: 1.8147
✅ Epoch 1: New best model saved with val_loss = 1.5508
Epoch 1, accuracy: 0.8150
✅ Epoch 2: New best model saved with val_loss = 1.1467
Epoch 2, accuracy: 0.8040
Epoch 2, Train Loss: 1.3387, Val Loss: 1.1467
✅ Epoch 3: New best model saved with val_loss = 0.8173
Epoch 3, accuracy: 0.7800
✅ Epoch 4: New best model saved with val_loss = 0.6549
Epoch 4, accuracy: 0.8010
Epoch 4, Train Loss: 0.3572, Val Loss: 0.6549
Epoch 5, accuracy: 0.8120
Epoch 6, accuracy: 0.7990
Epoch 6, Train Loss: 0.0898, Val Loss: 0.8657
Epoch 7, accuracy: 0.7730
Epoch 8, accuracy: 0.7600
Epoch 8, Train Loss: 0.0678, Val Loss: 1.2310
Epoch 9, accuracy: 0.7660
Epoch 10, accuracy: 0.7890
Epoch 10, Train Loss: 0.0752, Val Loss: 1.3536
Epoch 11, accuracy: 0.7880
Epoch 12, accuracy: 0.7840
Epoch 12, Train Loss: 0.0387, Val Loss: 1.3739
Epoch 13, accuracy: 0.7790
Epoch 14, accuracy: 0.7760
Epoch 14, Train Loss: 0.0217, Val Loss: 1.4198
Epoch 15, accuracy: 0.7720
Epoch 16, accuracy: 0.7710
Epoch 16, Train Loss: 0.0144, Val Loss: 1.4644
Epoch 17, accuracy: 0.7710
Epoch 18, accuracy: 0.7700
Epoch 18, Train Loss: 0.0140, Val Loss: 1.4694
Epoch 19, accuracy: 0.7710
Epoch 20, accuracy: 0.7710
Epoch 20, Train Loss: 0.0069, Val Loss: 1.4743
Epoch 21, accuracy: 0.7710
Epoch 22, accuracy: 0.7710
Epoch 22, Train Loss: 0.0257, Val Loss: 1.4781
Epoch 23, accuracy: 0.7710
Epoch 24, accuracy: 0.7710
Epoch 24, Train Loss: 0.0048, Val Loss: 1.4787
Epoch 25, accuracy: 0.7710
Epoch 26, accuracy: 0.7700
Epoch 26, Train Loss: 0.0042, Val Loss: 1.4792
Epoch 27, accuracy: 0.7700
Epoch 28, accuracy: 0.7700
Epoch 28, Train Loss: 0.0035, Val Loss: 1.4797
Epoch 29, accuracy: 0.7700
Epoch 30, accuracy: 0.7700
Epoch 30, Train Loss: 0.0312, Val Loss: 1.4797
Epoch 31, accuracy: 0.7700
Epoch 32, accuracy: 0.7700
Epoch 32, Train Loss: 0.0031, Val Loss: 1.4797
Epoch 33, accuracy: 0.7700
Epoch 34, accuracy: 0.7700
Epoch 34, Train Loss: 0.0078, Val Loss: 1.4797
Epoch 35, accuracy: 0.7700
Epoch 36, accuracy: 0.7700
Epoch 36, Train Loss: 0.0096, Val Loss: 1.4797
Epoch 37, accuracy: 0.7700
Epoch 38, accuracy: 0.7700
Epoch 38, Train Loss: 0.0143, Val Loss: 1.4797
Epoch 39, accuracy: 0.7700
Epoch 40, accuracy: 0.7700
Epoch 40, Train Loss: 0.0294, Val Loss: 1.4797
Epoch 41, accuracy: 0.7700
Epoch 42, accuracy: 0.7700
Epoch 42, Train Loss: 0.0057, Val Loss: 1.4797
Epoch 43, accuracy: 0.7700
Epoch 44, accuracy: 0.7700
Epoch 44, Train Loss: 0.0130, Val Loss: 1.4797
Epoch 45, accuracy: 0.7700
Epoch 46, accuracy: 0.7700
Epoch 46, Train Loss: 0.0295, Val Loss: 1.4797
Epoch 47, accuracy: 0.7700
Epoch 48, accuracy: 0.7700
Epoch 48, Train Loss: 0.0126, Val Loss: 1.4797
Epoch 49, accuracy: 0.7700
Epoch 50, accuracy: 0.7700
Epoch 50, Train Loss: 0.0093, Val Loss: 1.4797
Epoch 51, accuracy: 0.7700
Epoch 52, accuracy: 0.7700
Epoch 52, Train Loss: 0.0309, Val Loss: 1.4797
Epoch 53, accuracy: 0.7700
Epoch 54, accuracy: 0.7700
Epoch 54, Train Loss: 0.0234, Val Loss: 1.4797
Epoch 55, accuracy: 0.7700
Epoch 56, accuracy: 0.7700
Epoch 56, Train Loss: 0.0064, Val Loss: 1.4797
Epoch 57, accuracy: 0.7700
Epoch 58, accuracy: 0.7700
Epoch 58, Train Loss: 0.0189, Val Loss: 1.4797
Epoch 59, accuracy: 0.7700
Epoch 60, accuracy: 0.7700
Epoch 60, Train Loss: 0.0058, Val Loss: 1.4797
Epoch 61, accuracy: 0.7700
Epoch 62, accuracy: 0.7700
Epoch 62, Train Loss: 0.0077, Val Loss: 1.4797
Epoch 63, accuracy: 0.7700
Epoch 64, accuracy: 0.7700
Epoch 64, Train Loss: 0.0038, Val Loss: 1.4797
Epoch 65, accuracy: 0.7700
Epoch 66, accuracy: 0.7700
Epoch 66, Train Loss: 0.0111, Val Loss: 1.4797
Epoch 67, accuracy: 0.7700
Epoch 68, accuracy: 0.7700
Epoch 68, Train Loss: 0.0118, Val Loss: 1.4797
Epoch 69, accuracy: 0.7700
Epoch 70, accuracy: 0.7700
Epoch 70, Train Loss: 0.0139, Val Loss: 1.4797
Epoch 71, accuracy: 0.7700
Epoch 72, accuracy: 0.7700
Epoch 72, Train Loss: 0.0241, Val Loss: 1.4797
Epoch 73, accuracy: 0.7700
Epoch 74, accuracy: 0.7700
Epoch 74, Train Loss: 0.0170, Val Loss: 1.4797
Epoch 75, accuracy: 0.7700
Epoch 76, accuracy: 0.7700
Epoch 76, Train Loss: 0.0429, Val Loss: 1.4797
Epoch 77, accuracy: 0.7700
Epoch 78, accuracy: 0.7700
Epoch 78, Train Loss: 0.0059, Val Loss: 1.4797
Epoch 79, accuracy: 0.7700
Epoch 80, accuracy: 0.7700
Epoch 80, Train Loss: 0.0174, Val Loss: 1.4797
Epoch 81, accuracy: 0.7700
Epoch 82, accuracy: 0.7700
Epoch 82, Train Loss: 0.0136, Val Loss: 1.4797
Epoch 83, accuracy: 0.7700
Epoch 84, accuracy: 0.7700
Epoch 84, Train Loss: 0.0055, Val Loss: 1.4797
Epoch 85, accuracy: 0.7700
Epoch 86, accuracy: 0.7700
Epoch 86, Train Loss: 0.0078, Val Loss: 1.4797
Epoch 87, accuracy: 0.7700
Epoch 88, accuracy: 0.7700
Epoch 88, Train Loss: 0.0120, Val Loss: 1.4797
Epoch 89, accuracy: 0.7700
Epoch 90, accuracy: 0.7700
Epoch 90, Train Loss: 0.0049, Val Loss: 1.4797
Epoch 91, accuracy: 0.7700
Epoch 92, accuracy: 0.7700
Epoch 92, Train Loss: 0.0509, Val Loss: 1.4797
Epoch 93, accuracy: 0.7700
Epoch 94, accuracy: 0.7700
Epoch 94, Train Loss: 0.0014, Val Loss: 1.4797
Epoch 95, accuracy: 0.7700
Epoch 96, accuracy: 0.7700
Epoch 96, Train Loss: 0.0370, Val Loss: 1.4797
Epoch 97, accuracy: 0.7700
Epoch 98, accuracy: 0.7700
Epoch 98, Train Loss: 0.0048, Val Loss: 1.4797
Epoch 99, accuracy: 0.7700
Epoch 100, accuracy: 0.7700
Epoch 100, Train Loss: 0.0035, Val Loss: 1.4797
Epoch 101, accuracy: 0.7700
Epoch 102, accuracy: 0.7700
Epoch 102, Train Loss: 0.0148, Val Loss: 1.4797
Epoch 103, accuracy: 0.7700
Epoch 104, accuracy: 0.7700
Epoch 104, Train Loss: 0.0132, Val Loss: 1.4797
Epoch 105, accuracy: 0.7700
Epoch 106, accuracy: 0.7700
Epoch 106, Train Loss: 0.0091, Val Loss: 1.4797
Epoch 107, accuracy: 0.7700
Epoch 108, accuracy: 0.7700
Epoch 108, Train Loss: 0.0244, Val Loss: 1.4797
Epoch 109, accuracy: 0.7700
Epoch 110, accuracy: 0.7700
Epoch 110, Train Loss: 0.0271, Val Loss: 1.4797
Epoch 111, accuracy: 0.7700
Epoch 112, accuracy: 0.7700
Epoch 112, Train Loss: 0.0199, Val Loss: 1.4797
Epoch 113, accuracy: 0.7700
Epoch 114, accuracy: 0.7700
Epoch 114, Train Loss: 0.0115, Val Loss: 1.4797
Epoch 115, accuracy: 0.7700
Epoch 116, accuracy: 0.7700
Epoch 116, Train Loss: 0.0098, Val Loss: 1.4797
Epoch 117, accuracy: 0.7700
Epoch 118, accuracy: 0.7700
Epoch 118, Train Loss: 0.0516, Val Loss: 1.4797
Epoch 119, accuracy: 0.7700
Epoch 120, accuracy: 0.7700
Epoch 120, Train Loss: 0.0426, Val Loss: 1.4797
Epoch 121, accuracy: 0.7700
Epoch 122, accuracy: 0.7700
Epoch 122, Train Loss: 0.0054, Val Loss: 1.4797
Epoch 123, accuracy: 0.7700
Epoch 124, accuracy: 0.7700
Epoch 124, Train Loss: 0.0295, Val Loss: 1.4797
Epoch 125, accuracy: 0.7700
Epoch 126, accuracy: 0.7700
Epoch 126, Train Loss: 0.0117, Val Loss: 1.4797
Epoch 127, accuracy: 0.7700
Epoch 128, accuracy: 0.7700
Epoch 128, Train Loss: 0.0040, Val Loss: 1.4797
Epoch 129, accuracy: 0.7700
Epoch 130, accuracy: 0.7700
Epoch 130, Train Loss: 0.0234, Val Loss: 1.4797
Epoch 131, accuracy: 0.7700
Epoch 132, accuracy: 0.7700
Epoch 132, Train Loss: 0.0079, Val Loss: 1.4797
Epoch 133, accuracy: 0.7700
Epoch 134, accuracy: 0.7700
Epoch 134, Train Loss: 0.0053, Val Loss: 1.4797
Epoch 135, accuracy: 0.7700
Epoch 136, accuracy: 0.7700
Epoch 136, Train Loss: 0.0428, Val Loss: 1.4797
Epoch 137, accuracy: 0.7700
Epoch 138, accuracy: 0.7700
Epoch 138, Train Loss: 0.0057, Val Loss: 1.4797
Epoch 139, accuracy: 0.7700
Epoch 140, accuracy: 0.7700
Epoch 140, Train Loss: 0.0267, Val Loss: 1.4797
Epoch 141, accuracy: 0.7700
Epoch 142, accuracy: 0.7700
Epoch 142, Train Loss: 0.0047, Val Loss: 1.4797
Epoch 143, accuracy: 0.7700
Epoch 144, accuracy: 0.7700
Epoch 144, Train Loss: 0.0023, Val Loss: 1.4797
Epoch 145, accuracy: 0.7700
Epoch 146, accuracy: 0.7700
Epoch 146, Train Loss: 0.0181, Val Loss: 1.4797
Epoch 147, accuracy: 0.7700
Epoch 148, accuracy: 0.7700
Epoch 148, Train Loss: 0.0089, Val Loss: 1.4797
Epoch 149, accuracy: 0.7700
Epoch 150, accuracy: 0.7700
Epoch 150, Train Loss: 0.0055, Val Loss: 1.4797
Epoch 151, accuracy: 0.7700
Epoch 152, accuracy: 0.7700
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 152, Train Loss: 0.0065, Val Loss: 1.4797
Epoch 153, accuracy: 0.7700
Epoch 154, accuracy: 0.7700
Epoch 154, Train Loss: 0.0219, Val Loss: 1.4797
Epoch 155, accuracy: 0.7700
Epoch 156, accuracy: 0.7700
Epoch 156, Train Loss: 0.0040, Val Loss: 1.4797
Epoch 157, accuracy: 0.7700
Epoch 158, accuracy: 0.7700
Epoch 158, Train Loss: 0.0026, Val Loss: 1.4797
Epoch 159, accuracy: 0.7700
Epoch 160, accuracy: 0.7700
Epoch 160, Train Loss: 0.0447, Val Loss: 1.4797
Epoch 161, accuracy: 0.7700
Epoch 162, accuracy: 0.7700
Epoch 162, Train Loss: 0.0334, Val Loss: 1.4797
Epoch 163, accuracy: 0.7700
Epoch 164, accuracy: 0.7700
Epoch 164, Train Loss: 0.0019, Val Loss: 1.4797
Epoch 165, accuracy: 0.7700
Epoch 166, accuracy: 0.7700
Epoch 166, Train Loss: 0.0210, Val Loss: 1.4797
Epoch 167, accuracy: 0.7700
Epoch 168, accuracy: 0.7700
Epoch 168, Train Loss: 0.0028, Val Loss: 1.4797
Epoch 169, accuracy: 0.7700
Epoch 170, accuracy: 0.7700
Epoch 170, Train Loss: 0.0272, Val Loss: 1.4797
Epoch 171, accuracy: 0.7700
Epoch 172, accuracy: 0.7700
Epoch 172, Train Loss: 0.0093, Val Loss: 1.4797
Epoch 173, accuracy: 0.7700
Epoch 174, accuracy: 0.7700
Epoch 174, Train Loss: 0.0449, Val Loss: 1.4797
Epoch 175, accuracy: 0.7700
Epoch 176, accuracy: 0.7700
Epoch 176, Train Loss: 0.0238, Val Loss: 1.4797
Epoch 177, accuracy: 0.7700
Epoch 178, accuracy: 0.7700
Epoch 178, Train Loss: 0.0409, Val Loss: 1.4797
Epoch 179, accuracy: 0.7700
Epoch 180, accuracy: 0.7700
Epoch 180, Train Loss: 0.0226, Val Loss: 1.4797
Epoch 181, accuracy: 0.7700
Epoch 182, accuracy: 0.7700
Epoch 182, Train Loss: 0.0243, Val Loss: 1.4797
Epoch 183, accuracy: 0.7700
Epoch 184, accuracy: 0.7700
Epoch 184, Train Loss: 0.0304, Val Loss: 1.4797
Epoch 185, accuracy: 0.7700
Epoch 186, accuracy: 0.7700
Epoch 186, Train Loss: 0.0217, Val Loss: 1.4797
Epoch 187, accuracy: 0.7700
Epoch 188, accuracy: 0.7700
Epoch 188, Train Loss: 0.0251, Val Loss: 1.4797
Epoch 189, accuracy: 0.7700
Epoch 190, accuracy: 0.7700
Epoch 190, Train Loss: 0.0243, Val Loss: 1.4797
Epoch 191, accuracy: 0.7700
Epoch 192, accuracy: 0.7700
Epoch 192, Train Loss: 0.0304, Val Loss: 1.4798
Epoch 193, accuracy: 0.7700
Epoch 194, accuracy: 0.7700
Epoch 194, Train Loss: 0.0149, Val Loss: 1.4798
Epoch 195, accuracy: 0.7700
Epoch 196, accuracy: 0.7700
Epoch 196, Train Loss: 0.0175, Val Loss: 1.4798
Epoch 197, accuracy: 0.7700
Epoch 198, accuracy: 0.7700
Epoch 198, Train Loss: 0.0268, Val Loss: 1.4798
Epoch 199, accuracy: 0.7700
Loaded best model with val_loss = 0.6548923850059509
test :accuracy 0.8010, f1_macro: 0.7929, f1_micro: 0.8010, auc: 0.9692
Training GAT with 4 layers...
可训练参数: 856867_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.8594
Epoch 0, accuracy: 0.6690
Epoch 0, Train Loss: 1.9491, Val Loss: 1.8594
✅ Epoch 1: New best model saved with val_loss = 1.5767
Epoch 1, accuracy: 0.7670
✅ Epoch 2: New best model saved with val_loss = 1.0705
Epoch 2, accuracy: 0.7990
Epoch 2, Train Loss: 1.4202, Val Loss: 1.0705
✅ Epoch 3: New best model saved with val_loss = 0.7773
Epoch 3, accuracy: 0.7530
Epoch 4, accuracy: 0.6850
Epoch 4, Train Loss: 0.2953, Val Loss: 1.1174
Epoch 5, accuracy: 0.5550
Epoch 6, accuracy: 0.5010
Epoch 6, Train Loss: 0.7082, Val Loss: 2.7138
Epoch 7, accuracy: 0.7090
Epoch 8, accuracy: 0.7850
Epoch 8, Train Loss: 0.1574, Val Loss: 0.8918
Epoch 9, accuracy: 0.7690
Epoch 10, accuracy: 0.7740
Epoch 10, Train Loss: 0.2269, Val Loss: 0.9149
Epoch 11, accuracy: 0.7800
Epoch 12, accuracy: 0.7850
Epoch 12, Train Loss: 0.1797, Val Loss: 0.8672
Epoch 13, accuracy: 0.7960
Epoch 14, accuracy: 0.7960
Epoch 14, Train Loss: 0.1324, Val Loss: 0.8143
Epoch 15, accuracy: 0.7970
Epoch 16, accuracy: 0.7970
Epoch 16, Train Loss: 0.0901, Val Loss: 0.7946
Epoch 17, accuracy: 0.7970
Epoch 18, accuracy: 0.7950
Epoch 18, Train Loss: 0.0875, Val Loss: 0.7917
Epoch 19, accuracy: 0.7950
Epoch 20, accuracy: 0.7960
Epoch 20, Train Loss: 0.0869, Val Loss: 0.7889
Epoch 21, accuracy: 0.7960
Epoch 22, accuracy: 0.7960
Epoch 22, Train Loss: 0.0860, Val Loss: 0.7874
Epoch 23, accuracy: 0.7960
Epoch 24, accuracy: 0.7960
Epoch 24, Train Loss: 0.0740, Val Loss: 0.7871
Epoch 25, accuracy: 0.7970
Epoch 26, accuracy: 0.7970
Epoch 26, Train Loss: 0.0816, Val Loss: 0.7868
Epoch 27, accuracy: 0.7970
Epoch 28, accuracy: 0.7980
Epoch 28, Train Loss: 0.0801, Val Loss: 0.7866
Epoch 29, accuracy: 0.7980
Epoch 30, accuracy: 0.7980
Epoch 30, Train Loss: 0.0771, Val Loss: 0.7866
Epoch 31, accuracy: 0.7980
Epoch 32, accuracy: 0.7980
Epoch 32, Train Loss: 0.0799, Val Loss: 0.7865
Epoch 33, accuracy: 0.7980
Epoch 34, accuracy: 0.7980
Epoch 34, Train Loss: 0.0900, Val Loss: 0.7865
Epoch 35, accuracy: 0.7980
Epoch 36, accuracy: 0.7980
Epoch 36, Train Loss: 0.0816, Val Loss: 0.7865
Epoch 37, accuracy: 0.7980
Epoch 38, accuracy: 0.7980
Epoch 38, Train Loss: 0.0919, Val Loss: 0.7865
Epoch 39, accuracy: 0.7980
Epoch 40, accuracy: 0.7980
Epoch 40, Train Loss: 0.0932, Val Loss: 0.7865
Epoch 41, accuracy: 0.7980
Epoch 42, accuracy: 0.7980
Epoch 42, Train Loss: 0.0782, Val Loss: 0.7865
Epoch 43, accuracy: 0.7980
Epoch 44, accuracy: 0.7980
Epoch 44, Train Loss: 0.1281, Val Loss: 0.7865
Epoch 45, accuracy: 0.7980
Epoch 46, accuracy: 0.7980
Epoch 46, Train Loss: 0.0713, Val Loss: 0.7865
Epoch 47, accuracy: 0.7980
Epoch 48, accuracy: 0.7980
Epoch 48, Train Loss: 0.0867, Val Loss: 0.7865
Epoch 49, accuracy: 0.7980
Epoch 50, accuracy: 0.7980
Epoch 50, Train Loss: 0.0850, Val Loss: 0.7865
Epoch 51, accuracy: 0.7980
Epoch 52, accuracy: 0.7980
Epoch 52, Train Loss: 0.0761, Val Loss: 0.7865
Epoch 53, accuracy: 0.7980
Epoch 54, accuracy: 0.7980
Epoch 54, Train Loss: 0.0780, Val Loss: 0.7865
Epoch 55, accuracy: 0.7980
Epoch 56, accuracy: 0.7980
Epoch 56, Train Loss: 0.0748, Val Loss: 0.7865
Epoch 57, accuracy: 0.7980
Epoch 58, accuracy: 0.7980
Epoch 58, Train Loss: 0.0793, Val Loss: 0.7865
Epoch 59, accuracy: 0.7980
Epoch 60, accuracy: 0.7980
Epoch 60, Train Loss: 0.0684, Val Loss: 0.7865
Epoch 61, accuracy: 0.7980
Epoch 62, accuracy: 0.7980
Epoch 62, Train Loss: 0.0728, Val Loss: 0.7865
Epoch 63, accuracy: 0.7980
Epoch 64, accuracy: 0.7980
Epoch 64, Train Loss: 0.0827, Val Loss: 0.7865
Epoch 65, accuracy: 0.7980
Epoch 66, accuracy: 0.7980
Epoch 66, Train Loss: 0.0874, Val Loss: 0.7865
Epoch 67, accuracy: 0.7980
Epoch 68, accuracy: 0.7980
Epoch 68, Train Loss: 0.0789, Val Loss: 0.7865
Epoch 69, accuracy: 0.7980
Epoch 70, accuracy: 0.7980
Epoch 70, Train Loss: 0.0695, Val Loss: 0.7865
Epoch 71, accuracy: 0.7980
Epoch 72, accuracy: 0.7980
Epoch 72, Train Loss: 0.0826, Val Loss: 0.7865
Epoch 73, accuracy: 0.7980
Epoch 74, accuracy: 0.7980
Epoch 74, Train Loss: 0.0920, Val Loss: 0.7865
Epoch 75, accuracy: 0.7980
Epoch 76, accuracy: 0.7980
Epoch 76, Train Loss: 0.0782, Val Loss: 0.7865
Epoch 77, accuracy: 0.7980
Epoch 78, accuracy: 0.7980
Epoch 78, Train Loss: 0.0825, Val Loss: 0.7865
Epoch 79, accuracy: 0.7980
Epoch 80, accuracy: 0.7980
Epoch 80, Train Loss: 0.0763, Val Loss: 0.7865
Epoch 81, accuracy: 0.7980
Epoch 82, accuracy: 0.7980
Epoch 82, Train Loss: 0.0770, Val Loss: 0.7865
Epoch 83, accuracy: 0.7980
Epoch 84, accuracy: 0.7980
Epoch 84, Train Loss: 0.0766, Val Loss: 0.7865
Epoch 85, accuracy: 0.7980
Epoch 86, accuracy: 0.7980
Epoch 86, Train Loss: 0.0810, Val Loss: 0.7865
Epoch 87, accuracy: 0.7980
Epoch 88, accuracy: 0.7980
Epoch 88, Train Loss: 0.0873, Val Loss: 0.7865
Epoch 89, accuracy: 0.7980
Epoch 90, accuracy: 0.7980
Epoch 90, Train Loss: 0.0680, Val Loss: 0.7865
Epoch 91, accuracy: 0.7980
Epoch 92, accuracy: 0.7980
Epoch 92, Train Loss: 0.0895, Val Loss: 0.7865
Epoch 93, accuracy: 0.7980
Epoch 94, accuracy: 0.7980
Epoch 94, Train Loss: 0.0785, Val Loss: 0.7865
Epoch 95, accuracy: 0.7980
Epoch 96, accuracy: 0.7980
Epoch 96, Train Loss: 0.0833, Val Loss: 0.7865
Epoch 97, accuracy: 0.7980
Epoch 98, accuracy: 0.7980
Epoch 98, Train Loss: 0.0922, Val Loss: 0.7865
Epoch 99, accuracy: 0.7980
Epoch 100, accuracy: 0.7980
Epoch 100, Train Loss: 0.0815, Val Loss: 0.7865
Epoch 101, accuracy: 0.7980
Epoch 102, accuracy: 0.7980
Epoch 102, Train Loss: 0.0803, Val Loss: 0.7865
Epoch 103, accuracy: 0.7980
Epoch 104, accuracy: 0.7980
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 104, Train Loss: 0.0762, Val Loss: 0.7865
Epoch 105, accuracy: 0.7980
Epoch 106, accuracy: 0.7980
Epoch 106, Train Loss: 0.0811, Val Loss: 0.7865
Epoch 107, accuracy: 0.7980
Epoch 108, accuracy: 0.7980
Epoch 108, Train Loss: 0.0723, Val Loss: 0.7865
Epoch 109, accuracy: 0.7980
Epoch 110, accuracy: 0.7980
Epoch 110, Train Loss: 0.0794, Val Loss: 0.7865
Epoch 111, accuracy: 0.7980
Epoch 112, accuracy: 0.7980
Epoch 112, Train Loss: 0.0832, Val Loss: 0.7865
Epoch 113, accuracy: 0.7980
Epoch 114, accuracy: 0.7980
Epoch 114, Train Loss: 0.0761, Val Loss: 0.7865
Epoch 115, accuracy: 0.7980
Epoch 116, accuracy: 0.7980
Epoch 116, Train Loss: 0.0816, Val Loss: 0.7865
Epoch 117, accuracy: 0.7980
Epoch 118, accuracy: 0.7980
Epoch 118, Train Loss: 0.0849, Val Loss: 0.7865
Epoch 119, accuracy: 0.7980
Epoch 120, accuracy: 0.7980
Epoch 120, Train Loss: 0.0759, Val Loss: 0.7865
Epoch 121, accuracy: 0.7980
Epoch 122, accuracy: 0.7980
Epoch 122, Train Loss: 0.0698, Val Loss: 0.7865
Epoch 123, accuracy: 0.7980
Epoch 124, accuracy: 0.7980
Epoch 124, Train Loss: 0.0829, Val Loss: 0.7865
Epoch 125, accuracy: 0.7980
Epoch 126, accuracy: 0.7980
Epoch 126, Train Loss: 0.1026, Val Loss: 0.7865
Epoch 127, accuracy: 0.7980
Epoch 128, accuracy: 0.7980
Epoch 128, Train Loss: 0.0874, Val Loss: 0.7865
Epoch 129, accuracy: 0.7980
Epoch 130, accuracy: 0.7980
Epoch 130, Train Loss: 0.0871, Val Loss: 0.7865
Epoch 131, accuracy: 0.7980
Epoch 132, accuracy: 0.7980
Epoch 132, Train Loss: 0.0840, Val Loss: 0.7865
Epoch 133, accuracy: 0.7980
Epoch 134, accuracy: 0.7980
Epoch 134, Train Loss: 0.0769, Val Loss: 0.7865
Epoch 135, accuracy: 0.7980
Epoch 136, accuracy: 0.7980
Epoch 136, Train Loss: 0.0901, Val Loss: 0.7865
Epoch 137, accuracy: 0.7980
Epoch 138, accuracy: 0.7980
Epoch 138, Train Loss: 0.0706, Val Loss: 0.7865
Epoch 139, accuracy: 0.7980
Epoch 140, accuracy: 0.7980
Epoch 140, Train Loss: 0.0740, Val Loss: 0.7865
Epoch 141, accuracy: 0.7980
Epoch 142, accuracy: 0.7980
Epoch 142, Train Loss: 0.0901, Val Loss: 0.7865
Epoch 143, accuracy: 0.7980
Epoch 144, accuracy: 0.7980
Epoch 144, Train Loss: 0.0841, Val Loss: 0.7865
Epoch 145, accuracy: 0.7980
Epoch 146, accuracy: 0.7980
Epoch 146, Train Loss: 0.0878, Val Loss: 0.7865
Epoch 147, accuracy: 0.7980
Epoch 148, accuracy: 0.7980
Epoch 148, Train Loss: 0.0837, Val Loss: 0.7865
Epoch 149, accuracy: 0.7980
Epoch 150, accuracy: 0.7980
Epoch 150, Train Loss: 0.0786, Val Loss: 0.7865
Epoch 151, accuracy: 0.7980
Epoch 152, accuracy: 0.7980
Epoch 152, Train Loss: 0.0934, Val Loss: 0.7865
Epoch 153, accuracy: 0.7980
Epoch 154, accuracy: 0.7980
Epoch 154, Train Loss: 0.0815, Val Loss: 0.7865
Epoch 155, accuracy: 0.7980
Epoch 156, accuracy: 0.7980
Epoch 156, Train Loss: 0.0722, Val Loss: 0.7865
Epoch 157, accuracy: 0.7980
Epoch 158, accuracy: 0.7980
Epoch 158, Train Loss: 0.0763, Val Loss: 0.7865
Epoch 159, accuracy: 0.7980
Epoch 160, accuracy: 0.7980
Epoch 160, Train Loss: 0.0909, Val Loss: 0.7865
Epoch 161, accuracy: 0.7980
Epoch 162, accuracy: 0.7980
Epoch 162, Train Loss: 0.0788, Val Loss: 0.7865
Epoch 163, accuracy: 0.7980
Epoch 164, accuracy: 0.7980
Epoch 164, Train Loss: 0.0808, Val Loss: 0.7865
Epoch 165, accuracy: 0.7980
Epoch 166, accuracy: 0.7980
Epoch 166, Train Loss: 0.0966, Val Loss: 0.7865
Epoch 167, accuracy: 0.7980
Epoch 168, accuracy: 0.7980
Epoch 168, Train Loss: 0.0711, Val Loss: 0.7865
Epoch 169, accuracy: 0.7980
Epoch 170, accuracy: 0.7980
Epoch 170, Train Loss: 0.1260, Val Loss: 0.7865
Epoch 171, accuracy: 0.7980
Epoch 172, accuracy: 0.7980
Epoch 172, Train Loss: 0.0815, Val Loss: 0.7865
Epoch 173, accuracy: 0.7980
Epoch 174, accuracy: 0.7980
Epoch 174, Train Loss: 0.0751, Val Loss: 0.7865
Epoch 175, accuracy: 0.7980
Epoch 176, accuracy: 0.7980
Epoch 176, Train Loss: 0.0836, Val Loss: 0.7865
Epoch 177, accuracy: 0.7980
Epoch 178, accuracy: 0.7980
Epoch 178, Train Loss: 0.0858, Val Loss: 0.7865
Epoch 179, accuracy: 0.7980
Epoch 180, accuracy: 0.7980
Epoch 180, Train Loss: 0.0722, Val Loss: 0.7865
Epoch 181, accuracy: 0.7980
Epoch 182, accuracy: 0.7980
Epoch 182, Train Loss: 0.0757, Val Loss: 0.7865
Epoch 183, accuracy: 0.7980
Epoch 184, accuracy: 0.7980
Epoch 184, Train Loss: 0.0822, Val Loss: 0.7865
Epoch 185, accuracy: 0.7980
Epoch 186, accuracy: 0.7980
Epoch 186, Train Loss: 0.0811, Val Loss: 0.7865
Epoch 187, accuracy: 0.7980
Epoch 188, accuracy: 0.7980
Epoch 188, Train Loss: 0.0907, Val Loss: 0.7865
Epoch 189, accuracy: 0.7980
Epoch 190, accuracy: 0.7980
Epoch 190, Train Loss: 0.0769, Val Loss: 0.7865
Epoch 191, accuracy: 0.7980
Epoch 192, accuracy: 0.7980
Epoch 192, Train Loss: 0.0828, Val Loss: 0.7865
Epoch 193, accuracy: 0.7980
Epoch 194, accuracy: 0.7980
Epoch 194, Train Loss: 0.0781, Val Loss: 0.7865
Epoch 195, accuracy: 0.7980
Epoch 196, accuracy: 0.7980
Epoch 196, Train Loss: 0.0797, Val Loss: 0.7865
Epoch 197, accuracy: 0.7980
Epoch 198, accuracy: 0.7980
Epoch 198, Train Loss: 0.0938, Val Loss: 0.7865
Epoch 199, accuracy: 0.7980
Loaded best model with val_loss = 0.7773486375808716
test :accuracy 0.7530, f1_macro: 0.7561, f1_micro: 0.7530, auc: 0.9672
Training GAT with 5 layers...
可训练参数: 1006371_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.8914
Epoch 0, accuracy: 0.4340
Epoch 0, Train Loss: 1.9492, Val Loss: 1.8914
✅ Epoch 1: New best model saved with val_loss = 1.7327
Epoch 1, accuracy: 0.2700
✅ Epoch 2: New best model saved with val_loss = 1.3812
Epoch 2, accuracy: 0.6200
Epoch 2, Train Loss: 1.5885, Val Loss: 1.3812
✅ Epoch 3: New best model saved with val_loss = 1.0967
Epoch 3, accuracy: 0.6560
✅ Epoch 4: New best model saved with val_loss = 0.9364
Epoch 4, accuracy: 0.7020
Epoch 4, Train Loss: 0.7062, Val Loss: 0.9364
Epoch 5, accuracy: 0.5610
Epoch 6, accuracy: 0.5760
Epoch 6, Train Loss: 0.6297, Val Loss: 1.6553
Epoch 7, accuracy: 0.7270
Epoch 8, accuracy: 0.7500
Epoch 8, Train Loss: 0.2199, Val Loss: 0.9787
✅ Epoch 9: New best model saved with val_loss = 0.8477
Epoch 9, accuracy: 0.7830
✅ Epoch 10: New best model saved with val_loss = 0.8045
Epoch 10, accuracy: 0.7910
Epoch 10, Train Loss: 0.2004, Val Loss: 0.8045
Epoch 11, accuracy: 0.7790
Epoch 12, accuracy: 0.7620
Epoch 12, Train Loss: 0.1041, Val Loss: 1.0162
Epoch 13, accuracy: 0.7670
Epoch 14, accuracy: 0.7650
Epoch 14, Train Loss: 0.1411, Val Loss: 1.1873
Epoch 15, accuracy: 0.7370
Epoch 16, accuracy: 0.7220
Epoch 16, Train Loss: 0.0430, Val Loss: 1.6984
Epoch 17, accuracy: 0.7220
Epoch 18, accuracy: 0.7260
Epoch 18, Train Loss: 0.0540, Val Loss: 1.6924
Epoch 19, accuracy: 0.7300
Epoch 20, accuracy: 0.7310
Epoch 20, Train Loss: 0.0228, Val Loss: 1.6525
Epoch 21, accuracy: 0.7350
Epoch 22, accuracy: 0.7350
Epoch 22, Train Loss: 0.0271, Val Loss: 1.6062
Epoch 23, accuracy: 0.7350
Epoch 24, accuracy: 0.7350
Epoch 24, Train Loss: 0.0215, Val Loss: 1.6025
Epoch 25, accuracy: 0.7350
Epoch 26, accuracy: 0.7350
Epoch 26, Train Loss: 0.0248, Val Loss: 1.5994
Epoch 27, accuracy: 0.7350
Epoch 28, accuracy: 0.7350
Epoch 28, Train Loss: 0.0241, Val Loss: 1.5953
Epoch 29, accuracy: 0.7350
Epoch 30, accuracy: 0.7350
Epoch 30, Train Loss: 0.0228, Val Loss: 1.5948
Epoch 31, accuracy: 0.7350
Epoch 32, accuracy: 0.7350
Epoch 32, Train Loss: 0.0306, Val Loss: 1.5945
Epoch 33, accuracy: 0.7350
Epoch 34, accuracy: 0.7350
Epoch 34, Train Loss: 0.0202, Val Loss: 1.5942
Epoch 35, accuracy: 0.7350
Epoch 36, accuracy: 0.7350
Epoch 36, Train Loss: 0.0302, Val Loss: 1.5941
Epoch 37, accuracy: 0.7350
Epoch 38, accuracy: 0.7350
Epoch 38, Train Loss: 0.0256, Val Loss: 1.5941
Epoch 39, accuracy: 0.7350
Epoch 40, accuracy: 0.7350
Epoch 40, Train Loss: 0.0182, Val Loss: 1.5940
Epoch 41, accuracy: 0.7350
Epoch 42, accuracy: 0.7350
Epoch 42, Train Loss: 0.0386, Val Loss: 1.5940
Epoch 43, accuracy: 0.7350
Epoch 44, accuracy: 0.7350
Epoch 44, Train Loss: 0.0152, Val Loss: 1.5940
Epoch 45, accuracy: 0.7350
Epoch 46, accuracy: 0.7350
Epoch 46, Train Loss: 0.0194, Val Loss: 1.5940
Epoch 47, accuracy: 0.7350
Epoch 48, accuracy: 0.7350
Epoch 48, Train Loss: 0.0217, Val Loss: 1.5940
Epoch 49, accuracy: 0.7350
Epoch 50, accuracy: 0.7350
Epoch 50, Train Loss: 0.0294, Val Loss: 1.5940
Epoch 51, accuracy: 0.7350
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 52, accuracy: 0.7350
Epoch 52, Train Loss: 0.0258, Val Loss: 1.5940
Epoch 53, accuracy: 0.7350
Epoch 54, accuracy: 0.7350
Epoch 54, Train Loss: 0.0206, Val Loss: 1.5940
Epoch 55, accuracy: 0.7350
Epoch 56, accuracy: 0.7350
Epoch 56, Train Loss: 0.0206, Val Loss: 1.5940
Epoch 57, accuracy: 0.7350
Epoch 58, accuracy: 0.7350
Epoch 58, Train Loss: 0.0185, Val Loss: 1.5940
Epoch 59, accuracy: 0.7350
Epoch 60, accuracy: 0.7350
Epoch 60, Train Loss: 0.0301, Val Loss: 1.5940
Epoch 61, accuracy: 0.7350
Epoch 62, accuracy: 0.7350
Epoch 62, Train Loss: 0.0258, Val Loss: 1.5940
Epoch 63, accuracy: 0.7350
Epoch 64, accuracy: 0.7350
Epoch 64, Train Loss: 0.0200, Val Loss: 1.5940
Epoch 65, accuracy: 0.7350
Epoch 66, accuracy: 0.7350
Epoch 66, Train Loss: 0.0284, Val Loss: 1.5940
Epoch 67, accuracy: 0.7350
Epoch 68, accuracy: 0.7350
Epoch 68, Train Loss: 0.0255, Val Loss: 1.5940
Epoch 69, accuracy: 0.7350
Epoch 70, accuracy: 0.7350
Epoch 70, Train Loss: 0.0393, Val Loss: 1.5940
Epoch 71, accuracy: 0.7350
Epoch 72, accuracy: 0.7350
Epoch 72, Train Loss: 0.0246, Val Loss: 1.5940
Epoch 73, accuracy: 0.7350
Epoch 74, accuracy: 0.7350
Epoch 74, Train Loss: 0.0256, Val Loss: 1.5940
Epoch 75, accuracy: 0.7350
Epoch 76, accuracy: 0.7350
Epoch 76, Train Loss: 0.0182, Val Loss: 1.5940
Epoch 77, accuracy: 0.7350
Epoch 78, accuracy: 0.7350
Epoch 78, Train Loss: 0.0226, Val Loss: 1.5940
Epoch 79, accuracy: 0.7350
Epoch 80, accuracy: 0.7350
Epoch 80, Train Loss: 0.0210, Val Loss: 1.5940
Epoch 81, accuracy: 0.7350
Epoch 82, accuracy: 0.7350
Epoch 82, Train Loss: 0.0223, Val Loss: 1.5940
Epoch 83, accuracy: 0.7350
Epoch 84, accuracy: 0.7350
Epoch 84, Train Loss: 0.0257, Val Loss: 1.5940
Epoch 85, accuracy: 0.7350
Epoch 86, accuracy: 0.7350
Epoch 86, Train Loss: 0.0210, Val Loss: 1.5940
Epoch 87, accuracy: 0.7350
Epoch 88, accuracy: 0.7350
Epoch 88, Train Loss: 0.0204, Val Loss: 1.5940
Epoch 89, accuracy: 0.7350
Epoch 90, accuracy: 0.7350
Epoch 90, Train Loss: 0.0244, Val Loss: 1.5940
Epoch 91, accuracy: 0.7350
Epoch 92, accuracy: 0.7350
Epoch 92, Train Loss: 0.0214, Val Loss: 1.5940
Epoch 93, accuracy: 0.7350
Epoch 94, accuracy: 0.7350
Epoch 94, Train Loss: 0.0142, Val Loss: 1.5940
Epoch 95, accuracy: 0.7350
Epoch 96, accuracy: 0.7350
Epoch 96, Train Loss: 0.0371, Val Loss: 1.5940
Epoch 97, accuracy: 0.7350
Epoch 98, accuracy: 0.7350
Epoch 98, Train Loss: 0.0223, Val Loss: 1.5940
Epoch 99, accuracy: 0.7350
Epoch 100, accuracy: 0.7350
Epoch 100, Train Loss: 0.0199, Val Loss: 1.5940
Epoch 101, accuracy: 0.7350
Epoch 102, accuracy: 0.7350
Epoch 102, Train Loss: 0.0251, Val Loss: 1.5940
Epoch 103, accuracy: 0.7350
Epoch 104, accuracy: 0.7350
Epoch 104, Train Loss: 0.0240, Val Loss: 1.5940
Epoch 105, accuracy: 0.7350
Epoch 106, accuracy: 0.7350
Epoch 106, Train Loss: 0.0330, Val Loss: 1.5940
Epoch 107, accuracy: 0.7350
Epoch 108, accuracy: 0.7350
Epoch 108, Train Loss: 0.0208, Val Loss: 1.5940
Epoch 109, accuracy: 0.7350
Epoch 110, accuracy: 0.7350
Epoch 110, Train Loss: 0.0202, Val Loss: 1.5940
Epoch 111, accuracy: 0.7350
Epoch 112, accuracy: 0.7350
Epoch 112, Train Loss: 0.0284, Val Loss: 1.5940
Epoch 113, accuracy: 0.7350
Epoch 114, accuracy: 0.7350
Epoch 114, Train Loss: 0.0326, Val Loss: 1.5940
Epoch 115, accuracy: 0.7350
Epoch 116, accuracy: 0.7350
Epoch 116, Train Loss: 0.0223, Val Loss: 1.5940
Epoch 117, accuracy: 0.7350
Epoch 118, accuracy: 0.7350
Epoch 118, Train Loss: 0.0284, Val Loss: 1.5940
Epoch 119, accuracy: 0.7350
Epoch 120, accuracy: 0.7350
Epoch 120, Train Loss: 0.0437, Val Loss: 1.5940
Epoch 121, accuracy: 0.7350
Epoch 122, accuracy: 0.7350
Epoch 122, Train Loss: 0.0231, Val Loss: 1.5940
Epoch 123, accuracy: 0.7350
Epoch 124, accuracy: 0.7350
Epoch 124, Train Loss: 0.0234, Val Loss: 1.5940
Epoch 125, accuracy: 0.7350
Epoch 126, accuracy: 0.7350
Epoch 126, Train Loss: 0.0325, Val Loss: 1.5940
Epoch 127, accuracy: 0.7350
Epoch 128, accuracy: 0.7350
Epoch 128, Train Loss: 0.0194, Val Loss: 1.5940
Epoch 129, accuracy: 0.7350
Epoch 130, accuracy: 0.7350
Epoch 130, Train Loss: 0.0334, Val Loss: 1.5940
Epoch 131, accuracy: 0.7350
Epoch 132, accuracy: 0.7350
Epoch 132, Train Loss: 0.0222, Val Loss: 1.5940
Epoch 133, accuracy: 0.7350
Epoch 134, accuracy: 0.7350
Epoch 134, Train Loss: 0.0194, Val Loss: 1.5940
Epoch 135, accuracy: 0.7350
Epoch 136, accuracy: 0.7350
Epoch 136, Train Loss: 0.0164, Val Loss: 1.5940
Epoch 137, accuracy: 0.7350
Epoch 138, accuracy: 0.7350
Epoch 138, Train Loss: 0.0282, Val Loss: 1.5940
Epoch 139, accuracy: 0.7350
Epoch 140, accuracy: 0.7350
Epoch 140, Train Loss: 0.0223, Val Loss: 1.5940
Epoch 141, accuracy: 0.7350
Epoch 142, accuracy: 0.7350
Epoch 142, Train Loss: 0.0215, Val Loss: 1.5940
Epoch 143, accuracy: 0.7350
Epoch 144, accuracy: 0.7350
Epoch 144, Train Loss: 0.0310, Val Loss: 1.5940
Epoch 145, accuracy: 0.7350
Epoch 146, accuracy: 0.7350
Epoch 146, Train Loss: 0.0215, Val Loss: 1.5940
Epoch 147, accuracy: 0.7350
Epoch 148, accuracy: 0.7350
Epoch 148, Train Loss: 0.0264, Val Loss: 1.5940
Epoch 149, accuracy: 0.7350
Epoch 150, accuracy: 0.7350
Epoch 150, Train Loss: 0.0185, Val Loss: 1.5940
Epoch 151, accuracy: 0.7350
Epoch 152, accuracy: 0.7350
Epoch 152, Train Loss: 0.0169, Val Loss: 1.5940
Epoch 153, accuracy: 0.7350
Epoch 154, accuracy: 0.7350
Epoch 154, Train Loss: 0.0290, Val Loss: 1.5940
Epoch 155, accuracy: 0.7350
Epoch 156, accuracy: 0.7350
Epoch 156, Train Loss: 0.0321, Val Loss: 1.5940
Epoch 157, accuracy: 0.7350
Epoch 158, accuracy: 0.7350
Epoch 158, Train Loss: 0.0315, Val Loss: 1.5940
Epoch 159, accuracy: 0.7350
Epoch 160, accuracy: 0.7350
Epoch 160, Train Loss: 0.0207, Val Loss: 1.5940
Epoch 161, accuracy: 0.7350
Epoch 162, accuracy: 0.7350
Epoch 162, Train Loss: 0.0230, Val Loss: 1.5940
Epoch 163, accuracy: 0.7350
Epoch 164, accuracy: 0.7350
Epoch 164, Train Loss: 0.0167, Val Loss: 1.5940
Epoch 165, accuracy: 0.7350
Epoch 166, accuracy: 0.7350
Epoch 166, Train Loss: 0.0274, Val Loss: 1.5940
Epoch 167, accuracy: 0.7350
Epoch 168, accuracy: 0.7350
Epoch 168, Train Loss: 0.0189, Val Loss: 1.5940
Epoch 169, accuracy: 0.7350
Epoch 170, accuracy: 0.7350
Epoch 170, Train Loss: 0.0147, Val Loss: 1.5940
Epoch 171, accuracy: 0.7350
Epoch 172, accuracy: 0.7350
Epoch 172, Train Loss: 0.0325, Val Loss: 1.5940
Epoch 173, accuracy: 0.7350
Epoch 174, accuracy: 0.7350
Epoch 174, Train Loss: 0.0212, Val Loss: 1.5940
Epoch 175, accuracy: 0.7350
Epoch 176, accuracy: 0.7350
Epoch 176, Train Loss: 0.0213, Val Loss: 1.5940
Epoch 177, accuracy: 0.7350
Epoch 178, accuracy: 0.7350
Epoch 178, Train Loss: 0.0192, Val Loss: 1.5940
Epoch 179, accuracy: 0.7350
Epoch 180, accuracy: 0.7350
Epoch 180, Train Loss: 0.0218, Val Loss: 1.5940
Epoch 181, accuracy: 0.7350
Epoch 182, accuracy: 0.7350
Epoch 182, Train Loss: 0.0307, Val Loss: 1.5940
Epoch 183, accuracy: 0.7350
Epoch 184, accuracy: 0.7350
Epoch 184, Train Loss: 0.0464, Val Loss: 1.5940
Epoch 185, accuracy: 0.7350
Epoch 186, accuracy: 0.7350
Epoch 186, Train Loss: 0.0220, Val Loss: 1.5940
Epoch 187, accuracy: 0.7350
Epoch 188, accuracy: 0.7350
Epoch 188, Train Loss: 0.0291, Val Loss: 1.5940
Epoch 189, accuracy: 0.7350
Epoch 190, accuracy: 0.7350
Epoch 190, Train Loss: 0.0284, Val Loss: 1.5940
Epoch 191, accuracy: 0.7350
Epoch 192, accuracy: 0.7350
Epoch 192, Train Loss: 0.0328, Val Loss: 1.5940
Epoch 193, accuracy: 0.7350
Epoch 194, accuracy: 0.7350
Epoch 194, Train Loss: 0.0148, Val Loss: 1.5940
Epoch 195, accuracy: 0.7350
Epoch 196, accuracy: 0.7350
Epoch 196, Train Loss: 0.0276, Val Loss: 1.5940
Epoch 197, accuracy: 0.7350
Epoch 198, accuracy: 0.7350
Epoch 198, Train Loss: 0.0292, Val Loss: 1.5940
Epoch 199, accuracy: 0.7350
Loaded best model with val_loss = 0.8044959902763367
test :accuracy 0.7910, f1_macro: 0.7869, f1_micro: 0.7910, auc: 0.9571
Training GAT with 6 layers...
可训练参数: 1155875_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.9330
Epoch 0, accuracy: 0.0640
Epoch 0, Train Loss: 1.9464, Val Loss: 1.9330
✅ Epoch 1: New best model saved with val_loss = 1.8492
Epoch 1, accuracy: 0.4010
✅ Epoch 2: New best model saved with val_loss = 1.6317
Epoch 2, accuracy: 0.4380
Epoch 2, Train Loss: 1.7334, Val Loss: 1.6317
✅ Epoch 3: New best model saved with val_loss = 1.5942
Epoch 3, accuracy: 0.4550
Epoch 4, accuracy: 0.4950
Epoch 4, Train Loss: 1.8074, Val Loss: 1.7367
✅ Epoch 5: New best model saved with val_loss = 1.4128
Epoch 5, accuracy: 0.5320
✅ Epoch 6: New best model saved with val_loss = 1.1925
Epoch 6, accuracy: 0.5390
Epoch 6, Train Loss: 1.0227, Val Loss: 1.1925
✅ Epoch 7: New best model saved with val_loss = 1.1832
Epoch 7, accuracy: 0.5660
✅ Epoch 8: New best model saved with val_loss = 0.9344
Epoch 8, accuracy: 0.7270
Epoch 8, Train Loss: 0.6159, Val Loss: 0.9344
✅ Epoch 9: New best model saved with val_loss = 0.7168
Epoch 9, accuracy: 0.8060
Epoch 10, accuracy: 0.8020
Epoch 10, Train Loss: 0.2391, Val Loss: 0.8051
Epoch 11, accuracy: 0.7890
Epoch 12, accuracy: 0.7190
Epoch 12, Train Loss: 0.2516, Val Loss: 1.7915
Epoch 13, accuracy: 0.7590
Epoch 14, accuracy: 0.7820
Epoch 14, Train Loss: 0.4359, Val Loss: 1.3521
Epoch 15, accuracy: 0.7670
Epoch 16, accuracy: 0.7660
Epoch 16, Train Loss: 0.2270, Val Loss: 1.2669
Epoch 17, accuracy: 0.7820
Epoch 18, accuracy: 0.7900
Epoch 18, Train Loss: 0.1851, Val Loss: 1.1280
Epoch 19, accuracy: 0.7950
Epoch 20, accuracy: 0.8040
Epoch 20, Train Loss: 0.1055, Val Loss: 1.0300
Epoch 21, accuracy: 0.8040
Epoch 22, accuracy: 0.8050
Epoch 22, Train Loss: 0.1233, Val Loss: 0.9996
Epoch 23, accuracy: 0.8040
Epoch 24, accuracy: 0.8050
Epoch 24, Train Loss: 0.1199, Val Loss: 0.9956
Epoch 25, accuracy: 0.8040
Epoch 26, accuracy: 0.8040
Epoch 26, Train Loss: 0.0980, Val Loss: 0.9915
Epoch 27, accuracy: 0.8040
Epoch 28, accuracy: 0.8040
Epoch 28, Train Loss: 0.0782, Val Loss: 0.9894
Epoch 29, accuracy: 0.8040
Epoch 30, accuracy: 0.8040
Epoch 30, Train Loss: 0.1053, Val Loss: 0.9890
Epoch 31, accuracy: 0.8040
Epoch 32, accuracy: 0.8040
Epoch 32, Train Loss: 0.0975, Val Loss: 0.9886
Epoch 33, accuracy: 0.8040
Epoch 34, accuracy: 0.8040
Epoch 34, Train Loss: 0.0723, Val Loss: 0.9885
Epoch 35, accuracy: 0.8040
Epoch 36, accuracy: 0.8040
Epoch 36, Train Loss: 0.0917, Val Loss: 0.9884
Epoch 37, accuracy: 0.8040
Epoch 38, accuracy: 0.8040
Epoch 38, Train Loss: 0.0822, Val Loss: 0.9884
Epoch 39, accuracy: 0.8040
Epoch 40, accuracy: 0.8040
Epoch 40, Train Loss: 0.0566, Val Loss: 0.9884
Epoch 41, accuracy: 0.8040
Epoch 42, accuracy: 0.8040
Epoch 42, Train Loss: 0.0922, Val Loss: 0.9884
Epoch 43, accuracy: 0.8040
Epoch 44, accuracy: 0.8040
Epoch 44, Train Loss: 0.1122, Val Loss: 0.9884
Epoch 45, accuracy: 0.8040
Epoch 46, accuracy: 0.8040
Epoch 46, Train Loss: 0.0742, Val Loss: 0.9884
Epoch 47, accuracy: 0.8040
Epoch 48, accuracy: 0.8040
Epoch 48, Train Loss: 0.0496, Val Loss: 0.9884
Epoch 49, accuracy: 0.8040
Epoch 50, accuracy: 0.8040
Epoch 50, Train Loss: 0.0742, Val Loss: 0.9884
Epoch 51, accuracy: 0.8040
Epoch 52, accuracy: 0.8040
Epoch 52, Train Loss: 0.1118, Val Loss: 0.9884
Epoch 53, accuracy: 0.8040
Epoch 54, accuracy: 0.8040
Epoch 54, Train Loss: 0.0498, Val Loss: 0.9884
Epoch 55, accuracy: 0.8040
Epoch 56, accuracy: 0.8040
Epoch 56, Train Loss: 0.0869, Val Loss: 0.9884
Epoch 57, accuracy: 0.8040
Epoch 58, accuracy: 0.8040
Epoch 58, Train Loss: 0.0932, Val Loss: 0.9884
Epoch 59, accuracy: 0.8040
Epoch 60, accuracy: 0.8040
Epoch 60, Train Loss: 0.0659, Val Loss: 0.9884
Epoch 61, accuracy: 0.8040
Epoch 62, accuracy: 0.8040
Epoch 62, Train Loss: 0.1037, Val Loss: 0.9884
Epoch 63, accuracy: 0.8040
Epoch 64, accuracy: 0.8040
Epoch 64, Train Loss: 0.0668, Val Loss: 0.9884
Epoch 65, accuracy: 0.8040
Epoch 66, accuracy: 0.8040
Epoch 66, Train Loss: 0.1559, Val Loss: 0.9884
Epoch 67, accuracy: 0.8040
Epoch 68, accuracy: 0.8040
Epoch 68, Train Loss: 0.0736, Val Loss: 0.9884
Epoch 69, accuracy: 0.8040
Epoch 70, accuracy: 0.8040
Epoch 70, Train Loss: 0.0663, Val Loss: 0.9884
Epoch 71, accuracy: 0.8040
Epoch 72, accuracy: 0.8040
Epoch 72, Train Loss: 0.0701, Val Loss: 0.9884
Epoch 73, accuracy: 0.8040
Epoch 74, accuracy: 0.8040
Epoch 74, Train Loss: 0.0678, Val Loss: 0.9884
Epoch 75, accuracy: 0.8040
Epoch 76, accuracy: 0.8040
Epoch 76, Train Loss: 0.1527, Val Loss: 0.9884
Epoch 77, accuracy: 0.8040
Epoch 78, accuracy: 0.8040
Epoch 78, Train Loss: 0.0667, Val Loss: 0.9884
Epoch 79, accuracy: 0.8040
Epoch 80, accuracy: 0.8040
Epoch 80, Train Loss: 0.0718, Val Loss: 0.9884
Epoch 81, accuracy: 0.8040
Epoch 82, accuracy: 0.8040
Epoch 82, Train Loss: 0.0590, Val Loss: 0.9884
Epoch 83, accuracy: 0.8040
Epoch 84, accuracy: 0.8040
Epoch 84, Train Loss: 0.1061, Val Loss: 0.9884
Epoch 85, accuracy: 0.8040
Epoch 86, accuracy: 0.8040
Epoch 86, Train Loss: 0.0814, Val Loss: 0.9884
Epoch 87, accuracy: 0.8040
Epoch 88, accuracy: 0.8040
Epoch 88, Train Loss: 0.0799, Val Loss: 0.9884
Epoch 89, accuracy: 0.8040
Epoch 90, accuracy: 0.8040
Epoch 90, Train Loss: 0.0727, Val Loss: 0.9884
Epoch 91, accuracy: 0.8040
Epoch 92, accuracy: 0.8040
Epoch 92, Train Loss: 0.1004, Val Loss: 0.9884
Epoch 93, accuracy: 0.8040
Epoch 94, accuracy: 0.8040
Epoch 94, Train Loss: 0.0990, Val Loss: 0.9884
Epoch 95, accuracy: 0.8040
Epoch 96, accuracy: 0.8040
Epoch 96, Train Loss: 0.0857, Val Loss: 0.9884
Epoch 97, accuracy: 0.8040
Epoch 98, accuracy: 0.8040
Epoch 98, Train Loss: 0.1030, Val Loss: 0.9884
Epoch 99, accuracy: 0.8040
Epoch 100, accuracy: 0.8040
Epoch 100, Train Loss: 0.0797, Val Loss: 0.9884
Epoch 101, accuracy: 0.8040
Epoch 102, accuracy: 0.8040
Epoch 102, Train Loss: 0.0844, Val Loss: 0.9884
Epoch 103, accuracy: 0.8040
Epoch 104, accuracy: 0.8040
Epoch 104, Train Loss: 0.1008, Val Loss: 0.9884
Epoch 105, accuracy: 0.8040
Epoch 106, accuracy: 0.8040
Epoch 106, Train Loss: 0.0676, Val Loss: 0.9884
Epoch 107, accuracy: 0.8040
Epoch 108, accuracy: 0.8040
Epoch 108, Train Loss: 0.0967, Val Loss: 0.9884
Epoch 109, accuracy: 0.8040
Epoch 110, accuracy: 0.8040
Epoch 110, Train Loss: 0.0610, Val Loss: 0.9884
Epoch 111, accuracy: 0.8040
Epoch 112, accuracy: 0.8040
Epoch 112, Train Loss: 0.0626, Val Loss: 0.9884
Epoch 113, accuracy: 0.8040
Epoch 114, accuracy: 0.8040
Epoch 114, Train Loss: 0.1132, Val Loss: 0.9884
Epoch 115, accuracy: 0.8040
Epoch 116, accuracy: 0.8040
Epoch 116, Train Loss: 0.0750, Val Loss: 0.9884
Epoch 117, accuracy: 0.8040
Epoch 118, accuracy: 0.8040
Epoch 118, Train Loss: 0.0585, Val Loss: 0.9884
Epoch 119, accuracy: 0.8040
Epoch 120, accuracy: 0.8040
Epoch 120, Train Loss: 0.0869, Val Loss: 0.9884
Epoch 121, accuracy: 0.8040
Epoch 122, accuracy: 0.8040
Epoch 122, Train Loss: 0.1156, Val Loss: 0.9884
Epoch 123, accuracy: 0.8040
Epoch 124, accuracy: 0.8040
Epoch 124, Train Loss: 0.0888, Val Loss: 0.9884
Epoch 125, accuracy: 0.8040
Epoch 126, accuracy: 0.8040
Epoch 126, Train Loss: 0.0662, Val Loss: 0.9884
Epoch 127, accuracy: 0.8040
Epoch 128, accuracy: 0.8040
Epoch 128, Train Loss: 0.0691, Val Loss: 0.9884
Epoch 129, accuracy: 0.8040
Epoch 130, accuracy: 0.8040
Epoch 130, Train Loss: 0.0827, Val Loss: 0.9884
Epoch 131, accuracy: 0.8040
Epoch 132, accuracy: 0.8040
Epoch 132, Train Loss: 0.0787, Val Loss: 0.9884
Epoch 133, accuracy: 0.8040
Epoch 134, accuracy: 0.8040
Epoch 134, Train Loss: 0.1003, Val Loss: 0.9884
Epoch 135, accuracy: 0.8040
Epoch 136, accuracy: 0.8040
Epoch 136, Train Loss: 0.1216, Val Loss: 0.9884
Epoch 137, accuracy: 0.8040
Epoch 138, accuracy: 0.8040
Epoch 138, Train Loss: 0.0566, Val Loss: 0.9884
Epoch 139, accuracy: 0.8040
Epoch 140, accuracy: 0.8040
Epoch 140, Train Loss: 0.0815, Val Loss: 0.9884
Epoch 141, accuracy: 0.8040
Epoch 142, accuracy: 0.8040
Epoch 142, Train Loss: 0.0589, Val Loss: 0.9884
Epoch 143, accuracy: 0.8040
Epoch 144, accuracy: 0.8040
Epoch 144, Train Loss: 0.0723, Val Loss: 0.9884
Epoch 145, accuracy: 0.8040
Epoch 146, accuracy: 0.8040
Epoch 146, Train Loss: 0.1171, Val Loss: 0.9884
Epoch 147, accuracy: 0.8040
Epoch 148, accuracy: 0.8040
Epoch 148, Train Loss: 0.1133, Val Loss: 0.9884
Epoch 149, accuracy: 0.8040
Epoch 150, accuracy: 0.8040
Epoch 150, Train Loss: 0.0762, Val Loss: 0.9884
Epoch 151, accuracy: 0.8040
Epoch 152, accuracy: 0.8040
Epoch 152, Train Loss: 0.0846, Val Loss: 0.9884
Epoch 153, accuracy: 0.8040
Epoch 154, accuracy: 0.8040
Epoch 154, Train Loss: 0.1109, Val Loss: 0.9884
Epoch 155, accuracy: 0.8040
Epoch 156, accuracy: 0.8040
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 156, Train Loss: 0.0833, Val Loss: 0.9884
Epoch 157, accuracy: 0.8040
Epoch 158, accuracy: 0.8040
Epoch 158, Train Loss: 0.1033, Val Loss: 0.9884
Epoch 159, accuracy: 0.8040
Epoch 160, accuracy: 0.8040
Epoch 160, Train Loss: 0.1064, Val Loss: 0.9884
Epoch 161, accuracy: 0.8040
Epoch 162, accuracy: 0.8040
Epoch 162, Train Loss: 0.0791, Val Loss: 0.9884
Epoch 163, accuracy: 0.8040
Epoch 164, accuracy: 0.8040
Epoch 164, Train Loss: 0.0955, Val Loss: 0.9884
Epoch 165, accuracy: 0.8040
Epoch 166, accuracy: 0.8040
Epoch 166, Train Loss: 0.1149, Val Loss: 0.9884
Epoch 167, accuracy: 0.8040
Epoch 168, accuracy: 0.8040
Epoch 168, Train Loss: 0.0739, Val Loss: 0.9884
Epoch 169, accuracy: 0.8040
Epoch 170, accuracy: 0.8040
Epoch 170, Train Loss: 0.1235, Val Loss: 0.9884
Epoch 171, accuracy: 0.8040
Epoch 172, accuracy: 0.8040
Epoch 172, Train Loss: 0.0718, Val Loss: 0.9884
Epoch 173, accuracy: 0.8040
Epoch 174, accuracy: 0.8040
Epoch 174, Train Loss: 0.0710, Val Loss: 0.9884
Epoch 175, accuracy: 0.8040
Epoch 176, accuracy: 0.8040
Epoch 176, Train Loss: 0.0859, Val Loss: 0.9884
Epoch 177, accuracy: 0.8040
Epoch 178, accuracy: 0.8040
Epoch 178, Train Loss: 0.0669, Val Loss: 0.9884
Epoch 179, accuracy: 0.8040
Epoch 180, accuracy: 0.8040
Epoch 180, Train Loss: 0.0818, Val Loss: 0.9884
Epoch 181, accuracy: 0.8040
Epoch 182, accuracy: 0.8040
Epoch 182, Train Loss: 0.1898, Val Loss: 0.9884
Epoch 183, accuracy: 0.8040
Epoch 184, accuracy: 0.8040
Epoch 184, Train Loss: 0.0732, Val Loss: 0.9884
Epoch 185, accuracy: 0.8040
Epoch 186, accuracy: 0.8040
Epoch 186, Train Loss: 0.0804, Val Loss: 0.9884
Epoch 187, accuracy: 0.8040
Epoch 188, accuracy: 0.8040
Epoch 188, Train Loss: 0.0649, Val Loss: 0.9884
Epoch 189, accuracy: 0.8040
Epoch 190, accuracy: 0.8040
Epoch 190, Train Loss: 0.1197, Val Loss: 0.9884
Epoch 191, accuracy: 0.8040
Epoch 192, accuracy: 0.8040
Epoch 192, Train Loss: 0.0850, Val Loss: 0.9884
Epoch 193, accuracy: 0.8040
Epoch 194, accuracy: 0.8040
Epoch 194, Train Loss: 0.0692, Val Loss: 0.9884
Epoch 195, accuracy: 0.8040
Epoch 196, accuracy: 0.8040
Epoch 196, Train Loss: 0.0958, Val Loss: 0.9884
Epoch 197, accuracy: 0.8040
Epoch 198, accuracy: 0.8040
Epoch 198, Train Loss: 0.0716, Val Loss: 0.9884
Epoch 199, accuracy: 0.8040
Loaded best model with val_loss = 0.7167736291885376
test :accuracy 0.8060, f1_macro: 0.7982, f1_micro: 0.8060, auc: 0.9634
Training GAT with 7 layers...
可训练参数: 1305379_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.9638
Epoch 0, accuracy: 0.0640
Epoch 0, Train Loss: 1.9442, Val Loss: 1.9638
✅ Epoch 1: New best model saved with val_loss = 1.8895
Epoch 1, accuracy: 0.3340
Epoch 2, accuracy: 0.0670
Epoch 2, Train Loss: 1.8608, Val Loss: 2.1137
Epoch 3, accuracy: 0.1490
✅ Epoch 4: New best model saved with val_loss = 1.8149
Epoch 4, accuracy: 0.1460
Epoch 4, Train Loss: 2.1168, Val Loss: 1.8149
✅ Epoch 5: New best model saved with val_loss = 1.7667
Epoch 5, accuracy: 0.4600
✅ Epoch 6: New best model saved with val_loss = 1.6470
Epoch 6, accuracy: 0.4930
Epoch 6, Train Loss: 1.7849, Val Loss: 1.6470
✅ Epoch 7: New best model saved with val_loss = 1.4470
Epoch 7, accuracy: 0.5990
✅ Epoch 8: New best model saved with val_loss = 1.1484
Epoch 8, accuracy: 0.6720
Epoch 8, Train Loss: 1.4172, Val Loss: 1.1484
✅ Epoch 9: New best model saved with val_loss = 1.1262
Epoch 9, accuracy: 0.5770
✅ Epoch 10: New best model saved with val_loss = 0.8978
Epoch 10, accuracy: 0.6800
Epoch 10, Train Loss: 0.8878, Val Loss: 0.8978
Epoch 11, accuracy: 0.6650
Epoch 12, accuracy: 0.6590
Epoch 12, Train Loss: 0.7358, Val Loss: 1.3366
Epoch 13, accuracy: 0.7180
Epoch 14, accuracy: 0.7610
Epoch 14, Train Loss: 0.4008, Val Loss: 0.9255
Epoch 15, accuracy: 0.7820
Epoch 16, accuracy: 0.7290
Epoch 16, Train Loss: 0.2175, Val Loss: 1.1230
Epoch 17, accuracy: 0.7260
Epoch 18, accuracy: 0.7280
Epoch 18, Train Loss: 0.1878, Val Loss: 1.1153
Epoch 19, accuracy: 0.7290
Epoch 20, accuracy: 0.7310
Epoch 20, Train Loss: 0.1844, Val Loss: 1.0663
Epoch 21, accuracy: 0.7410
Epoch 22, accuracy: 0.7540
Epoch 22, Train Loss: 0.2033, Val Loss: 1.0232
Epoch 23, accuracy: 0.7560
Epoch 24, accuracy: 0.7580
Epoch 24, Train Loss: 0.1512, Val Loss: 1.0201
Epoch 25, accuracy: 0.7610
Epoch 26, accuracy: 0.7590
Epoch 26, Train Loss: 0.1588, Val Loss: 1.0171
Epoch 27, accuracy: 0.7590
Epoch 28, accuracy: 0.7590
Epoch 28, Train Loss: 0.1298, Val Loss: 1.0146
Epoch 29, accuracy: 0.7590
Epoch 30, accuracy: 0.7590
Epoch 30, Train Loss: 0.1184, Val Loss: 1.0144
Epoch 31, accuracy: 0.7590
Epoch 32, accuracy: 0.7590
Epoch 32, Train Loss: 0.1341, Val Loss: 1.0141
Epoch 33, accuracy: 0.7590
Epoch 34, accuracy: 0.7590
Epoch 34, Train Loss: 0.1247, Val Loss: 1.0139
Epoch 35, accuracy: 0.7590
Epoch 36, accuracy: 0.7590
Epoch 36, Train Loss: 0.1624, Val Loss: 1.0139
Epoch 37, accuracy: 0.7590
Epoch 38, accuracy: 0.7590
Epoch 38, Train Loss: 0.1485, Val Loss: 1.0138
Epoch 39, accuracy: 0.7590
Epoch 40, accuracy: 0.7590
Epoch 40, Train Loss: 0.1459, Val Loss: 1.0138
Epoch 41, accuracy: 0.7590
Epoch 42, accuracy: 0.7590
Epoch 42, Train Loss: 0.1475, Val Loss: 1.0138
Epoch 43, accuracy: 0.7590
Epoch 44, accuracy: 0.7590
Epoch 44, Train Loss: 0.1796, Val Loss: 1.0138
Epoch 45, accuracy: 0.7590
Epoch 46, accuracy: 0.7590
Epoch 46, Train Loss: 0.1710, Val Loss: 1.0138
Epoch 47, accuracy: 0.7590
Epoch 48, accuracy: 0.7590
Epoch 48, Train Loss: 0.1184, Val Loss: 1.0138
Epoch 49, accuracy: 0.7590
Epoch 50, accuracy: 0.7590
Epoch 50, Train Loss: 0.1299, Val Loss: 1.0138
Epoch 51, accuracy: 0.7590
Epoch 52, accuracy: 0.7590
Epoch 52, Train Loss: 0.1589, Val Loss: 1.0138
Epoch 53, accuracy: 0.7590
Epoch 54, accuracy: 0.7590
Epoch 54, Train Loss: 0.1452, Val Loss: 1.0138
Epoch 55, accuracy: 0.7590
Epoch 56, accuracy: 0.7590
Epoch 56, Train Loss: 0.1719, Val Loss: 1.0138
Epoch 57, accuracy: 0.7590
Epoch 58, accuracy: 0.7590
Epoch 58, Train Loss: 0.1735, Val Loss: 1.0138
Epoch 59, accuracy: 0.7590
Epoch 60, accuracy: 0.7590
Epoch 60, Train Loss: 0.1505, Val Loss: 1.0138
Epoch 61, accuracy: 0.7590
Epoch 62, accuracy: 0.7590
Epoch 62, Train Loss: 0.1258, Val Loss: 1.0138
Epoch 63, accuracy: 0.7590
Epoch 64, accuracy: 0.7590
Epoch 64, Train Loss: 0.1448, Val Loss: 1.0138
Epoch 65, accuracy: 0.7590
Epoch 66, accuracy: 0.7590
Epoch 66, Train Loss: 0.1598, Val Loss: 1.0138
Epoch 67, accuracy: 0.7590
Epoch 68, accuracy: 0.7590
Epoch 68, Train Loss: 0.1438, Val Loss: 1.0138
Epoch 69, accuracy: 0.7590
Epoch 70, accuracy: 0.7590
Epoch 70, Train Loss: 0.1487, Val Loss: 1.0138
Epoch 71, accuracy: 0.7590
Epoch 72, accuracy: 0.7590
Epoch 72, Train Loss: 0.1213, Val Loss: 1.0138
Epoch 73, accuracy: 0.7590
Epoch 74, accuracy: 0.7590
Epoch 74, Train Loss: 0.1360, Val Loss: 1.0138
Epoch 75, accuracy: 0.7590
Epoch 76, accuracy: 0.7590
Epoch 76, Train Loss: 0.1476, Val Loss: 1.0138
Epoch 77, accuracy: 0.7590
Epoch 78, accuracy: 0.7590
Epoch 78, Train Loss: 0.1343, Val Loss: 1.0138
Epoch 79, accuracy: 0.7590
Epoch 80, accuracy: 0.7590
Epoch 80, Train Loss: 0.1593, Val Loss: 1.0138
Epoch 81, accuracy: 0.7590
Epoch 82, accuracy: 0.7590
Epoch 82, Train Loss: 0.1343, Val Loss: 1.0138
Epoch 83, accuracy: 0.7590
Epoch 84, accuracy: 0.7590
Epoch 84, Train Loss: 0.1489, Val Loss: 1.0138
Epoch 85, accuracy: 0.7590
Epoch 86, accuracy: 0.7590
Epoch 86, Train Loss: 0.1545, Val Loss: 1.0138
Epoch 87, accuracy: 0.7590
Epoch 88, accuracy: 0.7590
Epoch 88, Train Loss: 0.1762, Val Loss: 1.0138
Epoch 89, accuracy: 0.7590
Epoch 90, accuracy: 0.7590
Epoch 90, Train Loss: 0.1278, Val Loss: 1.0138
Epoch 91, accuracy: 0.7590
Epoch 92, accuracy: 0.7590
Epoch 92, Train Loss: 0.1354, Val Loss: 1.0138
Epoch 93, accuracy: 0.7590
Epoch 94, accuracy: 0.7590
Epoch 94, Train Loss: 0.1459, Val Loss: 1.0138
Epoch 95, accuracy: 0.7590
Epoch 96, accuracy: 0.7590
Epoch 96, Train Loss: 0.1495, Val Loss: 1.0138
Epoch 97, accuracy: 0.7590
Epoch 98, accuracy: 0.7590
Epoch 98, Train Loss: 0.1217, Val Loss: 1.0138
Epoch 99, accuracy: 0.7590
Epoch 100, accuracy: 0.7590
Epoch 100, Train Loss: 0.1393, Val Loss: 1.0138
Epoch 101, accuracy: 0.7590
Epoch 102, accuracy: 0.7590
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 102, Train Loss: 0.1264, Val Loss: 1.0138
Epoch 103, accuracy: 0.7590
Epoch 104, accuracy: 0.7590
Epoch 104, Train Loss: 0.1426, Val Loss: 1.0138
Epoch 105, accuracy: 0.7590
Epoch 106, accuracy: 0.7590
Epoch 106, Train Loss: 0.1332, Val Loss: 1.0138
Epoch 107, accuracy: 0.7590
Epoch 108, accuracy: 0.7590
Epoch 108, Train Loss: 0.1326, Val Loss: 1.0138
Epoch 109, accuracy: 0.7590
Epoch 110, accuracy: 0.7590
Epoch 110, Train Loss: 0.1532, Val Loss: 1.0138
Epoch 111, accuracy: 0.7590
Epoch 112, accuracy: 0.7590
Epoch 112, Train Loss: 0.1821, Val Loss: 1.0138
Epoch 113, accuracy: 0.7590
Epoch 114, accuracy: 0.7590
Epoch 114, Train Loss: 0.1194, Val Loss: 1.0138
Epoch 115, accuracy: 0.7590
Epoch 116, accuracy: 0.7590
Epoch 116, Train Loss: 0.1427, Val Loss: 1.0138
Epoch 117, accuracy: 0.7590
Epoch 118, accuracy: 0.7590
Epoch 118, Train Loss: 0.1418, Val Loss: 1.0138
Epoch 119, accuracy: 0.7590
Epoch 120, accuracy: 0.7590
Epoch 120, Train Loss: 0.1728, Val Loss: 1.0138
Epoch 121, accuracy: 0.7590
Epoch 122, accuracy: 0.7590
Epoch 122, Train Loss: 0.1307, Val Loss: 1.0138
Epoch 123, accuracy: 0.7590
Epoch 124, accuracy: 0.7590
Epoch 124, Train Loss: 0.1361, Val Loss: 1.0138
Epoch 125, accuracy: 0.7590
Epoch 126, accuracy: 0.7590
Epoch 126, Train Loss: 0.1533, Val Loss: 1.0138
Epoch 127, accuracy: 0.7590
Epoch 128, accuracy: 0.7590
Epoch 128, Train Loss: 0.1631, Val Loss: 1.0138
Epoch 129, accuracy: 0.7590
Epoch 130, accuracy: 0.7590
Epoch 130, Train Loss: 0.1334, Val Loss: 1.0138
Epoch 131, accuracy: 0.7590
Epoch 132, accuracy: 0.7590
Epoch 132, Train Loss: 0.1205, Val Loss: 1.0138
Epoch 133, accuracy: 0.7590
Epoch 134, accuracy: 0.7590
Epoch 134, Train Loss: 0.1811, Val Loss: 1.0138
Epoch 135, accuracy: 0.7590
Epoch 136, accuracy: 0.7590
Epoch 136, Train Loss: 0.1531, Val Loss: 1.0138
Epoch 137, accuracy: 0.7590
Epoch 138, accuracy: 0.7590
Epoch 138, Train Loss: 0.1497, Val Loss: 1.0138
Epoch 139, accuracy: 0.7590
Epoch 140, accuracy: 0.7590
Epoch 140, Train Loss: 0.1557, Val Loss: 1.0138
Epoch 141, accuracy: 0.7590
Epoch 142, accuracy: 0.7590
Epoch 142, Train Loss: 0.1301, Val Loss: 1.0138
Epoch 143, accuracy: 0.7590
Epoch 144, accuracy: 0.7590
Epoch 144, Train Loss: 0.1368, Val Loss: 1.0138
Epoch 145, accuracy: 0.7590
Epoch 146, accuracy: 0.7590
Epoch 146, Train Loss: 0.1497, Val Loss: 1.0138
Epoch 147, accuracy: 0.7590
Epoch 148, accuracy: 0.7590
Epoch 148, Train Loss: 0.1341, Val Loss: 1.0138
Epoch 149, accuracy: 0.7590
Epoch 150, accuracy: 0.7590
Epoch 150, Train Loss: 0.1447, Val Loss: 1.0138
Epoch 151, accuracy: 0.7590
Epoch 152, accuracy: 0.7590
Epoch 152, Train Loss: 0.1553, Val Loss: 1.0138
Epoch 153, accuracy: 0.7590
Epoch 154, accuracy: 0.7590
Epoch 154, Train Loss: 0.1404, Val Loss: 1.0138
Epoch 155, accuracy: 0.7590
Epoch 156, accuracy: 0.7590
Epoch 156, Train Loss: 0.1572, Val Loss: 1.0138
Epoch 157, accuracy: 0.7590
Epoch 158, accuracy: 0.7590
Epoch 158, Train Loss: 0.1488, Val Loss: 1.0138
Epoch 159, accuracy: 0.7590
Epoch 160, accuracy: 0.7590
Epoch 160, Train Loss: 0.1670, Val Loss: 1.0138
Epoch 161, accuracy: 0.7590
Epoch 162, accuracy: 0.7590
Epoch 162, Train Loss: 0.1379, Val Loss: 1.0138
Epoch 163, accuracy: 0.7590
Epoch 164, accuracy: 0.7590
Epoch 164, Train Loss: 0.1500, Val Loss: 1.0138
Epoch 165, accuracy: 0.7590
Epoch 166, accuracy: 0.7590
Epoch 166, Train Loss: 0.1519, Val Loss: 1.0138
Epoch 167, accuracy: 0.7590
Epoch 168, accuracy: 0.7590
Epoch 168, Train Loss: 0.1648, Val Loss: 1.0138
Epoch 169, accuracy: 0.7590
Epoch 170, accuracy: 0.7590
Epoch 170, Train Loss: 0.1407, Val Loss: 1.0138
Epoch 171, accuracy: 0.7590
Epoch 172, accuracy: 0.7590
Epoch 172, Train Loss: 0.1246, Val Loss: 1.0138
Epoch 173, accuracy: 0.7590
Epoch 174, accuracy: 0.7590
Epoch 174, Train Loss: 0.1346, Val Loss: 1.0138
Epoch 175, accuracy: 0.7590
Epoch 176, accuracy: 0.7590
Epoch 176, Train Loss: 0.1888, Val Loss: 1.0138
Epoch 177, accuracy: 0.7590
Epoch 178, accuracy: 0.7590
Epoch 178, Train Loss: 0.1272, Val Loss: 1.0138
Epoch 179, accuracy: 0.7590
Epoch 180, accuracy: 0.7590
Epoch 180, Train Loss: 0.1349, Val Loss: 1.0138
Epoch 181, accuracy: 0.7590
Epoch 182, accuracy: 0.7590
Epoch 182, Train Loss: 0.1399, Val Loss: 1.0138
Epoch 183, accuracy: 0.7590
Epoch 184, accuracy: 0.7590
Epoch 184, Train Loss: 0.1369, Val Loss: 1.0138
Epoch 185, accuracy: 0.7590
Epoch 186, accuracy: 0.7590
Epoch 186, Train Loss: 0.1465, Val Loss: 1.0138
Epoch 187, accuracy: 0.7590
Epoch 188, accuracy: 0.7590
Epoch 188, Train Loss: 0.1539, Val Loss: 1.0138
Epoch 189, accuracy: 0.7590
Epoch 190, accuracy: 0.7590
Epoch 190, Train Loss: 0.1219, Val Loss: 1.0138
Epoch 191, accuracy: 0.7590
Epoch 192, accuracy: 0.7590
Epoch 192, Train Loss: 0.1544, Val Loss: 1.0138
Epoch 193, accuracy: 0.7590
Epoch 194, accuracy: 0.7590
Epoch 194, Train Loss: 0.1465, Val Loss: 1.0138
Epoch 195, accuracy: 0.7590
Epoch 196, accuracy: 0.7590
Epoch 196, Train Loss: 0.1368, Val Loss: 1.0138
Epoch 197, accuracy: 0.7590
Epoch 198, accuracy: 0.7590
Epoch 198, Train Loss: 0.1319, Val Loss: 1.0138
Epoch 199, accuracy: 0.7590
Loaded best model with val_loss = 0.897771418094635
test :accuracy 0.6800, f1_macro: 0.6037, f1_micro: 0.6800, auc: 0.9463
Training mamba3 with 3 layers...
可训练参数: 915885_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.9460
Epoch 0, accuracy: 0.2760
Epoch 0, Train Loss: 1.9810, Val Loss: 1.9460
✅ Epoch 1: New best model saved with val_loss = 1.4859
Epoch 1, accuracy: 0.4640
✅ Epoch 2: New best model saved with val_loss = 1.1688
Epoch 2, accuracy: 0.6690
Epoch 2, Train Loss: 1.3206, Val Loss: 1.1688
✅ Epoch 3: New best model saved with val_loss = 1.1113
Epoch 3, accuracy: 0.6570
Epoch 4, accuracy: 0.6610
Epoch 4, Train Loss: 0.7775, Val Loss: 1.1368
✅ Epoch 5: New best model saved with val_loss = 1.0460
Epoch 5, accuracy: 0.7110
✅ Epoch 6: New best model saved with val_loss = 0.9278
Epoch 6, accuracy: 0.7580
Epoch 6, Train Loss: 0.5643, Val Loss: 0.9278
✅ Epoch 7: New best model saved with val_loss = 0.8672
Epoch 7, accuracy: 0.7720
✅ Epoch 8: New best model saved with val_loss = 0.8522
Epoch 8, accuracy: 0.7810
Epoch 8, Train Loss: 0.4431, Val Loss: 0.8522
Epoch 9, accuracy: 0.7730
Epoch 10, accuracy: 0.7900
Epoch 10, Train Loss: 0.3172, Val Loss: 0.8844
Epoch 11, accuracy: 0.7910
Epoch 12, accuracy: 0.7900
Epoch 12, Train Loss: 0.1487, Val Loss: 1.0042
Epoch 13, accuracy: 0.7920
Epoch 14, accuracy: 0.7880
Epoch 14, Train Loss: 0.1696, Val Loss: 1.0808
Epoch 15, accuracy: 0.7870
Epoch 16, accuracy: 0.7860
Epoch 16, Train Loss: 0.0892, Val Loss: 1.0859
Epoch 17, accuracy: 0.7860
Epoch 18, accuracy: 0.7870
Epoch 18, Train Loss: 0.0824, Val Loss: 1.0923
Epoch 19, accuracy: 0.7850
Epoch 20, accuracy: 0.7880
Epoch 20, Train Loss: 0.1148, Val Loss: 1.0971
Epoch 21, accuracy: 0.7880
Epoch 22, accuracy: 0.7880
Epoch 22, Train Loss: 0.1607, Val Loss: 1.0975
Epoch 23, accuracy: 0.7880
Epoch 24, accuracy: 0.7880
Epoch 24, Train Loss: 0.0899, Val Loss: 1.0980
Epoch 25, accuracy: 0.7890
Epoch 26, accuracy: 0.7890
Epoch 26, Train Loss: 0.1556, Val Loss: 1.0986
Epoch 27, accuracy: 0.7890
Epoch 28, accuracy: 0.7890
Epoch 28, Train Loss: 0.1088, Val Loss: 1.0986
Epoch 29, accuracy: 0.7890
Epoch 30, accuracy: 0.7890
Epoch 30, Train Loss: 0.1270, Val Loss: 1.0986
Epoch 31, accuracy: 0.7890
Epoch 32, accuracy: 0.7890
Epoch 32, Train Loss: 0.1239, Val Loss: 1.0987
Epoch 33, accuracy: 0.7890
Epoch 34, accuracy: 0.7890
Epoch 34, Train Loss: 0.1151, Val Loss: 1.0987
Epoch 35, accuracy: 0.7890
Epoch 36, accuracy: 0.7890
Epoch 36, Train Loss: 0.1382, Val Loss: 1.0987
Epoch 37, accuracy: 0.7890
Epoch 38, accuracy: 0.7890
Epoch 38, Train Loss: 0.0831, Val Loss: 1.0987
Epoch 39, accuracy: 0.7890
Epoch 40, accuracy: 0.7890
Epoch 40, Train Loss: 0.1016, Val Loss: 1.0987
Epoch 41, accuracy: 0.7890
Epoch 42, accuracy: 0.7890
Epoch 42, Train Loss: 0.1128, Val Loss: 1.0987
Epoch 43, accuracy: 0.7890
Epoch 44, accuracy: 0.7890
Epoch 44, Train Loss: 0.1492, Val Loss: 1.0987
Epoch 45, accuracy: 0.7890
Epoch 46, accuracy: 0.7890
Epoch 46, Train Loss: 0.1073, Val Loss: 1.0987
Epoch 47, accuracy: 0.7890
Epoch 48, accuracy: 0.7890
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 48, Train Loss: 0.1173, Val Loss: 1.0987
Epoch 49, accuracy: 0.7890
Epoch 50, accuracy: 0.7890
Epoch 50, Train Loss: 0.1103, Val Loss: 1.0987
Epoch 51, accuracy: 0.7890
Epoch 52, accuracy: 0.7890
Epoch 52, Train Loss: 0.1740, Val Loss: 1.0987
Epoch 53, accuracy: 0.7890
Epoch 54, accuracy: 0.7890
Epoch 54, Train Loss: 0.1700, Val Loss: 1.0987
Epoch 55, accuracy: 0.7890
Epoch 56, accuracy: 0.7890
Epoch 56, Train Loss: 0.1309, Val Loss: 1.0987
Epoch 57, accuracy: 0.7890
Epoch 58, accuracy: 0.7890
Epoch 58, Train Loss: 0.0715, Val Loss: 1.0987
Epoch 59, accuracy: 0.7890
Epoch 60, accuracy: 0.7890
Epoch 60, Train Loss: 0.1100, Val Loss: 1.0987
Epoch 61, accuracy: 0.7890
Epoch 62, accuracy: 0.7890
Epoch 62, Train Loss: 0.1042, Val Loss: 1.0987
Epoch 63, accuracy: 0.7890
Epoch 64, accuracy: 0.7890
Epoch 64, Train Loss: 0.1152, Val Loss: 1.0987
Epoch 65, accuracy: 0.7890
Epoch 66, accuracy: 0.7890
Epoch 66, Train Loss: 0.0801, Val Loss: 1.0987
Epoch 67, accuracy: 0.7890
Epoch 68, accuracy: 0.7890
Epoch 68, Train Loss: 0.0991, Val Loss: 1.0987
Epoch 69, accuracy: 0.7890
Epoch 70, accuracy: 0.7890
Epoch 70, Train Loss: 0.1218, Val Loss: 1.0987
Epoch 71, accuracy: 0.7890
Epoch 72, accuracy: 0.7890
Epoch 72, Train Loss: 0.0872, Val Loss: 1.0987
Epoch 73, accuracy: 0.7890
Epoch 74, accuracy: 0.7890
Epoch 74, Train Loss: 0.0795, Val Loss: 1.0987
Epoch 75, accuracy: 0.7890
Epoch 76, accuracy: 0.7890
Epoch 76, Train Loss: 0.0973, Val Loss: 1.0987
Epoch 77, accuracy: 0.7890
Epoch 78, accuracy: 0.7890
Epoch 78, Train Loss: 0.1420, Val Loss: 1.0987
Epoch 79, accuracy: 0.7890
Epoch 80, accuracy: 0.7890
Epoch 80, Train Loss: 0.1394, Val Loss: 1.0987
Epoch 81, accuracy: 0.7890
Epoch 82, accuracy: 0.7890
Epoch 82, Train Loss: 0.0979, Val Loss: 1.0987
Epoch 83, accuracy: 0.7890
Epoch 84, accuracy: 0.7890
Epoch 84, Train Loss: 0.1237, Val Loss: 1.0987
Epoch 85, accuracy: 0.7890
Epoch 86, accuracy: 0.7890
Epoch 86, Train Loss: 0.1195, Val Loss: 1.0987
Epoch 87, accuracy: 0.7890
Epoch 88, accuracy: 0.7890
Epoch 88, Train Loss: 0.1073, Val Loss: 1.0987
Epoch 89, accuracy: 0.7890
Epoch 90, accuracy: 0.7890
Epoch 90, Train Loss: 0.1206, Val Loss: 1.0987
Epoch 91, accuracy: 0.7890
Epoch 92, accuracy: 0.7890
Epoch 92, Train Loss: 0.0946, Val Loss: 1.0987
Epoch 93, accuracy: 0.7890
Epoch 94, accuracy: 0.7890
Epoch 94, Train Loss: 0.1361, Val Loss: 1.0987
Epoch 95, accuracy: 0.7890
Epoch 96, accuracy: 0.7890
Epoch 96, Train Loss: 0.2027, Val Loss: 1.0987
Epoch 97, accuracy: 0.7890
Epoch 98, accuracy: 0.7890
Epoch 98, Train Loss: 0.0789, Val Loss: 1.0987
Epoch 99, accuracy: 0.7890
Epoch 100, accuracy: 0.7890
Epoch 100, Train Loss: 0.1533, Val Loss: 1.0987
Epoch 101, accuracy: 0.7890
Epoch 102, accuracy: 0.7890
Epoch 102, Train Loss: 0.1479, Val Loss: 1.0987
Epoch 103, accuracy: 0.7890
Epoch 104, accuracy: 0.7890
Epoch 104, Train Loss: 0.0698, Val Loss: 1.0987
Epoch 105, accuracy: 0.7890
Epoch 106, accuracy: 0.7890
Epoch 106, Train Loss: 0.1056, Val Loss: 1.0987
Epoch 107, accuracy: 0.7890
Epoch 108, accuracy: 0.7890
Epoch 108, Train Loss: 0.1476, Val Loss: 1.0987
Epoch 109, accuracy: 0.7890
Epoch 110, accuracy: 0.7890
Epoch 110, Train Loss: 0.1224, Val Loss: 1.0987
Epoch 111, accuracy: 0.7890
Epoch 112, accuracy: 0.7890
Epoch 112, Train Loss: 0.1219, Val Loss: 1.0987
Epoch 113, accuracy: 0.7890
Epoch 114, accuracy: 0.7890
Epoch 114, Train Loss: 0.0936, Val Loss: 1.0987
Epoch 115, accuracy: 0.7890
Epoch 116, accuracy: 0.7890
Epoch 116, Train Loss: 0.1459, Val Loss: 1.0987
Epoch 117, accuracy: 0.7890
Epoch 118, accuracy: 0.7890
Epoch 118, Train Loss: 0.1074, Val Loss: 1.0987
Epoch 119, accuracy: 0.7890
Epoch 120, accuracy: 0.7890
Epoch 120, Train Loss: 0.0768, Val Loss: 1.0987
Epoch 121, accuracy: 0.7890
Epoch 122, accuracy: 0.7890
Epoch 122, Train Loss: 0.0958, Val Loss: 1.0987
Epoch 123, accuracy: 0.7890
Epoch 124, accuracy: 0.7890
Epoch 124, Train Loss: 0.1198, Val Loss: 1.0987
Epoch 125, accuracy: 0.7890
Epoch 126, accuracy: 0.7890
Epoch 126, Train Loss: 0.1611, Val Loss: 1.0987
Epoch 127, accuracy: 0.7890
Epoch 128, accuracy: 0.7890
Epoch 128, Train Loss: 0.1280, Val Loss: 1.0987
Epoch 129, accuracy: 0.7890
Epoch 130, accuracy: 0.7890
Epoch 130, Train Loss: 0.0751, Val Loss: 1.0987
Epoch 131, accuracy: 0.7890
Epoch 132, accuracy: 0.7890
Epoch 132, Train Loss: 0.1339, Val Loss: 1.0987
Epoch 133, accuracy: 0.7890
Epoch 134, accuracy: 0.7890
Epoch 134, Train Loss: 0.1202, Val Loss: 1.0987
Epoch 135, accuracy: 0.7890
Epoch 136, accuracy: 0.7890
Epoch 136, Train Loss: 0.0904, Val Loss: 1.0987
Epoch 137, accuracy: 0.7890
Epoch 138, accuracy: 0.7890
Epoch 138, Train Loss: 0.1131, Val Loss: 1.0987
Epoch 139, accuracy: 0.7890
Epoch 140, accuracy: 0.7890
Epoch 140, Train Loss: 0.1623, Val Loss: 1.0987
Epoch 141, accuracy: 0.7890
Epoch 142, accuracy: 0.7890
Epoch 142, Train Loss: 0.1260, Val Loss: 1.0987
Epoch 143, accuracy: 0.7890
Epoch 144, accuracy: 0.7890
Epoch 144, Train Loss: 0.0860, Val Loss: 1.0987
Epoch 145, accuracy: 0.7890
Epoch 146, accuracy: 0.7890
Epoch 146, Train Loss: 0.1318, Val Loss: 1.0987
Epoch 147, accuracy: 0.7890
Epoch 148, accuracy: 0.7890
Epoch 148, Train Loss: 0.1170, Val Loss: 1.0987
Epoch 149, accuracy: 0.7890
Epoch 150, accuracy: 0.7890
Epoch 150, Train Loss: 0.1247, Val Loss: 1.0987
Epoch 151, accuracy: 0.7890
Epoch 152, accuracy: 0.7890
Epoch 152, Train Loss: 0.0998, Val Loss: 1.0987
Epoch 153, accuracy: 0.7890
Epoch 154, accuracy: 0.7890
Epoch 154, Train Loss: 0.0908, Val Loss: 1.0987
Epoch 155, accuracy: 0.7890
Epoch 156, accuracy: 0.7890
Epoch 156, Train Loss: 0.1027, Val Loss: 1.0987
Epoch 157, accuracy: 0.7890
Epoch 158, accuracy: 0.7890
Epoch 158, Train Loss: 0.1465, Val Loss: 1.0987
Epoch 159, accuracy: 0.7890
Epoch 160, accuracy: 0.7890
Epoch 160, Train Loss: 0.0922, Val Loss: 1.0987
Epoch 161, accuracy: 0.7890
Epoch 162, accuracy: 0.7890
Epoch 162, Train Loss: 0.0997, Val Loss: 1.0987
Epoch 163, accuracy: 0.7890
Epoch 164, accuracy: 0.7890
Epoch 164, Train Loss: 0.1108, Val Loss: 1.0987
Epoch 165, accuracy: 0.7890
Epoch 166, accuracy: 0.7890
Epoch 166, Train Loss: 0.0690, Val Loss: 1.0987
Epoch 167, accuracy: 0.7890
Epoch 168, accuracy: 0.7890
Epoch 168, Train Loss: 0.1111, Val Loss: 1.0987
Epoch 169, accuracy: 0.7890
Epoch 170, accuracy: 0.7890
Epoch 170, Train Loss: 0.1204, Val Loss: 1.0987
Epoch 171, accuracy: 0.7890
Epoch 172, accuracy: 0.7890
Epoch 172, Train Loss: 0.0655, Val Loss: 1.0987
Epoch 173, accuracy: 0.7890
Epoch 174, accuracy: 0.7890
Epoch 174, Train Loss: 0.1146, Val Loss: 1.0987
Epoch 175, accuracy: 0.7890
Epoch 176, accuracy: 0.7890
Epoch 176, Train Loss: 0.0625, Val Loss: 1.0987
Epoch 177, accuracy: 0.7890
Epoch 178, accuracy: 0.7890
Epoch 178, Train Loss: 0.1051, Val Loss: 1.0987
Epoch 179, accuracy: 0.7890
Epoch 180, accuracy: 0.7890
Epoch 180, Train Loss: 0.1616, Val Loss: 1.0987
Epoch 181, accuracy: 0.7890
Epoch 182, accuracy: 0.7890
Epoch 182, Train Loss: 0.1167, Val Loss: 1.0987
Epoch 183, accuracy: 0.7890
Epoch 184, accuracy: 0.7890
Epoch 184, Train Loss: 0.0731, Val Loss: 1.0987
Epoch 185, accuracy: 0.7890
Epoch 186, accuracy: 0.7890
Epoch 186, Train Loss: 0.1207, Val Loss: 1.0987
Epoch 187, accuracy: 0.7890
Epoch 188, accuracy: 0.7890
Epoch 188, Train Loss: 0.1372, Val Loss: 1.0987
Epoch 189, accuracy: 0.7890
Epoch 190, accuracy: 0.7890
Epoch 190, Train Loss: 0.1293, Val Loss: 1.0987
Epoch 191, accuracy: 0.7890
Epoch 192, accuracy: 0.7890
Epoch 192, Train Loss: 0.0801, Val Loss: 1.0987
Epoch 193, accuracy: 0.7890
Epoch 194, accuracy: 0.7890
Epoch 194, Train Loss: 0.0960, Val Loss: 1.0987
Epoch 195, accuracy: 0.7890
Epoch 196, accuracy: 0.7890
Epoch 196, Train Loss: 0.1094, Val Loss: 1.0987
Epoch 197, accuracy: 0.7890
Epoch 198, accuracy: 0.7890
Epoch 198, Train Loss: 0.1032, Val Loss: 1.0987
Epoch 199, accuracy: 0.7890
Loaded best model with val_loss = 0.8522449731826782
test :accuracy 0.7810, f1_macro: 0.7656, f1_micro: 0.7810, auc: 0.9526
Training mamba3 with 4 layers...
可训练参数: 998957_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.9951
Epoch 0, accuracy: 0.2490
Epoch 0, Train Loss: 2.1166, Val Loss: 1.9951
✅ Epoch 1: New best model saved with val_loss = 1.6544
Epoch 1, accuracy: 0.3220
✅ Epoch 2: New best model saved with val_loss = 1.3811
Epoch 2, accuracy: 0.4740
Epoch 2, Train Loss: 1.6479, Val Loss: 1.3811
Epoch 3, accuracy: 0.6200
✅ Epoch 4: New best model saved with val_loss = 1.3797
Epoch 4, accuracy: 0.6600
Epoch 4, Train Loss: 1.0227, Val Loss: 1.3797
✅ Epoch 5: New best model saved with val_loss = 1.1362
Epoch 5, accuracy: 0.7340
✅ Epoch 6: New best model saved with val_loss = 0.9968
Epoch 6, accuracy: 0.7600
Epoch 6, Train Loss: 0.7060, Val Loss: 0.9968
✅ Epoch 7: New best model saved with val_loss = 0.9369
Epoch 7, accuracy: 0.7700
✅ Epoch 8: New best model saved with val_loss = 0.9133
Epoch 8, accuracy: 0.7740
Epoch 8, Train Loss: 0.5996, Val Loss: 0.9133
Epoch 9, accuracy: 0.7820
Epoch 10, accuracy: 0.7750
Epoch 10, Train Loss: 0.5071, Val Loss: 0.9748
Epoch 11, accuracy: 0.7640
Epoch 12, accuracy: 0.7850
Epoch 12, Train Loss: 0.4209, Val Loss: 0.9817
Epoch 13, accuracy: 0.7870
Epoch 14, accuracy: 0.7850
Epoch 14, Train Loss: 0.2467, Val Loss: 1.0434
Epoch 15, accuracy: 0.7860
Epoch 16, accuracy: 0.7870
Epoch 16, Train Loss: 0.3017, Val Loss: 1.0347
Epoch 17, accuracy: 0.7910
Epoch 18, accuracy: 0.7890
Epoch 18, Train Loss: 0.3352, Val Loss: 1.0152
Epoch 19, accuracy: 0.7940
Epoch 20, accuracy: 0.7950
Epoch 20, Train Loss: 0.2623, Val Loss: 0.9934
Epoch 21, accuracy: 0.7980
Epoch 22, accuracy: 0.7980
Epoch 22, Train Loss: 0.3299, Val Loss: 0.9921
Epoch 23, accuracy: 0.8000
Epoch 24, accuracy: 0.8000
Epoch 24, Train Loss: 0.3073, Val Loss: 0.9912
Epoch 25, accuracy: 0.7990
Epoch 26, accuracy: 0.7990
Epoch 26, Train Loss: 0.2316, Val Loss: 0.9905
Epoch 27, accuracy: 0.7990
Epoch 28, accuracy: 0.7990
Epoch 28, Train Loss: 0.2543, Val Loss: 0.9905
Epoch 29, accuracy: 0.7990
Epoch 30, accuracy: 0.8000
Epoch 30, Train Loss: 0.2737, Val Loss: 0.9904
Epoch 31, accuracy: 0.8000
Epoch 32, accuracy: 0.8000
Epoch 32, Train Loss: 0.2567, Val Loss: 0.9903
Epoch 33, accuracy: 0.8000
Epoch 34, accuracy: 0.8000
Epoch 34, Train Loss: 0.2648, Val Loss: 0.9903
Epoch 35, accuracy: 0.8000
Epoch 36, accuracy: 0.8000
Epoch 36, Train Loss: 0.2582, Val Loss: 0.9903
Epoch 37, accuracy: 0.8000
Epoch 38, accuracy: 0.8000
Epoch 38, Train Loss: 0.2567, Val Loss: 0.9903
Epoch 39, accuracy: 0.8000
Epoch 40, accuracy: 0.8000
Epoch 40, Train Loss: 0.2997, Val Loss: 0.9903
Epoch 41, accuracy: 0.8000
Epoch 42, accuracy: 0.8000
Epoch 42, Train Loss: 0.2455, Val Loss: 0.9903
Epoch 43, accuracy: 0.8000
Epoch 44, accuracy: 0.8000
Epoch 44, Train Loss: 0.2412, Val Loss: 0.9903
Epoch 45, accuracy: 0.8000
Epoch 46, accuracy: 0.8000
Epoch 46, Train Loss: 0.2976, Val Loss: 0.9903
Epoch 47, accuracy: 0.8000
Epoch 48, accuracy: 0.8000
Epoch 48, Train Loss: 0.3143, Val Loss: 0.9903
Epoch 49, accuracy: 0.8000
Epoch 50, accuracy: 0.8000
Epoch 50, Train Loss: 0.2739, Val Loss: 0.9903
Epoch 51, accuracy: 0.8000
Epoch 52, accuracy: 0.8000
Epoch 52, Train Loss: 0.2732, Val Loss: 0.9903
Epoch 53, accuracy: 0.8000
Epoch 54, accuracy: 0.8000
Epoch 54, Train Loss: 0.2507, Val Loss: 0.9903
Epoch 55, accuracy: 0.8000
Epoch 56, accuracy: 0.8000
Epoch 56, Train Loss: 0.2467, Val Loss: 0.9903
Epoch 57, accuracy: 0.8000
Epoch 58, accuracy: 0.8000
Epoch 58, Train Loss: 0.2637, Val Loss: 0.9903
Epoch 59, accuracy: 0.8000
Epoch 60, accuracy: 0.8000
Epoch 60, Train Loss: 0.1784, Val Loss: 0.9903
Epoch 61, accuracy: 0.8000
Epoch 62, accuracy: 0.8000
Epoch 62, Train Loss: 0.2491, Val Loss: 0.9903
Epoch 63, accuracy: 0.8000
Epoch 64, accuracy: 0.8000
Epoch 64, Train Loss: 0.2642, Val Loss: 0.9903
Epoch 65, accuracy: 0.8000
Epoch 66, accuracy: 0.8000
Epoch 66, Train Loss: 0.2181, Val Loss: 0.9903
Epoch 67, accuracy: 0.8000
Epoch 68, accuracy: 0.8000
Epoch 68, Train Loss: 0.2357, Val Loss: 0.9903
Epoch 69, accuracy: 0.8000
Epoch 70, accuracy: 0.8000
Epoch 70, Train Loss: 0.2722, Val Loss: 0.9903
Epoch 71, accuracy: 0.8000
Epoch 72, accuracy: 0.8000
Epoch 72, Train Loss: 0.2540, Val Loss: 0.9903
Epoch 73, accuracy: 0.8000
Epoch 74, accuracy: 0.8000
Epoch 74, Train Loss: 0.2568, Val Loss: 0.9903
Epoch 75, accuracy: 0.8000
Epoch 76, accuracy: 0.8000
Epoch 76, Train Loss: 0.2408, Val Loss: 0.9903
Epoch 77, accuracy: 0.8000
Epoch 78, accuracy: 0.8000
Epoch 78, Train Loss: 0.3683, Val Loss: 0.9903
Epoch 79, accuracy: 0.8000
Epoch 80, accuracy: 0.8000
Epoch 80, Train Loss: 0.2617, Val Loss: 0.9903
Epoch 81, accuracy: 0.8000
Epoch 82, accuracy: 0.8000
Epoch 82, Train Loss: 0.2642, Val Loss: 0.9903
Epoch 83, accuracy: 0.8000
Epoch 84, accuracy: 0.8000
Epoch 84, Train Loss: 0.2257, Val Loss: 0.9903
Epoch 85, accuracy: 0.8000
Epoch 86, accuracy: 0.8000
Epoch 86, Train Loss: 0.2841, Val Loss: 0.9903
Epoch 87, accuracy: 0.8000
Epoch 88, accuracy: 0.8000
Epoch 88, Train Loss: 0.2516, Val Loss: 0.9903
Epoch 89, accuracy: 0.8000
Epoch 90, accuracy: 0.8000
Epoch 90, Train Loss: 0.2224, Val Loss: 0.9903
Epoch 91, accuracy: 0.8000
Epoch 92, accuracy: 0.8000
Epoch 92, Train Loss: 0.2727, Val Loss: 0.9903
Epoch 93, accuracy: 0.8000
Epoch 94, accuracy: 0.8000
Epoch 94, Train Loss: 0.2198, Val Loss: 0.9903
Epoch 95, accuracy: 0.8000
Epoch 96, accuracy: 0.8000
Epoch 96, Train Loss: 0.1731, Val Loss: 0.9903
Epoch 97, accuracy: 0.8000
Epoch 98, accuracy: 0.8000
Epoch 98, Train Loss: 0.2144, Val Loss: 0.9903
Epoch 99, accuracy: 0.8000
Epoch 100, accuracy: 0.8000
Epoch 100, Train Loss: 0.2621, Val Loss: 0.9903
Epoch 101, accuracy: 0.8000
Epoch 102, accuracy: 0.8000
Epoch 102, Train Loss: 0.2475, Val Loss: 0.9903
Epoch 103, accuracy: 0.8000
Epoch 104, accuracy: 0.8000
Epoch 104, Train Loss: 0.2736, Val Loss: 0.9903
Epoch 105, accuracy: 0.8000
Epoch 106, accuracy: 0.8000
Epoch 106, Train Loss: 0.1909, Val Loss: 0.9903
Epoch 107, accuracy: 0.8000
Epoch 108, accuracy: 0.8000
Epoch 108, Train Loss: 0.2842, Val Loss: 0.9903
Epoch 109, accuracy: 0.8000
Epoch 110, accuracy: 0.8000
Epoch 110, Train Loss: 0.2966, Val Loss: 0.9903
Epoch 111, accuracy: 0.8000
Epoch 112, accuracy: 0.8000
Epoch 112, Train Loss: 0.2101, Val Loss: 0.9903
Epoch 113, accuracy: 0.8000
Epoch 114, accuracy: 0.8000
Epoch 114, Train Loss: 0.2597, Val Loss: 0.9903
Epoch 115, accuracy: 0.8000
Epoch 116, accuracy: 0.8000
Epoch 116, Train Loss: 0.2598, Val Loss: 0.9903
Epoch 117, accuracy: 0.8000
Epoch 118, accuracy: 0.8000
Epoch 118, Train Loss: 0.2363, Val Loss: 0.9903
Epoch 119, accuracy: 0.8000
Epoch 120, accuracy: 0.8000
Epoch 120, Train Loss: 0.2567, Val Loss: 0.9903
Epoch 121, accuracy: 0.8000
Epoch 122, accuracy: 0.8000
Epoch 122, Train Loss: 0.2763, Val Loss: 0.9903
Epoch 123, accuracy: 0.8000
Epoch 124, accuracy: 0.8000
Epoch 124, Train Loss: 0.2342, Val Loss: 0.9903
Epoch 125, accuracy: 0.8000
Epoch 126, accuracy: 0.8000
Epoch 126, Train Loss: 0.2664, Val Loss: 0.9903
Epoch 127, accuracy: 0.8000
Epoch 128, accuracy: 0.8000
Epoch 128, Train Loss: 0.2383, Val Loss: 0.9903
Epoch 129, accuracy: 0.8000
Epoch 130, accuracy: 0.8000
Epoch 130, Train Loss: 0.2534, Val Loss: 0.9903
Epoch 131, accuracy: 0.8000
Epoch 132, accuracy: 0.8000
Epoch 132, Train Loss: 0.2456, Val Loss: 0.9903
Epoch 133, accuracy: 0.8000
Epoch 134, accuracy: 0.8000
Epoch 134, Train Loss: 0.2282, Val Loss: 0.9903
Epoch 135, accuracy: 0.8000
Epoch 136, accuracy: 0.8000
Epoch 136, Train Loss: 0.2426, Val Loss: 0.9903
Epoch 137, accuracy: 0.8000
Epoch 138, accuracy: 0.8000
Epoch 138, Train Loss: 0.2036, Val Loss: 0.9903
Epoch 139, accuracy: 0.8000
Epoch 140, accuracy: 0.8000
Epoch 140, Train Loss: 0.2606, Val Loss: 0.9903
Epoch 141, accuracy: 0.8000
Epoch 142, accuracy: 0.8000
Epoch 142, Train Loss: 0.2949, Val Loss: 0.9903
Epoch 143, accuracy: 0.8000
Epoch 144, accuracy: 0.8000
Epoch 144, Train Loss: 0.2770, Val Loss: 0.9903
Epoch 145, accuracy: 0.8000
Epoch 146, accuracy: 0.8000
Epoch 146, Train Loss: 0.2657, Val Loss: 0.9903
Epoch 147, accuracy: 0.8000
Epoch 148, accuracy: 0.8000
Epoch 148, Train Loss: 0.2760, Val Loss: 0.9903
Epoch 149, accuracy: 0.8000
Epoch 150, accuracy: 0.8000
Epoch 150, Train Loss: 0.2229, Val Loss: 0.9903
Epoch 151, accuracy: 0.8000
Epoch 152, accuracy: 0.8000
Epoch 152, Train Loss: 0.2271, Val Loss: 0.9903
Epoch 153, accuracy: 0.8000
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 154, accuracy: 0.8000
Epoch 154, Train Loss: 0.2533, Val Loss: 0.9903
Epoch 155, accuracy: 0.8000
Epoch 156, accuracy: 0.8000
Epoch 156, Train Loss: 0.3017, Val Loss: 0.9903
Epoch 157, accuracy: 0.8000
Epoch 158, accuracy: 0.8000
Epoch 158, Train Loss: 0.2198, Val Loss: 0.9903
Epoch 159, accuracy: 0.8000
Epoch 160, accuracy: 0.8000
Epoch 160, Train Loss: 0.1913, Val Loss: 0.9903
Epoch 161, accuracy: 0.8000
Epoch 162, accuracy: 0.8000
Epoch 162, Train Loss: 0.2046, Val Loss: 0.9903
Epoch 163, accuracy: 0.8000
Epoch 164, accuracy: 0.8000
Epoch 164, Train Loss: 0.1946, Val Loss: 0.9903
Epoch 165, accuracy: 0.8000
Epoch 166, accuracy: 0.8000
Epoch 166, Train Loss: 0.2540, Val Loss: 0.9903
Epoch 167, accuracy: 0.8000
Epoch 168, accuracy: 0.8000
Epoch 168, Train Loss: 0.2806, Val Loss: 0.9903
Epoch 169, accuracy: 0.8000
Epoch 170, accuracy: 0.8000
Epoch 170, Train Loss: 0.2292, Val Loss: 0.9903
Epoch 171, accuracy: 0.8000
Epoch 172, accuracy: 0.8000
Epoch 172, Train Loss: 0.2174, Val Loss: 0.9903
Epoch 173, accuracy: 0.8000
Epoch 174, accuracy: 0.8000
Epoch 174, Train Loss: 0.3856, Val Loss: 0.9903
Epoch 175, accuracy: 0.8000
Epoch 176, accuracy: 0.8000
Epoch 176, Train Loss: 0.2439, Val Loss: 0.9903
Epoch 177, accuracy: 0.8000
Epoch 178, accuracy: 0.8000
Epoch 178, Train Loss: 0.3223, Val Loss: 0.9903
Epoch 179, accuracy: 0.8000
Epoch 180, accuracy: 0.8000
Epoch 180, Train Loss: 0.2623, Val Loss: 0.9903
Epoch 181, accuracy: 0.8000
Epoch 182, accuracy: 0.8000
Epoch 182, Train Loss: 0.2218, Val Loss: 0.9903
Epoch 183, accuracy: 0.8000
Epoch 184, accuracy: 0.8000
Epoch 184, Train Loss: 0.2010, Val Loss: 0.9903
Epoch 185, accuracy: 0.8000
Epoch 186, accuracy: 0.8000
Epoch 186, Train Loss: 0.1980, Val Loss: 0.9903
Epoch 187, accuracy: 0.8000
Epoch 188, accuracy: 0.8000
Epoch 188, Train Loss: 0.2128, Val Loss: 0.9903
Epoch 189, accuracy: 0.8000
Epoch 190, accuracy: 0.8000
Epoch 190, Train Loss: 0.2129, Val Loss: 0.9903
Epoch 191, accuracy: 0.8000
Epoch 192, accuracy: 0.8000
Epoch 192, Train Loss: 0.2661, Val Loss: 0.9903
Epoch 193, accuracy: 0.8000
Epoch 194, accuracy: 0.8000
Epoch 194, Train Loss: 0.2243, Val Loss: 0.9903
Epoch 195, accuracy: 0.8000
Epoch 196, accuracy: 0.8000
Epoch 196, Train Loss: 0.2777, Val Loss: 0.9903
Epoch 197, accuracy: 0.8000
Epoch 198, accuracy: 0.8000
Epoch 198, Train Loss: 0.2574, Val Loss: 0.9903
Epoch 199, accuracy: 0.8000
Loaded best model with val_loss = 0.9132561087608337
test :accuracy 0.7740, f1_macro: 0.7554, f1_micro: 0.7740, auc: 0.9452
Training mamba3 with 5 layers...
可训练参数: 1082029_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.8460
Epoch 0, accuracy: 0.3750
Epoch 0, Train Loss: 2.0243, Val Loss: 1.8460
✅ Epoch 1: New best model saved with val_loss = 1.4709
Epoch 1, accuracy: 0.5150
✅ Epoch 2: New best model saved with val_loss = 1.2308
Epoch 2, accuracy: 0.5340
Epoch 2, Train Loss: 1.3996, Val Loss: 1.2308
✅ Epoch 3: New best model saved with val_loss = 1.1313
Epoch 3, accuracy: 0.5930
Epoch 4, accuracy: 0.6390
Epoch 4, Train Loss: 0.7593, Val Loss: 1.1502
✅ Epoch 5: New best model saved with val_loss = 1.0516
Epoch 5, accuracy: 0.6950
✅ Epoch 6: New best model saved with val_loss = 0.8718
Epoch 6, accuracy: 0.7540
Epoch 6, Train Loss: 0.5336, Val Loss: 0.8718
✅ Epoch 7: New best model saved with val_loss = 0.7858
Epoch 7, accuracy: 0.7650
✅ Epoch 8: New best model saved with val_loss = 0.7727
Epoch 8, accuracy: 0.7810
Epoch 8, Train Loss: 0.3062, Val Loss: 0.7727
✅ Epoch 9: New best model saved with val_loss = 0.7683
Epoch 9, accuracy: 0.7880
Epoch 10, accuracy: 0.7910
Epoch 10, Train Loss: 0.3928, Val Loss: 0.8300
Epoch 11, accuracy: 0.7690
Epoch 12, accuracy: 0.8000
Epoch 12, Train Loss: 0.2321, Val Loss: 0.9563
Epoch 13, accuracy: 0.8080
Epoch 14, accuracy: 0.7970
Epoch 14, Train Loss: 0.2676, Val Loss: 1.0005
Epoch 15, accuracy: 0.7740
Epoch 16, accuracy: 0.7740
Epoch 16, Train Loss: 0.2737, Val Loss: 1.0665
Epoch 17, accuracy: 0.7750
Epoch 18, accuracy: 0.7760
Epoch 18, Train Loss: 0.2101, Val Loss: 1.0640
Epoch 19, accuracy: 0.7790
Epoch 20, accuracy: 0.7780
Epoch 20, Train Loss: 0.2328, Val Loss: 1.0540
Epoch 21, accuracy: 0.7830
Epoch 22, accuracy: 0.7830
Epoch 22, Train Loss: 0.1946, Val Loss: 1.0497
Epoch 23, accuracy: 0.7820
Epoch 24, accuracy: 0.7820
Epoch 24, Train Loss: 0.1911, Val Loss: 1.0491
Epoch 25, accuracy: 0.7820
Epoch 26, accuracy: 0.7820
Epoch 26, Train Loss: 0.1626, Val Loss: 1.0487
Epoch 27, accuracy: 0.7830
Epoch 28, accuracy: 0.7830
Epoch 28, Train Loss: 0.1942, Val Loss: 1.0483
Epoch 29, accuracy: 0.7830
Epoch 30, accuracy: 0.7830
Epoch 30, Train Loss: 0.2155, Val Loss: 1.0483
Epoch 31, accuracy: 0.7830
Epoch 32, accuracy: 0.7830
Epoch 32, Train Loss: 0.1590, Val Loss: 1.0482
Epoch 33, accuracy: 0.7830
Epoch 34, accuracy: 0.7830
Epoch 34, Train Loss: 0.1554, Val Loss: 1.0482
Epoch 35, accuracy: 0.7830
Epoch 36, accuracy: 0.7830
Epoch 36, Train Loss: 0.1864, Val Loss: 1.0482
Epoch 37, accuracy: 0.7830
Epoch 38, accuracy: 0.7830
Epoch 38, Train Loss: 0.2115, Val Loss: 1.0482
Epoch 39, accuracy: 0.7830
Epoch 40, accuracy: 0.7830
Epoch 40, Train Loss: 0.1699, Val Loss: 1.0482
Epoch 41, accuracy: 0.7830
Epoch 42, accuracy: 0.7830
Epoch 42, Train Loss: 0.2080, Val Loss: 1.0482
Epoch 43, accuracy: 0.7830
Epoch 44, accuracy: 0.7830
Epoch 44, Train Loss: 0.2142, Val Loss: 1.0482
Epoch 45, accuracy: 0.7830
Epoch 46, accuracy: 0.7830
Epoch 46, Train Loss: 0.1988, Val Loss: 1.0482
Epoch 47, accuracy: 0.7830
Epoch 48, accuracy: 0.7830
Epoch 48, Train Loss: 0.1671, Val Loss: 1.0482
Epoch 49, accuracy: 0.7830
Epoch 50, accuracy: 0.7830
Epoch 50, Train Loss: 0.1943, Val Loss: 1.0482
Epoch 51, accuracy: 0.7830
Epoch 52, accuracy: 0.7830
Epoch 52, Train Loss: 0.1404, Val Loss: 1.0482
Epoch 53, accuracy: 0.7830
Epoch 54, accuracy: 0.7830
Epoch 54, Train Loss: 0.1944, Val Loss: 1.0482
Epoch 55, accuracy: 0.7830
Epoch 56, accuracy: 0.7830
Epoch 56, Train Loss: 0.2624, Val Loss: 1.0482
Epoch 57, accuracy: 0.7830
Epoch 58, accuracy: 0.7830
Epoch 58, Train Loss: 0.1724, Val Loss: 1.0482
Epoch 59, accuracy: 0.7830
Epoch 60, accuracy: 0.7830
Epoch 60, Train Loss: 0.2031, Val Loss: 1.0482
Epoch 61, accuracy: 0.7830
Epoch 62, accuracy: 0.7830
Epoch 62, Train Loss: 0.2163, Val Loss: 1.0482
Epoch 63, accuracy: 0.7830
Epoch 64, accuracy: 0.7830
Epoch 64, Train Loss: 0.2043, Val Loss: 1.0482
Epoch 65, accuracy: 0.7830
Epoch 66, accuracy: 0.7830
Epoch 66, Train Loss: 0.1828, Val Loss: 1.0482
Epoch 67, accuracy: 0.7830
Epoch 68, accuracy: 0.7830
Epoch 68, Train Loss: 0.1585, Val Loss: 1.0482
Epoch 69, accuracy: 0.7830
Epoch 70, accuracy: 0.7830
Epoch 70, Train Loss: 0.1791, Val Loss: 1.0482
Epoch 71, accuracy: 0.7830
Epoch 72, accuracy: 0.7830
Epoch 72, Train Loss: 0.1955, Val Loss: 1.0482
Epoch 73, accuracy: 0.7830
Epoch 74, accuracy: 0.7830
Epoch 74, Train Loss: 0.1460, Val Loss: 1.0482
Epoch 75, accuracy: 0.7830
Epoch 76, accuracy: 0.7830
Epoch 76, Train Loss: 0.1396, Val Loss: 1.0482
Epoch 77, accuracy: 0.7830
Epoch 78, accuracy: 0.7830
Epoch 78, Train Loss: 0.1906, Val Loss: 1.0482
Epoch 79, accuracy: 0.7830
Epoch 80, accuracy: 0.7830
Epoch 80, Train Loss: 0.1649, Val Loss: 1.0482
Epoch 81, accuracy: 0.7830
Epoch 82, accuracy: 0.7830
Epoch 82, Train Loss: 0.1497, Val Loss: 1.0482
Epoch 83, accuracy: 0.7830
Epoch 84, accuracy: 0.7830
Epoch 84, Train Loss: 0.1948, Val Loss: 1.0482
Epoch 85, accuracy: 0.7830
Epoch 86, accuracy: 0.7830
Epoch 86, Train Loss: 0.1762, Val Loss: 1.0482
Epoch 87, accuracy: 0.7830
Epoch 88, accuracy: 0.7830
Epoch 88, Train Loss: 0.2509, Val Loss: 1.0482
Epoch 89, accuracy: 0.7830
Epoch 90, accuracy: 0.7830
Epoch 90, Train Loss: 0.1639, Val Loss: 1.0482
Epoch 91, accuracy: 0.7830
Epoch 92, accuracy: 0.7830
Epoch 92, Train Loss: 0.1959, Val Loss: 1.0482
Epoch 93, accuracy: 0.7830
Epoch 94, accuracy: 0.7830
Epoch 94, Train Loss: 0.1408, Val Loss: 1.0482
Epoch 95, accuracy: 0.7830
Epoch 96, accuracy: 0.7830
Epoch 96, Train Loss: 0.1449, Val Loss: 1.0482
Epoch 97, accuracy: 0.7830
Epoch 98, accuracy: 0.7830
Epoch 98, Train Loss: 0.1305, Val Loss: 1.0482
Epoch 99, accuracy: 0.7830
Epoch 100, accuracy: 0.7830
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 100, Train Loss: 0.1928, Val Loss: 1.0482
Epoch 101, accuracy: 0.7830
Epoch 102, accuracy: 0.7830
Epoch 102, Train Loss: 0.2547, Val Loss: 1.0482
Epoch 103, accuracy: 0.7830
Epoch 104, accuracy: 0.7830
Epoch 104, Train Loss: 0.1427, Val Loss: 1.0482
Epoch 105, accuracy: 0.7830
Epoch 106, accuracy: 0.7830
Epoch 106, Train Loss: 0.1699, Val Loss: 1.0482
Epoch 107, accuracy: 0.7830
Epoch 108, accuracy: 0.7830
Epoch 108, Train Loss: 0.1434, Val Loss: 1.0482
Epoch 109, accuracy: 0.7830
Epoch 110, accuracy: 0.7830
Epoch 110, Train Loss: 0.1820, Val Loss: 1.0482
Epoch 111, accuracy: 0.7830
Epoch 112, accuracy: 0.7830
Epoch 112, Train Loss: 0.1739, Val Loss: 1.0482
Epoch 113, accuracy: 0.7830
Epoch 114, accuracy: 0.7830
Epoch 114, Train Loss: 0.2004, Val Loss: 1.0482
Epoch 115, accuracy: 0.7830
Epoch 116, accuracy: 0.7830
Epoch 116, Train Loss: 0.2267, Val Loss: 1.0482
Epoch 117, accuracy: 0.7830
Epoch 118, accuracy: 0.7830
Epoch 118, Train Loss: 0.1984, Val Loss: 1.0482
Epoch 119, accuracy: 0.7830
Epoch 120, accuracy: 0.7830
Epoch 120, Train Loss: 0.1964, Val Loss: 1.0482
Epoch 121, accuracy: 0.7830
Epoch 122, accuracy: 0.7830
Epoch 122, Train Loss: 0.1483, Val Loss: 1.0482
Epoch 123, accuracy: 0.7830
Epoch 124, accuracy: 0.7830
Epoch 124, Train Loss: 0.2139, Val Loss: 1.0482
Epoch 125, accuracy: 0.7830
Epoch 126, accuracy: 0.7830
Epoch 126, Train Loss: 0.1336, Val Loss: 1.0482
Epoch 127, accuracy: 0.7830
Epoch 128, accuracy: 0.7830
Epoch 128, Train Loss: 0.2327, Val Loss: 1.0482
Epoch 129, accuracy: 0.7830
Epoch 130, accuracy: 0.7830
Epoch 130, Train Loss: 0.1697, Val Loss: 1.0482
Epoch 131, accuracy: 0.7830
Epoch 132, accuracy: 0.7830
Epoch 132, Train Loss: 0.1758, Val Loss: 1.0482
Epoch 133, accuracy: 0.7830
Epoch 134, accuracy: 0.7830
Epoch 134, Train Loss: 0.1903, Val Loss: 1.0482
Epoch 135, accuracy: 0.7830
Epoch 136, accuracy: 0.7830
Epoch 136, Train Loss: 0.2270, Val Loss: 1.0482
Epoch 137, accuracy: 0.7830
Epoch 138, accuracy: 0.7830
Epoch 138, Train Loss: 0.1895, Val Loss: 1.0482
Epoch 139, accuracy: 0.7830
Epoch 140, accuracy: 0.7830
Epoch 140, Train Loss: 0.2400, Val Loss: 1.0482
Epoch 141, accuracy: 0.7830
Epoch 142, accuracy: 0.7830
Epoch 142, Train Loss: 0.1676, Val Loss: 1.0482
Epoch 143, accuracy: 0.7830
Epoch 144, accuracy: 0.7830
Epoch 144, Train Loss: 0.1704, Val Loss: 1.0482
Epoch 145, accuracy: 0.7830
Epoch 146, accuracy: 0.7830
Epoch 146, Train Loss: 0.1550, Val Loss: 1.0482
Epoch 147, accuracy: 0.7830
Epoch 148, accuracy: 0.7830
Epoch 148, Train Loss: 0.2161, Val Loss: 1.0482
Epoch 149, accuracy: 0.7830
Epoch 150, accuracy: 0.7830
Epoch 150, Train Loss: 0.1727, Val Loss: 1.0482
Epoch 151, accuracy: 0.7830
Epoch 152, accuracy: 0.7830
Epoch 152, Train Loss: 0.1362, Val Loss: 1.0482
Epoch 153, accuracy: 0.7830
Epoch 154, accuracy: 0.7830
Epoch 154, Train Loss: 0.1712, Val Loss: 1.0482
Epoch 155, accuracy: 0.7830
Epoch 156, accuracy: 0.7830
Epoch 156, Train Loss: 0.2024, Val Loss: 1.0482
Epoch 157, accuracy: 0.7830
Epoch 158, accuracy: 0.7830
Epoch 158, Train Loss: 0.2051, Val Loss: 1.0482
Epoch 159, accuracy: 0.7830
Epoch 160, accuracy: 0.7830
Epoch 160, Train Loss: 0.1786, Val Loss: 1.0482
Epoch 161, accuracy: 0.7830
Epoch 162, accuracy: 0.7830
Epoch 162, Train Loss: 0.1649, Val Loss: 1.0482
Epoch 163, accuracy: 0.7830
Epoch 164, accuracy: 0.7830
Epoch 164, Train Loss: 0.1759, Val Loss: 1.0482
Epoch 165, accuracy: 0.7830
Epoch 166, accuracy: 0.7830
Epoch 166, Train Loss: 0.1646, Val Loss: 1.0482
Epoch 167, accuracy: 0.7830
Epoch 168, accuracy: 0.7830
Epoch 168, Train Loss: 0.2116, Val Loss: 1.0482
Epoch 169, accuracy: 0.7830
Epoch 170, accuracy: 0.7830
Epoch 170, Train Loss: 0.1861, Val Loss: 1.0482
Epoch 171, accuracy: 0.7830
Epoch 172, accuracy: 0.7830
Epoch 172, Train Loss: 0.2173, Val Loss: 1.0482
Epoch 173, accuracy: 0.7830
Epoch 174, accuracy: 0.7830
Epoch 174, Train Loss: 0.1581, Val Loss: 1.0482
Epoch 175, accuracy: 0.7830
Epoch 176, accuracy: 0.7830
Epoch 176, Train Loss: 0.1493, Val Loss: 1.0482
Epoch 177, accuracy: 0.7830
Epoch 178, accuracy: 0.7830
Epoch 178, Train Loss: 0.1876, Val Loss: 1.0482
Epoch 179, accuracy: 0.7830
Epoch 180, accuracy: 0.7830
Epoch 180, Train Loss: 0.1729, Val Loss: 1.0482
Epoch 181, accuracy: 0.7830
Epoch 182, accuracy: 0.7830
Epoch 182, Train Loss: 0.2286, Val Loss: 1.0482
Epoch 183, accuracy: 0.7830
Epoch 184, accuracy: 0.7830
Epoch 184, Train Loss: 0.1372, Val Loss: 1.0482
Epoch 185, accuracy: 0.7830
Epoch 186, accuracy: 0.7830
Epoch 186, Train Loss: 0.1943, Val Loss: 1.0482
Epoch 187, accuracy: 0.7830
Epoch 188, accuracy: 0.7830
Epoch 188, Train Loss: 0.2376, Val Loss: 1.0482
Epoch 189, accuracy: 0.7830
Epoch 190, accuracy: 0.7830
Epoch 190, Train Loss: 0.2088, Val Loss: 1.0482
Epoch 191, accuracy: 0.7830
Epoch 192, accuracy: 0.7830
Epoch 192, Train Loss: 0.1432, Val Loss: 1.0482
Epoch 193, accuracy: 0.7830
Epoch 194, accuracy: 0.7830
Epoch 194, Train Loss: 0.1429, Val Loss: 1.0482
Epoch 195, accuracy: 0.7830
Epoch 196, accuracy: 0.7830
Epoch 196, Train Loss: 0.1742, Val Loss: 1.0482
Epoch 197, accuracy: 0.7830
Epoch 198, accuracy: 0.7830
Epoch 198, Train Loss: 0.2008, Val Loss: 1.0482
Epoch 199, accuracy: 0.7830
Loaded best model with val_loss = 0.7683379054069519
test :accuracy 0.7880, f1_macro: 0.7798, f1_micro: 0.7880, auc: 0.9505
Training mamba3 with 6 layers...
可训练参数: 1165101_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.6129
Epoch 0, accuracy: 0.4310
Epoch 0, Train Loss: 2.0468, Val Loss: 1.6129
✅ Epoch 1: New best model saved with val_loss = 1.3409
Epoch 1, accuracy: 0.4660
✅ Epoch 2: New best model saved with val_loss = 1.1666
Epoch 2, accuracy: 0.6940
Epoch 2, Train Loss: 1.3343, Val Loss: 1.1666
✅ Epoch 3: New best model saved with val_loss = 1.1224
Epoch 3, accuracy: 0.6930
✅ Epoch 4: New best model saved with val_loss = 0.9549
Epoch 4, accuracy: 0.7440
Epoch 4, Train Loss: 0.8236, Val Loss: 0.9549
✅ Epoch 5: New best model saved with val_loss = 0.8726
Epoch 5, accuracy: 0.7410
✅ Epoch 6: New best model saved with val_loss = 0.8009
Epoch 6, accuracy: 0.7730
Epoch 6, Train Loss: 0.7018, Val Loss: 0.8009
✅ Epoch 7: New best model saved with val_loss = 0.7877
Epoch 7, accuracy: 0.7860
Epoch 8, accuracy: 0.7760
Epoch 8, Train Loss: 0.4133, Val Loss: 0.8357
Epoch 9, accuracy: 0.7800
Epoch 10, accuracy: 0.7910
Epoch 10, Train Loss: 0.3097, Val Loss: 0.8489
Epoch 11, accuracy: 0.7900
Epoch 12, accuracy: 0.7840
Epoch 12, Train Loss: 0.3245, Val Loss: 0.8359
Epoch 13, accuracy: 0.7860
Epoch 14, accuracy: 0.7880
Epoch 14, Train Loss: 0.2445, Val Loss: 0.8678
Epoch 15, accuracy: 0.7890
Epoch 16, accuracy: 0.7890
Epoch 16, Train Loss: 0.2591, Val Loss: 0.8813
Epoch 17, accuracy: 0.7900
Epoch 18, accuracy: 0.7940
Epoch 18, Train Loss: 0.3188, Val Loss: 0.9029
Epoch 19, accuracy: 0.7920
Epoch 20, accuracy: 0.7930
Epoch 20, Train Loss: 0.2006, Val Loss: 0.9141
Epoch 21, accuracy: 0.7930
Epoch 22, accuracy: 0.7940
Epoch 22, Train Loss: 0.2853, Val Loss: 0.9158
Epoch 23, accuracy: 0.7940
Epoch 24, accuracy: 0.7940
Epoch 24, Train Loss: 0.1390, Val Loss: 0.9171
Epoch 25, accuracy: 0.7940
Epoch 26, accuracy: 0.7940
Epoch 26, Train Loss: 0.1998, Val Loss: 0.9177
Epoch 27, accuracy: 0.7940
Epoch 28, accuracy: 0.7940
Epoch 28, Train Loss: 0.2518, Val Loss: 0.9178
Epoch 29, accuracy: 0.7940
Epoch 30, accuracy: 0.7940
Epoch 30, Train Loss: 0.1441, Val Loss: 0.9180
Epoch 31, accuracy: 0.7940
Epoch 32, accuracy: 0.7940
Epoch 32, Train Loss: 0.2531, Val Loss: 0.9181
Epoch 33, accuracy: 0.7940
Epoch 34, accuracy: 0.7940
Epoch 34, Train Loss: 0.2507, Val Loss: 0.9181
Epoch 35, accuracy: 0.7940
Epoch 36, accuracy: 0.7940
Epoch 36, Train Loss: 0.2367, Val Loss: 0.9181
Epoch 37, accuracy: 0.7940
Epoch 38, accuracy: 0.7940
Epoch 38, Train Loss: 0.2156, Val Loss: 0.9181
Epoch 39, accuracy: 0.7940
Epoch 40, accuracy: 0.7940
Epoch 40, Train Loss: 0.1877, Val Loss: 0.9181
Epoch 41, accuracy: 0.7940
Epoch 42, accuracy: 0.7940
Epoch 42, Train Loss: 0.2032, Val Loss: 0.9181
Epoch 43, accuracy: 0.7940
Epoch 44, accuracy: 0.7940
Epoch 44, Train Loss: 0.1634, Val Loss: 0.9181
Epoch 45, accuracy: 0.7940
Epoch 46, accuracy: 0.7940
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 46, Train Loss: 0.1928, Val Loss: 0.9181
Epoch 47, accuracy: 0.7940
Epoch 48, accuracy: 0.7940
Epoch 48, Train Loss: 0.2026, Val Loss: 0.9181
Epoch 49, accuracy: 0.7940
Epoch 50, accuracy: 0.7940
Epoch 50, Train Loss: 0.1576, Val Loss: 0.9181
Epoch 51, accuracy: 0.7940
Epoch 52, accuracy: 0.7940
Epoch 52, Train Loss: 0.2559, Val Loss: 0.9181
Epoch 53, accuracy: 0.7940
Epoch 54, accuracy: 0.7940
Epoch 54, Train Loss: 0.2252, Val Loss: 0.9181
Epoch 55, accuracy: 0.7940
Epoch 56, accuracy: 0.7940
Epoch 56, Train Loss: 0.2640, Val Loss: 0.9181
Epoch 57, accuracy: 0.7940
Epoch 58, accuracy: 0.7940
Epoch 58, Train Loss: 0.2274, Val Loss: 0.9181
Epoch 59, accuracy: 0.7940
Epoch 60, accuracy: 0.7940
Epoch 60, Train Loss: 0.2788, Val Loss: 0.9181
Epoch 61, accuracy: 0.7940
Epoch 62, accuracy: 0.7940
Epoch 62, Train Loss: 0.1930, Val Loss: 0.9181
Epoch 63, accuracy: 0.7940
Epoch 64, accuracy: 0.7940
Epoch 64, Train Loss: 0.1825, Val Loss: 0.9181
Epoch 65, accuracy: 0.7940
Epoch 66, accuracy: 0.7940
Epoch 66, Train Loss: 0.2319, Val Loss: 0.9181
Epoch 67, accuracy: 0.7940
Epoch 68, accuracy: 0.7940
Epoch 68, Train Loss: 0.2604, Val Loss: 0.9181
Epoch 69, accuracy: 0.7940
Epoch 70, accuracy: 0.7940
Epoch 70, Train Loss: 0.2609, Val Loss: 0.9181
Epoch 71, accuracy: 0.7940
Epoch 72, accuracy: 0.7940
Epoch 72, Train Loss: 0.1654, Val Loss: 0.9181
Epoch 73, accuracy: 0.7940
Epoch 74, accuracy: 0.7940
Epoch 74, Train Loss: 0.2108, Val Loss: 0.9181
Epoch 75, accuracy: 0.7940
Epoch 76, accuracy: 0.7940
Epoch 76, Train Loss: 0.1716, Val Loss: 0.9181
Epoch 77, accuracy: 0.7940
Epoch 78, accuracy: 0.7940
Epoch 78, Train Loss: 0.2265, Val Loss: 0.9181
Epoch 79, accuracy: 0.7940
Epoch 80, accuracy: 0.7940
Epoch 80, Train Loss: 0.2221, Val Loss: 0.9181
Epoch 81, accuracy: 0.7940
Epoch 82, accuracy: 0.7940
Epoch 82, Train Loss: 0.2660, Val Loss: 0.9181
Epoch 83, accuracy: 0.7940
Epoch 84, accuracy: 0.7940
Epoch 84, Train Loss: 0.2583, Val Loss: 0.9181
Epoch 85, accuracy: 0.7940
Epoch 86, accuracy: 0.7940
Epoch 86, Train Loss: 0.2438, Val Loss: 0.9181
Epoch 87, accuracy: 0.7940
Epoch 88, accuracy: 0.7940
Epoch 88, Train Loss: 0.2744, Val Loss: 0.9181
Epoch 89, accuracy: 0.7940
Epoch 90, accuracy: 0.7940
Epoch 90, Train Loss: 0.2115, Val Loss: 0.9181
Epoch 91, accuracy: 0.7940
Epoch 92, accuracy: 0.7940
Epoch 92, Train Loss: 0.2120, Val Loss: 0.9181
Epoch 93, accuracy: 0.7940
Epoch 94, accuracy: 0.7940
Epoch 94, Train Loss: 0.2065, Val Loss: 0.9181
Epoch 95, accuracy: 0.7940
Epoch 96, accuracy: 0.7940
Epoch 96, Train Loss: 0.1906, Val Loss: 0.9181
Epoch 97, accuracy: 0.7940
Epoch 98, accuracy: 0.7940
Epoch 98, Train Loss: 0.2563, Val Loss: 0.9181
Epoch 99, accuracy: 0.7940
Epoch 100, accuracy: 0.7940
Epoch 100, Train Loss: 0.2058, Val Loss: 0.9181
Epoch 101, accuracy: 0.7940
Epoch 102, accuracy: 0.7940
Epoch 102, Train Loss: 0.2295, Val Loss: 0.9181
Epoch 103, accuracy: 0.7940
Epoch 104, accuracy: 0.7940
Epoch 104, Train Loss: 0.1854, Val Loss: 0.9181
Epoch 105, accuracy: 0.7940
Epoch 106, accuracy: 0.7940
Epoch 106, Train Loss: 0.2725, Val Loss: 0.9181
Epoch 107, accuracy: 0.7940
Epoch 108, accuracy: 0.7940
Epoch 108, Train Loss: 0.1834, Val Loss: 0.9181
Epoch 109, accuracy: 0.7940
Epoch 110, accuracy: 0.7940
Epoch 110, Train Loss: 0.2470, Val Loss: 0.9181
Epoch 111, accuracy: 0.7940
Epoch 112, accuracy: 0.7940
Epoch 112, Train Loss: 0.2555, Val Loss: 0.9181
Epoch 113, accuracy: 0.7940
Epoch 114, accuracy: 0.7940
Epoch 114, Train Loss: 0.2190, Val Loss: 0.9181
Epoch 115, accuracy: 0.7940
Epoch 116, accuracy: 0.7940
Epoch 116, Train Loss: 0.2335, Val Loss: 0.9181
Epoch 117, accuracy: 0.7940
Epoch 118, accuracy: 0.7940
Epoch 118, Train Loss: 0.2083, Val Loss: 0.9181
Epoch 119, accuracy: 0.7940
Epoch 120, accuracy: 0.7940
Epoch 120, Train Loss: 0.1804, Val Loss: 0.9181
Epoch 121, accuracy: 0.7940
Epoch 122, accuracy: 0.7940
Epoch 122, Train Loss: 0.2384, Val Loss: 0.9181
Epoch 123, accuracy: 0.7940
Epoch 124, accuracy: 0.7940
Epoch 124, Train Loss: 0.2555, Val Loss: 0.9181
Epoch 125, accuracy: 0.7940
Epoch 126, accuracy: 0.7940
Epoch 126, Train Loss: 0.2070, Val Loss: 0.9181
Epoch 127, accuracy: 0.7940
Epoch 128, accuracy: 0.7940
Epoch 128, Train Loss: 0.2007, Val Loss: 0.9181
Epoch 129, accuracy: 0.7940
Epoch 130, accuracy: 0.7940
Epoch 130, Train Loss: 0.2344, Val Loss: 0.9181
Epoch 131, accuracy: 0.7940
Epoch 132, accuracy: 0.7940
Epoch 132, Train Loss: 0.2328, Val Loss: 0.9181
Epoch 133, accuracy: 0.7940
Epoch 134, accuracy: 0.7940
Epoch 134, Train Loss: 0.2369, Val Loss: 0.9181
Epoch 135, accuracy: 0.7940
Epoch 136, accuracy: 0.7940
Epoch 136, Train Loss: 0.2258, Val Loss: 0.9181
Epoch 137, accuracy: 0.7940
Epoch 138, accuracy: 0.7940
Epoch 138, Train Loss: 0.2665, Val Loss: 0.9181
Epoch 139, accuracy: 0.7940
Epoch 140, accuracy: 0.7940
Epoch 140, Train Loss: 0.2678, Val Loss: 0.9181
Epoch 141, accuracy: 0.7940
Epoch 142, accuracy: 0.7940
Epoch 142, Train Loss: 0.1842, Val Loss: 0.9181
Epoch 143, accuracy: 0.7940
Epoch 144, accuracy: 0.7940
Epoch 144, Train Loss: 0.1842, Val Loss: 0.9181
Epoch 145, accuracy: 0.7940
Epoch 146, accuracy: 0.7940
Epoch 146, Train Loss: 0.1676, Val Loss: 0.9181
Epoch 147, accuracy: 0.7940
Epoch 148, accuracy: 0.7940
Epoch 148, Train Loss: 0.2503, Val Loss: 0.9181
Epoch 149, accuracy: 0.7940
Epoch 150, accuracy: 0.7940
Epoch 150, Train Loss: 0.2454, Val Loss: 0.9181
Epoch 151, accuracy: 0.7940
Epoch 152, accuracy: 0.7940
Epoch 152, Train Loss: 0.3097, Val Loss: 0.9181
Epoch 153, accuracy: 0.7940
Epoch 154, accuracy: 0.7940
Epoch 154, Train Loss: 0.2273, Val Loss: 0.9181
Epoch 155, accuracy: 0.7940
Epoch 156, accuracy: 0.7940
Epoch 156, Train Loss: 0.3919, Val Loss: 0.9181
Epoch 157, accuracy: 0.7940
Epoch 158, accuracy: 0.7940
Epoch 158, Train Loss: 0.1736, Val Loss: 0.9181
Epoch 159, accuracy: 0.7940
Epoch 160, accuracy: 0.7940
Epoch 160, Train Loss: 0.1659, Val Loss: 0.9181
Epoch 161, accuracy: 0.7940
Epoch 162, accuracy: 0.7940
Epoch 162, Train Loss: 0.2863, Val Loss: 0.9181
Epoch 163, accuracy: 0.7940
Epoch 164, accuracy: 0.7940
Epoch 164, Train Loss: 0.3041, Val Loss: 0.9181
Epoch 165, accuracy: 0.7940
Epoch 166, accuracy: 0.7940
Epoch 166, Train Loss: 0.1712, Val Loss: 0.9181
Epoch 167, accuracy: 0.7940
Epoch 168, accuracy: 0.7940
Epoch 168, Train Loss: 0.1826, Val Loss: 0.9181
Epoch 169, accuracy: 0.7940
Epoch 170, accuracy: 0.7940
Epoch 170, Train Loss: 0.1732, Val Loss: 0.9181
Epoch 171, accuracy: 0.7940
Epoch 172, accuracy: 0.7940
Epoch 172, Train Loss: 0.2093, Val Loss: 0.9181
Epoch 173, accuracy: 0.7940
Epoch 174, accuracy: 0.7940
Epoch 174, Train Loss: 0.2285, Val Loss: 0.9181
Epoch 175, accuracy: 0.7940
Epoch 176, accuracy: 0.7940
Epoch 176, Train Loss: 0.2714, Val Loss: 0.9181
Epoch 177, accuracy: 0.7940
Epoch 178, accuracy: 0.7940
Epoch 178, Train Loss: 0.2082, Val Loss: 0.9181
Epoch 179, accuracy: 0.7940
Epoch 180, accuracy: 0.7940
Epoch 180, Train Loss: 0.2219, Val Loss: 0.9181
Epoch 181, accuracy: 0.7940
Epoch 182, accuracy: 0.7940
Epoch 182, Train Loss: 0.1941, Val Loss: 0.9181
Epoch 183, accuracy: 0.7940
Epoch 184, accuracy: 0.7940
Epoch 184, Train Loss: 0.2447, Val Loss: 0.9181
Epoch 185, accuracy: 0.7940
Epoch 186, accuracy: 0.7940
Epoch 186, Train Loss: 0.2299, Val Loss: 0.9181
Epoch 187, accuracy: 0.7940
Epoch 188, accuracy: 0.7940
Epoch 188, Train Loss: 0.2459, Val Loss: 0.9181
Epoch 189, accuracy: 0.7940
Epoch 190, accuracy: 0.7940
Epoch 190, Train Loss: 0.1803, Val Loss: 0.9181
Epoch 191, accuracy: 0.7940
Epoch 192, accuracy: 0.7940
Epoch 192, Train Loss: 0.1830, Val Loss: 0.9181
Epoch 193, accuracy: 0.7940
Epoch 194, accuracy: 0.7940
Epoch 194, Train Loss: 0.2170, Val Loss: 0.9181
Epoch 195, accuracy: 0.7940
Epoch 196, accuracy: 0.7940
Epoch 196, Train Loss: 0.2672, Val Loss: 0.9181
Epoch 197, accuracy: 0.7940
Epoch 198, accuracy: 0.7940
Epoch 198, Train Loss: 0.2108, Val Loss: 0.9181
Epoch 199, accuracy: 0.7940
Loaded best model with val_loss = 0.7876808047294617
test :accuracy 0.7860, f1_macro: 0.7778, f1_micro: 0.7860, auc: 0.9615
Training mamba3 with 7 layers...
可训练参数: 1248173_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 2.2006
Epoch 0, accuracy: 0.1620
Epoch 0, Train Loss: 1.9992, Val Loss: 2.2006
✅ Epoch 1: New best model saved with val_loss = 1.4073
Epoch 1, accuracy: 0.4800
Epoch 2, accuracy: 0.4340
Epoch 2, Train Loss: 1.4789, Val Loss: 1.5492
✅ Epoch 3: New best model saved with val_loss = 1.3413
Epoch 3, accuracy: 0.6440
✅ Epoch 4: New best model saved with val_loss = 1.2224
Epoch 4, accuracy: 0.6400
Epoch 4, Train Loss: 1.0138, Val Loss: 1.2224
✅ Epoch 5: New best model saved with val_loss = 1.0510
Epoch 5, accuracy: 0.7220
✅ Epoch 6: New best model saved with val_loss = 0.9725
Epoch 6, accuracy: 0.7430
Epoch 6, Train Loss: 0.8295, Val Loss: 0.9725
✅ Epoch 7: New best model saved with val_loss = 0.9020
Epoch 7, accuracy: 0.7510
✅ Epoch 8: New best model saved with val_loss = 0.8458
Epoch 8, accuracy: 0.7740
Epoch 8, Train Loss: 0.6847, Val Loss: 0.8458
Epoch 9, accuracy: 0.7620
Epoch 10, accuracy: 0.7440
Epoch 10, Train Loss: 0.5318, Val Loss: 0.9668
Epoch 11, accuracy: 0.7470
Epoch 12, accuracy: 0.7650
Epoch 12, Train Loss: 0.4728, Val Loss: 0.8830
Epoch 13, accuracy: 0.7690
Epoch 14, accuracy: 0.7700
Epoch 14, Train Loss: 0.3640, Val Loss: 0.8467
✅ Epoch 15: New best model saved with val_loss = 0.8446
Epoch 15, accuracy: 0.7690
✅ Epoch 16: New best model saved with val_loss = 0.8426
Epoch 16, accuracy: 0.7720
Epoch 16, Train Loss: 0.2973, Val Loss: 0.8426
✅ Epoch 17: New best model saved with val_loss = 0.8402
Epoch 17, accuracy: 0.7760
✅ Epoch 18: New best model saved with val_loss = 0.8377
Epoch 18, accuracy: 0.7790
Epoch 18, Train Loss: 0.3050, Val Loss: 0.8377
✅ Epoch 19: New best model saved with val_loss = 0.8357
Epoch 19, accuracy: 0.7820
✅ Epoch 20: New best model saved with val_loss = 0.8341
Epoch 20, accuracy: 0.7830
Epoch 20, Train Loss: 0.2918, Val Loss: 0.8341
✅ Epoch 21: New best model saved with val_loss = 0.8331
Epoch 21, accuracy: 0.7840
Epoch 22, accuracy: 0.7830
Epoch 22, Train Loss: 0.3647, Val Loss: 0.8357
Epoch 23, accuracy: 0.7810
Epoch 24, accuracy: 0.7770
Epoch 24, Train Loss: 0.3215, Val Loss: 0.8431
Epoch 25, accuracy: 0.7760
Epoch 26, accuracy: 0.7770
Epoch 26, Train Loss: 0.2770, Val Loss: 0.8450
Epoch 27, accuracy: 0.7760
Epoch 28, accuracy: 0.7760
Epoch 28, Train Loss: 0.2606, Val Loss: 0.8459
Epoch 29, accuracy: 0.7760
Epoch 30, accuracy: 0.7760
Epoch 30, Train Loss: 0.2459, Val Loss: 0.8458
Epoch 31, accuracy: 0.7760
Epoch 32, accuracy: 0.7760
Epoch 32, Train Loss: 0.2579, Val Loss: 0.8450
Epoch 33, accuracy: 0.7760
Epoch 34, accuracy: 0.7760
Epoch 34, Train Loss: 0.2943, Val Loss: 0.8444
Epoch 35, accuracy: 0.7760
Epoch 36, accuracy: 0.7760
Epoch 36, Train Loss: 0.2781, Val Loss: 0.8443
Epoch 37, accuracy: 0.7780
Epoch 38, accuracy: 0.7780
Epoch 38, Train Loss: 0.2741, Val Loss: 0.8442
Epoch 39, accuracy: 0.7780
Epoch 40, accuracy: 0.7780
Epoch 40, Train Loss: 0.3499, Val Loss: 0.8442
Epoch 41, accuracy: 0.7780
Epoch 42, accuracy: 0.7780
Epoch 42, Train Loss: 0.3103, Val Loss: 0.8441
Epoch 43, accuracy: 0.7780
Epoch 44, accuracy: 0.7780
Epoch 44, Train Loss: 0.3010, Val Loss: 0.8441
Epoch 45, accuracy: 0.7780
Epoch 46, accuracy: 0.7780
Epoch 46, Train Loss: 0.2178, Val Loss: 0.8441
Epoch 47, accuracy: 0.7780
Epoch 48, accuracy: 0.7780
Epoch 48, Train Loss: 0.2928, Val Loss: 0.8441
Epoch 49, accuracy: 0.7780
Epoch 50, accuracy: 0.7780
Epoch 50, Train Loss: 0.2795, Val Loss: 0.8441
Epoch 51, accuracy: 0.7780
Epoch 52, accuracy: 0.7780
Epoch 52, Train Loss: 0.3065, Val Loss: 0.8441
Epoch 53, accuracy: 0.7780
Epoch 54, accuracy: 0.7780
Epoch 54, Train Loss: 0.2904, Val Loss: 0.8441
Epoch 55, accuracy: 0.7780
Epoch 56, accuracy: 0.7780
Epoch 56, Train Loss: 0.3200, Val Loss: 0.8441
Epoch 57, accuracy: 0.7780
Epoch 58, accuracy: 0.7780
Epoch 58, Train Loss: 0.3127, Val Loss: 0.8441
Epoch 59, accuracy: 0.7780
Epoch 60, accuracy: 0.7780
Epoch 60, Train Loss: 0.3178, Val Loss: 0.8441
Epoch 61, accuracy: 0.7780
Epoch 62, accuracy: 0.7780
Epoch 62, Train Loss: 0.3414, Val Loss: 0.8441
Epoch 63, accuracy: 0.7780
Epoch 64, accuracy: 0.7780
Epoch 64, Train Loss: 0.2215, Val Loss: 0.8441
Epoch 65, accuracy: 0.7780
Epoch 66, accuracy: 0.7780
Epoch 66, Train Loss: 0.3616, Val Loss: 0.8441
Epoch 67, accuracy: 0.7780
Epoch 68, accuracy: 0.7780
Epoch 68, Train Loss: 0.2879, Val Loss: 0.8441
Epoch 69, accuracy: 0.7780
Epoch 70, accuracy: 0.7780
Epoch 70, Train Loss: 0.3582, Val Loss: 0.8441
Epoch 71, accuracy: 0.7780
Epoch 72, accuracy: 0.7780
Epoch 72, Train Loss: 0.2953, Val Loss: 0.8441
Epoch 73, accuracy: 0.7780
Epoch 74, accuracy: 0.7780
Epoch 74, Train Loss: 0.2688, Val Loss: 0.8441
Epoch 75, accuracy: 0.7780
Epoch 76, accuracy: 0.7780
Epoch 76, Train Loss: 0.3361, Val Loss: 0.8441
Epoch 77, accuracy: 0.7780
Epoch 78, accuracy: 0.7780
Epoch 78, Train Loss: 0.2916, Val Loss: 0.8441
Epoch 79, accuracy: 0.7780
Epoch 80, accuracy: 0.7780
Epoch 80, Train Loss: 0.2486, Val Loss: 0.8441
Epoch 81, accuracy: 0.7780
Epoch 82, accuracy: 0.7780
Epoch 82, Train Loss: 0.2568, Val Loss: 0.8441
Epoch 83, accuracy: 0.7780
Epoch 84, accuracy: 0.7780
Epoch 84, Train Loss: 0.2576, Val Loss: 0.8441
Epoch 85, accuracy: 0.7780
Epoch 86, accuracy: 0.7780
Epoch 86, Train Loss: 0.3107, Val Loss: 0.8441
Epoch 87, accuracy: 0.7780
Epoch 88, accuracy: 0.7780
Epoch 88, Train Loss: 0.2912, Val Loss: 0.8441
Epoch 89, accuracy: 0.7780
Epoch 90, accuracy: 0.7780
Epoch 90, Train Loss: 0.2474, Val Loss: 0.8441
Epoch 91, accuracy: 0.7780
Epoch 92, accuracy: 0.7780
Epoch 92, Train Loss: 0.2986, Val Loss: 0.8441
Epoch 93, accuracy: 0.7780
Epoch 94, accuracy: 0.7780
Epoch 94, Train Loss: 0.3622, Val Loss: 0.8441
Epoch 95, accuracy: 0.7780
Epoch 96, accuracy: 0.7780
Epoch 96, Train Loss: 0.2576, Val Loss: 0.8441
Epoch 97, accuracy: 0.7780
Epoch 98, accuracy: 0.7780
Epoch 98, Train Loss: 0.2756, Val Loss: 0.8441
Epoch 99, accuracy: 0.7780
Epoch 100, accuracy: 0.7780
Epoch 100, Train Loss: 0.1486, Val Loss: 0.8441
Epoch 101, accuracy: 0.7780
Epoch 102, accuracy: 0.7780
Epoch 102, Train Loss: 0.3506, Val Loss: 0.8441
Epoch 103, accuracy: 0.7780
Epoch 104, accuracy: 0.7780
Epoch 104, Train Loss: 0.2377, Val Loss: 0.8441
Epoch 105, accuracy: 0.7780
Epoch 106, accuracy: 0.7780
Epoch 106, Train Loss: 0.2574, Val Loss: 0.8441
Epoch 107, accuracy: 0.7780
Epoch 108, accuracy: 0.7780
Epoch 108, Train Loss: 0.2710, Val Loss: 0.8441
Epoch 109, accuracy: 0.7780
Epoch 110, accuracy: 0.7780
Epoch 110, Train Loss: 0.2972, Val Loss: 0.8441
Epoch 111, accuracy: 0.7780
Epoch 112, accuracy: 0.7780
Epoch 112, Train Loss: 0.2989, Val Loss: 0.8441
Epoch 113, accuracy: 0.7780
Epoch 114, accuracy: 0.7780
Epoch 114, Train Loss: 0.3441, Val Loss: 0.8441
Epoch 115, accuracy: 0.7780
Epoch 116, accuracy: 0.7780
Epoch 116, Train Loss: 0.3357, Val Loss: 0.8441
Epoch 117, accuracy: 0.7780
Epoch 118, accuracy: 0.7780
Epoch 118, Train Loss: 0.2731, Val Loss: 0.8441
Epoch 119, accuracy: 0.7780
Epoch 120, accuracy: 0.7780
Epoch 120, Train Loss: 0.2715, Val Loss: 0.8441
Epoch 121, accuracy: 0.7780
Epoch 122, accuracy: 0.7780
Epoch 122, Train Loss: 0.3022, Val Loss: 0.8441
Epoch 123, accuracy: 0.7780
Epoch 124, accuracy: 0.7780
Epoch 124, Train Loss: 0.2453, Val Loss: 0.8441
Epoch 125, accuracy: 0.7780
Epoch 126, accuracy: 0.7780
Epoch 126, Train Loss: 0.2578, Val Loss: 0.8441
Epoch 127, accuracy: 0.7780
Epoch 128, accuracy: 0.7780
Epoch 128, Train Loss: 0.2592, Val Loss: 0.8441
Epoch 129, accuracy: 0.7780
Epoch 130, accuracy: 0.7780
Epoch 130, Train Loss: 0.3015, Val Loss: 0.8441
Epoch 131, accuracy: 0.7780
Epoch 132, accuracy: 0.7780
Epoch 132, Train Loss: 0.2296, Val Loss: 0.8441
Epoch 133, accuracy: 0.7780
Epoch 134, accuracy: 0.7780
Epoch 134, Train Loss: 0.2944, Val Loss: 0.8441
Epoch 135, accuracy: 0.7780
Epoch 136, accuracy: 0.7780
Epoch 136, Train Loss: 0.2828, Val Loss: 0.8441
Epoch 137, accuracy: 0.7780
Epoch 138, accuracy: 0.7780
Epoch 138, Train Loss: 0.3225, Val Loss: 0.8441
Epoch 139, accuracy: 0.7780
Epoch 140, accuracy: 0.7780
Epoch 140, Train Loss: 0.3509, Val Loss: 0.8441
Epoch 141, accuracy: 0.7780
Epoch 142, accuracy: 0.7780
Epoch 142, Train Loss: 0.3058, Val Loss: 0.8441
Epoch 143, accuracy: 0.7780
Epoch 144, accuracy: 0.7780
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
/root/miniconda3/lib/python3.12/site-packages/torch_geometric/sampler/neighbor_sampler.py:61: UserWarning: Using 'NeighborSampler' without a 'pyg-lib' installation is deprecated and will be removed soon. Please install 'pyg-lib' for accelerated neighborhood sampling
  warnings.warn(f"Using '{self.__class__.__name__}' without a "
Epoch 144, Train Loss: 0.3848, Val Loss: 0.8441
Epoch 145, accuracy: 0.7780
Epoch 146, accuracy: 0.7780
Epoch 146, Train Loss: 0.3155, Val Loss: 0.8441
Epoch 147, accuracy: 0.7780
Epoch 148, accuracy: 0.7780
Epoch 148, Train Loss: 0.3040, Val Loss: 0.8441
Epoch 149, accuracy: 0.7780
Epoch 150, accuracy: 0.7780
Epoch 150, Train Loss: 0.3009, Val Loss: 0.8441
Epoch 151, accuracy: 0.7780
Epoch 152, accuracy: 0.7780
Epoch 152, Train Loss: 0.3178, Val Loss: 0.8441
Epoch 153, accuracy: 0.7780
Epoch 154, accuracy: 0.7780
Epoch 154, Train Loss: 0.3528, Val Loss: 0.8441
Epoch 155, accuracy: 0.7780
Epoch 156, accuracy: 0.7780
Epoch 156, Train Loss: 0.3113, Val Loss: 0.8441
Epoch 157, accuracy: 0.7780
Epoch 158, accuracy: 0.7780
Epoch 158, Train Loss: 0.3706, Val Loss: 0.8441
Epoch 159, accuracy: 0.7780
Epoch 160, accuracy: 0.7780
Epoch 160, Train Loss: 0.2453, Val Loss: 0.8441
Epoch 161, accuracy: 0.7780
Epoch 162, accuracy: 0.7780
Epoch 162, Train Loss: 0.3204, Val Loss: 0.8441
Epoch 163, accuracy: 0.7780
Epoch 164, accuracy: 0.7780
Epoch 164, Train Loss: 0.2934, Val Loss: 0.8441
Epoch 165, accuracy: 0.7780
Epoch 166, accuracy: 0.7780
Epoch 166, Train Loss: 0.2921, Val Loss: 0.8441
Epoch 167, accuracy: 0.7780
Epoch 168, accuracy: 0.7780
Epoch 168, Train Loss: 0.3121, Val Loss: 0.8441
Epoch 169, accuracy: 0.7780
Epoch 170, accuracy: 0.7780
Epoch 170, Train Loss: 0.2909, Val Loss: 0.8441
Epoch 171, accuracy: 0.7780
Epoch 172, accuracy: 0.7780
Epoch 172, Train Loss: 0.3320, Val Loss: 0.8441
Epoch 173, accuracy: 0.7780
Epoch 174, accuracy: 0.7780
Epoch 174, Train Loss: 0.3405, Val Loss: 0.8441
Epoch 175, accuracy: 0.7780
Epoch 176, accuracy: 0.7780
Epoch 176, Train Loss: 0.2762, Val Loss: 0.8441
Epoch 177, accuracy: 0.7780
Epoch 178, accuracy: 0.7780
Epoch 178, Train Loss: 0.2984, Val Loss: 0.8441
Epoch 179, accuracy: 0.7780
Epoch 180, accuracy: 0.7780
Epoch 180, Train Loss: 0.3524, Val Loss: 0.8441
Epoch 181, accuracy: 0.7780
Epoch 182, accuracy: 0.7780
Epoch 182, Train Loss: 0.2754, Val Loss: 0.8441
Epoch 183, accuracy: 0.7780
Epoch 184, accuracy: 0.7780
Epoch 184, Train Loss: 0.3212, Val Loss: 0.8441
Epoch 185, accuracy: 0.7780
Epoch 186, accuracy: 0.7780
Epoch 186, Train Loss: 0.2625, Val Loss: 0.8441
Epoch 187, accuracy: 0.7780
Epoch 188, accuracy: 0.7780
Epoch 188, Train Loss: 0.3562, Val Loss: 0.8441
Epoch 189, accuracy: 0.7780
Epoch 190, accuracy: 0.7780
Epoch 190, Train Loss: 0.2917, Val Loss: 0.8441
Epoch 191, accuracy: 0.7780
Epoch 192, accuracy: 0.7780
Epoch 192, Train Loss: 0.2931, Val Loss: 0.8441
Epoch 193, accuracy: 0.7780
Epoch 194, accuracy: 0.7780
Epoch 194, Train Loss: 0.3631, Val Loss: 0.8441
Epoch 195, accuracy: 0.7780
Epoch 196, accuracy: 0.7780
Epoch 196, Train Loss: 0.2973, Val Loss: 0.8441
Epoch 197, accuracy: 0.7780
Epoch 198, accuracy: 0.7780
Epoch 198, Train Loss: 0.2447, Val Loss: 0.8441
Epoch 199, accuracy: 0.7780
Loaded best model with val_loss = 0.8330729007720947
test :accuracy 0.7840, f1_macro: 0.7686, f1_micro: 0.7840, auc: 0.9554
Final Results: {'GAT_3_Cora': np.float64(0.801), 'GAT_4_Cora': np.float64(0.753), 'GAT_5_Cora': np.float64(0.791), 'GAT_6_Cora': np.float64(0.806), 'GAT_7_Cora': np.float64(0.68), 'mamba3_3_Cora': np.float64(0.781), 'mamba3_4_Cora': np.float64(0.774), 'mamba3_5_Cora': np.float64(0.788), 'mamba3_6_Cora': np.float64(0.786), 'mamba3_7_Cora': np.float64(0.784)} ['707363_GAT_0', '856867_GAT_0', '1006371_GAT_0', '1155875_GAT_0', '1305379_GAT_0', '915885_mamba3_0', '998957_mamba3_0', '1082029_mamba3_0', '1165101_mamba3_0', '1248173_mamba3_0']
========== Running baseline 2/3 ==========
Training GAT with 3 layers...
可训练参数: 707363_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.8096
Epoch 0, accuracy: 0.7140
Epoch 0, Train Loss: 1.9453, Val Loss: 1.8096
✅ Epoch 1: New best model saved with val_loss = 1.5377
Epoch 1, accuracy: 0.7650
✅ Epoch 2: New best model saved with val_loss = 1.1369
Epoch 2, accuracy: 0.7790
Epoch 2, Train Loss: 1.3056, Val Loss: 1.1369
✅ Epoch 3: New best model saved with val_loss = 0.8131
Epoch 3, accuracy: 0.7820
✅ Epoch 4: New best model saved with val_loss = 0.6795
Epoch 4, accuracy: 0.8020
Epoch 4, Train Loss: 0.3798, Val Loss: 0.6795
Epoch 5, accuracy: 0.7640
Epoch 6, accuracy: 0.7520
Epoch 6, Train Loss: 0.1709, Val Loss: 1.1171
Epoch 7, accuracy: 0.7640
Epoch 8, accuracy: 0.7850
Epoch 8, Train Loss: 0.0390, Val Loss: 1.4310
Epoch 9, accuracy: 0.7750
Epoch 10, accuracy: 0.7970
Epoch 10, Train Loss: 0.0508, Val Loss: 1.3400
Epoch 11, accuracy: 0.7990
Epoch 12, accuracy: 0.7940
Epoch 12, Train Loss: 0.0115, Val Loss: 1.3359
Epoch 13, accuracy: 0.7920
Epoch 14, accuracy: 0.7860
Epoch 14, Train Loss: 0.0032, Val Loss: 1.3596
Epoch 15, accuracy: 0.7850
Epoch 16, accuracy: 0.7850
Epoch 16, Train Loss: 0.0087, Val Loss: 1.3850
Epoch 17, accuracy: 0.7850
Epoch 18, accuracy: 0.7850
Epoch 18, Train Loss: 0.0212, Val Loss: 1.3876
Epoch 19, accuracy: 0.7850
Epoch 20, accuracy: 0.7860
Epoch 20, Train Loss: 0.0045, Val Loss: 1.3898
Epoch 21, accuracy: 0.7860
Epoch 22, accuracy: 0.7850
Epoch 22, Train Loss: 0.0117, Val Loss: 1.3916
Epoch 23, accuracy: 0.7850
Epoch 24, accuracy: 0.7850
Epoch 24, Train Loss: 0.0079, Val Loss: 1.3918
Epoch 25, accuracy: 0.7850
Epoch 26, accuracy: 0.7850
Epoch 26, Train Loss: 0.0129, Val Loss: 1.3920
Epoch 27, accuracy: 0.7850
Epoch 28, accuracy: 0.7860
Epoch 28, Train Loss: 0.0110, Val Loss: 1.3922
Epoch 29, accuracy: 0.7860
Epoch 30, accuracy: 0.7860
Epoch 30, Train Loss: 0.0029, Val Loss: 1.3922
Epoch 31, accuracy: 0.7860
Epoch 32, accuracy: 0.7860
Epoch 32, Train Loss: 0.0136, Val Loss: 1.3923
Epoch 33, accuracy: 0.7860
Epoch 34, accuracy: 0.7860
Epoch 34, Train Loss: 0.0084, Val Loss: 1.3923
Epoch 35, accuracy: 0.7860
Epoch 36, accuracy: 0.7860
Epoch 36, Train Loss: 0.0253, Val Loss: 1.3923
Epoch 37, accuracy: 0.7860
Epoch 38, accuracy: 0.7860
Epoch 38, Train Loss: 0.0084, Val Loss: 1.3923
Epoch 39, accuracy: 0.7860
Epoch 40, accuracy: 0.7860
Epoch 40, Train Loss: 0.0049, Val Loss: 1.3923
Epoch 41, accuracy: 0.7860
Epoch 42, accuracy: 0.7860
Epoch 42, Train Loss: 0.0072, Val Loss: 1.3923
Epoch 43, accuracy: 0.7860
Epoch 44, accuracy: 0.7860
Epoch 44, Train Loss: 0.0153, Val Loss: 1.3923
Epoch 45, accuracy: 0.7860
Epoch 46, accuracy: 0.7860
Epoch 46, Train Loss: 0.0058, Val Loss: 1.3923
Epoch 47, accuracy: 0.7860
Epoch 48, accuracy: 0.7860
Epoch 48, Train Loss: 0.0308, Val Loss: 1.3923
Epoch 49, accuracy: 0.7860
Epoch 50, accuracy: 0.7860
Epoch 50, Train Loss: 0.0221, Val Loss: 1.3923
Epoch 51, accuracy: 0.7860
Epoch 52, accuracy: 0.7860
Epoch 52, Train Loss: 0.0065, Val Loss: 1.3923
Epoch 53, accuracy: 0.7860
Epoch 54, accuracy: 0.7860
Epoch 54, Train Loss: 0.0259, Val Loss: 1.3923
Epoch 55, accuracy: 0.7860
Epoch 56, accuracy: 0.7860
Epoch 56, Train Loss: 0.0099, Val Loss: 1.3923
Epoch 57, accuracy: 0.7860
Epoch 58, accuracy: 0.7860
Epoch 58, Train Loss: 0.0102, Val Loss: 1.3923
Epoch 59, accuracy: 0.7860
Epoch 60, accuracy: 0.7860
Epoch 60, Train Loss: 0.0265, Val Loss: 1.3923
Epoch 61, accuracy: 0.7860
Epoch 62, accuracy: 0.7860
Epoch 62, Train Loss: 0.0063, Val Loss: 1.3923
Epoch 63, accuracy: 0.7860
Epoch 64, accuracy: 0.7860
Epoch 64, Train Loss: 0.0150, Val Loss: 1.3923
Epoch 65, accuracy: 0.7860
Epoch 66, accuracy: 0.7860
Epoch 66, Train Loss: 0.0300, Val Loss: 1.3923
Epoch 67, accuracy: 0.7860
Epoch 68, accuracy: 0.7860
Epoch 68, Train Loss: 0.0064, Val Loss: 1.3923
Epoch 69, accuracy: 0.7860
Epoch 70, accuracy: 0.7860
Epoch 70, Train Loss: 0.0170, Val Loss: 1.3923
Epoch 71, accuracy: 0.7860
Epoch 72, accuracy: 0.7860
Epoch 72, Train Loss: 0.0147, Val Loss: 1.3923
Epoch 73, accuracy: 0.7860
Epoch 74, accuracy: 0.7860
Epoch 74, Train Loss: 0.0088, Val Loss: 1.3923
Epoch 75, accuracy: 0.7860
Epoch 76, accuracy: 0.7860
Epoch 76, Train Loss: 0.0098, Val Loss: 1.3923
Epoch 77, accuracy: 0.7860
Epoch 78, accuracy: 0.7860
Epoch 78, Train Loss: 0.0091, Val Loss: 1.3923
Epoch 79, accuracy: 0.7860
Epoch 80, accuracy: 0.7860
Epoch 80, Train Loss: 0.0159, Val Loss: 1.3923
Epoch 81, accuracy: 0.7860
Epoch 82, accuracy: 0.7860
Epoch 82, Train Loss: 0.0030, Val Loss: 1.3923
Epoch 83, accuracy: 0.7860
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 84, accuracy: 0.7860
Epoch 84, Train Loss: 0.0115, Val Loss: 1.3923
Epoch 85, accuracy: 0.7860
Epoch 86, accuracy: 0.7860
Epoch 86, Train Loss: 0.0066, Val Loss: 1.3923
Epoch 87, accuracy: 0.7860
Epoch 88, accuracy: 0.7860
Epoch 88, Train Loss: 0.0163, Val Loss: 1.3923
Epoch 89, accuracy: 0.7860
Epoch 90, accuracy: 0.7860
Epoch 90, Train Loss: 0.0081, Val Loss: 1.3923
Epoch 91, accuracy: 0.7860
Epoch 92, accuracy: 0.7860
Epoch 92, Train Loss: 0.0187, Val Loss: 1.3923
Epoch 93, accuracy: 0.7860
Epoch 94, accuracy: 0.7860
Epoch 94, Train Loss: 0.0093, Val Loss: 1.3923
Epoch 95, accuracy: 0.7860
Epoch 96, accuracy: 0.7860
Epoch 96, Train Loss: 0.0021, Val Loss: 1.3923
Epoch 97, accuracy: 0.7860
Epoch 98, accuracy: 0.7860
Epoch 98, Train Loss: 0.0096, Val Loss: 1.3923
Epoch 99, accuracy: 0.7860
Epoch 100, accuracy: 0.7860
Epoch 100, Train Loss: 0.0050, Val Loss: 1.3923
Epoch 101, accuracy: 0.7860
Epoch 102, accuracy: 0.7860
Epoch 102, Train Loss: 0.0055, Val Loss: 1.3923
Epoch 103, accuracy: 0.7860
Epoch 104, accuracy: 0.7860
Epoch 104, Train Loss: 0.0077, Val Loss: 1.3923
Epoch 105, accuracy: 0.7860
Epoch 106, accuracy: 0.7860
Epoch 106, Train Loss: 0.0282, Val Loss: 1.3923
Epoch 107, accuracy: 0.7860
Epoch 108, accuracy: 0.7860
Epoch 108, Train Loss: 0.0055, Val Loss: 1.3923
Epoch 109, accuracy: 0.7860
Epoch 110, accuracy: 0.7860
Epoch 110, Train Loss: 0.0026, Val Loss: 1.3923
Epoch 111, accuracy: 0.7860
Epoch 112, accuracy: 0.7860
Epoch 112, Train Loss: 0.0045, Val Loss: 1.3923
Epoch 113, accuracy: 0.7860
Epoch 114, accuracy: 0.7860
Epoch 114, Train Loss: 0.0145, Val Loss: 1.3923
Epoch 115, accuracy: 0.7860
Epoch 116, accuracy: 0.7860
Epoch 116, Train Loss: 0.0072, Val Loss: 1.3923
Epoch 117, accuracy: 0.7860
Epoch 118, accuracy: 0.7860
Epoch 118, Train Loss: 0.0047, Val Loss: 1.3923
Epoch 119, accuracy: 0.7860
Epoch 120, accuracy: 0.7860
Epoch 120, Train Loss: 0.0096, Val Loss: 1.3923
Epoch 121, accuracy: 0.7860
Epoch 122, accuracy: 0.7860
Epoch 122, Train Loss: 0.0093, Val Loss: 1.3923
Epoch 123, accuracy: 0.7860
Epoch 124, accuracy: 0.7860
Epoch 124, Train Loss: 0.0022, Val Loss: 1.3923
Epoch 125, accuracy: 0.7860
Epoch 126, accuracy: 0.7860
Epoch 126, Train Loss: 0.0146, Val Loss: 1.3923
Epoch 127, accuracy: 0.7860
Epoch 128, accuracy: 0.7860
Epoch 128, Train Loss: 0.0050, Val Loss: 1.3923
Epoch 129, accuracy: 0.7860
Epoch 130, accuracy: 0.7860
Epoch 130, Train Loss: 0.0069, Val Loss: 1.3923
Epoch 131, accuracy: 0.7860
Epoch 132, accuracy: 0.7860
Epoch 132, Train Loss: 0.0110, Val Loss: 1.3923
Epoch 133, accuracy: 0.7860
Epoch 134, accuracy: 0.7860
Epoch 134, Train Loss: 0.0035, Val Loss: 1.3923
Epoch 135, accuracy: 0.7860
Epoch 136, accuracy: 0.7860
Epoch 136, Train Loss: 0.0085, Val Loss: 1.3923
Epoch 137, accuracy: 0.7860
Epoch 138, accuracy: 0.7860
Epoch 138, Train Loss: 0.0049, Val Loss: 1.3923
Epoch 139, accuracy: 0.7860
Epoch 140, accuracy: 0.7860
Epoch 140, Train Loss: 0.0040, Val Loss: 1.3923
Epoch 141, accuracy: 0.7860
Epoch 142, accuracy: 0.7860
Epoch 142, Train Loss: 0.0126, Val Loss: 1.3923
Epoch 143, accuracy: 0.7860
Epoch 144, accuracy: 0.7860
Epoch 144, Train Loss: 0.0022, Val Loss: 1.3923
Epoch 145, accuracy: 0.7860
Epoch 146, accuracy: 0.7860
Epoch 146, Train Loss: 0.0403, Val Loss: 1.3923
Epoch 147, accuracy: 0.7860
Epoch 148, accuracy: 0.7860
Epoch 148, Train Loss: 0.0099, Val Loss: 1.3923
Epoch 149, accuracy: 0.7860
Epoch 150, accuracy: 0.7860
Epoch 150, Train Loss: 0.0187, Val Loss: 1.3923
Epoch 151, accuracy: 0.7860
Epoch 152, accuracy: 0.7860
Epoch 152, Train Loss: 0.0312, Val Loss: 1.3923
Epoch 153, accuracy: 0.7860
Epoch 154, accuracy: 0.7860
Epoch 154, Train Loss: 0.0053, Val Loss: 1.3923
Epoch 155, accuracy: 0.7860
Epoch 156, accuracy: 0.7860
Epoch 156, Train Loss: 0.0056, Val Loss: 1.3923
Epoch 157, accuracy: 0.7860
Epoch 158, accuracy: 0.7860
Epoch 158, Train Loss: 0.0115, Val Loss: 1.3923
Epoch 159, accuracy: 0.7860
Epoch 160, accuracy: 0.7860
Epoch 160, Train Loss: 0.0128, Val Loss: 1.3923
Epoch 161, accuracy: 0.7860
Epoch 162, accuracy: 0.7860
Epoch 162, Train Loss: 0.0052, Val Loss: 1.3923
Epoch 163, accuracy: 0.7860
Epoch 164, accuracy: 0.7860
Epoch 164, Train Loss: 0.0122, Val Loss: 1.3923
Epoch 165, accuracy: 0.7860
Epoch 166, accuracy: 0.7860
Epoch 166, Train Loss: 0.0077, Val Loss: 1.3923
Epoch 167, accuracy: 0.7860
Epoch 168, accuracy: 0.7860
Epoch 168, Train Loss: 0.0134, Val Loss: 1.3923
Epoch 169, accuracy: 0.7860
Epoch 170, accuracy: 0.7860
Epoch 170, Train Loss: 0.0055, Val Loss: 1.3923
Epoch 171, accuracy: 0.7860
Epoch 172, accuracy: 0.7860
Epoch 172, Train Loss: 0.0203, Val Loss: 1.3923
Epoch 173, accuracy: 0.7860
Epoch 174, accuracy: 0.7860
Epoch 174, Train Loss: 0.0200, Val Loss: 1.3923
Epoch 175, accuracy: 0.7860
Epoch 176, accuracy: 0.7860
Epoch 176, Train Loss: 0.0058, Val Loss: 1.3923
Epoch 177, accuracy: 0.7860
Epoch 178, accuracy: 0.7860
Epoch 178, Train Loss: 0.0044, Val Loss: 1.3923
Epoch 179, accuracy: 0.7860
Epoch 180, accuracy: 0.7860
Epoch 180, Train Loss: 0.0065, Val Loss: 1.3923
Epoch 181, accuracy: 0.7860
Epoch 182, accuracy: 0.7860
Epoch 182, Train Loss: 0.0074, Val Loss: 1.3923
Epoch 183, accuracy: 0.7860
Epoch 184, accuracy: 0.7860
Epoch 184, Train Loss: 0.0111, Val Loss: 1.3923
Epoch 185, accuracy: 0.7860
Epoch 186, accuracy: 0.7860
Epoch 186, Train Loss: 0.0089, Val Loss: 1.3923
Epoch 187, accuracy: 0.7860
Epoch 188, accuracy: 0.7860
Epoch 188, Train Loss: 0.0103, Val Loss: 1.3923
Epoch 189, accuracy: 0.7860
Epoch 190, accuracy: 0.7860
Epoch 190, Train Loss: 0.0281, Val Loss: 1.3923
Epoch 191, accuracy: 0.7860
Epoch 192, accuracy: 0.7860
Epoch 192, Train Loss: 0.0619, Val Loss: 1.3923
Epoch 193, accuracy: 0.7860
Epoch 194, accuracy: 0.7860
Epoch 194, Train Loss: 0.0111, Val Loss: 1.3923
Epoch 195, accuracy: 0.7860
Epoch 196, accuracy: 0.7860
Epoch 196, Train Loss: 0.0143, Val Loss: 1.3923
Epoch 197, accuracy: 0.7860
Epoch 198, accuracy: 0.7860
Epoch 198, Train Loss: 0.0069, Val Loss: 1.3923
Epoch 199, accuracy: 0.7860
Loaded best model with val_loss = 0.6794766187667847
test :accuracy 0.8020, f1_macro: 0.7955, f1_micro: 0.8020, auc: 0.9673
Training GAT with 4 layers...
可训练参数: 856867_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.8757
Epoch 0, accuracy: 0.5060
Epoch 0, Train Loss: 1.9512, Val Loss: 1.8757
✅ Epoch 1: New best model saved with val_loss = 1.6308
Epoch 1, accuracy: 0.7140
✅ Epoch 2: New best model saved with val_loss = 1.1365
Epoch 2, accuracy: 0.7460
Epoch 2, Train Loss: 1.4102, Val Loss: 1.1365
✅ Epoch 3: New best model saved with val_loss = 0.6829
Epoch 3, accuracy: 0.7900
Epoch 4, accuracy: 0.7300
Epoch 4, Train Loss: 0.3381, Val Loss: 0.9889
Epoch 5, accuracy: 0.5900
Epoch 6, accuracy: 0.7690
Epoch 6, Train Loss: 0.4005, Val Loss: 1.0117
Epoch 7, accuracy: 0.7880
Epoch 8, accuracy: 0.8090
Epoch 8, Train Loss: 0.2135, Val Loss: 1.0163
Epoch 9, accuracy: 0.7770
Epoch 10, accuracy: 0.7730
Epoch 10, Train Loss: 0.0621, Val Loss: 1.2278
Epoch 11, accuracy: 0.7740
Epoch 12, accuracy: 0.7710
Epoch 12, Train Loss: 0.0466, Val Loss: 1.2517
Epoch 13, accuracy: 0.7730
Epoch 14, accuracy: 0.7680
Epoch 14, Train Loss: 0.0262, Val Loss: 1.2613
Epoch 15, accuracy: 0.7660
Epoch 16, accuracy: 0.7660
Epoch 16, Train Loss: 0.0373, Val Loss: 1.2626
Epoch 17, accuracy: 0.7640
Epoch 18, accuracy: 0.7640
Epoch 18, Train Loss: 0.0265, Val Loss: 1.2620
Epoch 19, accuracy: 0.7640
Epoch 20, accuracy: 0.7650
Epoch 20, Train Loss: 0.0319, Val Loss: 1.2612
Epoch 21, accuracy: 0.7650
Epoch 22, accuracy: 0.7650
Epoch 22, Train Loss: 0.0315, Val Loss: 1.2607
Epoch 23, accuracy: 0.7650
Epoch 24, accuracy: 0.7650
Epoch 24, Train Loss: 0.0281, Val Loss: 1.2606
Epoch 25, accuracy: 0.7650
Epoch 26, accuracy: 0.7650
Epoch 26, Train Loss: 0.0244, Val Loss: 1.2603
Epoch 27, accuracy: 0.7650
Epoch 28, accuracy: 0.7650
Epoch 28, Train Loss: 0.0275, Val Loss: 1.2601
Epoch 29, accuracy: 0.7650
Epoch 30, accuracy: 0.7650
Epoch 30, Train Loss: 0.0239, Val Loss: 1.2601
Epoch 31, accuracy: 0.7650
Epoch 32, accuracy: 0.7650
Epoch 32, Train Loss: 0.0199, Val Loss: 1.2600
Epoch 33, accuracy: 0.7650
Epoch 34, accuracy: 0.7650
Epoch 34, Train Loss: 0.0309, Val Loss: 1.2600
Epoch 35, accuracy: 0.7650
Epoch 36, accuracy: 0.7650
Epoch 36, Train Loss: 0.0347, Val Loss: 1.2600
Epoch 37, accuracy: 0.7650
Epoch 38, accuracy: 0.7650
Epoch 38, Train Loss: 0.0230, Val Loss: 1.2600
Epoch 39, accuracy: 0.7650
Epoch 40, accuracy: 0.7650
Epoch 40, Train Loss: 0.0273, Val Loss: 1.2600
Epoch 41, accuracy: 0.7650
Epoch 42, accuracy: 0.7650
Epoch 42, Train Loss: 0.0249, Val Loss: 1.2600
Epoch 43, accuracy: 0.7650
Epoch 44, accuracy: 0.7650
Epoch 44, Train Loss: 0.0288, Val Loss: 1.2600
Epoch 45, accuracy: 0.7650
Epoch 46, accuracy: 0.7650
Epoch 46, Train Loss: 0.0301, Val Loss: 1.2600
Epoch 47, accuracy: 0.7650
Epoch 48, accuracy: 0.7650
Epoch 48, Train Loss: 0.0275, Val Loss: 1.2600
Epoch 49, accuracy: 0.7650
Epoch 50, accuracy: 0.7650
Epoch 50, Train Loss: 0.0280, Val Loss: 1.2600
Epoch 51, accuracy: 0.7650
Epoch 52, accuracy: 0.7650
Epoch 52, Train Loss: 0.0345, Val Loss: 1.2600
Epoch 53, accuracy: 0.7650
Epoch 54, accuracy: 0.7650
Epoch 54, Train Loss: 0.0289, Val Loss: 1.2600
Epoch 55, accuracy: 0.7650
Epoch 56, accuracy: 0.7650
Epoch 56, Train Loss: 0.0232, Val Loss: 1.2600
Epoch 57, accuracy: 0.7650
Epoch 58, accuracy: 0.7650
Epoch 58, Train Loss: 0.0245, Val Loss: 1.2600
Epoch 59, accuracy: 0.7650
Epoch 60, accuracy: 0.7650
Epoch 60, Train Loss: 0.0206, Val Loss: 1.2600
Epoch 61, accuracy: 0.7650
Epoch 62, accuracy: 0.7650
Epoch 62, Train Loss: 0.0279, Val Loss: 1.2600
Epoch 63, accuracy: 0.7650
Epoch 64, accuracy: 0.7650
Epoch 64, Train Loss: 0.0202, Val Loss: 1.2600
Epoch 65, accuracy: 0.7650
Epoch 66, accuracy: 0.7650
Epoch 66, Train Loss: 0.0258, Val Loss: 1.2600
Epoch 67, accuracy: 0.7650
Epoch 68, accuracy: 0.7650
Epoch 68, Train Loss: 0.0433, Val Loss: 1.2600
Epoch 69, accuracy: 0.7650
Epoch 70, accuracy: 0.7650
Epoch 70, Train Loss: 0.0250, Val Loss: 1.2600
Epoch 71, accuracy: 0.7650
Epoch 72, accuracy: 0.7650
Epoch 72, Train Loss: 0.0334, Val Loss: 1.2600
Epoch 73, accuracy: 0.7650
Epoch 74, accuracy: 0.7650
Epoch 74, Train Loss: 0.0281, Val Loss: 1.2600
Epoch 75, accuracy: 0.7650
Epoch 76, accuracy: 0.7650
Epoch 76, Train Loss: 0.0325, Val Loss: 1.2600
Epoch 77, accuracy: 0.7650
Epoch 78, accuracy: 0.7650
Epoch 78, Train Loss: 0.0314, Val Loss: 1.2600
Epoch 79, accuracy: 0.7650
Epoch 80, accuracy: 0.7650
Epoch 80, Train Loss: 0.0336, Val Loss: 1.2600
Epoch 81, accuracy: 0.7650
Epoch 82, accuracy: 0.7650
Epoch 82, Train Loss: 0.0229, Val Loss: 1.2600
Epoch 83, accuracy: 0.7650
Epoch 84, accuracy: 0.7650
Epoch 84, Train Loss: 0.0414, Val Loss: 1.2600
Epoch 85, accuracy: 0.7650
Epoch 86, accuracy: 0.7650
Epoch 86, Train Loss: 0.0257, Val Loss: 1.2600
Epoch 87, accuracy: 0.7650
Epoch 88, accuracy: 0.7650
Epoch 88, Train Loss: 0.0254, Val Loss: 1.2600
Epoch 89, accuracy: 0.7650
Epoch 90, accuracy: 0.7650
Epoch 90, Train Loss: 0.0368, Val Loss: 1.2600
Epoch 91, accuracy: 0.7650
Epoch 92, accuracy: 0.7650
Epoch 92, Train Loss: 0.0203, Val Loss: 1.2600
Epoch 93, accuracy: 0.7650
Epoch 94, accuracy: 0.7650
Epoch 94, Train Loss: 0.0379, Val Loss: 1.2600
Epoch 95, accuracy: 0.7650
Epoch 96, accuracy: 0.7650
Epoch 96, Train Loss: 0.0322, Val Loss: 1.2600
Epoch 97, accuracy: 0.7650
Epoch 98, accuracy: 0.7650
Epoch 98, Train Loss: 0.0226, Val Loss: 1.2600
Epoch 99, accuracy: 0.7650
Epoch 100, accuracy: 0.7650
Epoch 100, Train Loss: 0.0295, Val Loss: 1.2600
Epoch 101, accuracy: 0.7650
Epoch 102, accuracy: 0.7650
Epoch 102, Train Loss: 0.0215, Val Loss: 1.2600
Epoch 103, accuracy: 0.7650
Epoch 104, accuracy: 0.7650
Epoch 104, Train Loss: 0.0282, Val Loss: 1.2600
Epoch 105, accuracy: 0.7650
Epoch 106, accuracy: 0.7650
Epoch 106, Train Loss: 0.0522, Val Loss: 1.2600
Epoch 107, accuracy: 0.7650
Epoch 108, accuracy: 0.7650
Epoch 108, Train Loss: 0.0241, Val Loss: 1.2600
Epoch 109, accuracy: 0.7650
Epoch 110, accuracy: 0.7650
Epoch 110, Train Loss: 0.0275, Val Loss: 1.2600
Epoch 111, accuracy: 0.7650
Epoch 112, accuracy: 0.7650
Epoch 112, Train Loss: 0.0282, Val Loss: 1.2600
Epoch 113, accuracy: 0.7650
Epoch 114, accuracy: 0.7650
Epoch 114, Train Loss: 0.0167, Val Loss: 1.2600
Epoch 115, accuracy: 0.7650
Epoch 116, accuracy: 0.7650
Epoch 116, Train Loss: 0.0385, Val Loss: 1.2600
Epoch 117, accuracy: 0.7650
Epoch 118, accuracy: 0.7650
Epoch 118, Train Loss: 0.0257, Val Loss: 1.2600
Epoch 119, accuracy: 0.7650
Epoch 120, accuracy: 0.7650
Epoch 120, Train Loss: 0.0358, Val Loss: 1.2600
Epoch 121, accuracy: 0.7650
Epoch 122, accuracy: 0.7650
Epoch 122, Train Loss: 0.0227, Val Loss: 1.2600
Epoch 123, accuracy: 0.7650
Epoch 124, accuracy: 0.7650
Epoch 124, Train Loss: 0.0233, Val Loss: 1.2600
Epoch 125, accuracy: 0.7650
Epoch 126, accuracy: 0.7650
Epoch 126, Train Loss: 0.0339, Val Loss: 1.2600
Epoch 127, accuracy: 0.7650
Epoch 128, accuracy: 0.7650
Epoch 128, Train Loss: 0.0195, Val Loss: 1.2600
Epoch 129, accuracy: 0.7650
Epoch 130, accuracy: 0.7650
Epoch 130, Train Loss: 0.0397, Val Loss: 1.2600
Epoch 131, accuracy: 0.7650
Epoch 132, accuracy: 0.7650
Epoch 132, Train Loss: 0.0262, Val Loss: 1.2600
Epoch 133, accuracy: 0.7650
Epoch 134, accuracy: 0.7650
Epoch 134, Train Loss: 0.0335, Val Loss: 1.2600
Epoch 135, accuracy: 0.7650
Epoch 136, accuracy: 0.7650
Epoch 136, Train Loss: 0.0327, Val Loss: 1.2600
Epoch 137, accuracy: 0.7650
Epoch 138, accuracy: 0.7650
Epoch 138, Train Loss: 0.0371, Val Loss: 1.2600
Epoch 139, accuracy: 0.7650
Epoch 140, accuracy: 0.7650
Epoch 140, Train Loss: 0.0267, Val Loss: 1.2600
Epoch 141, accuracy: 0.7650
Epoch 142, accuracy: 0.7650
Epoch 142, Train Loss: 0.0360, Val Loss: 1.2600
Epoch 143, accuracy: 0.7650
Epoch 144, accuracy: 0.7650
Epoch 144, Train Loss: 0.0227, Val Loss: 1.2600
Epoch 145, accuracy: 0.7650
Epoch 146, accuracy: 0.7650
Epoch 146, Train Loss: 0.0210, Val Loss: 1.2600
Epoch 147, accuracy: 0.7650
Epoch 148, accuracy: 0.7650
Epoch 148, Train Loss: 0.0268, Val Loss: 1.2600
Epoch 149, accuracy: 0.7650
Epoch 150, accuracy: 0.7650
Epoch 150, Train Loss: 0.0303, Val Loss: 1.2600
Epoch 151, accuracy: 0.7650
Epoch 152, accuracy: 0.7650
Epoch 152, Train Loss: 0.0265, Val Loss: 1.2600
Epoch 153, accuracy: 0.7650
Epoch 154, accuracy: 0.7650
Epoch 154, Train Loss: 0.0295, Val Loss: 1.2600
Epoch 155, accuracy: 0.7650
Epoch 156, accuracy: 0.7650
Epoch 156, Train Loss: 0.0185, Val Loss: 1.2600
Epoch 157, accuracy: 0.7650
Epoch 158, accuracy: 0.7650
Epoch 158, Train Loss: 0.0297, Val Loss: 1.2600
Epoch 159, accuracy: 0.7650
Epoch 160, accuracy: 0.7650
Epoch 160, Train Loss: 0.0438, Val Loss: 1.2600
Epoch 161, accuracy: 0.7650
Epoch 162, accuracy: 0.7650
Epoch 162, Train Loss: 0.0292, Val Loss: 1.2600
Epoch 163, accuracy: 0.7650
Epoch 164, accuracy: 0.7650
Epoch 164, Train Loss: 0.0399, Val Loss: 1.2600
Epoch 165, accuracy: 0.7650
Epoch 166, accuracy: 0.7650
Epoch 166, Train Loss: 0.0351, Val Loss: 1.2600
Epoch 167, accuracy: 0.7650
Epoch 168, accuracy: 0.7650
Epoch 168, Train Loss: 0.0245, Val Loss: 1.2600
Epoch 169, accuracy: 0.7650
Epoch 170, accuracy: 0.7650
Epoch 170, Train Loss: 0.0271, Val Loss: 1.2600
Epoch 171, accuracy: 0.7650
Epoch 172, accuracy: 0.7650
Epoch 172, Train Loss: 0.0263, Val Loss: 1.2600
Epoch 173, accuracy: 0.7650
Epoch 174, accuracy: 0.7650
Epoch 174, Train Loss: 0.0279, Val Loss: 1.2600
Epoch 175, accuracy: 0.7650
Epoch 176, accuracy: 0.7650
Epoch 176, Train Loss: 0.0342, Val Loss: 1.2600
Epoch 177, accuracy: 0.7650
Epoch 178, accuracy: 0.7650
Epoch 178, Train Loss: 0.0341, Val Loss: 1.2600
Epoch 179, accuracy: 0.7650
Epoch 180, accuracy: 0.7650
Epoch 180, Train Loss: 0.0222, Val Loss: 1.2600
Epoch 181, accuracy: 0.7650
Epoch 182, accuracy: 0.7650
Epoch 182, Train Loss: 0.0161, Val Loss: 1.2600
Epoch 183, accuracy: 0.7650
Epoch 184, accuracy: 0.7650
Epoch 184, Train Loss: 0.0340, Val Loss: 1.2600
Epoch 185, accuracy: 0.7650
Epoch 186, accuracy: 0.7650
Epoch 186, Train Loss: 0.0229, Val Loss: 1.2600
Epoch 187, accuracy: 0.7650
Epoch 188, accuracy: 0.7650
Epoch 188, Train Loss: 0.0238, Val Loss: 1.2600
Epoch 189, accuracy: 0.7650
Epoch 190, accuracy: 0.7650
Epoch 190, Train Loss: 0.0199, Val Loss: 1.2600
Epoch 191, accuracy: 0.7650
Epoch 192, accuracy: 0.7650
Epoch 192, Train Loss: 0.0374, Val Loss: 1.2600
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 193, accuracy: 0.7650
Epoch 194, accuracy: 0.7650
Epoch 194, Train Loss: 0.0215, Val Loss: 1.2600
Epoch 195, accuracy: 0.7650
Epoch 196, accuracy: 0.7650
Epoch 196, Train Loss: 0.0314, Val Loss: 1.2600
Epoch 197, accuracy: 0.7650
Epoch 198, accuracy: 0.7650
Epoch 198, Train Loss: 0.0263, Val Loss: 1.2600
Epoch 199, accuracy: 0.7650
Loaded best model with val_loss = 0.6829296946525574
test :accuracy 0.7900, f1_macro: 0.7855, f1_micro: 0.7900, auc: 0.9694
Training GAT with 5 layers...
可训练参数: 1006371_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.8847
Epoch 0, accuracy: 0.4200
Epoch 0, Train Loss: 1.9485, Val Loss: 1.8847
✅ Epoch 1: New best model saved with val_loss = 1.7149
Epoch 1, accuracy: 0.7290
✅ Epoch 2: New best model saved with val_loss = 1.2770
Epoch 2, accuracy: 0.7010
Epoch 2, Train Loss: 1.6455, Val Loss: 1.2770
✅ Epoch 3: New best model saved with val_loss = 1.0283
Epoch 3, accuracy: 0.7120
Epoch 4, accuracy: 0.5580
Epoch 4, Train Loss: 0.7970, Val Loss: 1.8238
Epoch 5, accuracy: 0.6510
✅ Epoch 6: New best model saved with val_loss = 0.8980
Epoch 6, accuracy: 0.7500
Epoch 6, Train Loss: 0.5046, Val Loss: 0.8980
✅ Epoch 7: New best model saved with val_loss = 0.8334
Epoch 7, accuracy: 0.7770
Epoch 8, accuracy: 0.7590
Epoch 8, Train Loss: 0.3107, Val Loss: 0.9043
Epoch 9, accuracy: 0.7810
Epoch 10, accuracy: 0.7900
Epoch 10, Train Loss: 0.1384, Val Loss: 0.9105
Epoch 11, accuracy: 0.7840
Epoch 12, accuracy: 0.7850
Epoch 12, Train Loss: 0.1049, Val Loss: 0.9541
Epoch 13, accuracy: 0.7730
Epoch 14, accuracy: 0.7730
Epoch 14, Train Loss: 0.0915, Val Loss: 1.0322
Epoch 15, accuracy: 0.7740
Epoch 16, accuracy: 0.7760
Epoch 16, Train Loss: 0.0778, Val Loss: 1.0138
Epoch 17, accuracy: 0.7820
Epoch 18, accuracy: 0.7870
Epoch 18, Train Loss: 0.0646, Val Loss: 0.9867
Epoch 19, accuracy: 0.7880
Epoch 20, accuracy: 0.7880
Epoch 20, Train Loss: 0.0595, Val Loss: 0.9734
Epoch 21, accuracy: 0.7880
Epoch 22, accuracy: 0.7880
Epoch 22, Train Loss: 0.0535, Val Loss: 0.9712
Epoch 23, accuracy: 0.7880
Epoch 24, accuracy: 0.7880
Epoch 24, Train Loss: 0.0599, Val Loss: 0.9690
Epoch 25, accuracy: 0.7870
Epoch 26, accuracy: 0.7870
Epoch 26, Train Loss: 0.0564, Val Loss: 0.9678
Epoch 27, accuracy: 0.7870
Epoch 28, accuracy: 0.7870
Epoch 28, Train Loss: 0.0584, Val Loss: 0.9676
Epoch 29, accuracy: 0.7870
Epoch 30, accuracy: 0.7870
Epoch 30, Train Loss: 0.0550, Val Loss: 0.9674
Epoch 31, accuracy: 0.7860
Epoch 32, accuracy: 0.7860
Epoch 32, Train Loss: 0.0490, Val Loss: 0.9673
Epoch 33, accuracy: 0.7860
Epoch 34, accuracy: 0.7860
Epoch 34, Train Loss: 0.0503, Val Loss: 0.9673
Epoch 35, accuracy: 0.7860
Epoch 36, accuracy: 0.7860
Epoch 36, Train Loss: 0.0591, Val Loss: 0.9673
Epoch 37, accuracy: 0.7860
Epoch 38, accuracy: 0.7860
Epoch 38, Train Loss: 0.0585, Val Loss: 0.9673
Epoch 39, accuracy: 0.7860
Epoch 40, accuracy: 0.7860
Epoch 40, Train Loss: 0.0569, Val Loss: 0.9673
Epoch 41, accuracy: 0.7860
Epoch 42, accuracy: 0.7860
Epoch 42, Train Loss: 0.0628, Val Loss: 0.9673
Epoch 43, accuracy: 0.7860
Epoch 44, accuracy: 0.7860
Epoch 44, Train Loss: 0.0540, Val Loss: 0.9673
Epoch 45, accuracy: 0.7860
Epoch 46, accuracy: 0.7860
Epoch 46, Train Loss: 0.0453, Val Loss: 0.9673
Epoch 47, accuracy: 0.7860
Epoch 48, accuracy: 0.7860
Epoch 48, Train Loss: 0.0514, Val Loss: 0.9673
Epoch 49, accuracy: 0.7860
Epoch 50, accuracy: 0.7860
Epoch 50, Train Loss: 0.0525, Val Loss: 0.9673
Epoch 51, accuracy: 0.7860
Epoch 52, accuracy: 0.7860
Epoch 52, Train Loss: 0.0574, Val Loss: 0.9673
Epoch 53, accuracy: 0.7860
Epoch 54, accuracy: 0.7860
Epoch 54, Train Loss: 0.0592, Val Loss: 0.9673
Epoch 55, accuracy: 0.7860
Epoch 56, accuracy: 0.7860
Epoch 56, Train Loss: 0.0520, Val Loss: 0.9673
Epoch 57, accuracy: 0.7860
Epoch 58, accuracy: 0.7860
Epoch 58, Train Loss: 0.0554, Val Loss: 0.9673
Epoch 59, accuracy: 0.7860
Epoch 60, accuracy: 0.7860
Epoch 60, Train Loss: 0.0512, Val Loss: 0.9673
Epoch 61, accuracy: 0.7860
Epoch 62, accuracy: 0.7860
Epoch 62, Train Loss: 0.0698, Val Loss: 0.9673
Epoch 63, accuracy: 0.7860
Epoch 64, accuracy: 0.7860
Epoch 64, Train Loss: 0.0556, Val Loss: 0.9673
Epoch 65, accuracy: 0.7860
Epoch 66, accuracy: 0.7860
Epoch 66, Train Loss: 0.0527, Val Loss: 0.9673
Epoch 67, accuracy: 0.7860
Epoch 68, accuracy: 0.7860
Epoch 68, Train Loss: 0.0504, Val Loss: 0.9673
Epoch 69, accuracy: 0.7860
Epoch 70, accuracy: 0.7860
Epoch 70, Train Loss: 0.0603, Val Loss: 0.9673
Epoch 71, accuracy: 0.7860
Epoch 72, accuracy: 0.7860
Epoch 72, Train Loss: 0.0593, Val Loss: 0.9673
Epoch 73, accuracy: 0.7860
Epoch 74, accuracy: 0.7860
Epoch 74, Train Loss: 0.0564, Val Loss: 0.9673
Epoch 75, accuracy: 0.7860
Epoch 76, accuracy: 0.7860
Epoch 76, Train Loss: 0.0519, Val Loss: 0.9673
Epoch 77, accuracy: 0.7860
Epoch 78, accuracy: 0.7860
Epoch 78, Train Loss: 0.0516, Val Loss: 0.9673
Epoch 79, accuracy: 0.7860
Epoch 80, accuracy: 0.7860
Epoch 80, Train Loss: 0.0509, Val Loss: 0.9673
Epoch 81, accuracy: 0.7860
Epoch 82, accuracy: 0.7860
Epoch 82, Train Loss: 0.0598, Val Loss: 0.9673
Epoch 83, accuracy: 0.7860
Epoch 84, accuracy: 0.7860
Epoch 84, Train Loss: 0.0582, Val Loss: 0.9673
Epoch 85, accuracy: 0.7860
Epoch 86, accuracy: 0.7860
Epoch 86, Train Loss: 0.0589, Val Loss: 0.9673
Epoch 87, accuracy: 0.7860
Epoch 88, accuracy: 0.7860
Epoch 88, Train Loss: 0.0565, Val Loss: 0.9673
Epoch 89, accuracy: 0.7860
Epoch 90, accuracy: 0.7860
Epoch 90, Train Loss: 0.0574, Val Loss: 0.9673
Epoch 91, accuracy: 0.7860
Epoch 92, accuracy: 0.7860
Epoch 92, Train Loss: 0.0583, Val Loss: 0.9673
Epoch 93, accuracy: 0.7860
Epoch 94, accuracy: 0.7860
Epoch 94, Train Loss: 0.0628, Val Loss: 0.9673
Epoch 95, accuracy: 0.7860
Epoch 96, accuracy: 0.7860
Epoch 96, Train Loss: 0.0590, Val Loss: 0.9673
Epoch 97, accuracy: 0.7860
Epoch 98, accuracy: 0.7860
Epoch 98, Train Loss: 0.0564, Val Loss: 0.9673
Epoch 99, accuracy: 0.7860
Epoch 100, accuracy: 0.7860
Epoch 100, Train Loss: 0.0567, Val Loss: 0.9673
Epoch 101, accuracy: 0.7860
Epoch 102, accuracy: 0.7860
Epoch 102, Train Loss: 0.0583, Val Loss: 0.9673
Epoch 103, accuracy: 0.7860
Epoch 104, accuracy: 0.7860
Epoch 104, Train Loss: 0.0623, Val Loss: 0.9673
Epoch 105, accuracy: 0.7860
Epoch 106, accuracy: 0.7860
Epoch 106, Train Loss: 0.0585, Val Loss: 0.9673
Epoch 107, accuracy: 0.7860
Epoch 108, accuracy: 0.7860
Epoch 108, Train Loss: 0.0650, Val Loss: 0.9673
Epoch 109, accuracy: 0.7860
Epoch 110, accuracy: 0.7860
Epoch 110, Train Loss: 0.0607, Val Loss: 0.9673
Epoch 111, accuracy: 0.7860
Epoch 112, accuracy: 0.7860
Epoch 112, Train Loss: 0.0542, Val Loss: 0.9673
Epoch 113, accuracy: 0.7860
Epoch 114, accuracy: 0.7860
Epoch 114, Train Loss: 0.0472, Val Loss: 0.9673
Epoch 115, accuracy: 0.7860
Epoch 116, accuracy: 0.7860
Epoch 116, Train Loss: 0.0448, Val Loss: 0.9673
Epoch 117, accuracy: 0.7860
Epoch 118, accuracy: 0.7860
Epoch 118, Train Loss: 0.0489, Val Loss: 0.9673
Epoch 119, accuracy: 0.7860
Epoch 120, accuracy: 0.7860
Epoch 120, Train Loss: 0.0696, Val Loss: 0.9673
Epoch 121, accuracy: 0.7860
Epoch 122, accuracy: 0.7860
Epoch 122, Train Loss: 0.0553, Val Loss: 0.9673
Epoch 123, accuracy: 0.7860
Epoch 124, accuracy: 0.7860
Epoch 124, Train Loss: 0.0525, Val Loss: 0.9673
Epoch 125, accuracy: 0.7860
Epoch 126, accuracy: 0.7860
Epoch 126, Train Loss: 0.0593, Val Loss: 0.9673
Epoch 127, accuracy: 0.7860
Epoch 128, accuracy: 0.7860
Epoch 128, Train Loss: 0.0545, Val Loss: 0.9673
Epoch 129, accuracy: 0.7860
Epoch 130, accuracy: 0.7860
Epoch 130, Train Loss: 0.0566, Val Loss: 0.9673
Epoch 131, accuracy: 0.7860
Epoch 132, accuracy: 0.7860
Epoch 132, Train Loss: 0.0591, Val Loss: 0.9673
Epoch 133, accuracy: 0.7860
Epoch 134, accuracy: 0.7860
Epoch 134, Train Loss: 0.0460, Val Loss: 0.9673
Epoch 135, accuracy: 0.7860
Epoch 136, accuracy: 0.7860
Epoch 136, Train Loss: 0.0647, Val Loss: 0.9673
Epoch 137, accuracy: 0.7860
Epoch 138, accuracy: 0.7860
Epoch 138, Train Loss: 0.0568, Val Loss: 0.9673
Epoch 139, accuracy: 0.7860
Epoch 140, accuracy: 0.7860
Epoch 140, Train Loss: 0.0717, Val Loss: 0.9673
Epoch 141, accuracy: 0.7860
Epoch 142, accuracy: 0.7860
Epoch 142, Train Loss: 0.0549, Val Loss: 0.9673
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 143, accuracy: 0.7860
Epoch 144, accuracy: 0.7860
Epoch 144, Train Loss: 0.0592, Val Loss: 0.9673
Epoch 145, accuracy: 0.7860
Epoch 146, accuracy: 0.7860
Epoch 146, Train Loss: 0.0593, Val Loss: 0.9673
Epoch 147, accuracy: 0.7860
Epoch 148, accuracy: 0.7860
Epoch 148, Train Loss: 0.0672, Val Loss: 0.9673
Epoch 149, accuracy: 0.7860
Epoch 150, accuracy: 0.7860
Epoch 150, Train Loss: 0.0598, Val Loss: 0.9673
Epoch 151, accuracy: 0.7860
Epoch 152, accuracy: 0.7860
Epoch 152, Train Loss: 0.0566, Val Loss: 0.9673
Epoch 153, accuracy: 0.7860
Epoch 154, accuracy: 0.7860
Epoch 154, Train Loss: 0.0662, Val Loss: 0.9673
Epoch 155, accuracy: 0.7860
Epoch 156, accuracy: 0.7860
Epoch 156, Train Loss: 0.0528, Val Loss: 0.9673
Epoch 157, accuracy: 0.7860
Epoch 158, accuracy: 0.7860
Epoch 158, Train Loss: 0.0468, Val Loss: 0.9673
Epoch 159, accuracy: 0.7860
Epoch 160, accuracy: 0.7860
Epoch 160, Train Loss: 0.0462, Val Loss: 0.9673
Epoch 161, accuracy: 0.7860
Epoch 162, accuracy: 0.7860
Epoch 162, Train Loss: 0.0498, Val Loss: 0.9673
Epoch 163, accuracy: 0.7860
Epoch 164, accuracy: 0.7860
Epoch 164, Train Loss: 0.0562, Val Loss: 0.9673
Epoch 165, accuracy: 0.7860
Epoch 166, accuracy: 0.7860
Epoch 166, Train Loss: 0.0638, Val Loss: 0.9673
Epoch 167, accuracy: 0.7860
Epoch 168, accuracy: 0.7860
Epoch 168, Train Loss: 0.0561, Val Loss: 0.9673
Epoch 169, accuracy: 0.7860
Epoch 170, accuracy: 0.7860
Epoch 170, Train Loss: 0.0487, Val Loss: 0.9673
Epoch 171, accuracy: 0.7860
Epoch 172, accuracy: 0.7860
Epoch 172, Train Loss: 0.0491, Val Loss: 0.9673
Epoch 173, accuracy: 0.7860
Epoch 174, accuracy: 0.7860
Epoch 174, Train Loss: 0.0655, Val Loss: 0.9673
Epoch 175, accuracy: 0.7860
Epoch 176, accuracy: 0.7860
Epoch 176, Train Loss: 0.0567, Val Loss: 0.9673
Epoch 177, accuracy: 0.7860
Epoch 178, accuracy: 0.7860
Epoch 178, Train Loss: 0.0561, Val Loss: 0.9673
Epoch 179, accuracy: 0.7860
Epoch 180, accuracy: 0.7860
Epoch 180, Train Loss: 0.0632, Val Loss: 0.9673
Epoch 181, accuracy: 0.7860
Epoch 182, accuracy: 0.7860
Epoch 182, Train Loss: 0.0486, Val Loss: 0.9673
Epoch 183, accuracy: 0.7860
Epoch 184, accuracy: 0.7860
Epoch 184, Train Loss: 0.0504, Val Loss: 0.9673
Epoch 185, accuracy: 0.7860
Epoch 186, accuracy: 0.7860
Epoch 186, Train Loss: 0.0546, Val Loss: 0.9673
Epoch 187, accuracy: 0.7860
Epoch 188, accuracy: 0.7860
Epoch 188, Train Loss: 0.0571, Val Loss: 0.9673
Epoch 189, accuracy: 0.7860
Epoch 190, accuracy: 0.7860
Epoch 190, Train Loss: 0.0461, Val Loss: 0.9673
Epoch 191, accuracy: 0.7860
Epoch 192, accuracy: 0.7860
Epoch 192, Train Loss: 0.0601, Val Loss: 0.9673
Epoch 193, accuracy: 0.7860
Epoch 194, accuracy: 0.7860
Epoch 194, Train Loss: 0.0680, Val Loss: 0.9673
Epoch 195, accuracy: 0.7860
Epoch 196, accuracy: 0.7860
Epoch 196, Train Loss: 0.0572, Val Loss: 0.9673
Epoch 197, accuracy: 0.7860
Epoch 198, accuracy: 0.7860
Epoch 198, Train Loss: 0.0592, Val Loss: 0.9673
Epoch 199, accuracy: 0.7860
Loaded best model with val_loss = 0.8334419131278992
test :accuracy 0.7770, f1_macro: 0.7336, f1_micro: 0.7770, auc: 0.9637
Training GAT with 6 layers...
可训练参数: 1155875_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.9227
Epoch 0, accuracy: 0.0830
Epoch 0, Train Loss: 1.9478, Val Loss: 1.9227
✅ Epoch 1: New best model saved with val_loss = 1.8504
Epoch 1, accuracy: 0.2410
✅ Epoch 2: New best model saved with val_loss = 1.6537
Epoch 2, accuracy: 0.4630
Epoch 2, Train Loss: 1.7955, Val Loss: 1.6537
Epoch 3, accuracy: 0.1400
Epoch 4, accuracy: 0.3560
Epoch 4, Train Loss: 2.5240, Val Loss: 1.9906
✅ Epoch 5: New best model saved with val_loss = 1.5557
Epoch 5, accuracy: 0.4280
Epoch 6, accuracy: 0.3640
Epoch 6, Train Loss: 1.6324, Val Loss: 1.5689
✅ Epoch 7: New best model saved with val_loss = 1.2997
Epoch 7, accuracy: 0.5750
✅ Epoch 8: New best model saved with val_loss = 1.2093
Epoch 8, accuracy: 0.5020
Epoch 8, Train Loss: 1.3779, Val Loss: 1.2093
✅ Epoch 9: New best model saved with val_loss = 1.1976
Epoch 9, accuracy: 0.4760
✅ Epoch 10: New best model saved with val_loss = 1.1683
Epoch 10, accuracy: 0.5640
Epoch 10, Train Loss: 1.0779, Val Loss: 1.1683
✅ Epoch 11: New best model saved with val_loss = 1.1025
Epoch 11, accuracy: 0.5840
✅ Epoch 12: New best model saved with val_loss = 0.9648
Epoch 12, accuracy: 0.6560
Epoch 12, Train Loss: 0.8983, Val Loss: 0.9648
✅ Epoch 13: New best model saved with val_loss = 0.8710
Epoch 13, accuracy: 0.6980
✅ Epoch 14: New best model saved with val_loss = 0.8422
Epoch 14, accuracy: 0.7480
Epoch 14, Train Loss: 0.6550, Val Loss: 0.8422
Epoch 15, accuracy: 0.7320
Epoch 16, accuracy: 0.7140
Epoch 16, Train Loss: 0.4271, Val Loss: 0.9741
Epoch 17, accuracy: 0.7280
Epoch 18, accuracy: 0.7730
Epoch 18, Train Loss: 0.2433, Val Loss: 1.0311
Epoch 19, accuracy: 0.7790
Epoch 20, accuracy: 0.7780
Epoch 20, Train Loss: 0.1879, Val Loss: 1.2636
Epoch 21, accuracy: 0.7780
Epoch 22, accuracy: 0.7760
Epoch 22, Train Loss: 0.1039, Val Loss: 1.2722
Epoch 23, accuracy: 0.7760
Epoch 24, accuracy: 0.7800
Epoch 24, Train Loss: 0.1177, Val Loss: 1.2854
Epoch 25, accuracy: 0.7810
Epoch 26, accuracy: 0.7800
Epoch 26, Train Loss: 0.0844, Val Loss: 1.3023
Epoch 27, accuracy: 0.7800
Epoch 28, accuracy: 0.7790
Epoch 28, Train Loss: 0.0645, Val Loss: 1.3036
Epoch 29, accuracy: 0.7790
Epoch 30, accuracy: 0.7790
Epoch 30, Train Loss: 0.0915, Val Loss: 1.3037
Epoch 31, accuracy: 0.7790
Epoch 32, accuracy: 0.7790
Epoch 32, Train Loss: 0.0905, Val Loss: 1.3023
Epoch 33, accuracy: 0.7790
Epoch 34, accuracy: 0.7790
Epoch 34, Train Loss: 0.1428, Val Loss: 1.3020
Epoch 35, accuracy: 0.7790
Epoch 36, accuracy: 0.7790
Epoch 36, Train Loss: 0.0682, Val Loss: 1.3018
Epoch 37, accuracy: 0.7790
Epoch 38, accuracy: 0.7790
Epoch 38, Train Loss: 0.0615, Val Loss: 1.3016
Epoch 39, accuracy: 0.7790
Epoch 40, accuracy: 0.7790
Epoch 40, Train Loss: 0.0830, Val Loss: 1.3016
Epoch 41, accuracy: 0.7790
Epoch 42, accuracy: 0.7780
Epoch 42, Train Loss: 0.0751, Val Loss: 1.3016
Epoch 43, accuracy: 0.7780
Epoch 44, accuracy: 0.7780
Epoch 44, Train Loss: 0.0705, Val Loss: 1.3016
Epoch 45, accuracy: 0.7780
Epoch 46, accuracy: 0.7780
Epoch 46, Train Loss: 0.0862, Val Loss: 1.3016
Epoch 47, accuracy: 0.7780
Epoch 48, accuracy: 0.7780
Epoch 48, Train Loss: 0.0848, Val Loss: 1.3016
Epoch 49, accuracy: 0.7780
Epoch 50, accuracy: 0.7780
Epoch 50, Train Loss: 0.0616, Val Loss: 1.3016
Epoch 51, accuracy: 0.7780
Epoch 52, accuracy: 0.7780
Epoch 52, Train Loss: 0.0845, Val Loss: 1.3016
Epoch 53, accuracy: 0.7780
Epoch 54, accuracy: 0.7780
Epoch 54, Train Loss: 0.0951, Val Loss: 1.3016
Epoch 55, accuracy: 0.7780
Epoch 56, accuracy: 0.7780
Epoch 56, Train Loss: 0.0559, Val Loss: 1.3016
Epoch 57, accuracy: 0.7780
Epoch 58, accuracy: 0.7780
Epoch 58, Train Loss: 0.0526, Val Loss: 1.3016
Epoch 59, accuracy: 0.7780
Epoch 60, accuracy: 0.7780
Epoch 60, Train Loss: 0.0764, Val Loss: 1.3016
Epoch 61, accuracy: 0.7780
Epoch 62, accuracy: 0.7780
Epoch 62, Train Loss: 0.1044, Val Loss: 1.3016
Epoch 63, accuracy: 0.7780
Epoch 64, accuracy: 0.7780
Epoch 64, Train Loss: 0.0687, Val Loss: 1.3016
Epoch 65, accuracy: 0.7780
Epoch 66, accuracy: 0.7780
Epoch 66, Train Loss: 0.0869, Val Loss: 1.3016
Epoch 67, accuracy: 0.7780
Epoch 68, accuracy: 0.7780
Epoch 68, Train Loss: 0.0809, Val Loss: 1.3016
Epoch 69, accuracy: 0.7780
Epoch 70, accuracy: 0.7780
Epoch 70, Train Loss: 0.0821, Val Loss: 1.3016
Epoch 71, accuracy: 0.7780
Epoch 72, accuracy: 0.7780
Epoch 72, Train Loss: 0.0965, Val Loss: 1.3016
Epoch 73, accuracy: 0.7780
Epoch 74, accuracy: 0.7780
Epoch 74, Train Loss: 0.0689, Val Loss: 1.3016
Epoch 75, accuracy: 0.7780
Epoch 76, accuracy: 0.7780
Epoch 76, Train Loss: 0.0704, Val Loss: 1.3016
Epoch 77, accuracy: 0.7780
Epoch 78, accuracy: 0.7780
Epoch 78, Train Loss: 0.0799, Val Loss: 1.3016
Epoch 79, accuracy: 0.7780
Epoch 80, accuracy: 0.7780
Epoch 80, Train Loss: 0.0845, Val Loss: 1.3016
Epoch 81, accuracy: 0.7780
Epoch 82, accuracy: 0.7780
Epoch 82, Train Loss: 0.0836, Val Loss: 1.3016
Epoch 83, accuracy: 0.7780
Epoch 84, accuracy: 0.7780
Epoch 84, Train Loss: 0.0933, Val Loss: 1.3016
Epoch 85, accuracy: 0.7780
Epoch 86, accuracy: 0.7780
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 86, Train Loss: 0.0869, Val Loss: 1.3016
Epoch 87, accuracy: 0.7780
Epoch 88, accuracy: 0.7780
Epoch 88, Train Loss: 0.0878, Val Loss: 1.3016
Epoch 89, accuracy: 0.7780
Epoch 90, accuracy: 0.7780
Epoch 90, Train Loss: 0.0658, Val Loss: 1.3016
Epoch 91, accuracy: 0.7780
Epoch 92, accuracy: 0.7780
Epoch 92, Train Loss: 0.0747, Val Loss: 1.3016
Epoch 93, accuracy: 0.7780
Epoch 94, accuracy: 0.7780
Epoch 94, Train Loss: 0.0551, Val Loss: 1.3016
Epoch 95, accuracy: 0.7780
Epoch 96, accuracy: 0.7780
Epoch 96, Train Loss: 0.0759, Val Loss: 1.3016
Epoch 97, accuracy: 0.7780
Epoch 98, accuracy: 0.7780
Epoch 98, Train Loss: 0.0682, Val Loss: 1.3016
Epoch 99, accuracy: 0.7780
Epoch 100, accuracy: 0.7780
Epoch 100, Train Loss: 0.0827, Val Loss: 1.3016
Epoch 101, accuracy: 0.7780
Epoch 102, accuracy: 0.7780
Epoch 102, Train Loss: 0.0846, Val Loss: 1.3015
Epoch 103, accuracy: 0.7780
Epoch 104, accuracy: 0.7780
Epoch 104, Train Loss: 0.1214, Val Loss: 1.3015
Epoch 105, accuracy: 0.7780
Epoch 106, accuracy: 0.7780
Epoch 106, Train Loss: 0.0966, Val Loss: 1.3015
Epoch 107, accuracy: 0.7780
Epoch 108, accuracy: 0.7780
Epoch 108, Train Loss: 0.0868, Val Loss: 1.3015
Epoch 109, accuracy: 0.7780
Epoch 110, accuracy: 0.7780
Epoch 110, Train Loss: 0.0881, Val Loss: 1.3015
Epoch 111, accuracy: 0.7780
Epoch 112, accuracy: 0.7780
Epoch 112, Train Loss: 0.0854, Val Loss: 1.3015
Epoch 113, accuracy: 0.7780
Epoch 114, accuracy: 0.7780
Epoch 114, Train Loss: 0.0903, Val Loss: 1.3015
Epoch 115, accuracy: 0.7780
Epoch 116, accuracy: 0.7780
Epoch 116, Train Loss: 0.1110, Val Loss: 1.3015
Epoch 117, accuracy: 0.7780
Epoch 118, accuracy: 0.7780
Epoch 118, Train Loss: 0.0678, Val Loss: 1.3015
Epoch 119, accuracy: 0.7780
Epoch 120, accuracy: 0.7780
Epoch 120, Train Loss: 0.0723, Val Loss: 1.3015
Epoch 121, accuracy: 0.7780
Epoch 122, accuracy: 0.7780
Epoch 122, Train Loss: 0.0667, Val Loss: 1.3015
Epoch 123, accuracy: 0.7780
Epoch 124, accuracy: 0.7780
Epoch 124, Train Loss: 0.1414, Val Loss: 1.3015
Epoch 125, accuracy: 0.7780
Epoch 126, accuracy: 0.7780
Epoch 126, Train Loss: 0.0746, Val Loss: 1.3015
Epoch 127, accuracy: 0.7780
Epoch 128, accuracy: 0.7780
Epoch 128, Train Loss: 0.0645, Val Loss: 1.3015
Epoch 129, accuracy: 0.7780
Epoch 130, accuracy: 0.7780
Epoch 130, Train Loss: 0.0812, Val Loss: 1.3015
Epoch 131, accuracy: 0.7780
Epoch 132, accuracy: 0.7780
Epoch 132, Train Loss: 0.0879, Val Loss: 1.3015
Epoch 133, accuracy: 0.7780
Epoch 134, accuracy: 0.7780
Epoch 134, Train Loss: 0.0751, Val Loss: 1.3015
Epoch 135, accuracy: 0.7780
Epoch 136, accuracy: 0.7780
Epoch 136, Train Loss: 0.0713, Val Loss: 1.3015
Epoch 137, accuracy: 0.7780
Epoch 138, accuracy: 0.7780
Epoch 138, Train Loss: 0.1029, Val Loss: 1.3015
Epoch 139, accuracy: 0.7780
Epoch 140, accuracy: 0.7780
Epoch 140, Train Loss: 0.0884, Val Loss: 1.3015
Epoch 141, accuracy: 0.7780
Epoch 142, accuracy: 0.7780
Epoch 142, Train Loss: 0.0784, Val Loss: 1.3015
Epoch 143, accuracy: 0.7780
Epoch 144, accuracy: 0.7780
Epoch 144, Train Loss: 0.0620, Val Loss: 1.3015
Epoch 145, accuracy: 0.7780
Epoch 146, accuracy: 0.7780
Epoch 146, Train Loss: 0.0854, Val Loss: 1.3015
Epoch 147, accuracy: 0.7780
Epoch 148, accuracy: 0.7780
Epoch 148, Train Loss: 0.0805, Val Loss: 1.3015
Epoch 149, accuracy: 0.7780
Epoch 150, accuracy: 0.7780
Epoch 150, Train Loss: 0.0981, Val Loss: 1.3015
Epoch 151, accuracy: 0.7780
Epoch 152, accuracy: 0.7780
Epoch 152, Train Loss: 0.0907, Val Loss: 1.3015
Epoch 153, accuracy: 0.7780
Epoch 154, accuracy: 0.7780
Epoch 154, Train Loss: 0.0876, Val Loss: 1.3015
Epoch 155, accuracy: 0.7780
Epoch 156, accuracy: 0.7780
Epoch 156, Train Loss: 0.0726, Val Loss: 1.3015
Epoch 157, accuracy: 0.7780
Epoch 158, accuracy: 0.7780
Epoch 158, Train Loss: 0.0909, Val Loss: 1.3015
Epoch 159, accuracy: 0.7780
Epoch 160, accuracy: 0.7780
Epoch 160, Train Loss: 0.0866, Val Loss: 1.3015
Epoch 161, accuracy: 0.7780
Epoch 162, accuracy: 0.7780
Epoch 162, Train Loss: 0.0758, Val Loss: 1.3015
Epoch 163, accuracy: 0.7780
Epoch 164, accuracy: 0.7780
Epoch 164, Train Loss: 0.0729, Val Loss: 1.3015
Epoch 165, accuracy: 0.7780
Epoch 166, accuracy: 0.7780
Epoch 166, Train Loss: 0.0956, Val Loss: 1.3015
Epoch 167, accuracy: 0.7780
Epoch 168, accuracy: 0.7780
Epoch 168, Train Loss: 0.0916, Val Loss: 1.3015
Epoch 169, accuracy: 0.7780
Epoch 170, accuracy: 0.7780
Epoch 170, Train Loss: 0.0642, Val Loss: 1.3015
Epoch 171, accuracy: 0.7780
Epoch 172, accuracy: 0.7780
Epoch 172, Train Loss: 0.0924, Val Loss: 1.3015
Epoch 173, accuracy: 0.7780
Epoch 174, accuracy: 0.7780
Epoch 174, Train Loss: 0.0904, Val Loss: 1.3015
Epoch 175, accuracy: 0.7780
Epoch 176, accuracy: 0.7780
Epoch 176, Train Loss: 0.1016, Val Loss: 1.3015
Epoch 177, accuracy: 0.7780
Epoch 178, accuracy: 0.7780
Epoch 178, Train Loss: 0.0994, Val Loss: 1.3015
Epoch 179, accuracy: 0.7780
Epoch 180, accuracy: 0.7780
Epoch 180, Train Loss: 0.0794, Val Loss: 1.3015
Epoch 181, accuracy: 0.7780
Epoch 182, accuracy: 0.7780
Epoch 182, Train Loss: 0.0714, Val Loss: 1.3015
Epoch 183, accuracy: 0.7780
Epoch 184, accuracy: 0.7780
Epoch 184, Train Loss: 0.0607, Val Loss: 1.3015
Epoch 185, accuracy: 0.7780
Epoch 186, accuracy: 0.7780
Epoch 186, Train Loss: 0.0960, Val Loss: 1.3015
Epoch 187, accuracy: 0.7780
Epoch 188, accuracy: 0.7780
Epoch 188, Train Loss: 0.0791, Val Loss: 1.3015
Epoch 189, accuracy: 0.7780
Epoch 190, accuracy: 0.7780
Epoch 190, Train Loss: 0.0954, Val Loss: 1.3015
Epoch 191, accuracy: 0.7780
Epoch 192, accuracy: 0.7780
Epoch 192, Train Loss: 0.0809, Val Loss: 1.3015
Epoch 193, accuracy: 0.7780
Epoch 194, accuracy: 0.7780
Epoch 194, Train Loss: 0.0977, Val Loss: 1.3015
Epoch 195, accuracy: 0.7780
Epoch 196, accuracy: 0.7780
Epoch 196, Train Loss: 0.1311, Val Loss: 1.3015
Epoch 197, accuracy: 0.7780
Epoch 198, accuracy: 0.7780
Epoch 198, Train Loss: 0.0804, Val Loss: 1.3015
Epoch 199, accuracy: 0.7780
Loaded best model with val_loss = 0.8422273397445679
test :accuracy 0.7480, f1_macro: 0.7081, f1_micro: 0.7480, auc: 0.9459
Training GAT with 7 layers...
可训练参数: 1305379_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.9416
Epoch 0, accuracy: 0.0640
Epoch 0, Train Loss: 1.9453, Val Loss: 1.9416
✅ Epoch 1: New best model saved with val_loss = 1.8878
Epoch 1, accuracy: 0.3080
✅ Epoch 2: New best model saved with val_loss = 1.8504
Epoch 2, accuracy: 0.1970
Epoch 2, Train Loss: 1.8050, Val Loss: 1.8504
✅ Epoch 3: New best model saved with val_loss = 1.7768
Epoch 3, accuracy: 0.5780
✅ Epoch 4: New best model saved with val_loss = 1.7228
Epoch 4, accuracy: 0.2550
Epoch 4, Train Loss: 2.2639, Val Loss: 1.7228
✅ Epoch 5: New best model saved with val_loss = 1.5457
Epoch 5, accuracy: 0.3710
✅ Epoch 6: New best model saved with val_loss = 1.4190
Epoch 6, accuracy: 0.3980
Epoch 6, Train Loss: 1.4966, Val Loss: 1.4190
✅ Epoch 7: New best model saved with val_loss = 1.2729
Epoch 7, accuracy: 0.6300
✅ Epoch 8: New best model saved with val_loss = 1.2580
Epoch 8, accuracy: 0.5660
Epoch 8, Train Loss: 1.1308, Val Loss: 1.2580
Epoch 9, accuracy: 0.4500
Epoch 10, accuracy: 0.4400
Epoch 10, Train Loss: 0.9599, Val Loss: 1.3606
✅ Epoch 11: New best model saved with val_loss = 1.1811
Epoch 11, accuracy: 0.4720
✅ Epoch 12: New best model saved with val_loss = 1.0864
Epoch 12, accuracy: 0.6270
Epoch 12, Train Loss: 0.7554, Val Loss: 1.0864
✅ Epoch 13: New best model saved with val_loss = 0.9934
Epoch 13, accuracy: 0.6650
Epoch 14, accuracy: 0.5810
Epoch 14, Train Loss: 0.5683, Val Loss: 1.0012
Epoch 15, accuracy: 0.5630
Epoch 16, accuracy: 0.5730
Epoch 16, Train Loss: 0.4529, Val Loss: 1.2514
Epoch 17, accuracy: 0.6530
Epoch 18, accuracy: 0.7080
Epoch 18, Train Loss: 0.3531, Val Loss: 1.1539
Epoch 19, accuracy: 0.6100
Epoch 20, accuracy: 0.6250
Epoch 20, Train Loss: 0.3168, Val Loss: 1.1689
Epoch 21, accuracy: 0.6470
Epoch 22, accuracy: 0.6900
Epoch 22, Train Loss: 0.2572, Val Loss: 1.1666
Epoch 23, accuracy: 0.7090
Epoch 24, accuracy: 0.7060
Epoch 24, Train Loss: 0.2314, Val Loss: 1.2178
Epoch 25, accuracy: 0.7030
Epoch 26, accuracy: 0.7040
Epoch 26, Train Loss: 0.2344, Val Loss: 1.2449
Epoch 27, accuracy: 0.7040
Epoch 28, accuracy: 0.7060
Epoch 28, Train Loss: 0.2840, Val Loss: 1.2444
Epoch 29, accuracy: 0.7090
Epoch 30, accuracy: 0.7070
Epoch 30, Train Loss: 0.2458, Val Loss: 1.2407
Epoch 31, accuracy: 0.7070
Epoch 32, accuracy: 0.7070
Epoch 32, Train Loss: 0.2195, Val Loss: 1.2370
Epoch 33, accuracy: 0.7070
Epoch 34, accuracy: 0.7070
Epoch 34, Train Loss: 0.2433, Val Loss: 1.2360
Epoch 35, accuracy: 0.7070
Epoch 36, accuracy: 0.7050
Epoch 36, Train Loss: 0.2456, Val Loss: 1.2349
Epoch 37, accuracy: 0.7060
Epoch 38, accuracy: 0.7060
Epoch 38, Train Loss: 0.2224, Val Loss: 1.2342
Epoch 39, accuracy: 0.7060
Epoch 40, accuracy: 0.7060
Epoch 40, Train Loss: 0.2054, Val Loss: 1.2341
Epoch 41, accuracy: 0.7060
Epoch 42, accuracy: 0.7060
Epoch 42, Train Loss: 0.2365, Val Loss: 1.2340
Epoch 43, accuracy: 0.7060
Epoch 44, accuracy: 0.7060
Epoch 44, Train Loss: 0.2093, Val Loss: 1.2339
Epoch 45, accuracy: 0.7060
Epoch 46, accuracy: 0.7060
Epoch 46, Train Loss: 0.2514, Val Loss: 1.2339
Epoch 47, accuracy: 0.7060
Epoch 48, accuracy: 0.7060
Epoch 48, Train Loss: 0.2298, Val Loss: 1.2339
Epoch 49, accuracy: 0.7060
Epoch 50, accuracy: 0.7060
Epoch 50, Train Loss: 0.2502, Val Loss: 1.2339
Epoch 51, accuracy: 0.7060
Epoch 52, accuracy: 0.7060
Epoch 52, Train Loss: 0.2327, Val Loss: 1.2339
Epoch 53, accuracy: 0.7060
Epoch 54, accuracy: 0.7060
Epoch 54, Train Loss: 0.2187, Val Loss: 1.2339
Epoch 55, accuracy: 0.7060
Epoch 56, accuracy: 0.7060
Epoch 56, Train Loss: 0.2563, Val Loss: 1.2339
Epoch 57, accuracy: 0.7060
Epoch 58, accuracy: 0.7060
Epoch 58, Train Loss: 0.2612, Val Loss: 1.2339
Epoch 59, accuracy: 0.7060
Epoch 60, accuracy: 0.7060
Epoch 60, Train Loss: 0.2190, Val Loss: 1.2339
Epoch 61, accuracy: 0.7060
Epoch 62, accuracy: 0.7060
Epoch 62, Train Loss: 0.2804, Val Loss: 1.2339
Epoch 63, accuracy: 0.7060
Epoch 64, accuracy: 0.7060
Epoch 64, Train Loss: 0.1937, Val Loss: 1.2339
Epoch 65, accuracy: 0.7060
Epoch 66, accuracy: 0.7060
Epoch 66, Train Loss: 0.2312, Val Loss: 1.2339
Epoch 67, accuracy: 0.7060
Epoch 68, accuracy: 0.7060
Epoch 68, Train Loss: 0.2336, Val Loss: 1.2339
Epoch 69, accuracy: 0.7060
Epoch 70, accuracy: 0.7060
Epoch 70, Train Loss: 0.2758, Val Loss: 1.2339
Epoch 71, accuracy: 0.7060
Epoch 72, accuracy: 0.7060
Epoch 72, Train Loss: 0.2385, Val Loss: 1.2339
Epoch 73, accuracy: 0.7060
Epoch 74, accuracy: 0.7060
Epoch 74, Train Loss: 0.2411, Val Loss: 1.2339
Epoch 75, accuracy: 0.7060
Epoch 76, accuracy: 0.7060
Epoch 76, Train Loss: 0.2500, Val Loss: 1.2339
Epoch 77, accuracy: 0.7060
Epoch 78, accuracy: 0.7060
Epoch 78, Train Loss: 0.2070, Val Loss: 1.2339
Epoch 79, accuracy: 0.7060
Epoch 80, accuracy: 0.7060
Epoch 80, Train Loss: 0.2007, Val Loss: 1.2339
Epoch 81, accuracy: 0.7060
Epoch 82, accuracy: 0.7060
Epoch 82, Train Loss: 0.2178, Val Loss: 1.2339
Epoch 83, accuracy: 0.7060
Epoch 84, accuracy: 0.7060
Epoch 84, Train Loss: 0.2397, Val Loss: 1.2339
Epoch 85, accuracy: 0.7060
Epoch 86, accuracy: 0.7060
Epoch 86, Train Loss: 0.2100, Val Loss: 1.2339
Epoch 87, accuracy: 0.7060
Epoch 88, accuracy: 0.7060
Epoch 88, Train Loss: 0.2331, Val Loss: 1.2339
Epoch 89, accuracy: 0.7060
Epoch 90, accuracy: 0.7060
Epoch 90, Train Loss: 0.1940, Val Loss: 1.2339
Epoch 91, accuracy: 0.7060
Epoch 92, accuracy: 0.7060
Epoch 92, Train Loss: 0.2062, Val Loss: 1.2339
Epoch 93, accuracy: 0.7060
Epoch 94, accuracy: 0.7060
Epoch 94, Train Loss: 0.2623, Val Loss: 1.2339
Epoch 95, accuracy: 0.7060
Epoch 96, accuracy: 0.7060
Epoch 96, Train Loss: 0.2013, Val Loss: 1.2339
Epoch 97, accuracy: 0.7060
Epoch 98, accuracy: 0.7060
Epoch 98, Train Loss: 0.2410, Val Loss: 1.2339
Epoch 99, accuracy: 0.7060
Epoch 100, accuracy: 0.7060
Epoch 100, Train Loss: 0.2360, Val Loss: 1.2339
Epoch 101, accuracy: 0.7060
Epoch 102, accuracy: 0.7060
Epoch 102, Train Loss: 0.2067, Val Loss: 1.2339
Epoch 103, accuracy: 0.7060
Epoch 104, accuracy: 0.7060
Epoch 104, Train Loss: 0.2129, Val Loss: 1.2339
Epoch 105, accuracy: 0.7060
Epoch 106, accuracy: 0.7060
Epoch 106, Train Loss: 0.2310, Val Loss: 1.2339
Epoch 107, accuracy: 0.7060
Epoch 108, accuracy: 0.7060
Epoch 108, Train Loss: 0.1983, Val Loss: 1.2339
Epoch 109, accuracy: 0.7060
Epoch 110, accuracy: 0.7060
Epoch 110, Train Loss: 0.2206, Val Loss: 1.2338
Epoch 111, accuracy: 0.7060
Epoch 112, accuracy: 0.7060
Epoch 112, Train Loss: 0.2620, Val Loss: 1.2338
Epoch 113, accuracy: 0.7060
Epoch 114, accuracy: 0.7060
Epoch 114, Train Loss: 0.2292, Val Loss: 1.2338
Epoch 115, accuracy: 0.7060
Epoch 116, accuracy: 0.7060
Epoch 116, Train Loss: 0.2566, Val Loss: 1.2338
Epoch 117, accuracy: 0.7060
Epoch 118, accuracy: 0.7060
Epoch 118, Train Loss: 0.2553, Val Loss: 1.2338
Epoch 119, accuracy: 0.7060
Epoch 120, accuracy: 0.7060
Epoch 120, Train Loss: 0.2248, Val Loss: 1.2338
Epoch 121, accuracy: 0.7060
Epoch 122, accuracy: 0.7060
Epoch 122, Train Loss: 0.2126, Val Loss: 1.2338
Epoch 123, accuracy: 0.7060
Epoch 124, accuracy: 0.7060
Epoch 124, Train Loss: 0.2241, Val Loss: 1.2338
Epoch 125, accuracy: 0.7060
Epoch 126, accuracy: 0.7060
Epoch 126, Train Loss: 0.2152, Val Loss: 1.2338
Epoch 127, accuracy: 0.7060
Epoch 128, accuracy: 0.7060
Epoch 128, Train Loss: 0.2240, Val Loss: 1.2338
Epoch 129, accuracy: 0.7060
Epoch 130, accuracy: 0.7060
Epoch 130, Train Loss: 0.2096, Val Loss: 1.2338
Epoch 131, accuracy: 0.7060
Epoch 132, accuracy: 0.7060
Epoch 132, Train Loss: 0.2471, Val Loss: 1.2338
Epoch 133, accuracy: 0.7060
Epoch 134, accuracy: 0.7060
Epoch 134, Train Loss: 0.2625, Val Loss: 1.2338
Epoch 135, accuracy: 0.7060
Epoch 136, accuracy: 0.7060
Epoch 136, Train Loss: 0.2436, Val Loss: 1.2338
Epoch 137, accuracy: 0.7060
Epoch 138, accuracy: 0.7060
Epoch 138, Train Loss: 0.2023, Val Loss: 1.2338
Epoch 139, accuracy: 0.7060
Epoch 140, accuracy: 0.7060
Epoch 140, Train Loss: 0.2224, Val Loss: 1.2338
Epoch 141, accuracy: 0.7060
Epoch 142, accuracy: 0.7060
Epoch 142, Train Loss: 0.2319, Val Loss: 1.2338
Epoch 143, accuracy: 0.7060
Epoch 144, accuracy: 0.7060
Epoch 144, Train Loss: 0.2393, Val Loss: 1.2338
Epoch 145, accuracy: 0.7060
Epoch 146, accuracy: 0.7060
Epoch 146, Train Loss: 0.2586, Val Loss: 1.2338
Epoch 147, accuracy: 0.7060
Epoch 148, accuracy: 0.7060
Epoch 148, Train Loss: 0.2003, Val Loss: 1.2338
Epoch 149, accuracy: 0.7060
Epoch 150, accuracy: 0.7060
Epoch 150, Train Loss: 0.1899, Val Loss: 1.2338
Epoch 151, accuracy: 0.7060
Epoch 152, accuracy: 0.7060
Epoch 152, Train Loss: 0.2408, Val Loss: 1.2338
Epoch 153, accuracy: 0.7060
Epoch 154, accuracy: 0.7060
Epoch 154, Train Loss: 0.2277, Val Loss: 1.2338
Epoch 155, accuracy: 0.7060
Epoch 156, accuracy: 0.7060
Epoch 156, Train Loss: 0.2294, Val Loss: 1.2338
Epoch 157, accuracy: 0.7060
Epoch 158, accuracy: 0.7060
Epoch 158, Train Loss: 0.2108, Val Loss: 1.2338
Epoch 159, accuracy: 0.7060
Epoch 160, accuracy: 0.7060
Epoch 160, Train Loss: 0.2656, Val Loss: 1.2338
Epoch 161, accuracy: 0.7060
Epoch 162, accuracy: 0.7060
Epoch 162, Train Loss: 0.2180, Val Loss: 1.2338
Epoch 163, accuracy: 0.7060
Epoch 164, accuracy: 0.7060
Epoch 164, Train Loss: 0.1961, Val Loss: 1.2338
Epoch 165, accuracy: 0.7060
Epoch 166, accuracy: 0.7060
Epoch 166, Train Loss: 0.2642, Val Loss: 1.2338
Epoch 167, accuracy: 0.7060
Epoch 168, accuracy: 0.7060
Epoch 168, Train Loss: 0.2305, Val Loss: 1.2338
Epoch 169, accuracy: 0.7060
Epoch 170, accuracy: 0.7060
Epoch 170, Train Loss: 0.2037, Val Loss: 1.2338
Epoch 171, accuracy: 0.7060
Epoch 172, accuracy: 0.7060
Epoch 172, Train Loss: 0.2255, Val Loss: 1.2338
Epoch 173, accuracy: 0.7060
Epoch 174, accuracy: 0.7060
Epoch 174, Train Loss: 0.2020, Val Loss: 1.2338
Epoch 175, accuracy: 0.7060
Epoch 176, accuracy: 0.7060
Epoch 176, Train Loss: 0.2334, Val Loss: 1.2338
Epoch 177, accuracy: 0.7060
Epoch 178, accuracy: 0.7060
Epoch 178, Train Loss: 0.2290, Val Loss: 1.2338
Epoch 179, accuracy: 0.7060
Epoch 180, accuracy: 0.7060
Epoch 180, Train Loss: 0.2310, Val Loss: 1.2338
Epoch 181, accuracy: 0.7060
Epoch 182, accuracy: 0.7060
Epoch 182, Train Loss: 0.2068, Val Loss: 1.2338
Epoch 183, accuracy: 0.7060
Epoch 184, accuracy: 0.7060
Epoch 184, Train Loss: 0.2273, Val Loss: 1.2338
Epoch 185, accuracy: 0.7060
Epoch 186, accuracy: 0.7060
Epoch 186, Train Loss: 0.1953, Val Loss: 1.2338
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 187, accuracy: 0.7060
Epoch 188, accuracy: 0.7060
Epoch 188, Train Loss: 0.2272, Val Loss: 1.2338
Epoch 189, accuracy: 0.7060
Epoch 190, accuracy: 0.7060
Epoch 190, Train Loss: 0.2434, Val Loss: 1.2338
Epoch 191, accuracy: 0.7060
Epoch 192, accuracy: 0.7060
Epoch 192, Train Loss: 0.2251, Val Loss: 1.2338
Epoch 193, accuracy: 0.7060
Epoch 194, accuracy: 0.7060
Epoch 194, Train Loss: 0.2583, Val Loss: 1.2338
Epoch 195, accuracy: 0.7060
Epoch 196, accuracy: 0.7060
Epoch 196, Train Loss: 0.2155, Val Loss: 1.2338
Epoch 197, accuracy: 0.7060
Epoch 198, accuracy: 0.7060
Epoch 198, Train Loss: 0.2641, Val Loss: 1.2338
Epoch 199, accuracy: 0.7060
Loaded best model with val_loss = 0.9933843016624451
test :accuracy 0.6650, f1_macro: 0.6258, f1_micro: 0.6650, auc: 0.9192
Training mamba3 with 3 layers...
可训练参数: 915885_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.4892
Epoch 0, accuracy: 0.4290
Epoch 0, Train Loss: 2.0991, Val Loss: 1.4892
✅ Epoch 1: New best model saved with val_loss = 1.3759
Epoch 1, accuracy: 0.4940
✅ Epoch 2: New best model saved with val_loss = 1.1219
Epoch 2, accuracy: 0.6350
Epoch 2, Train Loss: 1.1794, Val Loss: 1.1219
✅ Epoch 3: New best model saved with val_loss = 0.9156
Epoch 3, accuracy: 0.7430
Epoch 4, accuracy: 0.7380
Epoch 4, Train Loss: 0.6551, Val Loss: 0.9212
✅ Epoch 5: New best model saved with val_loss = 0.9054
Epoch 5, accuracy: 0.7380
✅ Epoch 6: New best model saved with val_loss = 0.8738
Epoch 6, accuracy: 0.7480
Epoch 6, Train Loss: 0.4783, Val Loss: 0.8738
✅ Epoch 7: New best model saved with val_loss = 0.8547
Epoch 7, accuracy: 0.7590
✅ Epoch 8: New best model saved with val_loss = 0.8433
Epoch 8, accuracy: 0.7630
Epoch 8, Train Loss: 0.2717, Val Loss: 0.8433
Epoch 9, accuracy: 0.7700
Epoch 10, accuracy: 0.7670
Epoch 10, Train Loss: 0.2010, Val Loss: 0.9318
Epoch 11, accuracy: 0.7630
Epoch 12, accuracy: 0.7670
Epoch 12, Train Loss: 0.1906, Val Loss: 1.0255
Epoch 13, accuracy: 0.7630
Epoch 14, accuracy: 0.7580
Epoch 14, Train Loss: 0.1864, Val Loss: 1.1056
Epoch 15, accuracy: 0.7580
Epoch 16, accuracy: 0.7570
Epoch 16, Train Loss: 0.1351, Val Loss: 1.1123
Epoch 17, accuracy: 0.7570
Epoch 18, accuracy: 0.7560
Epoch 18, Train Loss: 0.0964, Val Loss: 1.1181
Epoch 19, accuracy: 0.7580
Epoch 20, accuracy: 0.7590
Epoch 20, Train Loss: 0.0838, Val Loss: 1.1232
Epoch 21, accuracy: 0.7590
Epoch 22, accuracy: 0.7590
Epoch 22, Train Loss: 0.0904, Val Loss: 1.1241
Epoch 23, accuracy: 0.7590
Epoch 24, accuracy: 0.7590
Epoch 24, Train Loss: 0.1094, Val Loss: 1.1257
Epoch 25, accuracy: 0.7600
Epoch 26, accuracy: 0.7600
Epoch 26, Train Loss: 0.1007, Val Loss: 1.1272
Epoch 27, accuracy: 0.7600
Epoch 28, accuracy: 0.7600
Epoch 28, Train Loss: 0.0965, Val Loss: 1.1273
Epoch 29, accuracy: 0.7600
Epoch 30, accuracy: 0.7600
Epoch 30, Train Loss: 0.1196, Val Loss: 1.1274
Epoch 31, accuracy: 0.7600
Epoch 32, accuracy: 0.7600
Epoch 32, Train Loss: 0.0809, Val Loss: 1.1275
Epoch 33, accuracy: 0.7600
Epoch 34, accuracy: 0.7600
Epoch 34, Train Loss: 0.1089, Val Loss: 1.1275
Epoch 35, accuracy: 0.7600
Epoch 36, accuracy: 0.7600
Epoch 36, Train Loss: 0.1312, Val Loss: 1.1275
Epoch 37, accuracy: 0.7600
Epoch 38, accuracy: 0.7600
Epoch 38, Train Loss: 0.1499, Val Loss: 1.1275
Epoch 39, accuracy: 0.7600
Epoch 40, accuracy: 0.7600
Epoch 40, Train Loss: 0.1479, Val Loss: 1.1275
Epoch 41, accuracy: 0.7600
Epoch 42, accuracy: 0.7600
Epoch 42, Train Loss: 0.0760, Val Loss: 1.1275
Epoch 43, accuracy: 0.7600
Epoch 44, accuracy: 0.7600
Epoch 44, Train Loss: 0.1210, Val Loss: 1.1275
Epoch 45, accuracy: 0.7600
Epoch 46, accuracy: 0.7600
Epoch 46, Train Loss: 0.0687, Val Loss: 1.1275
Epoch 47, accuracy: 0.7600
Epoch 48, accuracy: 0.7600
Epoch 48, Train Loss: 0.0940, Val Loss: 1.1275
Epoch 49, accuracy: 0.7600
Epoch 50, accuracy: 0.7600
Epoch 50, Train Loss: 0.0792, Val Loss: 1.1275
Epoch 51, accuracy: 0.7600
Epoch 52, accuracy: 0.7600
Epoch 52, Train Loss: 0.0875, Val Loss: 1.1275
Epoch 53, accuracy: 0.7600
Epoch 54, accuracy: 0.7600
Epoch 54, Train Loss: 0.1249, Val Loss: 1.1275
Epoch 55, accuracy: 0.7600
Epoch 56, accuracy: 0.7600
Epoch 56, Train Loss: 0.0531, Val Loss: 1.1275
Epoch 57, accuracy: 0.7600
Epoch 58, accuracy: 0.7600
Epoch 58, Train Loss: 0.1063, Val Loss: 1.1275
Epoch 59, accuracy: 0.7600
Epoch 60, accuracy: 0.7600
Epoch 60, Train Loss: 0.0868, Val Loss: 1.1275
Epoch 61, accuracy: 0.7600
Epoch 62, accuracy: 0.7600
Epoch 62, Train Loss: 0.1272, Val Loss: 1.1275
Epoch 63, accuracy: 0.7600
Epoch 64, accuracy: 0.7600
Epoch 64, Train Loss: 0.1471, Val Loss: 1.1275
Epoch 65, accuracy: 0.7600
Epoch 66, accuracy: 0.7600
Epoch 66, Train Loss: 0.0765, Val Loss: 1.1275
Epoch 67, accuracy: 0.7600
Epoch 68, accuracy: 0.7600
Epoch 68, Train Loss: 0.0591, Val Loss: 1.1275
Epoch 69, accuracy: 0.7600
Epoch 70, accuracy: 0.7600
Epoch 70, Train Loss: 0.0869, Val Loss: 1.1275
Epoch 71, accuracy: 0.7600
Epoch 72, accuracy: 0.7600
Epoch 72, Train Loss: 0.0951, Val Loss: 1.1275
Epoch 73, accuracy: 0.7600
Epoch 74, accuracy: 0.7600
Epoch 74, Train Loss: 0.1140, Val Loss: 1.1275
Epoch 75, accuracy: 0.7600
Epoch 76, accuracy: 0.7600
Epoch 76, Train Loss: 0.0665, Val Loss: 1.1275
Epoch 77, accuracy: 0.7600
Epoch 78, accuracy: 0.7600
Epoch 78, Train Loss: 0.0837, Val Loss: 1.1275
Epoch 79, accuracy: 0.7600
Epoch 80, accuracy: 0.7600
Epoch 80, Train Loss: 0.0984, Val Loss: 1.1275
Epoch 81, accuracy: 0.7600
Epoch 82, accuracy: 0.7600
Epoch 82, Train Loss: 0.1362, Val Loss: 1.1275
Epoch 83, accuracy: 0.7600
Epoch 84, accuracy: 0.7600
Epoch 84, Train Loss: 0.0939, Val Loss: 1.1275
Epoch 85, accuracy: 0.7600
Epoch 86, accuracy: 0.7600
Epoch 86, Train Loss: 0.1027, Val Loss: 1.1275
Epoch 87, accuracy: 0.7600
Epoch 88, accuracy: 0.7600
Epoch 88, Train Loss: 0.0918, Val Loss: 1.1275
Epoch 89, accuracy: 0.7600
Epoch 90, accuracy: 0.7600
Epoch 90, Train Loss: 0.0635, Val Loss: 1.1275
Epoch 91, accuracy: 0.7600
Epoch 92, accuracy: 0.7600
Epoch 92, Train Loss: 0.0772, Val Loss: 1.1275
Epoch 93, accuracy: 0.7600
Epoch 94, accuracy: 0.7600
Epoch 94, Train Loss: 0.0658, Val Loss: 1.1275
Epoch 95, accuracy: 0.7600
Epoch 96, accuracy: 0.7600
Epoch 96, Train Loss: 0.1112, Val Loss: 1.1275
Epoch 97, accuracy: 0.7600
Epoch 98, accuracy: 0.7600
Epoch 98, Train Loss: 0.0845, Val Loss: 1.1275
Epoch 99, accuracy: 0.7600
Epoch 100, accuracy: 0.7600
Epoch 100, Train Loss: 0.0953, Val Loss: 1.1275
Epoch 101, accuracy: 0.7600
Epoch 102, accuracy: 0.7600
Epoch 102, Train Loss: 0.1295, Val Loss: 1.1275
Epoch 103, accuracy: 0.7600
Epoch 104, accuracy: 0.7600
Epoch 104, Train Loss: 0.2094, Val Loss: 1.1275
Epoch 105, accuracy: 0.7600
Epoch 106, accuracy: 0.7600
Epoch 106, Train Loss: 0.1341, Val Loss: 1.1275
Epoch 107, accuracy: 0.7600
Epoch 108, accuracy: 0.7600
Epoch 108, Train Loss: 0.0680, Val Loss: 1.1275
Epoch 109, accuracy: 0.7600
Epoch 110, accuracy: 0.7600
Epoch 110, Train Loss: 0.0779, Val Loss: 1.1275
Epoch 111, accuracy: 0.7600
Epoch 112, accuracy: 0.7600
Epoch 112, Train Loss: 0.0689, Val Loss: 1.1275
Epoch 113, accuracy: 0.7600
Epoch 114, accuracy: 0.7600
Epoch 114, Train Loss: 0.0781, Val Loss: 1.1275
Epoch 115, accuracy: 0.7600
Epoch 116, accuracy: 0.7600
Epoch 116, Train Loss: 0.0771, Val Loss: 1.1275
Epoch 117, accuracy: 0.7600
Epoch 118, accuracy: 0.7600
Epoch 118, Train Loss: 0.1218, Val Loss: 1.1275
Epoch 119, accuracy: 0.7600
Epoch 120, accuracy: 0.7600
Epoch 120, Train Loss: 0.1496, Val Loss: 1.1275
Epoch 121, accuracy: 0.7600
Epoch 122, accuracy: 0.7600
Epoch 122, Train Loss: 0.1061, Val Loss: 1.1275
Epoch 123, accuracy: 0.7600
Epoch 124, accuracy: 0.7600
Epoch 124, Train Loss: 0.1164, Val Loss: 1.1275
Epoch 125, accuracy: 0.7600
Epoch 126, accuracy: 0.7600
Epoch 126, Train Loss: 0.1109, Val Loss: 1.1275
Epoch 127, accuracy: 0.7600
Epoch 128, accuracy: 0.7600
Epoch 128, Train Loss: 0.1308, Val Loss: 1.1275
Epoch 129, accuracy: 0.7600
Epoch 130, accuracy: 0.7600
Epoch 130, Train Loss: 0.1075, Val Loss: 1.1275
Epoch 131, accuracy: 0.7600
Epoch 132, accuracy: 0.7600
Epoch 132, Train Loss: 0.1288, Val Loss: 1.1275
Epoch 133, accuracy: 0.7600
Epoch 134, accuracy: 0.7600
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 134, Train Loss: 0.1194, Val Loss: 1.1275
Epoch 135, accuracy: 0.7600
Epoch 136, accuracy: 0.7600
Epoch 136, Train Loss: 0.0598, Val Loss: 1.1275
Epoch 137, accuracy: 0.7600
Epoch 138, accuracy: 0.7600
Epoch 138, Train Loss: 0.1228, Val Loss: 1.1275
Epoch 139, accuracy: 0.7600
Epoch 140, accuracy: 0.7600
Epoch 140, Train Loss: 0.1351, Val Loss: 1.1275
Epoch 141, accuracy: 0.7600
Epoch 142, accuracy: 0.7600
Epoch 142, Train Loss: 0.0919, Val Loss: 1.1275
Epoch 143, accuracy: 0.7600
Epoch 144, accuracy: 0.7600
Epoch 144, Train Loss: 0.1072, Val Loss: 1.1275
Epoch 145, accuracy: 0.7600
Epoch 146, accuracy: 0.7600
Epoch 146, Train Loss: 0.0980, Val Loss: 1.1275
Epoch 147, accuracy: 0.7600
Epoch 148, accuracy: 0.7600
Epoch 148, Train Loss: 0.1451, Val Loss: 1.1275
Epoch 149, accuracy: 0.7600
Epoch 150, accuracy: 0.7600
Epoch 150, Train Loss: 0.1138, Val Loss: 1.1275
Epoch 151, accuracy: 0.7600
Epoch 152, accuracy: 0.7600
Epoch 152, Train Loss: 0.0792, Val Loss: 1.1275
Epoch 153, accuracy: 0.7600
Epoch 154, accuracy: 0.7600
Epoch 154, Train Loss: 0.0835, Val Loss: 1.1275
Epoch 155, accuracy: 0.7600
Epoch 156, accuracy: 0.7600
Epoch 156, Train Loss: 0.0813, Val Loss: 1.1275
Epoch 157, accuracy: 0.7600
Epoch 158, accuracy: 0.7600
Epoch 158, Train Loss: 0.0672, Val Loss: 1.1275
Epoch 159, accuracy: 0.7600
Epoch 160, accuracy: 0.7600
Epoch 160, Train Loss: 0.1033, Val Loss: 1.1275
Epoch 161, accuracy: 0.7600
Epoch 162, accuracy: 0.7600
Epoch 162, Train Loss: 0.0912, Val Loss: 1.1275
Epoch 163, accuracy: 0.7600
Epoch 164, accuracy: 0.7600
Epoch 164, Train Loss: 0.0935, Val Loss: 1.1275
Epoch 165, accuracy: 0.7600
Epoch 166, accuracy: 0.7600
Epoch 166, Train Loss: 0.1033, Val Loss: 1.1275
Epoch 167, accuracy: 0.7600
Epoch 168, accuracy: 0.7600
Epoch 168, Train Loss: 0.1220, Val Loss: 1.1275
Epoch 169, accuracy: 0.7600
Epoch 170, accuracy: 0.7600
Epoch 170, Train Loss: 0.0976, Val Loss: 1.1275
Epoch 171, accuracy: 0.7600
Epoch 172, accuracy: 0.7600
Epoch 172, Train Loss: 0.0910, Val Loss: 1.1275
Epoch 173, accuracy: 0.7600
Epoch 174, accuracy: 0.7600
Epoch 174, Train Loss: 0.0942, Val Loss: 1.1275
Epoch 175, accuracy: 0.7600
Epoch 176, accuracy: 0.7600
Epoch 176, Train Loss: 0.1293, Val Loss: 1.1275
Epoch 177, accuracy: 0.7600
Epoch 178, accuracy: 0.7600
Epoch 178, Train Loss: 0.0968, Val Loss: 1.1275
Epoch 179, accuracy: 0.7600
Epoch 180, accuracy: 0.7600
Epoch 180, Train Loss: 0.1033, Val Loss: 1.1275
Epoch 181, accuracy: 0.7600
Epoch 182, accuracy: 0.7600
Epoch 182, Train Loss: 0.0596, Val Loss: 1.1275
Epoch 183, accuracy: 0.7600
Epoch 184, accuracy: 0.7600
Epoch 184, Train Loss: 0.0905, Val Loss: 1.1275
Epoch 185, accuracy: 0.7600
Epoch 186, accuracy: 0.7600
Epoch 186, Train Loss: 0.0850, Val Loss: 1.1275
Epoch 187, accuracy: 0.7600
Epoch 188, accuracy: 0.7600
Epoch 188, Train Loss: 0.1138, Val Loss: 1.1275
Epoch 189, accuracy: 0.7600
Epoch 190, accuracy: 0.7600
Epoch 190, Train Loss: 0.1400, Val Loss: 1.1275
Epoch 191, accuracy: 0.7600
Epoch 192, accuracy: 0.7600
Epoch 192, Train Loss: 0.0853, Val Loss: 1.1275
Epoch 193, accuracy: 0.7600
Epoch 194, accuracy: 0.7600
Epoch 194, Train Loss: 0.1138, Val Loss: 1.1275
Epoch 195, accuracy: 0.7600
Epoch 196, accuracy: 0.7600
Epoch 196, Train Loss: 0.0887, Val Loss: 1.1275
Epoch 197, accuracy: 0.7600
Epoch 198, accuracy: 0.7600
Epoch 198, Train Loss: 0.1224, Val Loss: 1.1275
Epoch 199, accuracy: 0.7600
Loaded best model with val_loss = 0.8433141112327576
test :accuracy 0.7630, f1_macro: 0.7499, f1_micro: 0.7630, auc: 0.9429
Training mamba3 with 4 layers...
可训练参数: 998957_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.4731
Epoch 0, accuracy: 0.3620
Epoch 0, Train Loss: 2.0454, Val Loss: 1.4731
Epoch 1, accuracy: 0.4470
✅ Epoch 2: New best model saved with val_loss = 1.2038
Epoch 2, accuracy: 0.5880
Epoch 2, Train Loss: 1.3595, Val Loss: 1.2038
✅ Epoch 3: New best model saved with val_loss = 1.0324
Epoch 3, accuracy: 0.6620
✅ Epoch 4: New best model saved with val_loss = 0.8432
Epoch 4, accuracy: 0.7750
Epoch 4, Train Loss: 0.7739, Val Loss: 0.8432
Epoch 5, accuracy: 0.7670
Epoch 6, accuracy: 0.7480
Epoch 6, Train Loss: 0.4172, Val Loss: 0.9120
Epoch 7, accuracy: 0.7710
Epoch 8, accuracy: 0.7850
Epoch 8, Train Loss: 0.3084, Val Loss: 0.8457
Epoch 9, accuracy: 0.7900
Epoch 10, accuracy: 0.7870
Epoch 10, Train Loss: 0.4053, Val Loss: 0.9447
Epoch 11, accuracy: 0.7840
Epoch 12, accuracy: 0.7810
Epoch 12, Train Loss: 0.1931, Val Loss: 0.9756
Epoch 13, accuracy: 0.7780
Epoch 14, accuracy: 0.7770
Epoch 14, Train Loss: 0.2184, Val Loss: 1.0064
Epoch 15, accuracy: 0.7760
Epoch 16, accuracy: 0.7780
Epoch 16, Train Loss: 0.1378, Val Loss: 1.0354
Epoch 17, accuracy: 0.7780
Epoch 18, accuracy: 0.7760
Epoch 18, Train Loss: 0.2154, Val Loss: 1.0371
Epoch 19, accuracy: 0.7760
Epoch 20, accuracy: 0.7770
Epoch 20, Train Loss: 0.3134, Val Loss: 1.0368
Epoch 21, accuracy: 0.7790
Epoch 22, accuracy: 0.7780
Epoch 22, Train Loss: 0.2506, Val Loss: 1.0353
Epoch 23, accuracy: 0.7780
Epoch 24, accuracy: 0.7780
Epoch 24, Train Loss: 0.1693, Val Loss: 1.0350
Epoch 25, accuracy: 0.7780
Epoch 26, accuracy: 0.7780
Epoch 26, Train Loss: 0.1427, Val Loss: 1.0347
Epoch 27, accuracy: 0.7780
Epoch 28, accuracy: 0.7780
Epoch 28, Train Loss: 0.1935, Val Loss: 1.0343
Epoch 29, accuracy: 0.7780
Epoch 30, accuracy: 0.7780
Epoch 30, Train Loss: 0.1342, Val Loss: 1.0343
Epoch 31, accuracy: 0.7780
Epoch 32, accuracy: 0.7780
Epoch 32, Train Loss: 0.1744, Val Loss: 1.0343
Epoch 33, accuracy: 0.7780
Epoch 34, accuracy: 0.7780
Epoch 34, Train Loss: 0.1669, Val Loss: 1.0342
Epoch 35, accuracy: 0.7780
Epoch 36, accuracy: 0.7780
Epoch 36, Train Loss: 0.1177, Val Loss: 1.0342
Epoch 37, accuracy: 0.7780
Epoch 38, accuracy: 0.7780
Epoch 38, Train Loss: 0.2063, Val Loss: 1.0342
Epoch 39, accuracy: 0.7780
Epoch 40, accuracy: 0.7780
Epoch 40, Train Loss: 0.2238, Val Loss: 1.0342
Epoch 41, accuracy: 0.7780
Epoch 42, accuracy: 0.7780
Epoch 42, Train Loss: 0.1961, Val Loss: 1.0342
Epoch 43, accuracy: 0.7780
Epoch 44, accuracy: 0.7780
Epoch 44, Train Loss: 0.1650, Val Loss: 1.0342
Epoch 45, accuracy: 0.7780
Epoch 46, accuracy: 0.7780
Epoch 46, Train Loss: 0.1744, Val Loss: 1.0342
Epoch 47, accuracy: 0.7780
Epoch 48, accuracy: 0.7780
Epoch 48, Train Loss: 0.1480, Val Loss: 1.0342
Epoch 49, accuracy: 0.7780
Epoch 50, accuracy: 0.7780
Epoch 50, Train Loss: 0.1875, Val Loss: 1.0342
Epoch 51, accuracy: 0.7780
Epoch 52, accuracy: 0.7780
Epoch 52, Train Loss: 0.2416, Val Loss: 1.0342
Epoch 53, accuracy: 0.7780
Epoch 54, accuracy: 0.7780
Epoch 54, Train Loss: 0.2245, Val Loss: 1.0342
Epoch 55, accuracy: 0.7780
Epoch 56, accuracy: 0.7780
Epoch 56, Train Loss: 0.1990, Val Loss: 1.0342
Epoch 57, accuracy: 0.7780
Epoch 58, accuracy: 0.7780
Epoch 58, Train Loss: 0.1904, Val Loss: 1.0342
Epoch 59, accuracy: 0.7780
Epoch 60, accuracy: 0.7780
Epoch 60, Train Loss: 0.2237, Val Loss: 1.0342
Epoch 61, accuracy: 0.7780
Epoch 62, accuracy: 0.7780
Epoch 62, Train Loss: 0.1872, Val Loss: 1.0342
Epoch 63, accuracy: 0.7780
Epoch 64, accuracy: 0.7780
Epoch 64, Train Loss: 0.2522, Val Loss: 1.0342
Epoch 65, accuracy: 0.7780
Epoch 66, accuracy: 0.7780
Epoch 66, Train Loss: 0.1494, Val Loss: 1.0342
Epoch 67, accuracy: 0.7780
Epoch 68, accuracy: 0.7780
Epoch 68, Train Loss: 0.1822, Val Loss: 1.0342
Epoch 69, accuracy: 0.7780
Epoch 70, accuracy: 0.7780
Epoch 70, Train Loss: 0.1931, Val Loss: 1.0342
Epoch 71, accuracy: 0.7780
Epoch 72, accuracy: 0.7780
Epoch 72, Train Loss: 0.1705, Val Loss: 1.0342
Epoch 73, accuracy: 0.7780
Epoch 74, accuracy: 0.7780
Epoch 74, Train Loss: 0.1936, Val Loss: 1.0342
Epoch 75, accuracy: 0.7780
Epoch 76, accuracy: 0.7780
Epoch 76, Train Loss: 0.1787, Val Loss: 1.0342
Epoch 77, accuracy: 0.7780
Epoch 78, accuracy: 0.7780
Epoch 78, Train Loss: 0.1869, Val Loss: 1.0342
Epoch 79, accuracy: 0.7780
Epoch 80, accuracy: 0.7780
Epoch 80, Train Loss: 0.1980, Val Loss: 1.0342
Epoch 81, accuracy: 0.7780
Epoch 82, accuracy: 0.7780
Epoch 82, Train Loss: 0.1924, Val Loss: 1.0342
Epoch 83, accuracy: 0.7780
Epoch 84, accuracy: 0.7780
Epoch 84, Train Loss: 0.1851, Val Loss: 1.0342
Epoch 85, accuracy: 0.7780
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 86, accuracy: 0.7780
Epoch 86, Train Loss: 0.2445, Val Loss: 1.0342
Epoch 87, accuracy: 0.7780
Epoch 88, accuracy: 0.7780
Epoch 88, Train Loss: 0.1986, Val Loss: 1.0342
Epoch 89, accuracy: 0.7780
Epoch 90, accuracy: 0.7780
Epoch 90, Train Loss: 0.1565, Val Loss: 1.0342
Epoch 91, accuracy: 0.7780
Epoch 92, accuracy: 0.7780
Epoch 92, Train Loss: 0.1777, Val Loss: 1.0342
Epoch 93, accuracy: 0.7780
Epoch 94, accuracy: 0.7780
Epoch 94, Train Loss: 0.1672, Val Loss: 1.0342
Epoch 95, accuracy: 0.7780
Epoch 96, accuracy: 0.7780
Epoch 96, Train Loss: 0.2172, Val Loss: 1.0342
Epoch 97, accuracy: 0.7780
Epoch 98, accuracy: 0.7780
Epoch 98, Train Loss: 0.1997, Val Loss: 1.0342
Epoch 99, accuracy: 0.7780
Epoch 100, accuracy: 0.7780
Epoch 100, Train Loss: 0.2104, Val Loss: 1.0342
Epoch 101, accuracy: 0.7780
Epoch 102, accuracy: 0.7780
Epoch 102, Train Loss: 0.1851, Val Loss: 1.0342
Epoch 103, accuracy: 0.7780
Epoch 104, accuracy: 0.7780
Epoch 104, Train Loss: 0.1559, Val Loss: 1.0342
Epoch 105, accuracy: 0.7780
Epoch 106, accuracy: 0.7780
Epoch 106, Train Loss: 0.1440, Val Loss: 1.0342
Epoch 107, accuracy: 0.7780
Epoch 108, accuracy: 0.7780
Epoch 108, Train Loss: 0.1681, Val Loss: 1.0342
Epoch 109, accuracy: 0.7780
Epoch 110, accuracy: 0.7780
Epoch 110, Train Loss: 0.1685, Val Loss: 1.0342
Epoch 111, accuracy: 0.7780
Epoch 112, accuracy: 0.7780
Epoch 112, Train Loss: 0.1755, Val Loss: 1.0342
Epoch 113, accuracy: 0.7780
Epoch 114, accuracy: 0.7780
Epoch 114, Train Loss: 0.2208, Val Loss: 1.0342
Epoch 115, accuracy: 0.7780
Epoch 116, accuracy: 0.7780
Epoch 116, Train Loss: 0.2110, Val Loss: 1.0342
Epoch 117, accuracy: 0.7780
Epoch 118, accuracy: 0.7780
Epoch 118, Train Loss: 0.1545, Val Loss: 1.0342
Epoch 119, accuracy: 0.7780
Epoch 120, accuracy: 0.7780
Epoch 120, Train Loss: 0.1589, Val Loss: 1.0342
Epoch 121, accuracy: 0.7780
Epoch 122, accuracy: 0.7780
Epoch 122, Train Loss: 0.1849, Val Loss: 1.0342
Epoch 123, accuracy: 0.7780
Epoch 124, accuracy: 0.7780
Epoch 124, Train Loss: 0.2091, Val Loss: 1.0342
Epoch 125, accuracy: 0.7780
Epoch 126, accuracy: 0.7780
Epoch 126, Train Loss: 0.1847, Val Loss: 1.0342
Epoch 127, accuracy: 0.7780
Epoch 128, accuracy: 0.7780
Epoch 128, Train Loss: 0.1492, Val Loss: 1.0342
Epoch 129, accuracy: 0.7780
Epoch 130, accuracy: 0.7780
Epoch 130, Train Loss: 0.1672, Val Loss: 1.0342
Epoch 131, accuracy: 0.7780
Epoch 132, accuracy: 0.7780
Epoch 132, Train Loss: 0.1233, Val Loss: 1.0342
Epoch 133, accuracy: 0.7780
Epoch 134, accuracy: 0.7780
Epoch 134, Train Loss: 0.2196, Val Loss: 1.0342
Epoch 135, accuracy: 0.7780
Epoch 136, accuracy: 0.7780
Epoch 136, Train Loss: 0.1559, Val Loss: 1.0342
Epoch 137, accuracy: 0.7780
Epoch 138, accuracy: 0.7780
Epoch 138, Train Loss: 0.1856, Val Loss: 1.0342
Epoch 139, accuracy: 0.7780
Epoch 140, accuracy: 0.7780
Epoch 140, Train Loss: 0.2164, Val Loss: 1.0342
Epoch 141, accuracy: 0.7780
Epoch 142, accuracy: 0.7780
Epoch 142, Train Loss: 0.1909, Val Loss: 1.0342
Epoch 143, accuracy: 0.7780
Epoch 144, accuracy: 0.7780
Epoch 144, Train Loss: 0.1520, Val Loss: 1.0342
Epoch 145, accuracy: 0.7780
Epoch 146, accuracy: 0.7780
Epoch 146, Train Loss: 0.1867, Val Loss: 1.0342
Epoch 147, accuracy: 0.7780
Epoch 148, accuracy: 0.7780
Epoch 148, Train Loss: 0.1691, Val Loss: 1.0342
Epoch 149, accuracy: 0.7780
Epoch 150, accuracy: 0.7780
Epoch 150, Train Loss: 0.1430, Val Loss: 1.0342
Epoch 151, accuracy: 0.7780
Epoch 152, accuracy: 0.7780
Epoch 152, Train Loss: 0.2162, Val Loss: 1.0342
Epoch 153, accuracy: 0.7780
Epoch 154, accuracy: 0.7780
Epoch 154, Train Loss: 0.1708, Val Loss: 1.0342
Epoch 155, accuracy: 0.7780
Epoch 156, accuracy: 0.7780
Epoch 156, Train Loss: 0.2229, Val Loss: 1.0342
Epoch 157, accuracy: 0.7780
Epoch 158, accuracy: 0.7780
Epoch 158, Train Loss: 0.1977, Val Loss: 1.0342
Epoch 159, accuracy: 0.7780
Epoch 160, accuracy: 0.7780
Epoch 160, Train Loss: 0.2053, Val Loss: 1.0342
Epoch 161, accuracy: 0.7780
Epoch 162, accuracy: 0.7780
Epoch 162, Train Loss: 0.1690, Val Loss: 1.0342
Epoch 163, accuracy: 0.7780
Epoch 164, accuracy: 0.7780
Epoch 164, Train Loss: 0.1879, Val Loss: 1.0342
Epoch 165, accuracy: 0.7780
Epoch 166, accuracy: 0.7780
Epoch 166, Train Loss: 0.1497, Val Loss: 1.0342
Epoch 167, accuracy: 0.7780
Epoch 168, accuracy: 0.7780
Epoch 168, Train Loss: 0.1972, Val Loss: 1.0342
Epoch 169, accuracy: 0.7780
Epoch 170, accuracy: 0.7780
Epoch 170, Train Loss: 0.1895, Val Loss: 1.0342
Epoch 171, accuracy: 0.7780
Epoch 172, accuracy: 0.7780
Epoch 172, Train Loss: 0.1811, Val Loss: 1.0342
Epoch 173, accuracy: 0.7780
Epoch 174, accuracy: 0.7780
Epoch 174, Train Loss: 0.2013, Val Loss: 1.0342
Epoch 175, accuracy: 0.7780
Epoch 176, accuracy: 0.7780
Epoch 176, Train Loss: 0.1813, Val Loss: 1.0342
Epoch 177, accuracy: 0.7780
Epoch 178, accuracy: 0.7780
Epoch 178, Train Loss: 0.2432, Val Loss: 1.0342
Epoch 179, accuracy: 0.7780
Epoch 180, accuracy: 0.7780
Epoch 180, Train Loss: 0.2171, Val Loss: 1.0342
Epoch 181, accuracy: 0.7780
Epoch 182, accuracy: 0.7780
Epoch 182, Train Loss: 0.2598, Val Loss: 1.0342
Epoch 183, accuracy: 0.7780
Epoch 184, accuracy: 0.7780
Epoch 184, Train Loss: 0.1971, Val Loss: 1.0342
Epoch 185, accuracy: 0.7780
Epoch 186, accuracy: 0.7780
Epoch 186, Train Loss: 0.1989, Val Loss: 1.0342
Epoch 187, accuracy: 0.7780
Epoch 188, accuracy: 0.7780
Epoch 188, Train Loss: 0.1836, Val Loss: 1.0342
Epoch 189, accuracy: 0.7780
Epoch 190, accuracy: 0.7780
Epoch 190, Train Loss: 0.1926, Val Loss: 1.0342
Epoch 191, accuracy: 0.7780
Epoch 192, accuracy: 0.7780
Epoch 192, Train Loss: 0.1329, Val Loss: 1.0342
Epoch 193, accuracy: 0.7780
Epoch 194, accuracy: 0.7780
Epoch 194, Train Loss: 0.2291, Val Loss: 1.0342
Epoch 195, accuracy: 0.7780
Epoch 196, accuracy: 0.7780
Epoch 196, Train Loss: 0.2247, Val Loss: 1.0342
Epoch 197, accuracy: 0.7780
Epoch 198, accuracy: 0.7780
Epoch 198, Train Loss: 0.2231, Val Loss: 1.0342
Epoch 199, accuracy: 0.7780
Loaded best model with val_loss = 0.8432467579841614
test :accuracy 0.7750, f1_macro: 0.7624, f1_micro: 0.7750, auc: 0.9451
Training mamba3 with 5 layers...
可训练参数: 1082029_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.9261
Epoch 0, accuracy: 0.4060
Epoch 0, Train Loss: 2.0016, Val Loss: 1.9261
✅ Epoch 1: New best model saved with val_loss = 1.4229
Epoch 1, accuracy: 0.5160
✅ Epoch 2: New best model saved with val_loss = 1.1440
Epoch 2, accuracy: 0.6740
Epoch 2, Train Loss: 1.2153, Val Loss: 1.1440
✅ Epoch 3: New best model saved with val_loss = 1.0538
Epoch 3, accuracy: 0.6610
Epoch 4, accuracy: 0.6370
Epoch 4, Train Loss: 0.8334, Val Loss: 1.0802
✅ Epoch 5: New best model saved with val_loss = 1.0242
Epoch 5, accuracy: 0.7260
✅ Epoch 6: New best model saved with val_loss = 0.9283
Epoch 6, accuracy: 0.7550
Epoch 6, Train Loss: 0.5956, Val Loss: 0.9283
✅ Epoch 7: New best model saved with val_loss = 0.9260
Epoch 7, accuracy: 0.7690
Epoch 8, accuracy: 0.7640
Epoch 8, Train Loss: 0.4868, Val Loss: 0.9418
Epoch 9, accuracy: 0.7680
✅ Epoch 10: New best model saved with val_loss = 0.9231
Epoch 10, accuracy: 0.7780
Epoch 10, Train Loss: 0.2945, Val Loss: 0.9231
Epoch 11, accuracy: 0.7870
Epoch 12, accuracy: 0.7900
Epoch 12, Train Loss: 0.2637, Val Loss: 0.9237
Epoch 13, accuracy: 0.7900
Epoch 14, accuracy: 0.7780
Epoch 14, Train Loss: 0.2707, Val Loss: 1.0082
Epoch 15, accuracy: 0.7740
Epoch 16, accuracy: 0.7570
Epoch 16, Train Loss: 0.2244, Val Loss: 1.2037
Epoch 17, accuracy: 0.7630
Epoch 18, accuracy: 0.7670
Epoch 18, Train Loss: 0.1710, Val Loss: 1.1807
Epoch 19, accuracy: 0.7730
Epoch 20, accuracy: 0.7780
Epoch 20, Train Loss: 0.2361, Val Loss: 1.1463
Epoch 21, accuracy: 0.7830
Epoch 22, accuracy: 0.7850
Epoch 22, Train Loss: 0.1784, Val Loss: 1.1239
Epoch 23, accuracy: 0.7850
Epoch 24, accuracy: 0.7850
Epoch 24, Train Loss: 0.1395, Val Loss: 1.1220
Epoch 25, accuracy: 0.7850
Epoch 26, accuracy: 0.7840
Epoch 26, Train Loss: 0.1903, Val Loss: 1.1201
Epoch 27, accuracy: 0.7840
Epoch 28, accuracy: 0.7840
Epoch 28, Train Loss: 0.2380, Val Loss: 1.1185
Epoch 29, accuracy: 0.7840
Epoch 30, accuracy: 0.7840
Epoch 30, Train Loss: 0.2587, Val Loss: 1.1184
Epoch 31, accuracy: 0.7840
Epoch 32, accuracy: 0.7850
Epoch 32, Train Loss: 0.1916, Val Loss: 1.1183
Epoch 33, accuracy: 0.7850
Epoch 34, accuracy: 0.7850
Epoch 34, Train Loss: 0.1710, Val Loss: 1.1181
Epoch 35, accuracy: 0.7850
Epoch 36, accuracy: 0.7850
Epoch 36, Train Loss: 0.1583, Val Loss: 1.1181
Epoch 37, accuracy: 0.7850
Epoch 38, accuracy: 0.7850
Epoch 38, Train Loss: 0.1587, Val Loss: 1.1181
Epoch 39, accuracy: 0.7850
Epoch 40, accuracy: 0.7850
Epoch 40, Train Loss: 0.1395, Val Loss: 1.1181
Epoch 41, accuracy: 0.7850
Epoch 42, accuracy: 0.7850
Epoch 42, Train Loss: 0.2132, Val Loss: 1.1181
Epoch 43, accuracy: 0.7850
Epoch 44, accuracy: 0.7850
Epoch 44, Train Loss: 0.1442, Val Loss: 1.1181
Epoch 45, accuracy: 0.7850
Epoch 46, accuracy: 0.7850
Epoch 46, Train Loss: 0.1716, Val Loss: 1.1181
Epoch 47, accuracy: 0.7850
Epoch 48, accuracy: 0.7850
Epoch 48, Train Loss: 0.1918, Val Loss: 1.1181
Epoch 49, accuracy: 0.7850
Epoch 50, accuracy: 0.7850
Epoch 50, Train Loss: 0.0918, Val Loss: 1.1181
Epoch 51, accuracy: 0.7850
Epoch 52, accuracy: 0.7850
Epoch 52, Train Loss: 0.1621, Val Loss: 1.1181
Epoch 53, accuracy: 0.7850
Epoch 54, accuracy: 0.7850
Epoch 54, Train Loss: 0.1842, Val Loss: 1.1181
Epoch 55, accuracy: 0.7850
Epoch 56, accuracy: 0.7850
Epoch 56, Train Loss: 0.1303, Val Loss: 1.1181
Epoch 57, accuracy: 0.7850
Epoch 58, accuracy: 0.7850
Epoch 58, Train Loss: 0.1602, Val Loss: 1.1181
Epoch 59, accuracy: 0.7850
Epoch 60, accuracy: 0.7850
Epoch 60, Train Loss: 0.1499, Val Loss: 1.1181
Epoch 61, accuracy: 0.7850
Epoch 62, accuracy: 0.7850
Epoch 62, Train Loss: 0.1447, Val Loss: 1.1181
Epoch 63, accuracy: 0.7850
Epoch 64, accuracy: 0.7850
Epoch 64, Train Loss: 0.1605, Val Loss: 1.1181
Epoch 65, accuracy: 0.7850
Epoch 66, accuracy: 0.7850
Epoch 66, Train Loss: 0.1749, Val Loss: 1.1181
Epoch 67, accuracy: 0.7850
Epoch 68, accuracy: 0.7850
Epoch 68, Train Loss: 0.1122, Val Loss: 1.1181
Epoch 69, accuracy: 0.7850
Epoch 70, accuracy: 0.7850
Epoch 70, Train Loss: 0.1697, Val Loss: 1.1181
Epoch 71, accuracy: 0.7850
Epoch 72, accuracy: 0.7850
Epoch 72, Train Loss: 0.1488, Val Loss: 1.1181
Epoch 73, accuracy: 0.7850
Epoch 74, accuracy: 0.7850
Epoch 74, Train Loss: 0.1777, Val Loss: 1.1181
Epoch 75, accuracy: 0.7850
Epoch 76, accuracy: 0.7850
Epoch 76, Train Loss: 0.1923, Val Loss: 1.1181
Epoch 77, accuracy: 0.7850
Epoch 78, accuracy: 0.7850
Epoch 78, Train Loss: 0.1092, Val Loss: 1.1181
Epoch 79, accuracy: 0.7850
Epoch 80, accuracy: 0.7850
Epoch 80, Train Loss: 0.1704, Val Loss: 1.1181
Epoch 81, accuracy: 0.7850
Epoch 82, accuracy: 0.7850
Epoch 82, Train Loss: 0.2063, Val Loss: 1.1181
Epoch 83, accuracy: 0.7850
Epoch 84, accuracy: 0.7850
Epoch 84, Train Loss: 0.2055, Val Loss: 1.1181
Epoch 85, accuracy: 0.7850
Epoch 86, accuracy: 0.7850
Epoch 86, Train Loss: 0.1586, Val Loss: 1.1181
Epoch 87, accuracy: 0.7850
Epoch 88, accuracy: 0.7850
Epoch 88, Train Loss: 0.1848, Val Loss: 1.1181
Epoch 89, accuracy: 0.7850
Epoch 90, accuracy: 0.7850
Epoch 90, Train Loss: 0.1253, Val Loss: 1.1181
Epoch 91, accuracy: 0.7850
Epoch 92, accuracy: 0.7850
Epoch 92, Train Loss: 0.2151, Val Loss: 1.1181
Epoch 93, accuracy: 0.7850
Epoch 94, accuracy: 0.7850
Epoch 94, Train Loss: 0.1651, Val Loss: 1.1181
Epoch 95, accuracy: 0.7850
Epoch 96, accuracy: 0.7850
Epoch 96, Train Loss: 0.1609, Val Loss: 1.1181
Epoch 97, accuracy: 0.7850
Epoch 98, accuracy: 0.7850
Epoch 98, Train Loss: 0.1640, Val Loss: 1.1181
Epoch 99, accuracy: 0.7850
Epoch 100, accuracy: 0.7850
Epoch 100, Train Loss: 0.1785, Val Loss: 1.1181
Epoch 101, accuracy: 0.7850
Epoch 102, accuracy: 0.7850
Epoch 102, Train Loss: 0.1539, Val Loss: 1.1181
Epoch 103, accuracy: 0.7850
Epoch 104, accuracy: 0.7850
Epoch 104, Train Loss: 0.1048, Val Loss: 1.1181
Epoch 105, accuracy: 0.7850
Epoch 106, accuracy: 0.7850
Epoch 106, Train Loss: 0.2087, Val Loss: 1.1181
Epoch 107, accuracy: 0.7850
Epoch 108, accuracy: 0.7850
Epoch 108, Train Loss: 0.2105, Val Loss: 1.1181
Epoch 109, accuracy: 0.7850
Epoch 110, accuracy: 0.7850
Epoch 110, Train Loss: 0.1678, Val Loss: 1.1181
Epoch 111, accuracy: 0.7850
Epoch 112, accuracy: 0.7850
Epoch 112, Train Loss: 0.1660, Val Loss: 1.1181
Epoch 113, accuracy: 0.7850
Epoch 114, accuracy: 0.7850
Epoch 114, Train Loss: 0.1324, Val Loss: 1.1181
Epoch 115, accuracy: 0.7850
Epoch 116, accuracy: 0.7850
Epoch 116, Train Loss: 0.1951, Val Loss: 1.1181
Epoch 117, accuracy: 0.7850
Epoch 118, accuracy: 0.7850
Epoch 118, Train Loss: 0.1580, Val Loss: 1.1181
Epoch 119, accuracy: 0.7850
Epoch 120, accuracy: 0.7850
Epoch 120, Train Loss: 0.1884, Val Loss: 1.1181
Epoch 121, accuracy: 0.7850
Epoch 122, accuracy: 0.7850
Epoch 122, Train Loss: 0.1260, Val Loss: 1.1181
Epoch 123, accuracy: 0.7850
Epoch 124, accuracy: 0.7850
Epoch 124, Train Loss: 0.0913, Val Loss: 1.1181
Epoch 125, accuracy: 0.7850
Epoch 126, accuracy: 0.7850
Epoch 126, Train Loss: 0.1726, Val Loss: 1.1181
Epoch 127, accuracy: 0.7850
Epoch 128, accuracy: 0.7850
Epoch 128, Train Loss: 0.1587, Val Loss: 1.1181
Epoch 129, accuracy: 0.7850
Epoch 130, accuracy: 0.7850
Epoch 130, Train Loss: 0.2134, Val Loss: 1.1181
Epoch 131, accuracy: 0.7850
Epoch 132, accuracy: 0.7850
Epoch 132, Train Loss: 0.1006, Val Loss: 1.1181
Epoch 133, accuracy: 0.7850
Epoch 134, accuracy: 0.7850
Epoch 134, Train Loss: 0.1368, Val Loss: 1.1181
Epoch 135, accuracy: 0.7850
Epoch 136, accuracy: 0.7850
Epoch 136, Train Loss: 0.1857, Val Loss: 1.1181
Epoch 137, accuracy: 0.7850
Epoch 138, accuracy: 0.7850
Epoch 138, Train Loss: 0.1482, Val Loss: 1.1181
Epoch 139, accuracy: 0.7850
Epoch 140, accuracy: 0.7850
Epoch 140, Train Loss: 0.1316, Val Loss: 1.1181
Epoch 141, accuracy: 0.7850
Epoch 142, accuracy: 0.7850
Epoch 142, Train Loss: 0.1625, Val Loss: 1.1181
Epoch 143, accuracy: 0.7850
Epoch 144, accuracy: 0.7850
Epoch 144, Train Loss: 0.2558, Val Loss: 1.1181
Epoch 145, accuracy: 0.7850
Epoch 146, accuracy: 0.7850
Epoch 146, Train Loss: 0.1851, Val Loss: 1.1181
Epoch 147, accuracy: 0.7850
Epoch 148, accuracy: 0.7850
Epoch 148, Train Loss: 0.1337, Val Loss: 1.1181
Epoch 149, accuracy: 0.7850
Epoch 150, accuracy: 0.7850
Epoch 150, Train Loss: 0.2296, Val Loss: 1.1181
Epoch 151, accuracy: 0.7850
Epoch 152, accuracy: 0.7850
Epoch 152, Train Loss: 0.1681, Val Loss: 1.1181
Epoch 153, accuracy: 0.7850
Epoch 154, accuracy: 0.7850
Epoch 154, Train Loss: 0.1820, Val Loss: 1.1181
Epoch 155, accuracy: 0.7850
Epoch 156, accuracy: 0.7850
Epoch 156, Train Loss: 0.1646, Val Loss: 1.1181
Epoch 157, accuracy: 0.7850
Epoch 158, accuracy: 0.7850
Epoch 158, Train Loss: 0.2058, Val Loss: 1.1181
Epoch 159, accuracy: 0.7850
Epoch 160, accuracy: 0.7850
Epoch 160, Train Loss: 0.1587, Val Loss: 1.1181
Epoch 161, accuracy: 0.7850
Epoch 162, accuracy: 0.7850
Epoch 162, Train Loss: 0.1641, Val Loss: 1.1181
Epoch 163, accuracy: 0.7850
Epoch 164, accuracy: 0.7850
Epoch 164, Train Loss: 0.1400, Val Loss: 1.1181
Epoch 165, accuracy: 0.7850
Epoch 166, accuracy: 0.7850
Epoch 166, Train Loss: 0.1722, Val Loss: 1.1181
Epoch 167, accuracy: 0.7850
Epoch 168, accuracy: 0.7850
Epoch 168, Train Loss: 0.1851, Val Loss: 1.1181
Epoch 169, accuracy: 0.7850
Epoch 170, accuracy: 0.7850
Epoch 170, Train Loss: 0.1389, Val Loss: 1.1181
Epoch 171, accuracy: 0.7850
Epoch 172, accuracy: 0.7850
Epoch 172, Train Loss: 0.1956, Val Loss: 1.1181
Epoch 173, accuracy: 0.7850
Epoch 174, accuracy: 0.7850
Epoch 174, Train Loss: 0.1434, Val Loss: 1.1181
Epoch 175, accuracy: 0.7850
Epoch 176, accuracy: 0.7850
Epoch 176, Train Loss: 0.1620, Val Loss: 1.1181
Epoch 177, accuracy: 0.7850
Epoch 178, accuracy: 0.7850
Epoch 178, Train Loss: 0.1998, Val Loss: 1.1181
Epoch 179, accuracy: 0.7850
Epoch 180, accuracy: 0.7850
Epoch 180, Train Loss: 0.0720, Val Loss: 1.1181
Epoch 181, accuracy: 0.7850
Epoch 182, accuracy: 0.7850
Epoch 182, Train Loss: 0.1752, Val Loss: 1.1181
Epoch 183, accuracy: 0.7850
Epoch 184, accuracy: 0.7850
Epoch 184, Train Loss: 0.1720, Val Loss: 1.1181
Epoch 185, accuracy: 0.7850
Epoch 186, accuracy: 0.7850
Epoch 186, Train Loss: 0.1772, Val Loss: 1.1181
Epoch 187, accuracy: 0.7850
Epoch 188, accuracy: 0.7850
Epoch 188, Train Loss: 0.0976, Val Loss: 1.1181
Epoch 189, accuracy: 0.7850
Epoch 190, accuracy: 0.7850
Epoch 190, Train Loss: 0.2308, Val Loss: 1.1181
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 191, accuracy: 0.7850
Epoch 192, accuracy: 0.7850
Epoch 192, Train Loss: 0.2701, Val Loss: 1.1181
Epoch 193, accuracy: 0.7850
Epoch 194, accuracy: 0.7850
Epoch 194, Train Loss: 0.1758, Val Loss: 1.1181
Epoch 195, accuracy: 0.7850
Epoch 196, accuracy: 0.7850
Epoch 196, Train Loss: 0.1801, Val Loss: 1.1181
Epoch 197, accuracy: 0.7850
Epoch 198, accuracy: 0.7850
Epoch 198, Train Loss: 0.2365, Val Loss: 1.1181
Epoch 199, accuracy: 0.7850
Loaded best model with val_loss = 0.923145592212677
test :accuracy 0.7780, f1_macro: 0.7748, f1_micro: 0.7780, auc: 0.9590
Training mamba3 with 6 layers...
可训练参数: 1165101_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.5594
Epoch 0, accuracy: 0.4910
Epoch 0, Train Loss: 2.0273, Val Loss: 1.5594
Epoch 1, accuracy: 0.3310
✅ Epoch 2: New best model saved with val_loss = 1.1943
Epoch 2, accuracy: 0.4840
Epoch 2, Train Loss: 1.4011, Val Loss: 1.1943
✅ Epoch 3: New best model saved with val_loss = 0.9900
Epoch 3, accuracy: 0.6950
✅ Epoch 4: New best model saved with val_loss = 0.9588
Epoch 4, accuracy: 0.6980
Epoch 4, Train Loss: 0.8911, Val Loss: 0.9588
✅ Epoch 5: New best model saved with val_loss = 0.9375
Epoch 5, accuracy: 0.7440
Epoch 6, accuracy: 0.7350
Epoch 6, Train Loss: 0.6189, Val Loss: 0.9467
✅ Epoch 7: New best model saved with val_loss = 0.9190
Epoch 7, accuracy: 0.7510
✅ Epoch 8: New best model saved with val_loss = 0.8682
Epoch 8, accuracy: 0.7810
Epoch 8, Train Loss: 0.5255, Val Loss: 0.8682
✅ Epoch 9: New best model saved with val_loss = 0.8542
Epoch 9, accuracy: 0.7890
Epoch 10, accuracy: 0.7810
Epoch 10, Train Loss: 0.3974, Val Loss: 0.8700
Epoch 11, accuracy: 0.7830
Epoch 12, accuracy: 0.7760
Epoch 12, Train Loss: 0.2793, Val Loss: 0.8912
Epoch 13, accuracy: 0.7800
Epoch 14, accuracy: 0.7810
Epoch 14, Train Loss: 0.2094, Val Loss: 0.9033
Epoch 15, accuracy: 0.7680
Epoch 16, accuracy: 0.7690
Epoch 16, Train Loss: 0.1831, Val Loss: 0.9860
Epoch 17, accuracy: 0.7700
Epoch 18, accuracy: 0.7710
Epoch 18, Train Loss: 0.1538, Val Loss: 0.9860
Epoch 19, accuracy: 0.7730
Epoch 20, accuracy: 0.7760
Epoch 20, Train Loss: 0.2272, Val Loss: 0.9783
Epoch 21, accuracy: 0.7770
Epoch 22, accuracy: 0.7770
Epoch 22, Train Loss: 0.2293, Val Loss: 0.9697
Epoch 23, accuracy: 0.7770
Epoch 24, accuracy: 0.7770
Epoch 24, Train Loss: 0.1862, Val Loss: 0.9689
Epoch 25, accuracy: 0.7770
Epoch 26, accuracy: 0.7770
Epoch 26, Train Loss: 0.1784, Val Loss: 0.9694
Epoch 27, accuracy: 0.7760
Epoch 28, accuracy: 0.7760
Epoch 28, Train Loss: 0.1765, Val Loss: 0.9699
Epoch 29, accuracy: 0.7760
Epoch 30, accuracy: 0.7760
Epoch 30, Train Loss: 0.2097, Val Loss: 0.9700
Epoch 31, accuracy: 0.7760
Epoch 32, accuracy: 0.7760
Epoch 32, Train Loss: 0.2420, Val Loss: 0.9702
Epoch 33, accuracy: 0.7760
Epoch 34, accuracy: 0.7760
Epoch 34, Train Loss: 0.1688, Val Loss: 0.9703
Epoch 35, accuracy: 0.7760
Epoch 36, accuracy: 0.7760
Epoch 36, Train Loss: 0.1569, Val Loss: 0.9703
Epoch 37, accuracy: 0.7760
Epoch 38, accuracy: 0.7760
Epoch 38, Train Loss: 0.1878, Val Loss: 0.9703
Epoch 39, accuracy: 0.7760
Epoch 40, accuracy: 0.7760
Epoch 40, Train Loss: 0.2406, Val Loss: 0.9703
Epoch 41, accuracy: 0.7760
Epoch 42, accuracy: 0.7760
Epoch 42, Train Loss: 0.2384, Val Loss: 0.9703
Epoch 43, accuracy: 0.7760
Epoch 44, accuracy: 0.7760
Epoch 44, Train Loss: 0.1998, Val Loss: 0.9703
Epoch 45, accuracy: 0.7760
Epoch 46, accuracy: 0.7760
Epoch 46, Train Loss: 0.1727, Val Loss: 0.9703
Epoch 47, accuracy: 0.7760
Epoch 48, accuracy: 0.7760
Epoch 48, Train Loss: 0.1966, Val Loss: 0.9703
Epoch 49, accuracy: 0.7760
Epoch 50, accuracy: 0.7760
Epoch 50, Train Loss: 0.1475, Val Loss: 0.9703
Epoch 51, accuracy: 0.7760
Epoch 52, accuracy: 0.7760
Epoch 52, Train Loss: 0.1544, Val Loss: 0.9703
Epoch 53, accuracy: 0.7760
Epoch 54, accuracy: 0.7760
Epoch 54, Train Loss: 0.2533, Val Loss: 0.9703
Epoch 55, accuracy: 0.7760
Epoch 56, accuracy: 0.7760
Epoch 56, Train Loss: 0.1592, Val Loss: 0.9703
Epoch 57, accuracy: 0.7760
Epoch 58, accuracy: 0.7760
Epoch 58, Train Loss: 0.2026, Val Loss: 0.9703
Epoch 59, accuracy: 0.7760
Epoch 60, accuracy: 0.7760
Epoch 60, Train Loss: 0.1779, Val Loss: 0.9703
Epoch 61, accuracy: 0.7760
Epoch 62, accuracy: 0.7760
Epoch 62, Train Loss: 0.2448, Val Loss: 0.9703
Epoch 63, accuracy: 0.7760
Epoch 64, accuracy: 0.7760
Epoch 64, Train Loss: 0.2214, Val Loss: 0.9703
Epoch 65, accuracy: 0.7760
Epoch 66, accuracy: 0.7760
Epoch 66, Train Loss: 0.1458, Val Loss: 0.9703
Epoch 67, accuracy: 0.7760
Epoch 68, accuracy: 0.7760
Epoch 68, Train Loss: 0.2165, Val Loss: 0.9703
Epoch 69, accuracy: 0.7760
Epoch 70, accuracy: 0.7760
Epoch 70, Train Loss: 0.1468, Val Loss: 0.9703
Epoch 71, accuracy: 0.7760
Epoch 72, accuracy: 0.7760
Epoch 72, Train Loss: 0.2340, Val Loss: 0.9703
Epoch 73, accuracy: 0.7760
Epoch 74, accuracy: 0.7760
Epoch 74, Train Loss: 0.2076, Val Loss: 0.9703
Epoch 75, accuracy: 0.7760
Epoch 76, accuracy: 0.7760
Epoch 76, Train Loss: 0.1806, Val Loss: 0.9703
Epoch 77, accuracy: 0.7760
Epoch 78, accuracy: 0.7760
Epoch 78, Train Loss: 0.1976, Val Loss: 0.9703
Epoch 79, accuracy: 0.7760
Epoch 80, accuracy: 0.7760
Epoch 80, Train Loss: 0.2004, Val Loss: 0.9703
Epoch 81, accuracy: 0.7760
Epoch 82, accuracy: 0.7760
Epoch 82, Train Loss: 0.1995, Val Loss: 0.9703
Epoch 83, accuracy: 0.7760
Epoch 84, accuracy: 0.7760
Epoch 84, Train Loss: 0.2466, Val Loss: 0.9703
Epoch 85, accuracy: 0.7760
Epoch 86, accuracy: 0.7760
Epoch 86, Train Loss: 0.1790, Val Loss: 0.9703
Epoch 87, accuracy: 0.7760
Epoch 88, accuracy: 0.7760
Epoch 88, Train Loss: 0.1769, Val Loss: 0.9703
Epoch 89, accuracy: 0.7760
Epoch 90, accuracy: 0.7760
Epoch 90, Train Loss: 0.1647, Val Loss: 0.9703
Epoch 91, accuracy: 0.7760
Epoch 92, accuracy: 0.7760
Epoch 92, Train Loss: 0.1960, Val Loss: 0.9703
Epoch 93, accuracy: 0.7760
Epoch 94, accuracy: 0.7760
Epoch 94, Train Loss: 0.2133, Val Loss: 0.9703
Epoch 95, accuracy: 0.7760
Epoch 96, accuracy: 0.7760
Epoch 96, Train Loss: 0.2154, Val Loss: 0.9703
Epoch 97, accuracy: 0.7760
Epoch 98, accuracy: 0.7760
Epoch 98, Train Loss: 0.2093, Val Loss: 0.9703
Epoch 99, accuracy: 0.7760
Epoch 100, accuracy: 0.7760
Epoch 100, Train Loss: 0.1703, Val Loss: 0.9703
Epoch 101, accuracy: 0.7760
Epoch 102, accuracy: 0.7760
Epoch 102, Train Loss: 0.1515, Val Loss: 0.9703
Epoch 103, accuracy: 0.7760
Epoch 104, accuracy: 0.7760
Epoch 104, Train Loss: 0.1771, Val Loss: 0.9703
Epoch 105, accuracy: 0.7760
Epoch 106, accuracy: 0.7760
Epoch 106, Train Loss: 0.2000, Val Loss: 0.9703
Epoch 107, accuracy: 0.7760
Epoch 108, accuracy: 0.7760
Epoch 108, Train Loss: 0.2110, Val Loss: 0.9703
Epoch 109, accuracy: 0.7760
Epoch 110, accuracy: 0.7760
Epoch 110, Train Loss: 0.2169, Val Loss: 0.9703
Epoch 111, accuracy: 0.7760
Epoch 112, accuracy: 0.7760
Epoch 112, Train Loss: 0.1324, Val Loss: 0.9703
Epoch 113, accuracy: 0.7760
Epoch 114, accuracy: 0.7760
Epoch 114, Train Loss: 0.1576, Val Loss: 0.9703
Epoch 115, accuracy: 0.7760
Epoch 116, accuracy: 0.7760
Epoch 116, Train Loss: 0.1930, Val Loss: 0.9703
Epoch 117, accuracy: 0.7760
Epoch 118, accuracy: 0.7760
Epoch 118, Train Loss: 0.1758, Val Loss: 0.9703
Epoch 119, accuracy: 0.7760
Epoch 120, accuracy: 0.7760
Epoch 120, Train Loss: 0.1926, Val Loss: 0.9703
Epoch 121, accuracy: 0.7760
Epoch 122, accuracy: 0.7760
Epoch 122, Train Loss: 0.1590, Val Loss: 0.9703
Epoch 123, accuracy: 0.7760
Epoch 124, accuracy: 0.7760
Epoch 124, Train Loss: 0.1458, Val Loss: 0.9703
Epoch 125, accuracy: 0.7760
Epoch 126, accuracy: 0.7760
Epoch 126, Train Loss: 0.1966, Val Loss: 0.9703
Epoch 127, accuracy: 0.7760
Epoch 128, accuracy: 0.7760
Epoch 128, Train Loss: 0.2069, Val Loss: 0.9703
Epoch 129, accuracy: 0.7760
Epoch 130, accuracy: 0.7760
Epoch 130, Train Loss: 0.1470, Val Loss: 0.9703
Epoch 131, accuracy: 0.7760
Epoch 132, accuracy: 0.7760
Epoch 132, Train Loss: 0.1989, Val Loss: 0.9703
Epoch 133, accuracy: 0.7760
Epoch 134, accuracy: 0.7760
Epoch 134, Train Loss: 0.2126, Val Loss: 0.9703
Epoch 135, accuracy: 0.7760
Epoch 136, accuracy: 0.7760
Epoch 136, Train Loss: 0.1932, Val Loss: 0.9703
Epoch 137, accuracy: 0.7760
Epoch 138, accuracy: 0.7760
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 138, Train Loss: 0.1549, Val Loss: 0.9703
Epoch 139, accuracy: 0.7760
Epoch 140, accuracy: 0.7760
Epoch 140, Train Loss: 0.2090, Val Loss: 0.9703
Epoch 141, accuracy: 0.7760
Epoch 142, accuracy: 0.7760
Epoch 142, Train Loss: 0.1563, Val Loss: 0.9703
Epoch 143, accuracy: 0.7760
Epoch 144, accuracy: 0.7760
Epoch 144, Train Loss: 0.2215, Val Loss: 0.9703
Epoch 145, accuracy: 0.7760
Epoch 146, accuracy: 0.7760
Epoch 146, Train Loss: 0.1636, Val Loss: 0.9703
Epoch 147, accuracy: 0.7760
Epoch 148, accuracy: 0.7760
Epoch 148, Train Loss: 0.1852, Val Loss: 0.9703
Epoch 149, accuracy: 0.7760
Epoch 150, accuracy: 0.7760
Epoch 150, Train Loss: 0.1421, Val Loss: 0.9703
Epoch 151, accuracy: 0.7760
Epoch 152, accuracy: 0.7760
Epoch 152, Train Loss: 0.1613, Val Loss: 0.9703
Epoch 153, accuracy: 0.7760
Epoch 154, accuracy: 0.7760
Epoch 154, Train Loss: 0.1825, Val Loss: 0.9703
Epoch 155, accuracy: 0.7760
Epoch 156, accuracy: 0.7760
Epoch 156, Train Loss: 0.2213, Val Loss: 0.9703
Epoch 157, accuracy: 0.7760
Epoch 158, accuracy: 0.7760
Epoch 158, Train Loss: 0.1677, Val Loss: 0.9703
Epoch 159, accuracy: 0.7760
Epoch 160, accuracy: 0.7760
Epoch 160, Train Loss: 0.1209, Val Loss: 0.9703
Epoch 161, accuracy: 0.7760
Epoch 162, accuracy: 0.7760
Epoch 162, Train Loss: 0.1196, Val Loss: 0.9703
Epoch 163, accuracy: 0.7760
Epoch 164, accuracy: 0.7760
Epoch 164, Train Loss: 0.2075, Val Loss: 0.9703
Epoch 165, accuracy: 0.7760
Epoch 166, accuracy: 0.7760
Epoch 166, Train Loss: 0.2282, Val Loss: 0.9703
Epoch 167, accuracy: 0.7760
Epoch 168, accuracy: 0.7760
Epoch 168, Train Loss: 0.2231, Val Loss: 0.9703
Epoch 169, accuracy: 0.7760
Epoch 170, accuracy: 0.7760
Epoch 170, Train Loss: 0.1812, Val Loss: 0.9703
Epoch 171, accuracy: 0.7760
Epoch 172, accuracy: 0.7760
Epoch 172, Train Loss: 0.2294, Val Loss: 0.9703
Epoch 173, accuracy: 0.7760
Epoch 174, accuracy: 0.7760
Epoch 174, Train Loss: 0.2293, Val Loss: 0.9703
Epoch 175, accuracy: 0.7760
Epoch 176, accuracy: 0.7760
Epoch 176, Train Loss: 0.1618, Val Loss: 0.9703
Epoch 177, accuracy: 0.7760
Epoch 178, accuracy: 0.7760
Epoch 178, Train Loss: 0.1348, Val Loss: 0.9703
Epoch 179, accuracy: 0.7760
Epoch 180, accuracy: 0.7760
Epoch 180, Train Loss: 0.1324, Val Loss: 0.9703
Epoch 181, accuracy: 0.7760
Epoch 182, accuracy: 0.7760
Epoch 182, Train Loss: 0.1944, Val Loss: 0.9703
Epoch 183, accuracy: 0.7760
Epoch 184, accuracy: 0.7760
Epoch 184, Train Loss: 0.1748, Val Loss: 0.9703
Epoch 185, accuracy: 0.7760
Epoch 186, accuracy: 0.7760
Epoch 186, Train Loss: 0.1712, Val Loss: 0.9703
Epoch 187, accuracy: 0.7760
Epoch 188, accuracy: 0.7760
Epoch 188, Train Loss: 0.2291, Val Loss: 0.9703
Epoch 189, accuracy: 0.7760
Epoch 190, accuracy: 0.7760
Epoch 190, Train Loss: 0.1753, Val Loss: 0.9703
Epoch 191, accuracy: 0.7760
Epoch 192, accuracy: 0.7760
Epoch 192, Train Loss: 0.1615, Val Loss: 0.9703
Epoch 193, accuracy: 0.7760
Epoch 194, accuracy: 0.7760
Epoch 194, Train Loss: 0.2248, Val Loss: 0.9703
Epoch 195, accuracy: 0.7760
Epoch 196, accuracy: 0.7760
Epoch 196, Train Loss: 0.2408, Val Loss: 0.9703
Epoch 197, accuracy: 0.7760
Epoch 198, accuracy: 0.7760
Epoch 198, Train Loss: 0.2104, Val Loss: 0.9703
Epoch 199, accuracy: 0.7760
Loaded best model with val_loss = 0.8542484641075134
test :accuracy 0.7890, f1_macro: 0.7799, f1_micro: 0.7890, auc: 0.9478
Training mamba3 with 7 layers...
可训练参数: 1248173_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 2.0503
Epoch 0, accuracy: 0.1810
Epoch 0, Train Loss: 2.1151, Val Loss: 2.0503
✅ Epoch 1: New best model saved with val_loss = 1.6955
Epoch 1, accuracy: 0.3240
Epoch 2, accuracy: 0.2620
Epoch 2, Train Loss: 1.5740, Val Loss: 1.9944
✅ Epoch 3: New best model saved with val_loss = 1.4049
Epoch 3, accuracy: 0.5630
✅ Epoch 4: New best model saved with val_loss = 1.3370
Epoch 4, accuracy: 0.5510
Epoch 4, Train Loss: 1.2145, Val Loss: 1.3370
✅ Epoch 5: New best model saved with val_loss = 1.2237
Epoch 5, accuracy: 0.6420
✅ Epoch 6: New best model saved with val_loss = 1.1979
Epoch 6, accuracy: 0.6930
Epoch 6, Train Loss: 0.9560, Val Loss: 1.1979
Epoch 7, accuracy: 0.7160
✅ Epoch 8: New best model saved with val_loss = 1.1285
Epoch 8, accuracy: 0.7400
Epoch 8, Train Loss: 0.7593, Val Loss: 1.1285
✅ Epoch 9: New best model saved with val_loss = 1.0293
Epoch 9, accuracy: 0.7570
✅ Epoch 10: New best model saved with val_loss = 0.9486
Epoch 10, accuracy: 0.7750
Epoch 10, Train Loss: 0.6371, Val Loss: 0.9486
✅ Epoch 11: New best model saved with val_loss = 0.8957
Epoch 11, accuracy: 0.7970
✅ Epoch 12: New best model saved with val_loss = 0.8699
Epoch 12, accuracy: 0.8010
Epoch 12, Train Loss: 0.5338, Val Loss: 0.8699
Epoch 13, accuracy: 0.7960
Epoch 14, accuracy: 0.7800
Epoch 14, Train Loss: 0.4180, Val Loss: 0.9143
Epoch 15, accuracy: 0.7580
Epoch 16, accuracy: 0.7470
Epoch 16, Train Loss: 0.3697, Val Loss: 1.0384
Epoch 17, accuracy: 0.7380
Epoch 18, accuracy: 0.7550
Epoch 18, Train Loss: 0.3310, Val Loss: 1.0580
Epoch 19, accuracy: 0.7560
Epoch 20, accuracy: 0.7570
Epoch 20, Train Loss: 0.3365, Val Loss: 1.0454
Epoch 21, accuracy: 0.7580
Epoch 22, accuracy: 0.7590
Epoch 22, Train Loss: 0.2942, Val Loss: 1.0338
Epoch 23, accuracy: 0.7600
Epoch 24, accuracy: 0.7600
Epoch 24, Train Loss: 0.2590, Val Loss: 1.0199
Epoch 25, accuracy: 0.7600
Epoch 26, accuracy: 0.7610
Epoch 26, Train Loss: 0.2286, Val Loss: 1.0183
Epoch 27, accuracy: 0.7620
Epoch 28, accuracy: 0.7630
Epoch 28, Train Loss: 0.3293, Val Loss: 1.0172
Epoch 29, accuracy: 0.7640
Epoch 30, accuracy: 0.7640
Epoch 30, Train Loss: 0.3184, Val Loss: 1.0158
Epoch 31, accuracy: 0.7640
Epoch 32, accuracy: 0.7640
Epoch 32, Train Loss: 0.3504, Val Loss: 1.0157
Epoch 33, accuracy: 0.7640
Epoch 34, accuracy: 0.7640
Epoch 34, Train Loss: 0.2838, Val Loss: 1.0155
Epoch 35, accuracy: 0.7640
Epoch 36, accuracy: 0.7640
Epoch 36, Train Loss: 0.2360, Val Loss: 1.0154
Epoch 37, accuracy: 0.7640
Epoch 38, accuracy: 0.7640
Epoch 38, Train Loss: 0.2581, Val Loss: 1.0154
Epoch 39, accuracy: 0.7640
Epoch 40, accuracy: 0.7640
Epoch 40, Train Loss: 0.2298, Val Loss: 1.0154
Epoch 41, accuracy: 0.7640
Epoch 42, accuracy: 0.7640
Epoch 42, Train Loss: 0.3096, Val Loss: 1.0154
Epoch 43, accuracy: 0.7640
Epoch 44, accuracy: 0.7640
Epoch 44, Train Loss: 0.1878, Val Loss: 1.0154
Epoch 45, accuracy: 0.7640
Epoch 46, accuracy: 0.7640
Epoch 46, Train Loss: 0.2568, Val Loss: 1.0154
Epoch 47, accuracy: 0.7640
Epoch 48, accuracy: 0.7640
Epoch 48, Train Loss: 0.2718, Val Loss: 1.0154
Epoch 49, accuracy: 0.7640
Epoch 50, accuracy: 0.7640
Epoch 50, Train Loss: 0.2384, Val Loss: 1.0154
Epoch 51, accuracy: 0.7640
Epoch 52, accuracy: 0.7640
Epoch 52, Train Loss: 0.2355, Val Loss: 1.0154
Epoch 53, accuracy: 0.7640
Epoch 54, accuracy: 0.7640
Epoch 54, Train Loss: 0.2535, Val Loss: 1.0154
Epoch 55, accuracy: 0.7640
Epoch 56, accuracy: 0.7640
Epoch 56, Train Loss: 0.2855, Val Loss: 1.0154
Epoch 57, accuracy: 0.7640
Epoch 58, accuracy: 0.7640
Epoch 58, Train Loss: 0.2792, Val Loss: 1.0154
Epoch 59, accuracy: 0.7640
Epoch 60, accuracy: 0.7640
Epoch 60, Train Loss: 0.2518, Val Loss: 1.0153
Epoch 61, accuracy: 0.7640
Epoch 62, accuracy: 0.7640
Epoch 62, Train Loss: 0.2443, Val Loss: 1.0153
Epoch 63, accuracy: 0.7640
Epoch 64, accuracy: 0.7640
Epoch 64, Train Loss: 0.3179, Val Loss: 1.0153
Epoch 65, accuracy: 0.7640
Epoch 66, accuracy: 0.7640
Epoch 66, Train Loss: 0.1948, Val Loss: 1.0153
Epoch 67, accuracy: 0.7640
Epoch 68, accuracy: 0.7640
Epoch 68, Train Loss: 0.2255, Val Loss: 1.0153
Epoch 69, accuracy: 0.7640
Epoch 70, accuracy: 0.7640
Epoch 70, Train Loss: 0.3066, Val Loss: 1.0153
Epoch 71, accuracy: 0.7640
Epoch 72, accuracy: 0.7640
Epoch 72, Train Loss: 0.2616, Val Loss: 1.0153
Epoch 73, accuracy: 0.7640
Epoch 74, accuracy: 0.7640
Epoch 74, Train Loss: 0.2207, Val Loss: 1.0153
Epoch 75, accuracy: 0.7640
Epoch 76, accuracy: 0.7640
Epoch 76, Train Loss: 0.2457, Val Loss: 1.0153
Epoch 77, accuracy: 0.7640
Epoch 78, accuracy: 0.7640
Epoch 78, Train Loss: 0.2778, Val Loss: 1.0153
Epoch 79, accuracy: 0.7640
Epoch 80, accuracy: 0.7640
Epoch 80, Train Loss: 0.2474, Val Loss: 1.0153
Epoch 81, accuracy: 0.7640
Epoch 82, accuracy: 0.7640
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
/root/miniconda3/lib/python3.12/site-packages/torch_geometric/sampler/neighbor_sampler.py:61: UserWarning: Using 'NeighborSampler' without a 'pyg-lib' installation is deprecated and will be removed soon. Please install 'pyg-lib' for accelerated neighborhood sampling
  warnings.warn(f"Using '{self.__class__.__name__}' without a "
Epoch 82, Train Loss: 0.2387, Val Loss: 1.0153
Epoch 83, accuracy: 0.7640
Epoch 84, accuracy: 0.7640
Epoch 84, Train Loss: 0.2784, Val Loss: 1.0153
Epoch 85, accuracy: 0.7640
Epoch 86, accuracy: 0.7640
Epoch 86, Train Loss: 0.2602, Val Loss: 1.0153
Epoch 87, accuracy: 0.7640
Epoch 88, accuracy: 0.7640
Epoch 88, Train Loss: 0.2520, Val Loss: 1.0153
Epoch 89, accuracy: 0.7640
Epoch 90, accuracy: 0.7640
Epoch 90, Train Loss: 0.2552, Val Loss: 1.0153
Epoch 91, accuracy: 0.7640
Epoch 92, accuracy: 0.7640
Epoch 92, Train Loss: 0.2753, Val Loss: 1.0153
Epoch 93, accuracy: 0.7640
Epoch 94, accuracy: 0.7640
Epoch 94, Train Loss: 0.2492, Val Loss: 1.0153
Epoch 95, accuracy: 0.7640
Epoch 96, accuracy: 0.7640
Epoch 96, Train Loss: 0.2306, Val Loss: 1.0153
Epoch 97, accuracy: 0.7640
Epoch 98, accuracy: 0.7640
Epoch 98, Train Loss: 0.2123, Val Loss: 1.0153
Epoch 99, accuracy: 0.7640
Epoch 100, accuracy: 0.7640
Epoch 100, Train Loss: 0.2395, Val Loss: 1.0153
Epoch 101, accuracy: 0.7640
Epoch 102, accuracy: 0.7640
Epoch 102, Train Loss: 0.2982, Val Loss: 1.0153
Epoch 103, accuracy: 0.7640
Epoch 104, accuracy: 0.7640
Epoch 104, Train Loss: 0.3308, Val Loss: 1.0153
Epoch 105, accuracy: 0.7640
Epoch 106, accuracy: 0.7640
Epoch 106, Train Loss: 0.2120, Val Loss: 1.0153
Epoch 107, accuracy: 0.7640
Epoch 108, accuracy: 0.7640
Epoch 108, Train Loss: 0.3491, Val Loss: 1.0153
Epoch 109, accuracy: 0.7640
Epoch 110, accuracy: 0.7640
Epoch 110, Train Loss: 0.2751, Val Loss: 1.0153
Epoch 111, accuracy: 0.7640
Epoch 112, accuracy: 0.7640
Epoch 112, Train Loss: 0.3326, Val Loss: 1.0153
Epoch 113, accuracy: 0.7640
Epoch 114, accuracy: 0.7640
Epoch 114, Train Loss: 0.2251, Val Loss: 1.0153
Epoch 115, accuracy: 0.7640
Epoch 116, accuracy: 0.7640
Epoch 116, Train Loss: 0.2904, Val Loss: 1.0153
Epoch 117, accuracy: 0.7640
Epoch 118, accuracy: 0.7640
Epoch 118, Train Loss: 0.2783, Val Loss: 1.0153
Epoch 119, accuracy: 0.7640
Epoch 120, accuracy: 0.7640
Epoch 120, Train Loss: 0.3153, Val Loss: 1.0153
Epoch 121, accuracy: 0.7640
Epoch 122, accuracy: 0.7640
Epoch 122, Train Loss: 0.2164, Val Loss: 1.0153
Epoch 123, accuracy: 0.7640
Epoch 124, accuracy: 0.7640
Epoch 124, Train Loss: 0.2207, Val Loss: 1.0153
Epoch 125, accuracy: 0.7640
Epoch 126, accuracy: 0.7640
Epoch 126, Train Loss: 0.2507, Val Loss: 1.0153
Epoch 127, accuracy: 0.7640
Epoch 128, accuracy: 0.7640
Epoch 128, Train Loss: 0.2780, Val Loss: 1.0153
Epoch 129, accuracy: 0.7640
Epoch 130, accuracy: 0.7640
Epoch 130, Train Loss: 0.2945, Val Loss: 1.0153
Epoch 131, accuracy: 0.7640
Epoch 132, accuracy: 0.7640
Epoch 132, Train Loss: 0.2747, Val Loss: 1.0153
Epoch 133, accuracy: 0.7640
Epoch 134, accuracy: 0.7640
Epoch 134, Train Loss: 0.2303, Val Loss: 1.0153
Epoch 135, accuracy: 0.7640
Epoch 136, accuracy: 0.7640
Epoch 136, Train Loss: 0.2486, Val Loss: 1.0153
Epoch 137, accuracy: 0.7640
Epoch 138, accuracy: 0.7640
Epoch 138, Train Loss: 0.3119, Val Loss: 1.0153
Epoch 139, accuracy: 0.7640
Epoch 140, accuracy: 0.7640
Epoch 140, Train Loss: 0.2964, Val Loss: 1.0153
Epoch 141, accuracy: 0.7640
Epoch 142, accuracy: 0.7640
Epoch 142, Train Loss: 0.3347, Val Loss: 1.0153
Epoch 143, accuracy: 0.7640
Epoch 144, accuracy: 0.7640
Epoch 144, Train Loss: 0.3345, Val Loss: 1.0153
Epoch 145, accuracy: 0.7640
Epoch 146, accuracy: 0.7640
Epoch 146, Train Loss: 0.2742, Val Loss: 1.0153
Epoch 147, accuracy: 0.7640
Epoch 148, accuracy: 0.7640
Epoch 148, Train Loss: 0.2407, Val Loss: 1.0153
Epoch 149, accuracy: 0.7640
Epoch 150, accuracy: 0.7640
Epoch 150, Train Loss: 0.3419, Val Loss: 1.0153
Epoch 151, accuracy: 0.7640
Epoch 152, accuracy: 0.7640
Epoch 152, Train Loss: 0.2481, Val Loss: 1.0153
Epoch 153, accuracy: 0.7640
Epoch 154, accuracy: 0.7640
Epoch 154, Train Loss: 0.2819, Val Loss: 1.0153
Epoch 155, accuracy: 0.7640
Epoch 156, accuracy: 0.7640
Epoch 156, Train Loss: 0.2689, Val Loss: 1.0153
Epoch 157, accuracy: 0.7640
Epoch 158, accuracy: 0.7640
Epoch 158, Train Loss: 0.2207, Val Loss: 1.0153
Epoch 159, accuracy: 0.7640
Epoch 160, accuracy: 0.7640
Epoch 160, Train Loss: 0.2699, Val Loss: 1.0153
Epoch 161, accuracy: 0.7640
Epoch 162, accuracy: 0.7640
Epoch 162, Train Loss: 0.2891, Val Loss: 1.0153
Epoch 163, accuracy: 0.7640
Epoch 164, accuracy: 0.7640
Epoch 164, Train Loss: 0.2454, Val Loss: 1.0153
Epoch 165, accuracy: 0.7640
Epoch 166, accuracy: 0.7640
Epoch 166, Train Loss: 0.2331, Val Loss: 1.0153
Epoch 167, accuracy: 0.7640
Epoch 168, accuracy: 0.7640
Epoch 168, Train Loss: 0.2447, Val Loss: 1.0153
Epoch 169, accuracy: 0.7640
Epoch 170, accuracy: 0.7640
Epoch 170, Train Loss: 0.2534, Val Loss: 1.0153
Epoch 171, accuracy: 0.7640
Epoch 172, accuracy: 0.7640
Epoch 172, Train Loss: 0.2725, Val Loss: 1.0153
Epoch 173, accuracy: 0.7640
Epoch 174, accuracy: 0.7640
Epoch 174, Train Loss: 0.2540, Val Loss: 1.0153
Epoch 175, accuracy: 0.7640
Epoch 176, accuracy: 0.7640
Epoch 176, Train Loss: 0.3141, Val Loss: 1.0153
Epoch 177, accuracy: 0.7640
Epoch 178, accuracy: 0.7640
Epoch 178, Train Loss: 0.2035, Val Loss: 1.0153
Epoch 179, accuracy: 0.7640
Epoch 180, accuracy: 0.7640
Epoch 180, Train Loss: 0.2639, Val Loss: 1.0153
Epoch 181, accuracy: 0.7640
Epoch 182, accuracy: 0.7640
Epoch 182, Train Loss: 0.2532, Val Loss: 1.0153
Epoch 183, accuracy: 0.7640
Epoch 184, accuracy: 0.7640
Epoch 184, Train Loss: 0.2843, Val Loss: 1.0153
Epoch 185, accuracy: 0.7640
Epoch 186, accuracy: 0.7640
Epoch 186, Train Loss: 0.2466, Val Loss: 1.0153
Epoch 187, accuracy: 0.7640
Epoch 188, accuracy: 0.7640
Epoch 188, Train Loss: 0.2420, Val Loss: 1.0153
Epoch 189, accuracy: 0.7640
Epoch 190, accuracy: 0.7640
Epoch 190, Train Loss: 0.3069, Val Loss: 1.0153
Epoch 191, accuracy: 0.7640
Epoch 192, accuracy: 0.7640
Epoch 192, Train Loss: 0.2258, Val Loss: 1.0153
Epoch 193, accuracy: 0.7640
Epoch 194, accuracy: 0.7640
Epoch 194, Train Loss: 0.3175, Val Loss: 1.0153
Epoch 195, accuracy: 0.7640
Epoch 196, accuracy: 0.7640
Epoch 196, Train Loss: 0.2328, Val Loss: 1.0153
Epoch 197, accuracy: 0.7640
Epoch 198, accuracy: 0.7640
Epoch 198, Train Loss: 0.2546, Val Loss: 1.0153
Epoch 199, accuracy: 0.7640
Loaded best model with val_loss = 0.8698858618736267
test :accuracy 0.8010, f1_macro: 0.7891, f1_micro: 0.8010, auc: 0.9551
Final Results: {'GAT_3_Cora': np.float64(0.802), 'GAT_4_Cora': np.float64(0.79), 'GAT_5_Cora': np.float64(0.777), 'GAT_6_Cora': np.float64(0.748), 'GAT_7_Cora': np.float64(0.665), 'mamba3_3_Cora': np.float64(0.763), 'mamba3_4_Cora': np.float64(0.775), 'mamba3_5_Cora': np.float64(0.778), 'mamba3_6_Cora': np.float64(0.789), 'mamba3_7_Cora': np.float64(0.801)} ['707363_GAT_0', '856867_GAT_0', '1006371_GAT_0', '1155875_GAT_0', '1305379_GAT_0', '915885_mamba3_0', '998957_mamba3_0', '1082029_mamba3_0', '1165101_mamba3_0', '1248173_mamba3_0']
========== Running baseline 3/3 ==========
Training GAT with 3 layers...
可训练参数: 707363_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.8069
Epoch 0, accuracy: 0.7810
Epoch 0, Train Loss: 1.9644, Val Loss: 1.8069
✅ Epoch 1: New best model saved with val_loss = 1.5563
Epoch 1, accuracy: 0.7900
✅ Epoch 2: New best model saved with val_loss = 1.1689
Epoch 2, accuracy: 0.7960
Epoch 2, Train Loss: 1.3380, Val Loss: 1.1689
✅ Epoch 3: New best model saved with val_loss = 0.8096
Epoch 3, accuracy: 0.8060
✅ Epoch 4: New best model saved with val_loss = 0.6431
Epoch 4, accuracy: 0.8080
Epoch 4, Train Loss: 0.3757, Val Loss: 0.6431
Epoch 5, accuracy: 0.7810
Epoch 6, accuracy: 0.7840
Epoch 6, Train Loss: 0.1300, Val Loss: 0.8001
Epoch 7, accuracy: 0.7590
Epoch 8, accuracy: 0.7910
Epoch 8, Train Loss: 0.1393, Val Loss: 1.0964
Epoch 9, accuracy: 0.7710
Epoch 10, accuracy: 0.7590
Epoch 10, Train Loss: 0.0491, Val Loss: 1.5634
Epoch 11, accuracy: 0.7570
Epoch 12, accuracy: 0.7590
Epoch 12, Train Loss: 0.0225, Val Loss: 1.5882
Epoch 13, accuracy: 0.7610
Epoch 14, accuracy: 0.7650
Epoch 14, Train Loss: 0.0439, Val Loss: 1.5733
Epoch 15, accuracy: 0.7670
Epoch 16, accuracy: 0.7730
Epoch 16, Train Loss: 0.0315, Val Loss: 1.5217
Epoch 17, accuracy: 0.7730
Epoch 18, accuracy: 0.7730
Epoch 18, Train Loss: 0.0124, Val Loss: 1.5121
Epoch 19, accuracy: 0.7720
Epoch 20, accuracy: 0.7720
Epoch 20, Train Loss: 0.0168, Val Loss: 1.5021
Epoch 21, accuracy: 0.7730
Epoch 22, accuracy: 0.7730
Epoch 22, Train Loss: 0.0112, Val Loss: 1.4922
Epoch 23, accuracy: 0.7720
Epoch 24, accuracy: 0.7720
Epoch 24, Train Loss: 0.0469, Val Loss: 1.4912
Epoch 25, accuracy: 0.7720
Epoch 26, accuracy: 0.7720
Epoch 26, Train Loss: 0.0329, Val Loss: 1.4901
Epoch 27, accuracy: 0.7720
Epoch 28, accuracy: 0.7720
Epoch 28, Train Loss: 0.0140, Val Loss: 1.4891
Epoch 29, accuracy: 0.7720
Epoch 30, accuracy: 0.7720
Epoch 30, Train Loss: 0.0107, Val Loss: 1.4890
Epoch 31, accuracy: 0.7720
Epoch 32, accuracy: 0.7720
Epoch 32, Train Loss: 0.0064, Val Loss: 1.4889
Epoch 33, accuracy: 0.7720
Epoch 34, accuracy: 0.7720
Epoch 34, Train Loss: 0.0068, Val Loss: 1.4888
Epoch 35, accuracy: 0.7720
Epoch 36, accuracy: 0.7720
Epoch 36, Train Loss: 0.0577, Val Loss: 1.4888
Epoch 37, accuracy: 0.7720
Epoch 38, accuracy: 0.7720
Epoch 38, Train Loss: 0.0203, Val Loss: 1.4888
Epoch 39, accuracy: 0.7720
Epoch 40, accuracy: 0.7720
Epoch 40, Train Loss: 0.0334, Val Loss: 1.4887
Epoch 41, accuracy: 0.7720
Epoch 42, accuracy: 0.7720
Epoch 42, Train Loss: 0.0076, Val Loss: 1.4887
Epoch 43, accuracy: 0.7720
Epoch 44, accuracy: 0.7720
Epoch 44, Train Loss: 0.0173, Val Loss: 1.4887
Epoch 45, accuracy: 0.7720
Epoch 46, accuracy: 0.7720
Epoch 46, Train Loss: 0.0426, Val Loss: 1.4887
Epoch 47, accuracy: 0.7720
Epoch 48, accuracy: 0.7720
Epoch 48, Train Loss: 0.0181, Val Loss: 1.4887
Epoch 49, accuracy: 0.7720
Epoch 50, accuracy: 0.7720
Epoch 50, Train Loss: 0.0139, Val Loss: 1.4887
Epoch 51, accuracy: 0.7720
Epoch 52, accuracy: 0.7720
Epoch 52, Train Loss: 0.0074, Val Loss: 1.4887
Epoch 53, accuracy: 0.7720
Epoch 54, accuracy: 0.7720
Epoch 54, Train Loss: 0.0176, Val Loss: 1.4887
Epoch 55, accuracy: 0.7720
Epoch 56, accuracy: 0.7720
Epoch 56, Train Loss: 0.0074, Val Loss: 1.4887
Epoch 57, accuracy: 0.7720
Epoch 58, accuracy: 0.7720
Epoch 58, Train Loss: 0.0097, Val Loss: 1.4887
Epoch 59, accuracy: 0.7720
Epoch 60, accuracy: 0.7720
Epoch 60, Train Loss: 0.0152, Val Loss: 1.4887
Epoch 61, accuracy: 0.7720
Epoch 62, accuracy: 0.7720
Epoch 62, Train Loss: 0.0051, Val Loss: 1.4887
Epoch 63, accuracy: 0.7720
Epoch 64, accuracy: 0.7720
Epoch 64, Train Loss: 0.0296, Val Loss: 1.4887
Epoch 65, accuracy: 0.7720
Epoch 66, accuracy: 0.7720
Epoch 66, Train Loss: 0.0143, Val Loss: 1.4887
Epoch 67, accuracy: 0.7720
Epoch 68, accuracy: 0.7720
Epoch 68, Train Loss: 0.0723, Val Loss: 1.4887
Epoch 69, accuracy: 0.7720
Epoch 70, accuracy: 0.7720
Epoch 70, Train Loss: 0.0118, Val Loss: 1.4887
Epoch 71, accuracy: 0.7720
Epoch 72, accuracy: 0.7720
Epoch 72, Train Loss: 0.0087, Val Loss: 1.4887
Epoch 73, accuracy: 0.7720
Epoch 74, accuracy: 0.7720
Epoch 74, Train Loss: 0.0130, Val Loss: 1.4887
Epoch 75, accuracy: 0.7720
Epoch 76, accuracy: 0.7720
Epoch 76, Train Loss: 0.0176, Val Loss: 1.4887
Epoch 77, accuracy: 0.7720
Epoch 78, accuracy: 0.7720
Epoch 78, Train Loss: 0.0204, Val Loss: 1.4887
Epoch 79, accuracy: 0.7720
Epoch 80, accuracy: 0.7720
Epoch 80, Train Loss: 0.0113, Val Loss: 1.4887
Epoch 81, accuracy: 0.7720
Epoch 82, accuracy: 0.7720
Epoch 82, Train Loss: 0.0478, Val Loss: 1.4887
Epoch 83, accuracy: 0.7720
Epoch 84, accuracy: 0.7720
Epoch 84, Train Loss: 0.0588, Val Loss: 1.4887
Epoch 85, accuracy: 0.7720
Epoch 86, accuracy: 0.7720
Epoch 86, Train Loss: 0.0203, Val Loss: 1.4887
Epoch 87, accuracy: 0.7720
Epoch 88, accuracy: 0.7720
Epoch 88, Train Loss: 0.0095, Val Loss: 1.4887
Epoch 89, accuracy: 0.7720
Epoch 90, accuracy: 0.7720
Epoch 90, Train Loss: 0.0186, Val Loss: 1.4887
Epoch 91, accuracy: 0.7720
Epoch 92, accuracy: 0.7720
Epoch 92, Train Loss: 0.0121, Val Loss: 1.4887
Epoch 93, accuracy: 0.7720
Epoch 94, accuracy: 0.7720
Epoch 94, Train Loss: 0.0135, Val Loss: 1.4887
Epoch 95, accuracy: 0.7720
Epoch 96, accuracy: 0.7720
Epoch 96, Train Loss: 0.0377, Val Loss: 1.4887
Epoch 97, accuracy: 0.7720
Epoch 98, accuracy: 0.7720
Epoch 98, Train Loss: 0.0102, Val Loss: 1.4887
Epoch 99, accuracy: 0.7720
Epoch 100, accuracy: 0.7720
Epoch 100, Train Loss: 0.0081, Val Loss: 1.4887
Epoch 101, accuracy: 0.7720
Epoch 102, accuracy: 0.7720
Epoch 102, Train Loss: 0.0296, Val Loss: 1.4887
Epoch 103, accuracy: 0.7720
Epoch 104, accuracy: 0.7720
Epoch 104, Train Loss: 0.0300, Val Loss: 1.4887
Epoch 105, accuracy: 0.7720
Epoch 106, accuracy: 0.7720
Epoch 106, Train Loss: 0.0235, Val Loss: 1.4887
Epoch 107, accuracy: 0.7720
Epoch 108, accuracy: 0.7720
Epoch 108, Train Loss: 0.0393, Val Loss: 1.4887
Epoch 109, accuracy: 0.7720
Epoch 110, accuracy: 0.7720
Epoch 110, Train Loss: 0.0332, Val Loss: 1.4887
Epoch 111, accuracy: 0.7720
Epoch 112, accuracy: 0.7720
Epoch 112, Train Loss: 0.0117, Val Loss: 1.4887
Epoch 113, accuracy: 0.7720
Epoch 114, accuracy: 0.7720
Epoch 114, Train Loss: 0.0122, Val Loss: 1.4887
Epoch 115, accuracy: 0.7720
Epoch 116, accuracy: 0.7720
Epoch 116, Train Loss: 0.0388, Val Loss: 1.4887
Epoch 117, accuracy: 0.7720
Epoch 118, accuracy: 0.7720
Epoch 118, Train Loss: 0.0206, Val Loss: 1.4887
Epoch 119, accuracy: 0.7720
Epoch 120, accuracy: 0.7720
Epoch 120, Train Loss: 0.0118, Val Loss: 1.4887
Epoch 121, accuracy: 0.7720
Epoch 122, accuracy: 0.7720
Epoch 122, Train Loss: 0.0188, Val Loss: 1.4887
Epoch 123, accuracy: 0.7720
Epoch 124, accuracy: 0.7720
Epoch 124, Train Loss: 0.0341, Val Loss: 1.4887
Epoch 125, accuracy: 0.7720
Epoch 126, accuracy: 0.7720
Epoch 126, Train Loss: 0.0083, Val Loss: 1.4887
Epoch 127, accuracy: 0.7720
Epoch 128, accuracy: 0.7720
Epoch 128, Train Loss: 0.0170, Val Loss: 1.4887
Epoch 129, accuracy: 0.7720
Epoch 130, accuracy: 0.7720
Epoch 130, Train Loss: 0.0170, Val Loss: 1.4887
Epoch 131, accuracy: 0.7720
Epoch 132, accuracy: 0.7720
Epoch 132, Train Loss: 0.0206, Val Loss: 1.4887
Epoch 133, accuracy: 0.7720
Epoch 134, accuracy: 0.7720
Epoch 134, Train Loss: 0.0049, Val Loss: 1.4887
Epoch 135, accuracy: 0.7720
Epoch 136, accuracy: 0.7720
Epoch 136, Train Loss: 0.0100, Val Loss: 1.4887
Epoch 137, accuracy: 0.7720
Epoch 138, accuracy: 0.7720
Epoch 138, Train Loss: 0.0228, Val Loss: 1.4887
Epoch 139, accuracy: 0.7720
Epoch 140, accuracy: 0.7720
Epoch 140, Train Loss: 0.0302, Val Loss: 1.4887
Epoch 141, accuracy: 0.7720
Epoch 142, accuracy: 0.7720
Epoch 142, Train Loss: 0.0085, Val Loss: 1.4887
Epoch 143, accuracy: 0.7720
Epoch 144, accuracy: 0.7720
Epoch 144, Train Loss: 0.0127, Val Loss: 1.4887
Epoch 145, accuracy: 0.7720
Epoch 146, accuracy: 0.7720
Epoch 146, Train Loss: 0.0133, Val Loss: 1.4887
Epoch 147, accuracy: 0.7720
Epoch 148, accuracy: 0.7720
Epoch 148, Train Loss: 0.0153, Val Loss: 1.4887
Epoch 149, accuracy: 0.7720
Epoch 150, accuracy: 0.7720
Epoch 150, Train Loss: 0.0458, Val Loss: 1.4887
Epoch 151, accuracy: 0.7720
Epoch 152, accuracy: 0.7720
Epoch 152, Train Loss: 0.0271, Val Loss: 1.4887
Epoch 153, accuracy: 0.7720
Epoch 154, accuracy: 0.7720
Epoch 154, Train Loss: 0.0095, Val Loss: 1.4887
Epoch 155, accuracy: 0.7720
Epoch 156, accuracy: 0.7720
Epoch 156, Train Loss: 0.0136, Val Loss: 1.4887
Epoch 157, accuracy: 0.7720
Epoch 158, accuracy: 0.7720
Epoch 158, Train Loss: 0.0113, Val Loss: 1.4887
Epoch 159, accuracy: 0.7720
Epoch 160, accuracy: 0.7720
Epoch 160, Train Loss: 0.0179, Val Loss: 1.4887
Epoch 161, accuracy: 0.7720
Epoch 162, accuracy: 0.7720
Epoch 162, Train Loss: 0.0136, Val Loss: 1.4887
Epoch 163, accuracy: 0.7720
Epoch 164, accuracy: 0.7720
Epoch 164, Train Loss: 0.0338, Val Loss: 1.4887
Epoch 165, accuracy: 0.7720
Epoch 166, accuracy: 0.7720
Epoch 166, Train Loss: 0.0110, Val Loss: 1.4887
Epoch 167, accuracy: 0.7720
Epoch 168, accuracy: 0.7720
Epoch 168, Train Loss: 0.0113, Val Loss: 1.4887
Epoch 169, accuracy: 0.7720
Epoch 170, accuracy: 0.7720
Epoch 170, Train Loss: 0.0080, Val Loss: 1.4887
Epoch 171, accuracy: 0.7720
Epoch 172, accuracy: 0.7720
Epoch 172, Train Loss: 0.0072, Val Loss: 1.4887
Epoch 173, accuracy: 0.7720
Epoch 174, accuracy: 0.7720
Epoch 174, Train Loss: 0.0243, Val Loss: 1.4887
Epoch 175, accuracy: 0.7720
Epoch 176, accuracy: 0.7720
Epoch 176, Train Loss: 0.0417, Val Loss: 1.4887
Epoch 177, accuracy: 0.7720
Epoch 178, accuracy: 0.7720
Epoch 178, Train Loss: 0.0078, Val Loss: 1.4887
Epoch 179, accuracy: 0.7720
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 180, accuracy: 0.7720
Epoch 180, Train Loss: 0.0221, Val Loss: 1.4887
Epoch 181, accuracy: 0.7720
Epoch 182, accuracy: 0.7720
Epoch 182, Train Loss: 0.0180, Val Loss: 1.4887
Epoch 183, accuracy: 0.7720
Epoch 184, accuracy: 0.7720
Epoch 184, Train Loss: 0.0208, Val Loss: 1.4887
Epoch 185, accuracy: 0.7720
Epoch 186, accuracy: 0.7720
Epoch 186, Train Loss: 0.0171, Val Loss: 1.4887
Epoch 187, accuracy: 0.7720
Epoch 188, accuracy: 0.7720
Epoch 188, Train Loss: 0.0137, Val Loss: 1.4887
Epoch 189, accuracy: 0.7720
Epoch 190, accuracy: 0.7720
Epoch 190, Train Loss: 0.0165, Val Loss: 1.4887
Epoch 191, accuracy: 0.7720
Epoch 192, accuracy: 0.7720
Epoch 192, Train Loss: 0.0099, Val Loss: 1.4887
Epoch 193, accuracy: 0.7720
Epoch 194, accuracy: 0.7720
Epoch 194, Train Loss: 0.0109, Val Loss: 1.4887
Epoch 195, accuracy: 0.7720
Epoch 196, accuracy: 0.7720
Epoch 196, Train Loss: 0.0515, Val Loss: 1.4887
Epoch 197, accuracy: 0.7720
Epoch 198, accuracy: 0.7720
Epoch 198, Train Loss: 0.0220, Val Loss: 1.4887
Epoch 199, accuracy: 0.7720
Loaded best model with val_loss = 0.6430973410606384
test :accuracy 0.8080, f1_macro: 0.7992, f1_micro: 0.8080, auc: 0.9698
Training GAT with 4 layers...
可训练参数: 856867_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.8593
Epoch 0, accuracy: 0.4720
Epoch 0, Train Loss: 1.9410, Val Loss: 1.8593
✅ Epoch 1: New best model saved with val_loss = 1.5293
Epoch 1, accuracy: 0.7750
✅ Epoch 2: New best model saved with val_loss = 1.0395
Epoch 2, accuracy: 0.7850
Epoch 2, Train Loss: 1.3906, Val Loss: 1.0395
✅ Epoch 3: New best model saved with val_loss = 0.7388
Epoch 3, accuracy: 0.8070
Epoch 4, accuracy: 0.5890
Epoch 4, Train Loss: 0.4019, Val Loss: 1.5315
Epoch 5, accuracy: 0.7380
Epoch 6, accuracy: 0.7760
Epoch 6, Train Loss: 0.3628, Val Loss: 0.9245
Epoch 7, accuracy: 0.7660
Epoch 8, accuracy: 0.7990
Epoch 8, Train Loss: 0.2359, Val Loss: 0.9514
Epoch 9, accuracy: 0.7880
Epoch 10, accuracy: 0.7880
Epoch 10, Train Loss: 0.0564, Val Loss: 0.9728
Epoch 11, accuracy: 0.7880
Epoch 12, accuracy: 0.7850
Epoch 12, Train Loss: 0.0659, Val Loss: 0.9805
Epoch 13, accuracy: 0.7870
Epoch 14, accuracy: 0.7880
Epoch 14, Train Loss: 0.0625, Val Loss: 0.9866
Epoch 15, accuracy: 0.7880
Epoch 16, accuracy: 0.7890
Epoch 16, Train Loss: 0.0478, Val Loss: 0.9950
Epoch 17, accuracy: 0.7900
Epoch 18, accuracy: 0.7870
Epoch 18, Train Loss: 0.0600, Val Loss: 0.9958
Epoch 19, accuracy: 0.7880
Epoch 20, accuracy: 0.7880
Epoch 20, Train Loss: 0.0538, Val Loss: 0.9956
Epoch 21, accuracy: 0.7880
Epoch 22, accuracy: 0.7890
Epoch 22, Train Loss: 0.0609, Val Loss: 0.9952
Epoch 23, accuracy: 0.7890
Epoch 24, accuracy: 0.7890
Epoch 24, Train Loss: 0.0427, Val Loss: 0.9951
Epoch 25, accuracy: 0.7890
Epoch 26, accuracy: 0.7890
Epoch 26, Train Loss: 0.0364, Val Loss: 0.9950
Epoch 27, accuracy: 0.7890
Epoch 28, accuracy: 0.7890
Epoch 28, Train Loss: 0.0504, Val Loss: 0.9949
Epoch 29, accuracy: 0.7890
Epoch 30, accuracy: 0.7890
Epoch 30, Train Loss: 0.0555, Val Loss: 0.9949
Epoch 31, accuracy: 0.7890
Epoch 32, accuracy: 0.7890
Epoch 32, Train Loss: 0.0779, Val Loss: 0.9949
Epoch 33, accuracy: 0.7890
Epoch 34, accuracy: 0.7890
Epoch 34, Train Loss: 0.0326, Val Loss: 0.9948
Epoch 35, accuracy: 0.7890
Epoch 36, accuracy: 0.7890
Epoch 36, Train Loss: 0.0557, Val Loss: 0.9948
Epoch 37, accuracy: 0.7890
Epoch 38, accuracy: 0.7890
Epoch 38, Train Loss: 0.0591, Val Loss: 0.9948
Epoch 39, accuracy: 0.7890
Epoch 40, accuracy: 0.7890
Epoch 40, Train Loss: 0.0499, Val Loss: 0.9948
Epoch 41, accuracy: 0.7890
Epoch 42, accuracy: 0.7890
Epoch 42, Train Loss: 0.0659, Val Loss: 0.9948
Epoch 43, accuracy: 0.7890
Epoch 44, accuracy: 0.7890
Epoch 44, Train Loss: 0.0787, Val Loss: 0.9948
Epoch 45, accuracy: 0.7890
Epoch 46, accuracy: 0.7890
Epoch 46, Train Loss: 0.0376, Val Loss: 0.9948
Epoch 47, accuracy: 0.7890
Epoch 48, accuracy: 0.7890
Epoch 48, Train Loss: 0.0496, Val Loss: 0.9948
Epoch 49, accuracy: 0.7890
Epoch 50, accuracy: 0.7890
Epoch 50, Train Loss: 0.0532, Val Loss: 0.9948
Epoch 51, accuracy: 0.7890
Epoch 52, accuracy: 0.7890
Epoch 52, Train Loss: 0.0549, Val Loss: 0.9948
Epoch 53, accuracy: 0.7890
Epoch 54, accuracy: 0.7890
Epoch 54, Train Loss: 0.0279, Val Loss: 0.9948
Epoch 55, accuracy: 0.7890
Epoch 56, accuracy: 0.7890
Epoch 56, Train Loss: 0.0607, Val Loss: 0.9948
Epoch 57, accuracy: 0.7890
Epoch 58, accuracy: 0.7890
Epoch 58, Train Loss: 0.0430, Val Loss: 0.9948
Epoch 59, accuracy: 0.7890
Epoch 60, accuracy: 0.7890
Epoch 60, Train Loss: 0.0373, Val Loss: 0.9948
Epoch 61, accuracy: 0.7890
Epoch 62, accuracy: 0.7890
Epoch 62, Train Loss: 0.0378, Val Loss: 0.9948
Epoch 63, accuracy: 0.7890
Epoch 64, accuracy: 0.7890
Epoch 64, Train Loss: 0.0348, Val Loss: 0.9948
Epoch 65, accuracy: 0.7890
Epoch 66, accuracy: 0.7890
Epoch 66, Train Loss: 0.0515, Val Loss: 0.9948
Epoch 67, accuracy: 0.7890
Epoch 68, accuracy: 0.7890
Epoch 68, Train Loss: 0.0441, Val Loss: 0.9948
Epoch 69, accuracy: 0.7890
Epoch 70, accuracy: 0.7890
Epoch 70, Train Loss: 0.0468, Val Loss: 0.9948
Epoch 71, accuracy: 0.7890
Epoch 72, accuracy: 0.7890
Epoch 72, Train Loss: 0.0469, Val Loss: 0.9948
Epoch 73, accuracy: 0.7890
Epoch 74, accuracy: 0.7890
Epoch 74, Train Loss: 0.0314, Val Loss: 0.9948
Epoch 75, accuracy: 0.7890
Epoch 76, accuracy: 0.7890
Epoch 76, Train Loss: 0.0332, Val Loss: 0.9948
Epoch 77, accuracy: 0.7890
Epoch 78, accuracy: 0.7890
Epoch 78, Train Loss: 0.0438, Val Loss: 0.9948
Epoch 79, accuracy: 0.7890
Epoch 80, accuracy: 0.7890
Epoch 80, Train Loss: 0.0480, Val Loss: 0.9948
Epoch 81, accuracy: 0.7890
Epoch 82, accuracy: 0.7890
Epoch 82, Train Loss: 0.0660, Val Loss: 0.9948
Epoch 83, accuracy: 0.7890
Epoch 84, accuracy: 0.7890
Epoch 84, Train Loss: 0.0445, Val Loss: 0.9948
Epoch 85, accuracy: 0.7890
Epoch 86, accuracy: 0.7890
Epoch 86, Train Loss: 0.0392, Val Loss: 0.9948
Epoch 87, accuracy: 0.7890
Epoch 88, accuracy: 0.7890
Epoch 88, Train Loss: 0.0701, Val Loss: 0.9948
Epoch 89, accuracy: 0.7890
Epoch 90, accuracy: 0.7890
Epoch 90, Train Loss: 0.0632, Val Loss: 0.9948
Epoch 91, accuracy: 0.7890
Epoch 92, accuracy: 0.7890
Epoch 92, Train Loss: 0.0675, Val Loss: 0.9948
Epoch 93, accuracy: 0.7890
Epoch 94, accuracy: 0.7890
Epoch 94, Train Loss: 0.0502, Val Loss: 0.9948
Epoch 95, accuracy: 0.7890
Epoch 96, accuracy: 0.7890
Epoch 96, Train Loss: 0.0390, Val Loss: 0.9948
Epoch 97, accuracy: 0.7890
Epoch 98, accuracy: 0.7890
Epoch 98, Train Loss: 0.0523, Val Loss: 0.9948
Epoch 99, accuracy: 0.7890
Epoch 100, accuracy: 0.7890
Epoch 100, Train Loss: 0.0345, Val Loss: 0.9948
Epoch 101, accuracy: 0.7890
Epoch 102, accuracy: 0.7890
Epoch 102, Train Loss: 0.0280, Val Loss: 0.9948
Epoch 103, accuracy: 0.7890
Epoch 104, accuracy: 0.7890
Epoch 104, Train Loss: 0.0671, Val Loss: 0.9948
Epoch 105, accuracy: 0.7890
Epoch 106, accuracy: 0.7890
Epoch 106, Train Loss: 0.0421, Val Loss: 0.9948
Epoch 107, accuracy: 0.7890
Epoch 108, accuracy: 0.7890
Epoch 108, Train Loss: 0.0477, Val Loss: 0.9948
Epoch 109, accuracy: 0.7890
Epoch 110, accuracy: 0.7890
Epoch 110, Train Loss: 0.0398, Val Loss: 0.9948
Epoch 111, accuracy: 0.7890
Epoch 112, accuracy: 0.7890
Epoch 112, Train Loss: 0.0296, Val Loss: 0.9948
Epoch 113, accuracy: 0.7890
Epoch 114, accuracy: 0.7890
Epoch 114, Train Loss: 0.0645, Val Loss: 0.9948
Epoch 115, accuracy: 0.7890
Epoch 116, accuracy: 0.7890
Epoch 116, Train Loss: 0.0515, Val Loss: 0.9948
Epoch 117, accuracy: 0.7890
Epoch 118, accuracy: 0.7890
Epoch 118, Train Loss: 0.0519, Val Loss: 0.9948
Epoch 119, accuracy: 0.7890
Epoch 120, accuracy: 0.7890
Epoch 120, Train Loss: 0.0356, Val Loss: 0.9948
Epoch 121, accuracy: 0.7890
Epoch 122, accuracy: 0.7890
Epoch 122, Train Loss: 0.0682, Val Loss: 0.9948
Epoch 123, accuracy: 0.7890
Epoch 124, accuracy: 0.7890
Epoch 124, Train Loss: 0.0414, Val Loss: 0.9948
Epoch 125, accuracy: 0.7890
Epoch 126, accuracy: 0.7890
Epoch 126, Train Loss: 0.0438, Val Loss: 0.9948
Epoch 127, accuracy: 0.7890
Epoch 128, accuracy: 0.7890
Epoch 128, Train Loss: 0.0475, Val Loss: 0.9948
Epoch 129, accuracy: 0.7890
Epoch 130, accuracy: 0.7890
Epoch 130, Train Loss: 0.0334, Val Loss: 0.9948
Epoch 131, accuracy: 0.7890
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 132, accuracy: 0.7890
Epoch 132, Train Loss: 0.0396, Val Loss: 0.9948
Epoch 133, accuracy: 0.7890
Epoch 134, accuracy: 0.7890
Epoch 134, Train Loss: 0.0514, Val Loss: 0.9948
Epoch 135, accuracy: 0.7890
Epoch 136, accuracy: 0.7890
Epoch 136, Train Loss: 0.0625, Val Loss: 0.9948
Epoch 137, accuracy: 0.7890
Epoch 138, accuracy: 0.7890
Epoch 138, Train Loss: 0.0603, Val Loss: 0.9948
Epoch 139, accuracy: 0.7890
Epoch 140, accuracy: 0.7890
Epoch 140, Train Loss: 0.0518, Val Loss: 0.9948
Epoch 141, accuracy: 0.7890
Epoch 142, accuracy: 0.7890
Epoch 142, Train Loss: 0.0765, Val Loss: 0.9948
Epoch 143, accuracy: 0.7890
Epoch 144, accuracy: 0.7890
Epoch 144, Train Loss: 0.0393, Val Loss: 0.9948
Epoch 145, accuracy: 0.7890
Epoch 146, accuracy: 0.7890
Epoch 146, Train Loss: 0.0358, Val Loss: 0.9948
Epoch 147, accuracy: 0.7890
Epoch 148, accuracy: 0.7890
Epoch 148, Train Loss: 0.0524, Val Loss: 0.9948
Epoch 149, accuracy: 0.7890
Epoch 150, accuracy: 0.7890
Epoch 150, Train Loss: 0.0646, Val Loss: 0.9948
Epoch 151, accuracy: 0.7890
Epoch 152, accuracy: 0.7890
Epoch 152, Train Loss: 0.0549, Val Loss: 0.9948
Epoch 153, accuracy: 0.7890
Epoch 154, accuracy: 0.7890
Epoch 154, Train Loss: 0.0570, Val Loss: 0.9948
Epoch 155, accuracy: 0.7890
Epoch 156, accuracy: 0.7890
Epoch 156, Train Loss: 0.0359, Val Loss: 0.9948
Epoch 157, accuracy: 0.7890
Epoch 158, accuracy: 0.7890
Epoch 158, Train Loss: 0.0329, Val Loss: 0.9948
Epoch 159, accuracy: 0.7890
Epoch 160, accuracy: 0.7890
Epoch 160, Train Loss: 0.0829, Val Loss: 0.9948
Epoch 161, accuracy: 0.7890
Epoch 162, accuracy: 0.7890
Epoch 162, Train Loss: 0.0319, Val Loss: 0.9948
Epoch 163, accuracy: 0.7890
Epoch 164, accuracy: 0.7890
Epoch 164, Train Loss: 0.0588, Val Loss: 0.9948
Epoch 165, accuracy: 0.7890
Epoch 166, accuracy: 0.7890
Epoch 166, Train Loss: 0.0560, Val Loss: 0.9948
Epoch 167, accuracy: 0.7890
Epoch 168, accuracy: 0.7890
Epoch 168, Train Loss: 0.0557, Val Loss: 0.9948
Epoch 169, accuracy: 0.7890
Epoch 170, accuracy: 0.7890
Epoch 170, Train Loss: 0.0705, Val Loss: 0.9948
Epoch 171, accuracy: 0.7890
Epoch 172, accuracy: 0.7890
Epoch 172, Train Loss: 0.0515, Val Loss: 0.9948
Epoch 173, accuracy: 0.7890
Epoch 174, accuracy: 0.7890
Epoch 174, Train Loss: 0.0341, Val Loss: 0.9948
Epoch 175, accuracy: 0.7890
Epoch 176, accuracy: 0.7890
Epoch 176, Train Loss: 0.0525, Val Loss: 0.9948
Epoch 177, accuracy: 0.7890
Epoch 178, accuracy: 0.7890
Epoch 178, Train Loss: 0.0326, Val Loss: 0.9948
Epoch 179, accuracy: 0.7890
Epoch 180, accuracy: 0.7890
Epoch 180, Train Loss: 0.0555, Val Loss: 0.9948
Epoch 181, accuracy: 0.7890
Epoch 182, accuracy: 0.7890
Epoch 182, Train Loss: 0.0316, Val Loss: 0.9948
Epoch 183, accuracy: 0.7890
Epoch 184, accuracy: 0.7890
Epoch 184, Train Loss: 0.0523, Val Loss: 0.9948
Epoch 185, accuracy: 0.7890
Epoch 186, accuracy: 0.7890
Epoch 186, Train Loss: 0.0361, Val Loss: 0.9948
Epoch 187, accuracy: 0.7890
Epoch 188, accuracy: 0.7890
Epoch 188, Train Loss: 0.0444, Val Loss: 0.9948
Epoch 189, accuracy: 0.7890
Epoch 190, accuracy: 0.7890
Epoch 190, Train Loss: 0.0525, Val Loss: 0.9948
Epoch 191, accuracy: 0.7890
Epoch 192, accuracy: 0.7890
Epoch 192, Train Loss: 0.0448, Val Loss: 0.9948
Epoch 193, accuracy: 0.7890
Epoch 194, accuracy: 0.7890
Epoch 194, Train Loss: 0.0409, Val Loss: 0.9948
Epoch 195, accuracy: 0.7890
Epoch 196, accuracy: 0.7890
Epoch 196, Train Loss: 0.0378, Val Loss: 0.9948
Epoch 197, accuracy: 0.7890
Epoch 198, accuracy: 0.7890
Epoch 198, Train Loss: 0.0404, Val Loss: 0.9948
Epoch 199, accuracy: 0.7890
Loaded best model with val_loss = 0.7387529611587524
test :accuracy 0.8070, f1_macro: 0.7934, f1_micro: 0.8070, auc: 0.9694
Training GAT with 5 layers...
可训练参数: 1006371_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.8947
Epoch 0, accuracy: 0.5560
Epoch 0, Train Loss: 1.9464, Val Loss: 1.8947
✅ Epoch 1: New best model saved with val_loss = 1.6645
Epoch 1, accuracy: 0.7780
✅ Epoch 2: New best model saved with val_loss = 1.2641
Epoch 2, accuracy: 0.6870
Epoch 2, Train Loss: 1.6097, Val Loss: 1.2641
✅ Epoch 3: New best model saved with val_loss = 1.0948
Epoch 3, accuracy: 0.7040
Epoch 4, accuracy: 0.5810
Epoch 4, Train Loss: 1.0239, Val Loss: 1.3648
Epoch 5, accuracy: 0.6610
✅ Epoch 6: New best model saved with val_loss = 0.8782
Epoch 6, accuracy: 0.7540
Epoch 6, Train Loss: 0.7376, Val Loss: 0.8782
✅ Epoch 7: New best model saved with val_loss = 0.8661
Epoch 7, accuracy: 0.7420
Epoch 8, accuracy: 0.7060
Epoch 8, Train Loss: 0.1868, Val Loss: 1.0329
Epoch 9, accuracy: 0.7280
Epoch 10, accuracy: 0.7390
Epoch 10, Train Loss: 0.2316, Val Loss: 0.9597
Epoch 11, accuracy: 0.7720
Epoch 12, accuracy: 0.7780
Epoch 12, Train Loss: 0.1133, Val Loss: 0.9732
Epoch 13, accuracy: 0.7770
Epoch 14, accuracy: 0.7770
Epoch 14, Train Loss: 0.0658, Val Loss: 1.0211
Epoch 15, accuracy: 0.7780
Epoch 16, accuracy: 0.7810
Epoch 16, Train Loss: 0.0367, Val Loss: 1.0325
Epoch 17, accuracy: 0.7820
Epoch 18, accuracy: 0.7820
Epoch 18, Train Loss: 0.0536, Val Loss: 1.0375
Epoch 19, accuracy: 0.7830
Epoch 20, accuracy: 0.7830
Epoch 20, Train Loss: 0.0219, Val Loss: 1.0398
Epoch 21, accuracy: 0.7840
Epoch 22, accuracy: 0.7830
Epoch 22, Train Loss: 0.0242, Val Loss: 1.0408
Epoch 23, accuracy: 0.7830
Epoch 24, accuracy: 0.7830
Epoch 24, Train Loss: 0.0256, Val Loss: 1.0418
Epoch 25, accuracy: 0.7830
Epoch 26, accuracy: 0.7830
Epoch 26, Train Loss: 0.0272, Val Loss: 1.0423
Epoch 27, accuracy: 0.7830
Epoch 28, accuracy: 0.7830
Epoch 28, Train Loss: 0.0253, Val Loss: 1.0424
Epoch 29, accuracy: 0.7830
Epoch 30, accuracy: 0.7830
Epoch 30, Train Loss: 0.0323, Val Loss: 1.0425
Epoch 31, accuracy: 0.7830
Epoch 32, accuracy: 0.7830
Epoch 32, Train Loss: 0.0313, Val Loss: 1.0425
Epoch 33, accuracy: 0.7830
Epoch 34, accuracy: 0.7830
Epoch 34, Train Loss: 0.0285, Val Loss: 1.0426
Epoch 35, accuracy: 0.7830
Epoch 36, accuracy: 0.7830
Epoch 36, Train Loss: 0.0221, Val Loss: 1.0426
Epoch 37, accuracy: 0.7830
Epoch 38, accuracy: 0.7830
Epoch 38, Train Loss: 0.0241, Val Loss: 1.0426
Epoch 39, accuracy: 0.7830
Epoch 40, accuracy: 0.7830
Epoch 40, Train Loss: 0.0337, Val Loss: 1.0426
Epoch 41, accuracy: 0.7830
Epoch 42, accuracy: 0.7830
Epoch 42, Train Loss: 0.0256, Val Loss: 1.0426
Epoch 43, accuracy: 0.7830
Epoch 44, accuracy: 0.7830
Epoch 44, Train Loss: 0.0230, Val Loss: 1.0426
Epoch 45, accuracy: 0.7830
Epoch 46, accuracy: 0.7830
Epoch 46, Train Loss: 0.0336, Val Loss: 1.0426
Epoch 47, accuracy: 0.7830
Epoch 48, accuracy: 0.7830
Epoch 48, Train Loss: 0.0317, Val Loss: 1.0426
Epoch 49, accuracy: 0.7830
Epoch 50, accuracy: 0.7830
Epoch 50, Train Loss: 0.0205, Val Loss: 1.0426
Epoch 51, accuracy: 0.7830
Epoch 52, accuracy: 0.7830
Epoch 52, Train Loss: 0.0345, Val Loss: 1.0426
Epoch 53, accuracy: 0.7830
Epoch 54, accuracy: 0.7830
Epoch 54, Train Loss: 0.0255, Val Loss: 1.0426
Epoch 55, accuracy: 0.7830
Epoch 56, accuracy: 0.7830
Epoch 56, Train Loss: 0.0337, Val Loss: 1.0426
Epoch 57, accuracy: 0.7830
Epoch 58, accuracy: 0.7830
Epoch 58, Train Loss: 0.0331, Val Loss: 1.0426
Epoch 59, accuracy: 0.7830
Epoch 60, accuracy: 0.7830
Epoch 60, Train Loss: 0.0252, Val Loss: 1.0426
Epoch 61, accuracy: 0.7830
Epoch 62, accuracy: 0.7830
Epoch 62, Train Loss: 0.0317, Val Loss: 1.0426
Epoch 63, accuracy: 0.7830
Epoch 64, accuracy: 0.7830
Epoch 64, Train Loss: 0.0277, Val Loss: 1.0426
Epoch 65, accuracy: 0.7830
Epoch 66, accuracy: 0.7830
Epoch 66, Train Loss: 0.0284, Val Loss: 1.0426
Epoch 67, accuracy: 0.7830
Epoch 68, accuracy: 0.7830
Epoch 68, Train Loss: 0.0274, Val Loss: 1.0426
Epoch 69, accuracy: 0.7830
Epoch 70, accuracy: 0.7830
Epoch 70, Train Loss: 0.0374, Val Loss: 1.0426
Epoch 71, accuracy: 0.7830
Epoch 72, accuracy: 0.7830
Epoch 72, Train Loss: 0.0271, Val Loss: 1.0426
Epoch 73, accuracy: 0.7830
Epoch 74, accuracy: 0.7830
Epoch 74, Train Loss: 0.0322, Val Loss: 1.0426
Epoch 75, accuracy: 0.7830
Epoch 76, accuracy: 0.7830
Epoch 76, Train Loss: 0.0275, Val Loss: 1.0426
Epoch 77, accuracy: 0.7830
Epoch 78, accuracy: 0.7830
Epoch 78, Train Loss: 0.0272, Val Loss: 1.0426
Epoch 79, accuracy: 0.7830
Epoch 80, accuracy: 0.7830
Epoch 80, Train Loss: 0.0283, Val Loss: 1.0426
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 81, accuracy: 0.7830
Epoch 82, accuracy: 0.7830
Epoch 82, Train Loss: 0.0209, Val Loss: 1.0426
Epoch 83, accuracy: 0.7830
Epoch 84, accuracy: 0.7830
Epoch 84, Train Loss: 0.0354, Val Loss: 1.0426
Epoch 85, accuracy: 0.7830
Epoch 86, accuracy: 0.7830
Epoch 86, Train Loss: 0.0258, Val Loss: 1.0426
Epoch 87, accuracy: 0.7830
Epoch 88, accuracy: 0.7830
Epoch 88, Train Loss: 0.0250, Val Loss: 1.0426
Epoch 89, accuracy: 0.7830
Epoch 90, accuracy: 0.7830
Epoch 90, Train Loss: 0.0353, Val Loss: 1.0426
Epoch 91, accuracy: 0.7830
Epoch 92, accuracy: 0.7830
Epoch 92, Train Loss: 0.0349, Val Loss: 1.0426
Epoch 93, accuracy: 0.7830
Epoch 94, accuracy: 0.7830
Epoch 94, Train Loss: 0.0429, Val Loss: 1.0426
Epoch 95, accuracy: 0.7830
Epoch 96, accuracy: 0.7830
Epoch 96, Train Loss: 0.0336, Val Loss: 1.0426
Epoch 97, accuracy: 0.7830
Epoch 98, accuracy: 0.7830
Epoch 98, Train Loss: 0.0237, Val Loss: 1.0426
Epoch 99, accuracy: 0.7830
Epoch 100, accuracy: 0.7830
Epoch 100, Train Loss: 0.0311, Val Loss: 1.0426
Epoch 101, accuracy: 0.7830
Epoch 102, accuracy: 0.7830
Epoch 102, Train Loss: 0.0309, Val Loss: 1.0426
Epoch 103, accuracy: 0.7830
Epoch 104, accuracy: 0.7830
Epoch 104, Train Loss: 0.0385, Val Loss: 1.0426
Epoch 105, accuracy: 0.7830
Epoch 106, accuracy: 0.7830
Epoch 106, Train Loss: 0.0238, Val Loss: 1.0426
Epoch 107, accuracy: 0.7830
Epoch 108, accuracy: 0.7830
Epoch 108, Train Loss: 0.0268, Val Loss: 1.0426
Epoch 109, accuracy: 0.7830
Epoch 110, accuracy: 0.7830
Epoch 110, Train Loss: 0.0278, Val Loss: 1.0426
Epoch 111, accuracy: 0.7830
Epoch 112, accuracy: 0.7830
Epoch 112, Train Loss: 0.0246, Val Loss: 1.0426
Epoch 113, accuracy: 0.7830
Epoch 114, accuracy: 0.7830
Epoch 114, Train Loss: 0.0227, Val Loss: 1.0426
Epoch 115, accuracy: 0.7830
Epoch 116, accuracy: 0.7830
Epoch 116, Train Loss: 0.0321, Val Loss: 1.0426
Epoch 117, accuracy: 0.7830
Epoch 118, accuracy: 0.7830
Epoch 118, Train Loss: 0.0294, Val Loss: 1.0426
Epoch 119, accuracy: 0.7830
Epoch 120, accuracy: 0.7830
Epoch 120, Train Loss: 0.0259, Val Loss: 1.0426
Epoch 121, accuracy: 0.7830
Epoch 122, accuracy: 0.7830
Epoch 122, Train Loss: 0.0225, Val Loss: 1.0426
Epoch 123, accuracy: 0.7830
Epoch 124, accuracy: 0.7830
Epoch 124, Train Loss: 0.0387, Val Loss: 1.0426
Epoch 125, accuracy: 0.7830
Epoch 126, accuracy: 0.7830
Epoch 126, Train Loss: 0.0234, Val Loss: 1.0426
Epoch 127, accuracy: 0.7830
Epoch 128, accuracy: 0.7830
Epoch 128, Train Loss: 0.0260, Val Loss: 1.0426
Epoch 129, accuracy: 0.7830
Epoch 130, accuracy: 0.7830
Epoch 130, Train Loss: 0.0394, Val Loss: 1.0426
Epoch 131, accuracy: 0.7830
Epoch 132, accuracy: 0.7830
Epoch 132, Train Loss: 0.0265, Val Loss: 1.0426
Epoch 133, accuracy: 0.7830
Epoch 134, accuracy: 0.7830
Epoch 134, Train Loss: 0.0254, Val Loss: 1.0426
Epoch 135, accuracy: 0.7830
Epoch 136, accuracy: 0.7830
Epoch 136, Train Loss: 0.0432, Val Loss: 1.0426
Epoch 137, accuracy: 0.7830
Epoch 138, accuracy: 0.7830
Epoch 138, Train Loss: 0.0291, Val Loss: 1.0426
Epoch 139, accuracy: 0.7830
Epoch 140, accuracy: 0.7830
Epoch 140, Train Loss: 0.0307, Val Loss: 1.0426
Epoch 141, accuracy: 0.7830
Epoch 142, accuracy: 0.7830
Epoch 142, Train Loss: 0.0336, Val Loss: 1.0426
Epoch 143, accuracy: 0.7830
Epoch 144, accuracy: 0.7830
Epoch 144, Train Loss: 0.0300, Val Loss: 1.0426
Epoch 145, accuracy: 0.7830
Epoch 146, accuracy: 0.7830
Epoch 146, Train Loss: 0.0400, Val Loss: 1.0426
Epoch 147, accuracy: 0.7830
Epoch 148, accuracy: 0.7830
Epoch 148, Train Loss: 0.0335, Val Loss: 1.0426
Epoch 149, accuracy: 0.7830
Epoch 150, accuracy: 0.7830
Epoch 150, Train Loss: 0.0238, Val Loss: 1.0426
Epoch 151, accuracy: 0.7830
Epoch 152, accuracy: 0.7830
Epoch 152, Train Loss: 0.0228, Val Loss: 1.0426
Epoch 153, accuracy: 0.7830
Epoch 154, accuracy: 0.7830
Epoch 154, Train Loss: 0.0367, Val Loss: 1.0426
Epoch 155, accuracy: 0.7830
Epoch 156, accuracy: 0.7830
Epoch 156, Train Loss: 0.0330, Val Loss: 1.0426
Epoch 157, accuracy: 0.7830
Epoch 158, accuracy: 0.7830
Epoch 158, Train Loss: 0.0343, Val Loss: 1.0426
Epoch 159, accuracy: 0.7830
Epoch 160, accuracy: 0.7830
Epoch 160, Train Loss: 0.0516, Val Loss: 1.0426
Epoch 161, accuracy: 0.7830
Epoch 162, accuracy: 0.7830
Epoch 162, Train Loss: 0.0263, Val Loss: 1.0426
Epoch 163, accuracy: 0.7830
Epoch 164, accuracy: 0.7830
Epoch 164, Train Loss: 0.0356, Val Loss: 1.0426
Epoch 165, accuracy: 0.7830
Epoch 166, accuracy: 0.7830
Epoch 166, Train Loss: 0.0256, Val Loss: 1.0426
Epoch 167, accuracy: 0.7830
Epoch 168, accuracy: 0.7830
Epoch 168, Train Loss: 0.0229, Val Loss: 1.0426
Epoch 169, accuracy: 0.7830
Epoch 170, accuracy: 0.7830
Epoch 170, Train Loss: 0.0346, Val Loss: 1.0426
Epoch 171, accuracy: 0.7830
Epoch 172, accuracy: 0.7830
Epoch 172, Train Loss: 0.0304, Val Loss: 1.0426
Epoch 173, accuracy: 0.7830
Epoch 174, accuracy: 0.7830
Epoch 174, Train Loss: 0.0381, Val Loss: 1.0426
Epoch 175, accuracy: 0.7830
Epoch 176, accuracy: 0.7830
Epoch 176, Train Loss: 0.0248, Val Loss: 1.0426
Epoch 177, accuracy: 0.7830
Epoch 178, accuracy: 0.7830
Epoch 178, Train Loss: 0.0274, Val Loss: 1.0426
Epoch 179, accuracy: 0.7830
Epoch 180, accuracy: 0.7830
Epoch 180, Train Loss: 0.0290, Val Loss: 1.0426
Epoch 181, accuracy: 0.7830
Epoch 182, accuracy: 0.7830
Epoch 182, Train Loss: 0.0276, Val Loss: 1.0426
Epoch 183, accuracy: 0.7830
Epoch 184, accuracy: 0.7830
Epoch 184, Train Loss: 0.0366, Val Loss: 1.0426
Epoch 185, accuracy: 0.7830
Epoch 186, accuracy: 0.7830
Epoch 186, Train Loss: 0.0259, Val Loss: 1.0426
Epoch 187, accuracy: 0.7830
Epoch 188, accuracy: 0.7830
Epoch 188, Train Loss: 0.0260, Val Loss: 1.0426
Epoch 189, accuracy: 0.7830
Epoch 190, accuracy: 0.7830
Epoch 190, Train Loss: 0.0333, Val Loss: 1.0426
Epoch 191, accuracy: 0.7830
Epoch 192, accuracy: 0.7830
Epoch 192, Train Loss: 0.0254, Val Loss: 1.0426
Epoch 193, accuracy: 0.7830
Epoch 194, accuracy: 0.7830
Epoch 194, Train Loss: 0.0267, Val Loss: 1.0426
Epoch 195, accuracy: 0.7830
Epoch 196, accuracy: 0.7830
Epoch 196, Train Loss: 0.0258, Val Loss: 1.0426
Epoch 197, accuracy: 0.7830
Epoch 198, accuracy: 0.7830
Epoch 198, Train Loss: 0.0317, Val Loss: 1.0426
Epoch 199, accuracy: 0.7830
Loaded best model with val_loss = 0.866141676902771
test :accuracy 0.7420, f1_macro: 0.7315, f1_micro: 0.7420, auc: 0.9656
Training GAT with 6 layers...
可训练参数: 1155875_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.9125
Epoch 0, accuracy: 0.0640
Epoch 0, Train Loss: 1.9438, Val Loss: 1.9125
✅ Epoch 1: New best model saved with val_loss = 1.8105
Epoch 1, accuracy: 0.3390
Epoch 2, accuracy: 0.0690
Epoch 2, Train Loss: 1.7172, Val Loss: 1.8541
✅ Epoch 3: New best model saved with val_loss = 1.6808
Epoch 3, accuracy: 0.3490
✅ Epoch 4: New best model saved with val_loss = 1.5600
Epoch 4, accuracy: 0.3160
Epoch 4, Train Loss: 1.6504, Val Loss: 1.5600
✅ Epoch 5: New best model saved with val_loss = 1.1286
Epoch 5, accuracy: 0.7250
✅ Epoch 6: New best model saved with val_loss = 0.9920
Epoch 6, accuracy: 0.7160
Epoch 6, Train Loss: 1.1067, Val Loss: 0.9920
✅ Epoch 7: New best model saved with val_loss = 0.9506
Epoch 7, accuracy: 0.7000
✅ Epoch 8: New best model saved with val_loss = 0.8266
Epoch 8, accuracy: 0.7660
Epoch 8, Train Loss: 0.6729, Val Loss: 0.8266
Epoch 9, accuracy: 0.7730
Epoch 10, accuracy: 0.7280
Epoch 10, Train Loss: 0.2635, Val Loss: 1.1689
Epoch 11, accuracy: 0.7310
Epoch 12, accuracy: 0.7350
Epoch 12, Train Loss: 0.2570, Val Loss: 1.5301
Epoch 13, accuracy: 0.7510
Epoch 14, accuracy: 0.7160
Epoch 14, Train Loss: 0.1386, Val Loss: 1.7987
Epoch 15, accuracy: 0.7190
Epoch 16, accuracy: 0.7340
Epoch 16, Train Loss: 0.1218, Val Loss: 1.7670
Epoch 17, accuracy: 0.7380
Epoch 18, accuracy: 0.7450
Epoch 18, Train Loss: 0.0555, Val Loss: 1.7195
Epoch 19, accuracy: 0.7480
Epoch 20, accuracy: 0.7520
Epoch 20, Train Loss: 0.0346, Val Loss: 1.6921
Epoch 21, accuracy: 0.7520
Epoch 22, accuracy: 0.7520
Epoch 22, Train Loss: 0.0882, Val Loss: 1.6909
Epoch 23, accuracy: 0.7530
Epoch 24, accuracy: 0.7530
Epoch 24, Train Loss: 0.0717, Val Loss: 1.6904
Epoch 25, accuracy: 0.7540
Epoch 26, accuracy: 0.7540
Epoch 26, Train Loss: 0.0833, Val Loss: 1.6892
Epoch 27, accuracy: 0.7540
Epoch 28, accuracy: 0.7550
Epoch 28, Train Loss: 0.0562, Val Loss: 1.6891
Epoch 29, accuracy: 0.7550
Epoch 30, accuracy: 0.7550
Epoch 30, Train Loss: 0.0564, Val Loss: 1.6892
Epoch 31, accuracy: 0.7550
Epoch 32, accuracy: 0.7550
Epoch 32, Train Loss: 0.0578, Val Loss: 1.6893
Epoch 33, accuracy: 0.7550
Epoch 34, accuracy: 0.7550
Epoch 34, Train Loss: 0.0477, Val Loss: 1.6893
Epoch 35, accuracy: 0.7550
Epoch 36, accuracy: 0.7550
Epoch 36, Train Loss: 0.0877, Val Loss: 1.6894
Epoch 37, accuracy: 0.7550
Epoch 38, accuracy: 0.7550
Epoch 38, Train Loss: 0.0628, Val Loss: 1.6894
Epoch 39, accuracy: 0.7550
Epoch 40, accuracy: 0.7550
Epoch 40, Train Loss: 0.0673, Val Loss: 1.6894
Epoch 41, accuracy: 0.7550
Epoch 42, accuracy: 0.7550
Epoch 42, Train Loss: 0.0590, Val Loss: 1.6894
Epoch 43, accuracy: 0.7550
Epoch 44, accuracy: 0.7550
Epoch 44, Train Loss: 0.0680, Val Loss: 1.6894
Epoch 45, accuracy: 0.7550
Epoch 46, accuracy: 0.7550
Epoch 46, Train Loss: 0.0647, Val Loss: 1.6894
Epoch 47, accuracy: 0.7550
Epoch 48, accuracy: 0.7550
Epoch 48, Train Loss: 0.0299, Val Loss: 1.6894
Epoch 49, accuracy: 0.7550
Epoch 50, accuracy: 0.7550
Epoch 50, Train Loss: 0.0633, Val Loss: 1.6894
Epoch 51, accuracy: 0.7550
Epoch 52, accuracy: 0.7550
Epoch 52, Train Loss: 0.0475, Val Loss: 1.6894
Epoch 53, accuracy: 0.7550
Epoch 54, accuracy: 0.7550
Epoch 54, Train Loss: 0.0556, Val Loss: 1.6894
Epoch 55, accuracy: 0.7550
Epoch 56, accuracy: 0.7550
Epoch 56, Train Loss: 0.0622, Val Loss: 1.6894
Epoch 57, accuracy: 0.7550
Epoch 58, accuracy: 0.7550
Epoch 58, Train Loss: 0.0575, Val Loss: 1.6894
Epoch 59, accuracy: 0.7550
Epoch 60, accuracy: 0.7550
Epoch 60, Train Loss: 0.0431, Val Loss: 1.6894
Epoch 61, accuracy: 0.7550
Epoch 62, accuracy: 0.7550
Epoch 62, Train Loss: 0.0944, Val Loss: 1.6894
Epoch 63, accuracy: 0.7550
Epoch 64, accuracy: 0.7550
Epoch 64, Train Loss: 0.0548, Val Loss: 1.6894
Epoch 65, accuracy: 0.7550
Epoch 66, accuracy: 0.7550
Epoch 66, Train Loss: 0.0718, Val Loss: 1.6894
Epoch 67, accuracy: 0.7550
Epoch 68, accuracy: 0.7550
Epoch 68, Train Loss: 0.0534, Val Loss: 1.6894
Epoch 69, accuracy: 0.7550
Epoch 70, accuracy: 0.7550
Epoch 70, Train Loss: 0.0636, Val Loss: 1.6894
Epoch 71, accuracy: 0.7550
Epoch 72, accuracy: 0.7550
Epoch 72, Train Loss: 0.0603, Val Loss: 1.6894
Epoch 73, accuracy: 0.7550
Epoch 74, accuracy: 0.7550
Epoch 74, Train Loss: 0.0652, Val Loss: 1.6894
Epoch 75, accuracy: 0.7550
Epoch 76, accuracy: 0.7550
Epoch 76, Train Loss: 0.0890, Val Loss: 1.6894
Epoch 77, accuracy: 0.7550
Epoch 78, accuracy: 0.7550
Epoch 78, Train Loss: 0.0604, Val Loss: 1.6894
Epoch 79, accuracy: 0.7550
Epoch 80, accuracy: 0.7550
Epoch 80, Train Loss: 0.1010, Val Loss: 1.6894
Epoch 81, accuracy: 0.7550
Epoch 82, accuracy: 0.7550
Epoch 82, Train Loss: 0.0707, Val Loss: 1.6894
Epoch 83, accuracy: 0.7550
Epoch 84, accuracy: 0.7550
Epoch 84, Train Loss: 0.0795, Val Loss: 1.6894
Epoch 85, accuracy: 0.7550
Epoch 86, accuracy: 0.7550
Epoch 86, Train Loss: 0.0828, Val Loss: 1.6894
Epoch 87, accuracy: 0.7550
Epoch 88, accuracy: 0.7550
Epoch 88, Train Loss: 0.0696, Val Loss: 1.6894
Epoch 89, accuracy: 0.7550
Epoch 90, accuracy: 0.7550
Epoch 90, Train Loss: 0.0680, Val Loss: 1.6894
Epoch 91, accuracy: 0.7550
Epoch 92, accuracy: 0.7550
Epoch 92, Train Loss: 0.1067, Val Loss: 1.6894
Epoch 93, accuracy: 0.7550
Epoch 94, accuracy: 0.7550
Epoch 94, Train Loss: 0.0678, Val Loss: 1.6894
Epoch 95, accuracy: 0.7550
Epoch 96, accuracy: 0.7550
Epoch 96, Train Loss: 0.0768, Val Loss: 1.6894
Epoch 97, accuracy: 0.7550
Epoch 98, accuracy: 0.7550
Epoch 98, Train Loss: 0.0391, Val Loss: 1.6894
Epoch 99, accuracy: 0.7550
Epoch 100, accuracy: 0.7550
Epoch 100, Train Loss: 0.0616, Val Loss: 1.6894
Epoch 101, accuracy: 0.7550
Epoch 102, accuracy: 0.7550
Epoch 102, Train Loss: 0.0760, Val Loss: 1.6894
Epoch 103, accuracy: 0.7550
Epoch 104, accuracy: 0.7550
Epoch 104, Train Loss: 0.0634, Val Loss: 1.6894
Epoch 105, accuracy: 0.7550
Epoch 106, accuracy: 0.7550
Epoch 106, Train Loss: 0.0862, Val Loss: 1.6894
Epoch 107, accuracy: 0.7550
Epoch 108, accuracy: 0.7550
Epoch 108, Train Loss: 0.0328, Val Loss: 1.6894
Epoch 109, accuracy: 0.7550
Epoch 110, accuracy: 0.7550
Epoch 110, Train Loss: 0.0520, Val Loss: 1.6894
Epoch 111, accuracy: 0.7550
Epoch 112, accuracy: 0.7550
Epoch 112, Train Loss: 0.0460, Val Loss: 1.6894
Epoch 113, accuracy: 0.7550
Epoch 114, accuracy: 0.7550
Epoch 114, Train Loss: 0.0594, Val Loss: 1.6894
Epoch 115, accuracy: 0.7550
Epoch 116, accuracy: 0.7550
Epoch 116, Train Loss: 0.0673, Val Loss: 1.6894
Epoch 117, accuracy: 0.7550
Epoch 118, accuracy: 0.7550
Epoch 118, Train Loss: 0.1279, Val Loss: 1.6894
Epoch 119, accuracy: 0.7550
Epoch 120, accuracy: 0.7550
Epoch 120, Train Loss: 0.0581, Val Loss: 1.6894
Epoch 121, accuracy: 0.7550
Epoch 122, accuracy: 0.7550
Epoch 122, Train Loss: 0.0712, Val Loss: 1.6894
Epoch 123, accuracy: 0.7550
Epoch 124, accuracy: 0.7550
Epoch 124, Train Loss: 0.0575, Val Loss: 1.6894
Epoch 125, accuracy: 0.7550
Epoch 126, accuracy: 0.7550
Epoch 126, Train Loss: 0.0437, Val Loss: 1.6894
Epoch 127, accuracy: 0.7550
Epoch 128, accuracy: 0.7550
Epoch 128, Train Loss: 0.0791, Val Loss: 1.6894
Epoch 129, accuracy: 0.7550
Epoch 130, accuracy: 0.7550
Epoch 130, Train Loss: 0.0721, Val Loss: 1.6894
Epoch 131, accuracy: 0.7550
Epoch 132, accuracy: 0.7550
Epoch 132, Train Loss: 0.1010, Val Loss: 1.6894
Epoch 133, accuracy: 0.7550
Epoch 134, accuracy: 0.7550
Epoch 134, Train Loss: 0.0875, Val Loss: 1.6894
Epoch 135, accuracy: 0.7550
Epoch 136, accuracy: 0.7550
Epoch 136, Train Loss: 0.0508, Val Loss: 1.6894
Epoch 137, accuracy: 0.7550
Epoch 138, accuracy: 0.7550
Epoch 138, Train Loss: 0.0615, Val Loss: 1.6894
Epoch 139, accuracy: 0.7550
Epoch 140, accuracy: 0.7550
Epoch 140, Train Loss: 0.0404, Val Loss: 1.6894
Epoch 141, accuracy: 0.7550
Epoch 142, accuracy: 0.7550
Epoch 142, Train Loss: 0.0499, Val Loss: 1.6894
Epoch 143, accuracy: 0.7550
Epoch 144, accuracy: 0.7550
Epoch 144, Train Loss: 0.0504, Val Loss: 1.6894
Epoch 145, accuracy: 0.7550
Epoch 146, accuracy: 0.7550
Epoch 146, Train Loss: 0.0651, Val Loss: 1.6894
Epoch 147, accuracy: 0.7550
Epoch 148, accuracy: 0.7550
Epoch 148, Train Loss: 0.0942, Val Loss: 1.6894
Epoch 149, accuracy: 0.7550
Epoch 150, accuracy: 0.7550
Epoch 150, Train Loss: 0.0654, Val Loss: 1.6894
Epoch 151, accuracy: 0.7550
Epoch 152, accuracy: 0.7550
Epoch 152, Train Loss: 0.0548, Val Loss: 1.6894
Epoch 153, accuracy: 0.7550
Epoch 154, accuracy: 0.7550
Epoch 154, Train Loss: 0.0582, Val Loss: 1.6894
Epoch 155, accuracy: 0.7550
Epoch 156, accuracy: 0.7550
Epoch 156, Train Loss: 0.0414, Val Loss: 1.6894
Epoch 157, accuracy: 0.7550
Epoch 158, accuracy: 0.7550
Epoch 158, Train Loss: 0.0888, Val Loss: 1.6894
Epoch 159, accuracy: 0.7550
Epoch 160, accuracy: 0.7550
Epoch 160, Train Loss: 0.0763, Val Loss: 1.6894
Epoch 161, accuracy: 0.7550
Epoch 162, accuracy: 0.7550
Epoch 162, Train Loss: 0.0666, Val Loss: 1.6894
Epoch 163, accuracy: 0.7550
Epoch 164, accuracy: 0.7550
Epoch 164, Train Loss: 0.0760, Val Loss: 1.6894
Epoch 165, accuracy: 0.7550
Epoch 166, accuracy: 0.7550
Epoch 166, Train Loss: 0.0847, Val Loss: 1.6894
Epoch 167, accuracy: 0.7550
Epoch 168, accuracy: 0.7550
Epoch 168, Train Loss: 0.0801, Val Loss: 1.6894
Epoch 169, accuracy: 0.7550
Epoch 170, accuracy: 0.7550
Epoch 170, Train Loss: 0.0719, Val Loss: 1.6894
Epoch 171, accuracy: 0.7550
Epoch 172, accuracy: 0.7550
Epoch 172, Train Loss: 0.0659, Val Loss: 1.6894
Epoch 173, accuracy: 0.7550
Epoch 174, accuracy: 0.7550
Epoch 174, Train Loss: 0.1452, Val Loss: 1.6894
Epoch 175, accuracy: 0.7550
Epoch 176, accuracy: 0.7550
Epoch 176, Train Loss: 0.0413, Val Loss: 1.6894
Epoch 177, accuracy: 0.7550
Epoch 178, accuracy: 0.7550
Epoch 178, Train Loss: 0.0386, Val Loss: 1.6894
Epoch 179, accuracy: 0.7550
Epoch 180, accuracy: 0.7550
Epoch 180, Train Loss: 0.0493, Val Loss: 1.6894
Epoch 181, accuracy: 0.7550
Epoch 182, accuracy: 0.7550
Epoch 182, Train Loss: 0.0425, Val Loss: 1.6894
Epoch 183, accuracy: 0.7550
Epoch 184, accuracy: 0.7550
Epoch 184, Train Loss: 0.0791, Val Loss: 1.6894
Epoch 185, accuracy: 0.7550
Epoch 186, accuracy: 0.7550
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 186, Train Loss: 0.0519, Val Loss: 1.6894
Epoch 187, accuracy: 0.7550
Epoch 188, accuracy: 0.7550
Epoch 188, Train Loss: 0.0563, Val Loss: 1.6894
Epoch 189, accuracy: 0.7550
Epoch 190, accuracy: 0.7550
Epoch 190, Train Loss: 0.0514, Val Loss: 1.6894
Epoch 191, accuracy: 0.7550
Epoch 192, accuracy: 0.7550
Epoch 192, Train Loss: 0.0613, Val Loss: 1.6894
Epoch 193, accuracy: 0.7550
Epoch 194, accuracy: 0.7550
Epoch 194, Train Loss: 0.0674, Val Loss: 1.6894
Epoch 195, accuracy: 0.7550
Epoch 196, accuracy: 0.7550
Epoch 196, Train Loss: 0.0678, Val Loss: 1.6894
Epoch 197, accuracy: 0.7550
Epoch 198, accuracy: 0.7550
Epoch 198, Train Loss: 0.0624, Val Loss: 1.6894
Epoch 199, accuracy: 0.7550
Loaded best model with val_loss = 0.8265771269798279
test :accuracy 0.7660, f1_macro: 0.7676, f1_micro: 0.7660, auc: 0.9505
Training GAT with 7 layers...
可训练参数: 1305379_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.9226
Epoch 0, accuracy: 0.3220
Epoch 0, Train Loss: 1.9464, Val Loss: 1.9226
✅ Epoch 1: New best model saved with val_loss = 1.8804
Epoch 1, accuracy: 0.1780
Epoch 2, accuracy: 0.0640
Epoch 2, Train Loss: 1.8552, Val Loss: 1.9411
✅ Epoch 3: New best model saved with val_loss = 1.6823
Epoch 3, accuracy: 0.2210
Epoch 4, accuracy: 0.1460
Epoch 4, Train Loss: 1.7083, Val Loss: 1.7992
✅ Epoch 5: New best model saved with val_loss = 1.6480
Epoch 5, accuracy: 0.5200
✅ Epoch 6: New best model saved with val_loss = 1.4504
Epoch 6, accuracy: 0.7550
Epoch 6, Train Loss: 1.4719, Val Loss: 1.4504
✅ Epoch 7: New best model saved with val_loss = 1.1586
Epoch 7, accuracy: 0.6800
✅ Epoch 8: New best model saved with val_loss = 0.9475
Epoch 8, accuracy: 0.6720
Epoch 8, Train Loss: 0.8564, Val Loss: 0.9475
Epoch 9, accuracy: 0.6670
Epoch 10, accuracy: 0.7200
Epoch 10, Train Loss: 0.4274, Val Loss: 1.9658
Epoch 11, accuracy: 0.7480
Epoch 12, accuracy: 0.5590
Epoch 12, Train Loss: 0.8301, Val Loss: 1.6063
Epoch 13, accuracy: 0.6900
Epoch 14, accuracy: 0.7090
Epoch 14, Train Loss: 0.3665, Val Loss: 1.3776
Epoch 15, accuracy: 0.7130
Epoch 16, accuracy: 0.7210
Epoch 16, Train Loss: 0.2784, Val Loss: 1.3258
Epoch 17, accuracy: 0.7250
Epoch 18, accuracy: 0.7350
Epoch 18, Train Loss: 0.2208, Val Loss: 1.2468
Epoch 19, accuracy: 0.7340
Epoch 20, accuracy: 0.7430
Epoch 20, Train Loss: 0.1706, Val Loss: 1.1857
Epoch 21, accuracy: 0.7460
Epoch 22, accuracy: 0.7470
Epoch 22, Train Loss: 0.1425, Val Loss: 1.1812
Epoch 23, accuracy: 0.7480
Epoch 24, accuracy: 0.7480
Epoch 24, Train Loss: 0.1226, Val Loss: 1.1770
Epoch 25, accuracy: 0.7510
Epoch 26, accuracy: 0.7550
Epoch 26, Train Loss: 0.1345, Val Loss: 1.1730
Epoch 27, accuracy: 0.7550
Epoch 28, accuracy: 0.7550
Epoch 28, Train Loss: 0.1177, Val Loss: 1.1727
Epoch 29, accuracy: 0.7550
Epoch 30, accuracy: 0.7530
Epoch 30, Train Loss: 0.1310, Val Loss: 1.1723
Epoch 31, accuracy: 0.7520
Epoch 32, accuracy: 0.7520
Epoch 32, Train Loss: 0.1353, Val Loss: 1.1720
Epoch 33, accuracy: 0.7520
Epoch 34, accuracy: 0.7520
Epoch 34, Train Loss: 0.1228, Val Loss: 1.1719
Epoch 35, accuracy: 0.7520
Epoch 36, accuracy: 0.7520
Epoch 36, Train Loss: 0.1315, Val Loss: 1.1719
Epoch 37, accuracy: 0.7520
Epoch 38, accuracy: 0.7520
Epoch 38, Train Loss: 0.1187, Val Loss: 1.1719
Epoch 39, accuracy: 0.7520
Epoch 40, accuracy: 0.7520
Epoch 40, Train Loss: 0.1218, Val Loss: 1.1719
Epoch 41, accuracy: 0.7520
Epoch 42, accuracy: 0.7520
Epoch 42, Train Loss: 0.1283, Val Loss: 1.1719
Epoch 43, accuracy: 0.7520
Epoch 44, accuracy: 0.7520
Epoch 44, Train Loss: 0.1278, Val Loss: 1.1719
Epoch 45, accuracy: 0.7520
Epoch 46, accuracy: 0.7520
Epoch 46, Train Loss: 0.1355, Val Loss: 1.1719
Epoch 47, accuracy: 0.7520
Epoch 48, accuracy: 0.7520
Epoch 48, Train Loss: 0.1271, Val Loss: 1.1719
Epoch 49, accuracy: 0.7520
Epoch 50, accuracy: 0.7520
Epoch 50, Train Loss: 0.1291, Val Loss: 1.1719
Epoch 51, accuracy: 0.7520
Epoch 52, accuracy: 0.7520
Epoch 52, Train Loss: 0.1310, Val Loss: 1.1719
Epoch 53, accuracy: 0.7520
Epoch 54, accuracy: 0.7520
Epoch 54, Train Loss: 0.1427, Val Loss: 1.1719
Epoch 55, accuracy: 0.7520
Epoch 56, accuracy: 0.7520
Epoch 56, Train Loss: 0.1388, Val Loss: 1.1719
Epoch 57, accuracy: 0.7520
Epoch 58, accuracy: 0.7520
Epoch 58, Train Loss: 0.1357, Val Loss: 1.1719
Epoch 59, accuracy: 0.7520
Epoch 60, accuracy: 0.7520
Epoch 60, Train Loss: 0.1186, Val Loss: 1.1719
Epoch 61, accuracy: 0.7520
Epoch 62, accuracy: 0.7520
Epoch 62, Train Loss: 0.1207, Val Loss: 1.1719
Epoch 63, accuracy: 0.7520
Epoch 64, accuracy: 0.7520
Epoch 64, Train Loss: 0.1227, Val Loss: 1.1719
Epoch 65, accuracy: 0.7520
Epoch 66, accuracy: 0.7520
Epoch 66, Train Loss: 0.1237, Val Loss: 1.1719
Epoch 67, accuracy: 0.7520
Epoch 68, accuracy: 0.7520
Epoch 68, Train Loss: 0.1227, Val Loss: 1.1719
Epoch 69, accuracy: 0.7520
Epoch 70, accuracy: 0.7520
Epoch 70, Train Loss: 0.1277, Val Loss: 1.1719
Epoch 71, accuracy: 0.7520
Epoch 72, accuracy: 0.7520
Epoch 72, Train Loss: 0.1320, Val Loss: 1.1719
Epoch 73, accuracy: 0.7520
Epoch 74, accuracy: 0.7520
Epoch 74, Train Loss: 0.1415, Val Loss: 1.1719
Epoch 75, accuracy: 0.7520
Epoch 76, accuracy: 0.7520
Epoch 76, Train Loss: 0.1274, Val Loss: 1.1718
Epoch 77, accuracy: 0.7520
Epoch 78, accuracy: 0.7520
Epoch 78, Train Loss: 0.1244, Val Loss: 1.1718
Epoch 79, accuracy: 0.7520
Epoch 80, accuracy: 0.7520
Epoch 80, Train Loss: 0.1146, Val Loss: 1.1718
Epoch 81, accuracy: 0.7520
Epoch 82, accuracy: 0.7520
Epoch 82, Train Loss: 0.1368, Val Loss: 1.1718
Epoch 83, accuracy: 0.7520
Epoch 84, accuracy: 0.7520
Epoch 84, Train Loss: 0.1330, Val Loss: 1.1718
Epoch 85, accuracy: 0.7520
Epoch 86, accuracy: 0.7520
Epoch 86, Train Loss: 0.1290, Val Loss: 1.1718
Epoch 87, accuracy: 0.7520
Epoch 88, accuracy: 0.7520
Epoch 88, Train Loss: 0.1337, Val Loss: 1.1718
Epoch 89, accuracy: 0.7520
Epoch 90, accuracy: 0.7520
Epoch 90, Train Loss: 0.1397, Val Loss: 1.1718
Epoch 91, accuracy: 0.7520
Epoch 92, accuracy: 0.7520
Epoch 92, Train Loss: 0.1341, Val Loss: 1.1718
Epoch 93, accuracy: 0.7520
Epoch 94, accuracy: 0.7520
Epoch 94, Train Loss: 0.1392, Val Loss: 1.1718
Epoch 95, accuracy: 0.7520
Epoch 96, accuracy: 0.7520
Epoch 96, Train Loss: 0.1192, Val Loss: 1.1718
Epoch 97, accuracy: 0.7520
Epoch 98, accuracy: 0.7520
Epoch 98, Train Loss: 0.1206, Val Loss: 1.1718
Epoch 99, accuracy: 0.7520
Epoch 100, accuracy: 0.7520
Epoch 100, Train Loss: 0.1360, Val Loss: 1.1718
Epoch 101, accuracy: 0.7520
Epoch 102, accuracy: 0.7520
Epoch 102, Train Loss: 0.1302, Val Loss: 1.1718
Epoch 103, accuracy: 0.7520
Epoch 104, accuracy: 0.7520
Epoch 104, Train Loss: 0.1445, Val Loss: 1.1718
Epoch 105, accuracy: 0.7520
Epoch 106, accuracy: 0.7520
Epoch 106, Train Loss: 0.1357, Val Loss: 1.1718
Epoch 107, accuracy: 0.7520
Epoch 108, accuracy: 0.7520
Epoch 108, Train Loss: 0.1251, Val Loss: 1.1718
Epoch 109, accuracy: 0.7520
Epoch 110, accuracy: 0.7520
Epoch 110, Train Loss: 0.1251, Val Loss: 1.1718
Epoch 111, accuracy: 0.7520
Epoch 112, accuracy: 0.7520
Epoch 112, Train Loss: 0.1440, Val Loss: 1.1718
Epoch 113, accuracy: 0.7520
Epoch 114, accuracy: 0.7520
Epoch 114, Train Loss: 0.1198, Val Loss: 1.1718
Epoch 115, accuracy: 0.7520
Epoch 116, accuracy: 0.7520
Epoch 116, Train Loss: 0.1317, Val Loss: 1.1718
Epoch 117, accuracy: 0.7520
Epoch 118, accuracy: 0.7520
Epoch 118, Train Loss: 0.1332, Val Loss: 1.1718
Epoch 119, accuracy: 0.7520
Epoch 120, accuracy: 0.7520
Epoch 120, Train Loss: 0.1323, Val Loss: 1.1718
Epoch 121, accuracy: 0.7520
Epoch 122, accuracy: 0.7520
Epoch 122, Train Loss: 0.1352, Val Loss: 1.1718
Epoch 123, accuracy: 0.7520
Epoch 124, accuracy: 0.7520
Epoch 124, Train Loss: 0.1274, Val Loss: 1.1718
Epoch 125, accuracy: 0.7520
Epoch 126, accuracy: 0.7520
Epoch 126, Train Loss: 0.1339, Val Loss: 1.1718
Epoch 127, accuracy: 0.7520
Epoch 128, accuracy: 0.7520
Epoch 128, Train Loss: 0.1227, Val Loss: 1.1718
Epoch 129, accuracy: 0.7520
Epoch 130, accuracy: 0.7520
Epoch 130, Train Loss: 0.1320, Val Loss: 1.1718
Epoch 131, accuracy: 0.7520
Epoch 132, accuracy: 0.7520
Epoch 132, Train Loss: 0.1227, Val Loss: 1.1718
Epoch 133, accuracy: 0.7520
Epoch 134, accuracy: 0.7520
Epoch 134, Train Loss: 0.1303, Val Loss: 1.1718
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 135, accuracy: 0.7520
Epoch 136, accuracy: 0.7520
Epoch 136, Train Loss: 0.1352, Val Loss: 1.1718
Epoch 137, accuracy: 0.7520
Epoch 138, accuracy: 0.7520
Epoch 138, Train Loss: 0.1230, Val Loss: 1.1718
Epoch 139, accuracy: 0.7520
Epoch 140, accuracy: 0.7520
Epoch 140, Train Loss: 0.1362, Val Loss: 1.1718
Epoch 141, accuracy: 0.7520
Epoch 142, accuracy: 0.7520
Epoch 142, Train Loss: 0.1315, Val Loss: 1.1718
Epoch 143, accuracy: 0.7520
Epoch 144, accuracy: 0.7520
Epoch 144, Train Loss: 0.1315, Val Loss: 1.1718
Epoch 145, accuracy: 0.7520
Epoch 146, accuracy: 0.7520
Epoch 146, Train Loss: 0.1212, Val Loss: 1.1718
Epoch 147, accuracy: 0.7520
Epoch 148, accuracy: 0.7520
Epoch 148, Train Loss: 0.1252, Val Loss: 1.1718
Epoch 149, accuracy: 0.7520
Epoch 150, accuracy: 0.7520
Epoch 150, Train Loss: 0.1313, Val Loss: 1.1718
Epoch 151, accuracy: 0.7520
Epoch 152, accuracy: 0.7520
Epoch 152, Train Loss: 0.1297, Val Loss: 1.1718
Epoch 153, accuracy: 0.7520
Epoch 154, accuracy: 0.7520
Epoch 154, Train Loss: 0.1304, Val Loss: 1.1718
Epoch 155, accuracy: 0.7520
Epoch 156, accuracy: 0.7520
Epoch 156, Train Loss: 0.1323, Val Loss: 1.1718
Epoch 157, accuracy: 0.7520
Epoch 158, accuracy: 0.7520
Epoch 158, Train Loss: 0.1280, Val Loss: 1.1718
Epoch 159, accuracy: 0.7520
Epoch 160, accuracy: 0.7520
Epoch 160, Train Loss: 0.1199, Val Loss: 1.1718
Epoch 161, accuracy: 0.7520
Epoch 162, accuracy: 0.7520
Epoch 162, Train Loss: 0.1335, Val Loss: 1.1718
Epoch 163, accuracy: 0.7520
Epoch 164, accuracy: 0.7520
Epoch 164, Train Loss: 0.1287, Val Loss: 1.1718
Epoch 165, accuracy: 0.7520
Epoch 166, accuracy: 0.7520
Epoch 166, Train Loss: 0.1214, Val Loss: 1.1718
Epoch 167, accuracy: 0.7520
Epoch 168, accuracy: 0.7520
Epoch 168, Train Loss: 0.1437, Val Loss: 1.1718
Epoch 169, accuracy: 0.7520
Epoch 170, accuracy: 0.7520
Epoch 170, Train Loss: 0.1265, Val Loss: 1.1718
Epoch 171, accuracy: 0.7520
Epoch 172, accuracy: 0.7520
Epoch 172, Train Loss: 0.1258, Val Loss: 1.1718
Epoch 173, accuracy: 0.7520
Epoch 174, accuracy: 0.7520
Epoch 174, Train Loss: 0.1288, Val Loss: 1.1718
Epoch 175, accuracy: 0.7520
Epoch 176, accuracy: 0.7520
Epoch 176, Train Loss: 0.1328, Val Loss: 1.1718
Epoch 177, accuracy: 0.7520
Epoch 178, accuracy: 0.7520
Epoch 178, Train Loss: 0.1424, Val Loss: 1.1718
Epoch 179, accuracy: 0.7520
Epoch 180, accuracy: 0.7520
Epoch 180, Train Loss: 0.1340, Val Loss: 1.1718
Epoch 181, accuracy: 0.7520
Epoch 182, accuracy: 0.7520
Epoch 182, Train Loss: 0.1226, Val Loss: 1.1718
Epoch 183, accuracy: 0.7520
Epoch 184, accuracy: 0.7520
Epoch 184, Train Loss: 0.1372, Val Loss: 1.1718
Epoch 185, accuracy: 0.7520
Epoch 186, accuracy: 0.7520
Epoch 186, Train Loss: 0.1334, Val Loss: 1.1718
Epoch 187, accuracy: 0.7520
Epoch 188, accuracy: 0.7520
Epoch 188, Train Loss: 0.1369, Val Loss: 1.1718
Epoch 189, accuracy: 0.7520
Epoch 190, accuracy: 0.7520
Epoch 190, Train Loss: 0.1273, Val Loss: 1.1718
Epoch 191, accuracy: 0.7520
Epoch 192, accuracy: 0.7520
Epoch 192, Train Loss: 0.1183, Val Loss: 1.1718
Epoch 193, accuracy: 0.7520
Epoch 194, accuracy: 0.7520
Epoch 194, Train Loss: 0.1310, Val Loss: 1.1718
Epoch 195, accuracy: 0.7520
Epoch 196, accuracy: 0.7520
Epoch 196, Train Loss: 0.1418, Val Loss: 1.1718
Epoch 197, accuracy: 0.7520
Epoch 198, accuracy: 0.7520
Epoch 198, Train Loss: 0.1252, Val Loss: 1.1718
Epoch 199, accuracy: 0.7520
Loaded best model with val_loss = 0.947466254234314
test :accuracy 0.6720, f1_macro: 0.6300, f1_micro: 0.6720, auc: 0.9348
Training mamba3 with 3 layers...
可训练参数: 915885_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.6279
Epoch 0, accuracy: 0.3870
Epoch 0, Train Loss: 2.0016, Val Loss: 1.6279
✅ Epoch 1: New best model saved with val_loss = 1.2475
Epoch 1, accuracy: 0.6810
✅ Epoch 2: New best model saved with val_loss = 0.9752
Epoch 2, accuracy: 0.7060
Epoch 2, Train Loss: 0.8749, Val Loss: 0.9752
✅ Epoch 3: New best model saved with val_loss = 0.9329
Epoch 3, accuracy: 0.7340
✅ Epoch 4: New best model saved with val_loss = 0.9142
Epoch 4, accuracy: 0.7510
Epoch 4, Train Loss: 0.6420, Val Loss: 0.9142
✅ Epoch 5: New best model saved with val_loss = 0.8360
Epoch 5, accuracy: 0.7560
✅ Epoch 6: New best model saved with val_loss = 0.7548
Epoch 6, accuracy: 0.7740
Epoch 6, Train Loss: 0.4507, Val Loss: 0.7548
✅ Epoch 7: New best model saved with val_loss = 0.7073
Epoch 7, accuracy: 0.7910
Epoch 8, accuracy: 0.8010
Epoch 8, Train Loss: 0.3594, Val Loss: 0.7087
Epoch 9, accuracy: 0.7920
Epoch 10, accuracy: 0.7850
Epoch 10, Train Loss: 0.3052, Val Loss: 0.7706
Epoch 11, accuracy: 0.7820
Epoch 12, accuracy: 0.7720
Epoch 12, Train Loss: 0.3076, Val Loss: 0.8475
Epoch 13, accuracy: 0.7730
Epoch 14, accuracy: 0.7720
Epoch 14, Train Loss: 0.1785, Val Loss: 0.8820
Epoch 15, accuracy: 0.7730
Epoch 16, accuracy: 0.7730
Epoch 16, Train Loss: 0.1583, Val Loss: 0.8848
Epoch 17, accuracy: 0.7740
Epoch 18, accuracy: 0.7740
Epoch 18, Train Loss: 0.2478, Val Loss: 0.8870
Epoch 19, accuracy: 0.7750
Epoch 20, accuracy: 0.7750
Epoch 20, Train Loss: 0.1384, Val Loss: 0.8882
Epoch 21, accuracy: 0.7740
Epoch 22, accuracy: 0.7740
Epoch 22, Train Loss: 0.1363, Val Loss: 0.8886
Epoch 23, accuracy: 0.7740
Epoch 24, accuracy: 0.7730
Epoch 24, Train Loss: 0.1761, Val Loss: 0.8886
Epoch 25, accuracy: 0.7730
Epoch 26, accuracy: 0.7730
Epoch 26, Train Loss: 0.1388, Val Loss: 0.8885
Epoch 27, accuracy: 0.7730
Epoch 28, accuracy: 0.7730
Epoch 28, Train Loss: 0.1767, Val Loss: 0.8885
Epoch 29, accuracy: 0.7730
Epoch 30, accuracy: 0.7730
Epoch 30, Train Loss: 0.2000, Val Loss: 0.8884
Epoch 31, accuracy: 0.7730
Epoch 32, accuracy: 0.7730
Epoch 32, Train Loss: 0.1961, Val Loss: 0.8883
Epoch 33, accuracy: 0.7730
Epoch 34, accuracy: 0.7730
Epoch 34, Train Loss: 0.1825, Val Loss: 0.8883
Epoch 35, accuracy: 0.7730
Epoch 36, accuracy: 0.7730
Epoch 36, Train Loss: 0.1815, Val Loss: 0.8883
Epoch 37, accuracy: 0.7730
Epoch 38, accuracy: 0.7730
Epoch 38, Train Loss: 0.1862, Val Loss: 0.8883
Epoch 39, accuracy: 0.7730
Epoch 40, accuracy: 0.7730
Epoch 40, Train Loss: 0.1911, Val Loss: 0.8883
Epoch 41, accuracy: 0.7730
Epoch 42, accuracy: 0.7730
Epoch 42, Train Loss: 0.2167, Val Loss: 0.8883
Epoch 43, accuracy: 0.7730
Epoch 44, accuracy: 0.7730
Epoch 44, Train Loss: 0.1127, Val Loss: 0.8883
Epoch 45, accuracy: 0.7730
Epoch 46, accuracy: 0.7730
Epoch 46, Train Loss: 0.1714, Val Loss: 0.8883
Epoch 47, accuracy: 0.7730
Epoch 48, accuracy: 0.7730
Epoch 48, Train Loss: 0.2342, Val Loss: 0.8883
Epoch 49, accuracy: 0.7730
Epoch 50, accuracy: 0.7730
Epoch 50, Train Loss: 0.1357, Val Loss: 0.8883
Epoch 51, accuracy: 0.7730
Epoch 52, accuracy: 0.7730
Epoch 52, Train Loss: 0.1984, Val Loss: 0.8883
Epoch 53, accuracy: 0.7730
Epoch 54, accuracy: 0.7730
Epoch 54, Train Loss: 0.1591, Val Loss: 0.8883
Epoch 55, accuracy: 0.7730
Epoch 56, accuracy: 0.7730
Epoch 56, Train Loss: 0.1835, Val Loss: 0.8883
Epoch 57, accuracy: 0.7730
Epoch 58, accuracy: 0.7730
Epoch 58, Train Loss: 0.1413, Val Loss: 0.8883
Epoch 59, accuracy: 0.7730
Epoch 60, accuracy: 0.7730
Epoch 60, Train Loss: 0.1597, Val Loss: 0.8883
Epoch 61, accuracy: 0.7730
Epoch 62, accuracy: 0.7730
Epoch 62, Train Loss: 0.1677, Val Loss: 0.8883
Epoch 63, accuracy: 0.7730
Epoch 64, accuracy: 0.7730
Epoch 64, Train Loss: 0.1076, Val Loss: 0.8883
Epoch 65, accuracy: 0.7730
Epoch 66, accuracy: 0.7730
Epoch 66, Train Loss: 0.1746, Val Loss: 0.8883
Epoch 67, accuracy: 0.7730
Epoch 68, accuracy: 0.7730
Epoch 68, Train Loss: 0.1331, Val Loss: 0.8883
Epoch 69, accuracy: 0.7730
Epoch 70, accuracy: 0.7730
Epoch 70, Train Loss: 0.1449, Val Loss: 0.8883
Epoch 71, accuracy: 0.7730
Epoch 72, accuracy: 0.7730
Epoch 72, Train Loss: 0.1886, Val Loss: 0.8883
Epoch 73, accuracy: 0.7730
Epoch 74, accuracy: 0.7730
Epoch 74, Train Loss: 0.1562, Val Loss: 0.8883
Epoch 75, accuracy: 0.7730
Epoch 76, accuracy: 0.7730
Epoch 76, Train Loss: 0.2289, Val Loss: 0.8883
Epoch 77, accuracy: 0.7730
Epoch 78, accuracy: 0.7730
Epoch 78, Train Loss: 0.1674, Val Loss: 0.8883
Epoch 79, accuracy: 0.7730
Epoch 80, accuracy: 0.7730
Epoch 80, Train Loss: 0.1894, Val Loss: 0.8883
Epoch 81, accuracy: 0.7730
Epoch 82, accuracy: 0.7730
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 82, Train Loss: 0.1621, Val Loss: 0.8883
Epoch 83, accuracy: 0.7730
Epoch 84, accuracy: 0.7730
Epoch 84, Train Loss: 0.1555, Val Loss: 0.8883
Epoch 85, accuracy: 0.7730
Epoch 86, accuracy: 0.7730
Epoch 86, Train Loss: 0.1839, Val Loss: 0.8883
Epoch 87, accuracy: 0.7730
Epoch 88, accuracy: 0.7730
Epoch 88, Train Loss: 0.1710, Val Loss: 0.8883
Epoch 89, accuracy: 0.7730
Epoch 90, accuracy: 0.7730
Epoch 90, Train Loss: 0.1809, Val Loss: 0.8883
Epoch 91, accuracy: 0.7730
Epoch 92, accuracy: 0.7730
Epoch 92, Train Loss: 0.2099, Val Loss: 0.8883
Epoch 93, accuracy: 0.7730
Epoch 94, accuracy: 0.7730
Epoch 94, Train Loss: 0.2404, Val Loss: 0.8883
Epoch 95, accuracy: 0.7730
Epoch 96, accuracy: 0.7730
Epoch 96, Train Loss: 0.2430, Val Loss: 0.8883
Epoch 97, accuracy: 0.7730
Epoch 98, accuracy: 0.7730
Epoch 98, Train Loss: 0.1741, Val Loss: 0.8883
Epoch 99, accuracy: 0.7730
Epoch 100, accuracy: 0.7730
Epoch 100, Train Loss: 0.1907, Val Loss: 0.8883
Epoch 101, accuracy: 0.7730
Epoch 102, accuracy: 0.7730
Epoch 102, Train Loss: 0.1813, Val Loss: 0.8883
Epoch 103, accuracy: 0.7730
Epoch 104, accuracy: 0.7730
Epoch 104, Train Loss: 0.1862, Val Loss: 0.8883
Epoch 105, accuracy: 0.7730
Epoch 106, accuracy: 0.7730
Epoch 106, Train Loss: 0.2310, Val Loss: 0.8883
Epoch 107, accuracy: 0.7730
Epoch 108, accuracy: 0.7730
Epoch 108, Train Loss: 0.2299, Val Loss: 0.8883
Epoch 109, accuracy: 0.7730
Epoch 110, accuracy: 0.7730
Epoch 110, Train Loss: 0.2045, Val Loss: 0.8883
Epoch 111, accuracy: 0.7730
Epoch 112, accuracy: 0.7730
Epoch 112, Train Loss: 0.1650, Val Loss: 0.8883
Epoch 113, accuracy: 0.7730
Epoch 114, accuracy: 0.7730
Epoch 114, Train Loss: 0.1492, Val Loss: 0.8883
Epoch 115, accuracy: 0.7730
Epoch 116, accuracy: 0.7730
Epoch 116, Train Loss: 0.1852, Val Loss: 0.8883
Epoch 117, accuracy: 0.7730
Epoch 118, accuracy: 0.7730
Epoch 118, Train Loss: 0.1915, Val Loss: 0.8883
Epoch 119, accuracy: 0.7730
Epoch 120, accuracy: 0.7730
Epoch 120, Train Loss: 0.1938, Val Loss: 0.8883
Epoch 121, accuracy: 0.7730
Epoch 122, accuracy: 0.7730
Epoch 122, Train Loss: 0.1610, Val Loss: 0.8883
Epoch 123, accuracy: 0.7730
Epoch 124, accuracy: 0.7730
Epoch 124, Train Loss: 0.1593, Val Loss: 0.8883
Epoch 125, accuracy: 0.7730
Epoch 126, accuracy: 0.7730
Epoch 126, Train Loss: 0.1897, Val Loss: 0.8883
Epoch 127, accuracy: 0.7730
Epoch 128, accuracy: 0.7730
Epoch 128, Train Loss: 0.1809, Val Loss: 0.8883
Epoch 129, accuracy: 0.7730
Epoch 130, accuracy: 0.7730
Epoch 130, Train Loss: 0.1476, Val Loss: 0.8883
Epoch 131, accuracy: 0.7730
Epoch 132, accuracy: 0.7730
Epoch 132, Train Loss: 0.1751, Val Loss: 0.8883
Epoch 133, accuracy: 0.7730
Epoch 134, accuracy: 0.7730
Epoch 134, Train Loss: 0.1759, Val Loss: 0.8883
Epoch 135, accuracy: 0.7730
Epoch 136, accuracy: 0.7730
Epoch 136, Train Loss: 0.1933, Val Loss: 0.8883
Epoch 137, accuracy: 0.7730
Epoch 138, accuracy: 0.7730
Epoch 138, Train Loss: 0.2035, Val Loss: 0.8883
Epoch 139, accuracy: 0.7730
Epoch 140, accuracy: 0.7730
Epoch 140, Train Loss: 0.1763, Val Loss: 0.8883
Epoch 141, accuracy: 0.7730
Epoch 142, accuracy: 0.7730
Epoch 142, Train Loss: 0.1967, Val Loss: 0.8883
Epoch 143, accuracy: 0.7730
Epoch 144, accuracy: 0.7730
Epoch 144, Train Loss: 0.1845, Val Loss: 0.8883
Epoch 145, accuracy: 0.7730
Epoch 146, accuracy: 0.7730
Epoch 146, Train Loss: 0.1629, Val Loss: 0.8883
Epoch 147, accuracy: 0.7730
Epoch 148, accuracy: 0.7730
Epoch 148, Train Loss: 0.1971, Val Loss: 0.8883
Epoch 149, accuracy: 0.7730
Epoch 150, accuracy: 0.7730
Epoch 150, Train Loss: 0.1261, Val Loss: 0.8883
Epoch 151, accuracy: 0.7730
Epoch 152, accuracy: 0.7730
Epoch 152, Train Loss: 0.2140, Val Loss: 0.8883
Epoch 153, accuracy: 0.7730
Epoch 154, accuracy: 0.7730
Epoch 154, Train Loss: 0.1808, Val Loss: 0.8883
Epoch 155, accuracy: 0.7730
Epoch 156, accuracy: 0.7730
Epoch 156, Train Loss: 0.1346, Val Loss: 0.8883
Epoch 157, accuracy: 0.7730
Epoch 158, accuracy: 0.7730
Epoch 158, Train Loss: 0.1895, Val Loss: 0.8883
Epoch 159, accuracy: 0.7730
Epoch 160, accuracy: 0.7730
Epoch 160, Train Loss: 0.1808, Val Loss: 0.8883
Epoch 161, accuracy: 0.7730
Epoch 162, accuracy: 0.7730
Epoch 162, Train Loss: 0.1541, Val Loss: 0.8883
Epoch 163, accuracy: 0.7730
Epoch 164, accuracy: 0.7730
Epoch 164, Train Loss: 0.1551, Val Loss: 0.8883
Epoch 165, accuracy: 0.7730
Epoch 166, accuracy: 0.7730
Epoch 166, Train Loss: 0.1847, Val Loss: 0.8883
Epoch 167, accuracy: 0.7730
Epoch 168, accuracy: 0.7730
Epoch 168, Train Loss: 0.1371, Val Loss: 0.8883
Epoch 169, accuracy: 0.7730
Epoch 170, accuracy: 0.7730
Epoch 170, Train Loss: 0.1786, Val Loss: 0.8883
Epoch 171, accuracy: 0.7730
Epoch 172, accuracy: 0.7730
Epoch 172, Train Loss: 0.2363, Val Loss: 0.8883
Epoch 173, accuracy: 0.7730
Epoch 174, accuracy: 0.7730
Epoch 174, Train Loss: 0.1981, Val Loss: 0.8883
Epoch 175, accuracy: 0.7730
Epoch 176, accuracy: 0.7730
Epoch 176, Train Loss: 0.1109, Val Loss: 0.8883
Epoch 177, accuracy: 0.7730
Epoch 178, accuracy: 0.7730
Epoch 178, Train Loss: 0.1899, Val Loss: 0.8883
Epoch 179, accuracy: 0.7730
Epoch 180, accuracy: 0.7730
Epoch 180, Train Loss: 0.1869, Val Loss: 0.8883
Epoch 181, accuracy: 0.7730
Epoch 182, accuracy: 0.7730
Epoch 182, Train Loss: 0.2234, Val Loss: 0.8883
Epoch 183, accuracy: 0.7730
Epoch 184, accuracy: 0.7730
Epoch 184, Train Loss: 0.1250, Val Loss: 0.8883
Epoch 185, accuracy: 0.7730
Epoch 186, accuracy: 0.7730
Epoch 186, Train Loss: 0.2316, Val Loss: 0.8883
Epoch 187, accuracy: 0.7730
Epoch 188, accuracy: 0.7730
Epoch 188, Train Loss: 0.1796, Val Loss: 0.8883
Epoch 189, accuracy: 0.7730
Epoch 190, accuracy: 0.7730
Epoch 190, Train Loss: 0.1570, Val Loss: 0.8883
Epoch 191, accuracy: 0.7730
Epoch 192, accuracy: 0.7730
Epoch 192, Train Loss: 0.1600, Val Loss: 0.8883
Epoch 193, accuracy: 0.7730
Epoch 194, accuracy: 0.7730
Epoch 194, Train Loss: 0.1961, Val Loss: 0.8883
Epoch 195, accuracy: 0.7730
Epoch 196, accuracy: 0.7730
Epoch 196, Train Loss: 0.2036, Val Loss: 0.8883
Epoch 197, accuracy: 0.7730
Epoch 198, accuracy: 0.7730
Epoch 198, Train Loss: 0.1569, Val Loss: 0.8883
Epoch 199, accuracy: 0.7730
Loaded best model with val_loss = 0.7072871923446655
test :accuracy 0.7910, f1_macro: 0.7822, f1_micro: 0.7910, auc: 0.9579
Training mamba3 with 4 layers...
可训练参数: 998957_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.7896
Epoch 0, accuracy: 0.2440
Epoch 0, Train Loss: 2.0291, Val Loss: 1.7896
✅ Epoch 1: New best model saved with val_loss = 1.7238
Epoch 1, accuracy: 0.2880
✅ Epoch 2: New best model saved with val_loss = 1.1267
Epoch 2, accuracy: 0.7120
Epoch 2, Train Loss: 1.4096, Val Loss: 1.1267
✅ Epoch 3: New best model saved with val_loss = 1.0168
Epoch 3, accuracy: 0.7000
✅ Epoch 4: New best model saved with val_loss = 0.9315
Epoch 4, accuracy: 0.7250
Epoch 4, Train Loss: 0.9244, Val Loss: 0.9315
Epoch 5, accuracy: 0.7500
Epoch 6, accuracy: 0.7240
Epoch 6, Train Loss: 0.6378, Val Loss: 1.0774
Epoch 7, accuracy: 0.7400
Epoch 8, accuracy: 0.7440
Epoch 8, Train Loss: 0.3980, Val Loss: 1.0412
Epoch 9, accuracy: 0.7550
Epoch 10, accuracy: 0.7570
Epoch 10, Train Loss: 0.3084, Val Loss: 1.1577
Epoch 11, accuracy: 0.7560
Epoch 12, accuracy: 0.7570
Epoch 12, Train Loss: 0.2808, Val Loss: 1.1705
Epoch 13, accuracy: 0.7550
Epoch 14, accuracy: 0.7600
Epoch 14, Train Loss: 0.2836, Val Loss: 1.1527
Epoch 15, accuracy: 0.7640
Epoch 16, accuracy: 0.7630
Epoch 16, Train Loss: 0.2357, Val Loss: 1.1316
Epoch 17, accuracy: 0.7620
Epoch 18, accuracy: 0.7630
Epoch 18, Train Loss: 0.3109, Val Loss: 1.1299
Epoch 19, accuracy: 0.7640
Epoch 20, accuracy: 0.7650
Epoch 20, Train Loss: 0.2675, Val Loss: 1.1282
Epoch 21, accuracy: 0.7650
Epoch 22, accuracy: 0.7650
Epoch 22, Train Loss: 0.2529, Val Loss: 1.1266
Epoch 23, accuracy: 0.7650
Epoch 24, accuracy: 0.7650
Epoch 24, Train Loss: 0.2455, Val Loss: 1.1265
Epoch 25, accuracy: 0.7650
Epoch 26, accuracy: 0.7650
Epoch 26, Train Loss: 0.2951, Val Loss: 1.1264
Epoch 27, accuracy: 0.7650
Epoch 28, accuracy: 0.7650
Epoch 28, Train Loss: 0.2439, Val Loss: 1.1263
Epoch 29, accuracy: 0.7650
Epoch 30, accuracy: 0.7650
Epoch 30, Train Loss: 0.3185, Val Loss: 1.1263
Epoch 31, accuracy: 0.7650
Epoch 32, accuracy: 0.7650
Epoch 32, Train Loss: 0.2937, Val Loss: 1.1263
Epoch 33, accuracy: 0.7650
Epoch 34, accuracy: 0.7650
Epoch 34, Train Loss: 0.2319, Val Loss: 1.1263
Epoch 35, accuracy: 0.7650
Epoch 36, accuracy: 0.7650
Epoch 36, Train Loss: 0.2456, Val Loss: 1.1263
Epoch 37, accuracy: 0.7650
Epoch 38, accuracy: 0.7650
Epoch 38, Train Loss: 0.2936, Val Loss: 1.1262
Epoch 39, accuracy: 0.7650
Epoch 40, accuracy: 0.7650
Epoch 40, Train Loss: 0.2839, Val Loss: 1.1262
Epoch 41, accuracy: 0.7650
Epoch 42, accuracy: 0.7650
Epoch 42, Train Loss: 0.2147, Val Loss: 1.1262
Epoch 43, accuracy: 0.7650
Epoch 44, accuracy: 0.7650
Epoch 44, Train Loss: 0.2564, Val Loss: 1.1262
Epoch 45, accuracy: 0.7650
Epoch 46, accuracy: 0.7650
Epoch 46, Train Loss: 0.2551, Val Loss: 1.1262
Epoch 47, accuracy: 0.7650
Epoch 48, accuracy: 0.7650
Epoch 48, Train Loss: 0.2542, Val Loss: 1.1262
Epoch 49, accuracy: 0.7650
Epoch 50, accuracy: 0.7650
Epoch 50, Train Loss: 0.2976, Val Loss: 1.1262
Epoch 51, accuracy: 0.7650
Epoch 52, accuracy: 0.7650
Epoch 52, Train Loss: 0.2754, Val Loss: 1.1262
Epoch 53, accuracy: 0.7650
Epoch 54, accuracy: 0.7650
Epoch 54, Train Loss: 0.2609, Val Loss: 1.1262
Epoch 55, accuracy: 0.7650
Epoch 56, accuracy: 0.7650
Epoch 56, Train Loss: 0.2234, Val Loss: 1.1262
Epoch 57, accuracy: 0.7650
Epoch 58, accuracy: 0.7650
Epoch 58, Train Loss: 0.2606, Val Loss: 1.1262
Epoch 59, accuracy: 0.7650
Epoch 60, accuracy: 0.7650
Epoch 60, Train Loss: 0.1889, Val Loss: 1.1262
Epoch 61, accuracy: 0.7650
Epoch 62, accuracy: 0.7650
Epoch 62, Train Loss: 0.2624, Val Loss: 1.1262
Epoch 63, accuracy: 0.7650
Epoch 64, accuracy: 0.7650
Epoch 64, Train Loss: 0.2115, Val Loss: 1.1262
Epoch 65, accuracy: 0.7650
Epoch 66, accuracy: 0.7650
Epoch 66, Train Loss: 0.2807, Val Loss: 1.1262
Epoch 67, accuracy: 0.7650
Epoch 68, accuracy: 0.7650
Epoch 68, Train Loss: 0.2443, Val Loss: 1.1262
Epoch 69, accuracy: 0.7650
Epoch 70, accuracy: 0.7650
Epoch 70, Train Loss: 0.3530, Val Loss: 1.1262
Epoch 71, accuracy: 0.7650
Epoch 72, accuracy: 0.7650
Epoch 72, Train Loss: 0.2712, Val Loss: 1.1262
Epoch 73, accuracy: 0.7650
Epoch 74, accuracy: 0.7650
Epoch 74, Train Loss: 0.2203, Val Loss: 1.1262
Epoch 75, accuracy: 0.7650
Epoch 76, accuracy: 0.7650
Epoch 76, Train Loss: 0.2672, Val Loss: 1.1262
Epoch 77, accuracy: 0.7650
Epoch 78, accuracy: 0.7650
Epoch 78, Train Loss: 0.2318, Val Loss: 1.1262
Epoch 79, accuracy: 0.7650
Epoch 80, accuracy: 0.7650
Epoch 80, Train Loss: 0.2228, Val Loss: 1.1262
Epoch 81, accuracy: 0.7650
Epoch 82, accuracy: 0.7650
Epoch 82, Train Loss: 0.2488, Val Loss: 1.1262
Epoch 83, accuracy: 0.7650
Epoch 84, accuracy: 0.7650
Epoch 84, Train Loss: 0.2052, Val Loss: 1.1262
Epoch 85, accuracy: 0.7650
Epoch 86, accuracy: 0.7650
Epoch 86, Train Loss: 0.3170, Val Loss: 1.1262
Epoch 87, accuracy: 0.7650
Epoch 88, accuracy: 0.7650
Epoch 88, Train Loss: 0.2643, Val Loss: 1.1262
Epoch 89, accuracy: 0.7650
Epoch 90, accuracy: 0.7650
Epoch 90, Train Loss: 0.2856, Val Loss: 1.1262
Epoch 91, accuracy: 0.7650
Epoch 92, accuracy: 0.7650
Epoch 92, Train Loss: 0.2688, Val Loss: 1.1262
Epoch 93, accuracy: 0.7650
Epoch 94, accuracy: 0.7650
Epoch 94, Train Loss: 0.2099, Val Loss: 1.1262
Epoch 95, accuracy: 0.7650
Epoch 96, accuracy: 0.7650
Epoch 96, Train Loss: 0.2839, Val Loss: 1.1262
Epoch 97, accuracy: 0.7650
Epoch 98, accuracy: 0.7650
Epoch 98, Train Loss: 0.2114, Val Loss: 1.1262
Epoch 99, accuracy: 0.7650
Epoch 100, accuracy: 0.7650
Epoch 100, Train Loss: 0.2396, Val Loss: 1.1262
Epoch 101, accuracy: 0.7650
Epoch 102, accuracy: 0.7650
Epoch 102, Train Loss: 0.3431, Val Loss: 1.1262
Epoch 103, accuracy: 0.7650
Epoch 104, accuracy: 0.7650
Epoch 104, Train Loss: 0.1818, Val Loss: 1.1262
Epoch 105, accuracy: 0.7650
Epoch 106, accuracy: 0.7650
Epoch 106, Train Loss: 0.2846, Val Loss: 1.1262
Epoch 107, accuracy: 0.7650
Epoch 108, accuracy: 0.7650
Epoch 108, Train Loss: 0.2282, Val Loss: 1.1262
Epoch 109, accuracy: 0.7650
Epoch 110, accuracy: 0.7650
Epoch 110, Train Loss: 0.2289, Val Loss: 1.1262
Epoch 111, accuracy: 0.7650
Epoch 112, accuracy: 0.7650
Epoch 112, Train Loss: 0.3081, Val Loss: 1.1262
Epoch 113, accuracy: 0.7650
Epoch 114, accuracy: 0.7650
Epoch 114, Train Loss: 0.2443, Val Loss: 1.1262
Epoch 115, accuracy: 0.7650
Epoch 116, accuracy: 0.7650
Epoch 116, Train Loss: 0.1860, Val Loss: 1.1262
Epoch 117, accuracy: 0.7650
Epoch 118, accuracy: 0.7650
Epoch 118, Train Loss: 0.2512, Val Loss: 1.1262
Epoch 119, accuracy: 0.7650
Epoch 120, accuracy: 0.7650
Epoch 120, Train Loss: 0.2917, Val Loss: 1.1262
Epoch 121, accuracy: 0.7650
Epoch 122, accuracy: 0.7650
Epoch 122, Train Loss: 0.2574, Val Loss: 1.1262
Epoch 123, accuracy: 0.7650
Epoch 124, accuracy: 0.7650
Epoch 124, Train Loss: 0.3274, Val Loss: 1.1262
Epoch 125, accuracy: 0.7650
Epoch 126, accuracy: 0.7650
Epoch 126, Train Loss: 0.2503, Val Loss: 1.1262
Epoch 127, accuracy: 0.7650
Epoch 128, accuracy: 0.7650
Epoch 128, Train Loss: 0.2535, Val Loss: 1.1262
Epoch 129, accuracy: 0.7650
Epoch 130, accuracy: 0.7650
Epoch 130, Train Loss: 0.2960, Val Loss: 1.1262
Epoch 131, accuracy: 0.7650
Epoch 132, accuracy: 0.7650
Epoch 132, Train Loss: 0.2915, Val Loss: 1.1262
Epoch 133, accuracy: 0.7650
Epoch 134, accuracy: 0.7650
Epoch 134, Train Loss: 0.2713, Val Loss: 1.1262
Epoch 135, accuracy: 0.7650
Epoch 136, accuracy: 0.7650
Epoch 136, Train Loss: 0.2686, Val Loss: 1.1262
Epoch 137, accuracy: 0.7650
Epoch 138, accuracy: 0.7650
Epoch 138, Train Loss: 0.2313, Val Loss: 1.1262
Epoch 139, accuracy: 0.7650
Epoch 140, accuracy: 0.7650
Epoch 140, Train Loss: 0.2548, Val Loss: 1.1262
Epoch 141, accuracy: 0.7650
Epoch 142, accuracy: 0.7650
Epoch 142, Train Loss: 0.2291, Val Loss: 1.1262
Epoch 143, accuracy: 0.7650
Epoch 144, accuracy: 0.7650
Epoch 144, Train Loss: 0.2582, Val Loss: 1.1262
Epoch 145, accuracy: 0.7650
Epoch 146, accuracy: 0.7650
Epoch 146, Train Loss: 0.2007, Val Loss: 1.1262
Epoch 147, accuracy: 0.7650
Epoch 148, accuracy: 0.7650
Epoch 148, Train Loss: 0.2461, Val Loss: 1.1262
Epoch 149, accuracy: 0.7650
Epoch 150, accuracy: 0.7650
Epoch 150, Train Loss: 0.3173, Val Loss: 1.1262
Epoch 151, accuracy: 0.7650
Epoch 152, accuracy: 0.7650
Epoch 152, Train Loss: 0.3043, Val Loss: 1.1262
Epoch 153, accuracy: 0.7650
Epoch 154, accuracy: 0.7650
Epoch 154, Train Loss: 0.2277, Val Loss: 1.1262
Epoch 155, accuracy: 0.7650
Epoch 156, accuracy: 0.7650
Epoch 156, Train Loss: 0.3281, Val Loss: 1.1262
Epoch 157, accuracy: 0.7650
Epoch 158, accuracy: 0.7650
Epoch 158, Train Loss: 0.2268, Val Loss: 1.1262
Epoch 159, accuracy: 0.7650
Epoch 160, accuracy: 0.7650
Epoch 160, Train Loss: 0.2080, Val Loss: 1.1262
Epoch 161, accuracy: 0.7650
Epoch 162, accuracy: 0.7650
Epoch 162, Train Loss: 0.2534, Val Loss: 1.1262
Epoch 163, accuracy: 0.7650
Epoch 164, accuracy: 0.7650
Epoch 164, Train Loss: 0.2229, Val Loss: 1.1262
Epoch 165, accuracy: 0.7650
Epoch 166, accuracy: 0.7650
Epoch 166, Train Loss: 0.3125, Val Loss: 1.1262
Epoch 167, accuracy: 0.7650
Epoch 168, accuracy: 0.7650
Epoch 168, Train Loss: 0.2867, Val Loss: 1.1262
Epoch 169, accuracy: 0.7650
Epoch 170, accuracy: 0.7650
Epoch 170, Train Loss: 0.2058, Val Loss: 1.1262
Epoch 171, accuracy: 0.7650
Epoch 172, accuracy: 0.7650
Epoch 172, Train Loss: 0.1677, Val Loss: 1.1262
Epoch 173, accuracy: 0.7650
Epoch 174, accuracy: 0.7650
Epoch 174, Train Loss: 0.2333, Val Loss: 1.1262
Epoch 175, accuracy: 0.7650
Epoch 176, accuracy: 0.7650
Epoch 176, Train Loss: 0.2674, Val Loss: 1.1262
Epoch 177, accuracy: 0.7650
Epoch 178, accuracy: 0.7650
Epoch 178, Train Loss: 0.2720, Val Loss: 1.1262
Epoch 179, accuracy: 0.7650
Epoch 180, accuracy: 0.7650
Epoch 180, Train Loss: 0.1858, Val Loss: 1.1262
Epoch 181, accuracy: 0.7650
Epoch 182, accuracy: 0.7650
Epoch 182, Train Loss: 0.2367, Val Loss: 1.1262
Epoch 183, accuracy: 0.7650
Epoch 184, accuracy: 0.7650
Epoch 184, Train Loss: 0.2285, Val Loss: 1.1262
Epoch 185, accuracy: 0.7650
Epoch 186, accuracy: 0.7650
Epoch 186, Train Loss: 0.2333, Val Loss: 1.1262
Epoch 187, accuracy: 0.7650
Epoch 188, accuracy: 0.7650
Epoch 188, Train Loss: 0.2271, Val Loss: 1.1262
Epoch 189, accuracy: 0.7650
Epoch 190, accuracy: 0.7650
Epoch 190, Train Loss: 0.2816, Val Loss: 1.1262
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 191, accuracy: 0.7650
Epoch 192, accuracy: 0.7650
Epoch 192, Train Loss: 0.2954, Val Loss: 1.1262
Epoch 193, accuracy: 0.7650
Epoch 194, accuracy: 0.7650
Epoch 194, Train Loss: 0.2539, Val Loss: 1.1262
Epoch 195, accuracy: 0.7650
Epoch 196, accuracy: 0.7650
Epoch 196, Train Loss: 0.3156, Val Loss: 1.1262
Epoch 197, accuracy: 0.7650
Epoch 198, accuracy: 0.7650
Epoch 198, Train Loss: 0.2784, Val Loss: 1.1262
Epoch 199, accuracy: 0.7650
Loaded best model with val_loss = 0.9314505457878113
test :accuracy 0.7250, f1_macro: 0.7008, f1_micro: 0.7250, auc: 0.9379
Training mamba3 with 5 layers...
可训练参数: 1082029_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.5399
Epoch 0, accuracy: 0.4620
Epoch 0, Train Loss: 2.0385, Val Loss: 1.5399
✅ Epoch 1: New best model saved with val_loss = 1.3984
Epoch 1, accuracy: 0.4040
✅ Epoch 2: New best model saved with val_loss = 1.0480
Epoch 2, accuracy: 0.6880
Epoch 2, Train Loss: 1.2348, Val Loss: 1.0480
✅ Epoch 3: New best model saved with val_loss = 0.9032
Epoch 3, accuracy: 0.7580
✅ Epoch 4: New best model saved with val_loss = 0.8104
Epoch 4, accuracy: 0.7660
Epoch 4, Train Loss: 0.7670, Val Loss: 0.8104
✅ Epoch 5: New best model saved with val_loss = 0.7927
Epoch 5, accuracy: 0.7570
Epoch 6, accuracy: 0.7600
Epoch 6, Train Loss: 0.5401, Val Loss: 0.7935
✅ Epoch 7: New best model saved with val_loss = 0.7811
Epoch 7, accuracy: 0.7760
Epoch 8, accuracy: 0.7710
Epoch 8, Train Loss: 0.3808, Val Loss: 0.8360
Epoch 9, accuracy: 0.7670
Epoch 10, accuracy: 0.7620
Epoch 10, Train Loss: 0.3288, Val Loss: 0.9429
Epoch 11, accuracy: 0.7570
Epoch 12, accuracy: 0.7610
Epoch 12, Train Loss: 0.2191, Val Loss: 1.0357
Epoch 13, accuracy: 0.7730
Epoch 14, accuracy: 0.7730
Epoch 14, Train Loss: 0.2070, Val Loss: 0.9755
Epoch 15, accuracy: 0.7730
Epoch 16, accuracy: 0.7750
Epoch 16, Train Loss: 0.1819, Val Loss: 0.9689
Epoch 17, accuracy: 0.7750
Epoch 18, accuracy: 0.7740
Epoch 18, Train Loss: 0.2353, Val Loss: 0.9638
Epoch 19, accuracy: 0.7760
Epoch 20, accuracy: 0.7760
Epoch 20, Train Loss: 0.1700, Val Loss: 0.9628
Epoch 21, accuracy: 0.7760
Epoch 22, accuracy: 0.7770
Epoch 22, Train Loss: 0.2102, Val Loss: 0.9630
Epoch 23, accuracy: 0.7770
Epoch 24, accuracy: 0.7770
Epoch 24, Train Loss: 0.1431, Val Loss: 0.9634
Epoch 25, accuracy: 0.7780
Epoch 26, accuracy: 0.7780
Epoch 26, Train Loss: 0.1520, Val Loss: 0.9636
Epoch 27, accuracy: 0.7780
Epoch 28, accuracy: 0.7780
Epoch 28, Train Loss: 0.1302, Val Loss: 0.9637
Epoch 29, accuracy: 0.7780
Epoch 30, accuracy: 0.7780
Epoch 30, Train Loss: 0.1855, Val Loss: 0.9638
Epoch 31, accuracy: 0.7780
Epoch 32, accuracy: 0.7780
Epoch 32, Train Loss: 0.1823, Val Loss: 0.9638
Epoch 33, accuracy: 0.7780
Epoch 34, accuracy: 0.7780
Epoch 34, Train Loss: 0.1447, Val Loss: 0.9638
Epoch 35, accuracy: 0.7780
Epoch 36, accuracy: 0.7780
Epoch 36, Train Loss: 0.1477, Val Loss: 0.9638
Epoch 37, accuracy: 0.7780
Epoch 38, accuracy: 0.7780
Epoch 38, Train Loss: 0.1687, Val Loss: 0.9639
Epoch 39, accuracy: 0.7780
Epoch 40, accuracy: 0.7780
Epoch 40, Train Loss: 0.1575, Val Loss: 0.9639
Epoch 41, accuracy: 0.7780
Epoch 42, accuracy: 0.7780
Epoch 42, Train Loss: 0.2233, Val Loss: 0.9639
Epoch 43, accuracy: 0.7780
Epoch 44, accuracy: 0.7780
Epoch 44, Train Loss: 0.1891, Val Loss: 0.9639
Epoch 45, accuracy: 0.7780
Epoch 46, accuracy: 0.7780
Epoch 46, Train Loss: 0.1891, Val Loss: 0.9639
Epoch 47, accuracy: 0.7780
Epoch 48, accuracy: 0.7780
Epoch 48, Train Loss: 0.1828, Val Loss: 0.9639
Epoch 49, accuracy: 0.7780
Epoch 50, accuracy: 0.7780
Epoch 50, Train Loss: 0.1862, Val Loss: 0.9639
Epoch 51, accuracy: 0.7780
Epoch 52, accuracy: 0.7780
Epoch 52, Train Loss: 0.1533, Val Loss: 0.9639
Epoch 53, accuracy: 0.7780
Epoch 54, accuracy: 0.7780
Epoch 54, Train Loss: 0.1668, Val Loss: 0.9639
Epoch 55, accuracy: 0.7780
Epoch 56, accuracy: 0.7780
Epoch 56, Train Loss: 0.1525, Val Loss: 0.9639
Epoch 57, accuracy: 0.7780
Epoch 58, accuracy: 0.7780
Epoch 58, Train Loss: 0.1868, Val Loss: 0.9639
Epoch 59, accuracy: 0.7780
Epoch 60, accuracy: 0.7780
Epoch 60, Train Loss: 0.1630, Val Loss: 0.9639
Epoch 61, accuracy: 0.7780
Epoch 62, accuracy: 0.7780
Epoch 62, Train Loss: 0.0949, Val Loss: 0.9639
Epoch 63, accuracy: 0.7780
Epoch 64, accuracy: 0.7780
Epoch 64, Train Loss: 0.2287, Val Loss: 0.9639
Epoch 65, accuracy: 0.7780
Epoch 66, accuracy: 0.7780
Epoch 66, Train Loss: 0.2102, Val Loss: 0.9639
Epoch 67, accuracy: 0.7780
Epoch 68, accuracy: 0.7780
Epoch 68, Train Loss: 0.1118, Val Loss: 0.9639
Epoch 69, accuracy: 0.7780
Epoch 70, accuracy: 0.7780
Epoch 70, Train Loss: 0.1446, Val Loss: 0.9639
Epoch 71, accuracy: 0.7780
Epoch 72, accuracy: 0.7780
Epoch 72, Train Loss: 0.1502, Val Loss: 0.9639
Epoch 73, accuracy: 0.7780
Epoch 74, accuracy: 0.7780
Epoch 74, Train Loss: 0.1873, Val Loss: 0.9639
Epoch 75, accuracy: 0.7780
Epoch 76, accuracy: 0.7780
Epoch 76, Train Loss: 0.1796, Val Loss: 0.9639
Epoch 77, accuracy: 0.7780
Epoch 78, accuracy: 0.7780
Epoch 78, Train Loss: 0.2108, Val Loss: 0.9639
Epoch 79, accuracy: 0.7780
Epoch 80, accuracy: 0.7780
Epoch 80, Train Loss: 0.1427, Val Loss: 0.9639
Epoch 81, accuracy: 0.7780
Epoch 82, accuracy: 0.7780
Epoch 82, Train Loss: 0.1821, Val Loss: 0.9639
Epoch 83, accuracy: 0.7780
Epoch 84, accuracy: 0.7780
Epoch 84, Train Loss: 0.2163, Val Loss: 0.9639
Epoch 85, accuracy: 0.7780
Epoch 86, accuracy: 0.7780
Epoch 86, Train Loss: 0.1687, Val Loss: 0.9639
Epoch 87, accuracy: 0.7780
Epoch 88, accuracy: 0.7780
Epoch 88, Train Loss: 0.1560, Val Loss: 0.9639
Epoch 89, accuracy: 0.7780
Epoch 90, accuracy: 0.7780
Epoch 90, Train Loss: 0.1764, Val Loss: 0.9639
Epoch 91, accuracy: 0.7780
Epoch 92, accuracy: 0.7780
Epoch 92, Train Loss: 0.1966, Val Loss: 0.9639
Epoch 93, accuracy: 0.7780
Epoch 94, accuracy: 0.7780
Epoch 94, Train Loss: 0.1887, Val Loss: 0.9639
Epoch 95, accuracy: 0.7780
Epoch 96, accuracy: 0.7780
Epoch 96, Train Loss: 0.1890, Val Loss: 0.9639
Epoch 97, accuracy: 0.7780
Epoch 98, accuracy: 0.7780
Epoch 98, Train Loss: 0.1786, Val Loss: 0.9639
Epoch 99, accuracy: 0.7780
Epoch 100, accuracy: 0.7780
Epoch 100, Train Loss: 0.1799, Val Loss: 0.9639
Epoch 101, accuracy: 0.7780
Epoch 102, accuracy: 0.7780
Epoch 102, Train Loss: 0.1507, Val Loss: 0.9639
Epoch 103, accuracy: 0.7780
Epoch 104, accuracy: 0.7780
Epoch 104, Train Loss: 0.1303, Val Loss: 0.9639
Epoch 105, accuracy: 0.7780
Epoch 106, accuracy: 0.7780
Epoch 106, Train Loss: 0.1701, Val Loss: 0.9639
Epoch 107, accuracy: 0.7780
Epoch 108, accuracy: 0.7780
Epoch 108, Train Loss: 0.1391, Val Loss: 0.9639
Epoch 109, accuracy: 0.7780
Epoch 110, accuracy: 0.7780
Epoch 110, Train Loss: 0.1631, Val Loss: 0.9639
Epoch 111, accuracy: 0.7780
Epoch 112, accuracy: 0.7780
Epoch 112, Train Loss: 0.1665, Val Loss: 0.9639
Epoch 113, accuracy: 0.7780
Epoch 114, accuracy: 0.7780
Epoch 114, Train Loss: 0.1673, Val Loss: 0.9639
Epoch 115, accuracy: 0.7780
Epoch 116, accuracy: 0.7780
Epoch 116, Train Loss: 0.1393, Val Loss: 0.9639
Epoch 117, accuracy: 0.7780
Epoch 118, accuracy: 0.7780
Epoch 118, Train Loss: 0.1880, Val Loss: 0.9639
Epoch 119, accuracy: 0.7780
Epoch 120, accuracy: 0.7780
Epoch 120, Train Loss: 0.2620, Val Loss: 0.9639
Epoch 121, accuracy: 0.7780
Epoch 122, accuracy: 0.7780
Epoch 122, Train Loss: 0.1422, Val Loss: 0.9639
Epoch 123, accuracy: 0.7780
Epoch 124, accuracy: 0.7780
Epoch 124, Train Loss: 0.1638, Val Loss: 0.9639
Epoch 125, accuracy: 0.7780
Epoch 126, accuracy: 0.7780
Epoch 126, Train Loss: 0.1524, Val Loss: 0.9639
Epoch 127, accuracy: 0.7780
Epoch 128, accuracy: 0.7780
Epoch 128, Train Loss: 0.1715, Val Loss: 0.9639
Epoch 129, accuracy: 0.7780
Epoch 130, accuracy: 0.7780
Epoch 130, Train Loss: 0.1878, Val Loss: 0.9639
Epoch 131, accuracy: 0.7780
Epoch 132, accuracy: 0.7780
Epoch 132, Train Loss: 0.2050, Val Loss: 0.9639
Epoch 133, accuracy: 0.7780
Epoch 134, accuracy: 0.7780
Epoch 134, Train Loss: 0.1151, Val Loss: 0.9639
Epoch 135, accuracy: 0.7780
Epoch 136, accuracy: 0.7780
Epoch 136, Train Loss: 0.2005, Val Loss: 0.9639
Epoch 137, accuracy: 0.7780
Epoch 138, accuracy: 0.7780
Epoch 138, Train Loss: 0.1550, Val Loss: 0.9639
Epoch 139, accuracy: 0.7780
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 140, accuracy: 0.7780
Epoch 140, Train Loss: 0.1718, Val Loss: 0.9639
Epoch 141, accuracy: 0.7780
Epoch 142, accuracy: 0.7780
Epoch 142, Train Loss: 0.1543, Val Loss: 0.9639
Epoch 143, accuracy: 0.7780
Epoch 144, accuracy: 0.7780
Epoch 144, Train Loss: 0.1928, Val Loss: 0.9639
Epoch 145, accuracy: 0.7780
Epoch 146, accuracy: 0.7780
Epoch 146, Train Loss: 0.1096, Val Loss: 0.9639
Epoch 147, accuracy: 0.7780
Epoch 148, accuracy: 0.7780
Epoch 148, Train Loss: 0.1723, Val Loss: 0.9639
Epoch 149, accuracy: 0.7780
Epoch 150, accuracy: 0.7780
Epoch 150, Train Loss: 0.1836, Val Loss: 0.9639
Epoch 151, accuracy: 0.7780
Epoch 152, accuracy: 0.7780
Epoch 152, Train Loss: 0.1801, Val Loss: 0.9639
Epoch 153, accuracy: 0.7780
Epoch 154, accuracy: 0.7780
Epoch 154, Train Loss: 0.2217, Val Loss: 0.9639
Epoch 155, accuracy: 0.7780
Epoch 156, accuracy: 0.7780
Epoch 156, Train Loss: 0.1438, Val Loss: 0.9639
Epoch 157, accuracy: 0.7780
Epoch 158, accuracy: 0.7780
Epoch 158, Train Loss: 0.1368, Val Loss: 0.9639
Epoch 159, accuracy: 0.7780
Epoch 160, accuracy: 0.7780
Epoch 160, Train Loss: 0.1943, Val Loss: 0.9639
Epoch 161, accuracy: 0.7780
Epoch 162, accuracy: 0.7780
Epoch 162, Train Loss: 0.1962, Val Loss: 0.9639
Epoch 163, accuracy: 0.7780
Epoch 164, accuracy: 0.7780
Epoch 164, Train Loss: 0.1826, Val Loss: 0.9639
Epoch 165, accuracy: 0.7780
Epoch 166, accuracy: 0.7780
Epoch 166, Train Loss: 0.1174, Val Loss: 0.9639
Epoch 167, accuracy: 0.7780
Epoch 168, accuracy: 0.7780
Epoch 168, Train Loss: 0.2142, Val Loss: 0.9639
Epoch 169, accuracy: 0.7780
Epoch 170, accuracy: 0.7780
Epoch 170, Train Loss: 0.1404, Val Loss: 0.9639
Epoch 171, accuracy: 0.7780
Epoch 172, accuracy: 0.7780
Epoch 172, Train Loss: 0.1491, Val Loss: 0.9639
Epoch 173, accuracy: 0.7780
Epoch 174, accuracy: 0.7780
Epoch 174, Train Loss: 0.1556, Val Loss: 0.9639
Epoch 175, accuracy: 0.7780
Epoch 176, accuracy: 0.7780
Epoch 176, Train Loss: 0.1741, Val Loss: 0.9639
Epoch 177, accuracy: 0.7780
Epoch 178, accuracy: 0.7780
Epoch 178, Train Loss: 0.1097, Val Loss: 0.9639
Epoch 179, accuracy: 0.7780
Epoch 180, accuracy: 0.7780
Epoch 180, Train Loss: 0.1713, Val Loss: 0.9639
Epoch 181, accuracy: 0.7780
Epoch 182, accuracy: 0.7780
Epoch 182, Train Loss: 0.1848, Val Loss: 0.9639
Epoch 183, accuracy: 0.7780
Epoch 184, accuracy: 0.7780
Epoch 184, Train Loss: 0.1527, Val Loss: 0.9639
Epoch 185, accuracy: 0.7780
Epoch 186, accuracy: 0.7780
Epoch 186, Train Loss: 0.1784, Val Loss: 0.9639
Epoch 187, accuracy: 0.7780
Epoch 188, accuracy: 0.7780
Epoch 188, Train Loss: 0.1607, Val Loss: 0.9639
Epoch 189, accuracy: 0.7780
Epoch 190, accuracy: 0.7780
Epoch 190, Train Loss: 0.2013, Val Loss: 0.9639
Epoch 191, accuracy: 0.7780
Epoch 192, accuracy: 0.7780
Epoch 192, Train Loss: 0.1739, Val Loss: 0.9639
Epoch 193, accuracy: 0.7780
Epoch 194, accuracy: 0.7780
Epoch 194, Train Loss: 0.1366, Val Loss: 0.9639
Epoch 195, accuracy: 0.7780
Epoch 196, accuracy: 0.7780
Epoch 196, Train Loss: 0.2127, Val Loss: 0.9639
Epoch 197, accuracy: 0.7780
Epoch 198, accuracy: 0.7780
Epoch 198, Train Loss: 0.1651, Val Loss: 0.9639
Epoch 199, accuracy: 0.7780
Loaded best model with val_loss = 0.7810530066490173
test :accuracy 0.7760, f1_macro: 0.7596, f1_micro: 0.7760, auc: 0.9483
Training mamba3 with 6 layers...
可训练参数: 1165101_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.7167
Epoch 0, accuracy: 0.2750
Epoch 0, Train Loss: 2.0410, Val Loss: 1.7167
Epoch 1, accuracy: 0.4200
✅ Epoch 2: New best model saved with val_loss = 1.3779
Epoch 2, accuracy: 0.5960
Epoch 2, Train Loss: 1.5482, Val Loss: 1.3779
✅ Epoch 3: New best model saved with val_loss = 1.3771
Epoch 3, accuracy: 0.5770
✅ Epoch 4: New best model saved with val_loss = 1.2028
Epoch 4, accuracy: 0.6360
Epoch 4, Train Loss: 0.9556, Val Loss: 1.2028
✅ Epoch 5: New best model saved with val_loss = 1.1456
Epoch 5, accuracy: 0.6650
✅ Epoch 6: New best model saved with val_loss = 1.1045
Epoch 6, accuracy: 0.7010
Epoch 6, Train Loss: 0.8392, Val Loss: 1.1045
✅ Epoch 7: New best model saved with val_loss = 1.0579
Epoch 7, accuracy: 0.7150
✅ Epoch 8: New best model saved with val_loss = 1.0096
Epoch 8, accuracy: 0.7220
Epoch 8, Train Loss: 0.5933, Val Loss: 1.0096
Epoch 9, accuracy: 0.7230
Epoch 10, accuracy: 0.7140
Epoch 10, Train Loss: 0.4473, Val Loss: 1.0818
Epoch 11, accuracy: 0.7360
✅ Epoch 12: New best model saved with val_loss = 0.9669
Epoch 12, accuracy: 0.7690
Epoch 12, Train Loss: 0.3393, Val Loss: 0.9669
Epoch 13, accuracy: 0.7720
Epoch 14, accuracy: 0.7730
Epoch 14, Train Loss: 0.3226, Val Loss: 1.0272
Epoch 15, accuracy: 0.7640
Epoch 16, accuracy: 0.7570
Epoch 16, Train Loss: 0.2546, Val Loss: 1.1193
Epoch 17, accuracy: 0.7470
Epoch 18, accuracy: 0.7450
Epoch 18, Train Loss: 0.2178, Val Loss: 1.2145
Epoch 19, accuracy: 0.7440
Epoch 20, accuracy: 0.7420
Epoch 20, Train Loss: 0.1951, Val Loss: 1.2264
Epoch 21, accuracy: 0.7460
Epoch 22, accuracy: 0.7490
Epoch 22, Train Loss: 0.2155, Val Loss: 1.2249
Epoch 23, accuracy: 0.7490
Epoch 24, accuracy: 0.7540
Epoch 24, Train Loss: 0.2023, Val Loss: 1.2163
Epoch 25, accuracy: 0.7550
Epoch 26, accuracy: 0.7550
Epoch 26, Train Loss: 0.2276, Val Loss: 1.2157
Epoch 27, accuracy: 0.7550
Epoch 28, accuracy: 0.7550
Epoch 28, Train Loss: 0.1806, Val Loss: 1.2152
Epoch 29, accuracy: 0.7550
Epoch 30, accuracy: 0.7570
Epoch 30, Train Loss: 0.2251, Val Loss: 1.2147
Epoch 31, accuracy: 0.7570
Epoch 32, accuracy: 0.7570
Epoch 32, Train Loss: 0.1541, Val Loss: 1.2146
Epoch 33, accuracy: 0.7570
Epoch 34, accuracy: 0.7570
Epoch 34, Train Loss: 0.1937, Val Loss: 1.2146
Epoch 35, accuracy: 0.7570
Epoch 36, accuracy: 0.7570
Epoch 36, Train Loss: 0.2028, Val Loss: 1.2145
Epoch 37, accuracy: 0.7570
Epoch 38, accuracy: 0.7570
Epoch 38, Train Loss: 0.2070, Val Loss: 1.2145
Epoch 39, accuracy: 0.7570
Epoch 40, accuracy: 0.7570
Epoch 40, Train Loss: 0.2090, Val Loss: 1.2145
Epoch 41, accuracy: 0.7570
Epoch 42, accuracy: 0.7570
Epoch 42, Train Loss: 0.1572, Val Loss: 1.2145
Epoch 43, accuracy: 0.7570
Epoch 44, accuracy: 0.7570
Epoch 44, Train Loss: 0.2424, Val Loss: 1.2145
Epoch 45, accuracy: 0.7570
Epoch 46, accuracy: 0.7570
Epoch 46, Train Loss: 0.1930, Val Loss: 1.2145
Epoch 47, accuracy: 0.7570
Epoch 48, accuracy: 0.7570
Epoch 48, Train Loss: 0.1881, Val Loss: 1.2145
Epoch 49, accuracy: 0.7570
Epoch 50, accuracy: 0.7570
Epoch 50, Train Loss: 0.1848, Val Loss: 1.2145
Epoch 51, accuracy: 0.7570
Epoch 52, accuracy: 0.7570
Epoch 52, Train Loss: 0.1906, Val Loss: 1.2145
Epoch 53, accuracy: 0.7570
Epoch 54, accuracy: 0.7570
Epoch 54, Train Loss: 0.2334, Val Loss: 1.2145
Epoch 55, accuracy: 0.7570
Epoch 56, accuracy: 0.7570
Epoch 56, Train Loss: 0.1947, Val Loss: 1.2145
Epoch 57, accuracy: 0.7570
Epoch 58, accuracy: 0.7570
Epoch 58, Train Loss: 0.1591, Val Loss: 1.2145
Epoch 59, accuracy: 0.7570
Epoch 60, accuracy: 0.7570
Epoch 60, Train Loss: 0.1570, Val Loss: 1.2145
Epoch 61, accuracy: 0.7570
Epoch 62, accuracy: 0.7570
Epoch 62, Train Loss: 0.2073, Val Loss: 1.2145
Epoch 63, accuracy: 0.7570
Epoch 64, accuracy: 0.7570
Epoch 64, Train Loss: 0.2412, Val Loss: 1.2145
Epoch 65, accuracy: 0.7570
Epoch 66, accuracy: 0.7570
Epoch 66, Train Loss: 0.1356, Val Loss: 1.2145
Epoch 67, accuracy: 0.7570
Epoch 68, accuracy: 0.7570
Epoch 68, Train Loss: 0.1481, Val Loss: 1.2145
Epoch 69, accuracy: 0.7570
Epoch 70, accuracy: 0.7570
Epoch 70, Train Loss: 0.2033, Val Loss: 1.2145
Epoch 71, accuracy: 0.7570
Epoch 72, accuracy: 0.7570
Epoch 72, Train Loss: 0.1874, Val Loss: 1.2145
Epoch 73, accuracy: 0.7570
Epoch 74, accuracy: 0.7570
Epoch 74, Train Loss: 0.2633, Val Loss: 1.2145
Epoch 75, accuracy: 0.7570
Epoch 76, accuracy: 0.7570
Epoch 76, Train Loss: 0.2009, Val Loss: 1.2145
Epoch 77, accuracy: 0.7570
Epoch 78, accuracy: 0.7570
Epoch 78, Train Loss: 0.1978, Val Loss: 1.2145
Epoch 79, accuracy: 0.7570
Epoch 80, accuracy: 0.7570
Epoch 80, Train Loss: 0.1749, Val Loss: 1.2145
Epoch 81, accuracy: 0.7570
Epoch 82, accuracy: 0.7570
Epoch 82, Train Loss: 0.2086, Val Loss: 1.2145
Epoch 83, accuracy: 0.7570
Epoch 84, accuracy: 0.7570
Epoch 84, Train Loss: 0.2126, Val Loss: 1.2145
Epoch 85, accuracy: 0.7570
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 86, accuracy: 0.7570
Epoch 86, Train Loss: 0.1631, Val Loss: 1.2145
Epoch 87, accuracy: 0.7570
Epoch 88, accuracy: 0.7570
Epoch 88, Train Loss: 0.2134, Val Loss: 1.2145
Epoch 89, accuracy: 0.7570
Epoch 90, accuracy: 0.7570
Epoch 90, Train Loss: 0.1228, Val Loss: 1.2145
Epoch 91, accuracy: 0.7570
Epoch 92, accuracy: 0.7570
Epoch 92, Train Loss: 0.1875, Val Loss: 1.2145
Epoch 93, accuracy: 0.7570
Epoch 94, accuracy: 0.7570
Epoch 94, Train Loss: 0.1550, Val Loss: 1.2145
Epoch 95, accuracy: 0.7570
Epoch 96, accuracy: 0.7570
Epoch 96, Train Loss: 0.1776, Val Loss: 1.2145
Epoch 97, accuracy: 0.7570
Epoch 98, accuracy: 0.7570
Epoch 98, Train Loss: 0.2032, Val Loss: 1.2145
Epoch 99, accuracy: 0.7570
Epoch 100, accuracy: 0.7570
Epoch 100, Train Loss: 0.1575, Val Loss: 1.2145
Epoch 101, accuracy: 0.7570
Epoch 102, accuracy: 0.7570
Epoch 102, Train Loss: 0.1188, Val Loss: 1.2145
Epoch 103, accuracy: 0.7570
Epoch 104, accuracy: 0.7570
Epoch 104, Train Loss: 0.2335, Val Loss: 1.2145
Epoch 105, accuracy: 0.7570
Epoch 106, accuracy: 0.7570
Epoch 106, Train Loss: 0.1510, Val Loss: 1.2145
Epoch 107, accuracy: 0.7570
Epoch 108, accuracy: 0.7570
Epoch 108, Train Loss: 0.1977, Val Loss: 1.2145
Epoch 109, accuracy: 0.7570
Epoch 110, accuracy: 0.7570
Epoch 110, Train Loss: 0.1670, Val Loss: 1.2145
Epoch 111, accuracy: 0.7570
Epoch 112, accuracy: 0.7570
Epoch 112, Train Loss: 0.1926, Val Loss: 1.2145
Epoch 113, accuracy: 0.7570
Epoch 114, accuracy: 0.7570
Epoch 114, Train Loss: 0.1809, Val Loss: 1.2145
Epoch 115, accuracy: 0.7570
Epoch 116, accuracy: 0.7570
Epoch 116, Train Loss: 0.1591, Val Loss: 1.2145
Epoch 117, accuracy: 0.7570
Epoch 118, accuracy: 0.7570
Epoch 118, Train Loss: 0.1488, Val Loss: 1.2145
Epoch 119, accuracy: 0.7570
Epoch 120, accuracy: 0.7570
Epoch 120, Train Loss: 0.1616, Val Loss: 1.2145
Epoch 121, accuracy: 0.7570
Epoch 122, accuracy: 0.7570
Epoch 122, Train Loss: 0.2260, Val Loss: 1.2145
Epoch 123, accuracy: 0.7570
Epoch 124, accuracy: 0.7570
Epoch 124, Train Loss: 0.1695, Val Loss: 1.2145
Epoch 125, accuracy: 0.7570
Epoch 126, accuracy: 0.7570
Epoch 126, Train Loss: 0.1663, Val Loss: 1.2145
Epoch 127, accuracy: 0.7570
Epoch 128, accuracy: 0.7570
Epoch 128, Train Loss: 0.1903, Val Loss: 1.2145
Epoch 129, accuracy: 0.7570
Epoch 130, accuracy: 0.7570
Epoch 130, Train Loss: 0.2095, Val Loss: 1.2145
Epoch 131, accuracy: 0.7570
Epoch 132, accuracy: 0.7570
Epoch 132, Train Loss: 0.1842, Val Loss: 1.2145
Epoch 133, accuracy: 0.7570
Epoch 134, accuracy: 0.7570
Epoch 134, Train Loss: 0.2292, Val Loss: 1.2145
Epoch 135, accuracy: 0.7570
Epoch 136, accuracy: 0.7570
Epoch 136, Train Loss: 0.1598, Val Loss: 1.2145
Epoch 137, accuracy: 0.7570
Epoch 138, accuracy: 0.7570
Epoch 138, Train Loss: 0.2021, Val Loss: 1.2145
Epoch 139, accuracy: 0.7570
Epoch 140, accuracy: 0.7570
Epoch 140, Train Loss: 0.1939, Val Loss: 1.2145
Epoch 141, accuracy: 0.7570
Epoch 142, accuracy: 0.7570
Epoch 142, Train Loss: 0.1166, Val Loss: 1.2145
Epoch 143, accuracy: 0.7570
Epoch 144, accuracy: 0.7570
Epoch 144, Train Loss: 0.2393, Val Loss: 1.2145
Epoch 145, accuracy: 0.7570
Epoch 146, accuracy: 0.7570
Epoch 146, Train Loss: 0.2615, Val Loss: 1.2145
Epoch 147, accuracy: 0.7570
Epoch 148, accuracy: 0.7570
Epoch 148, Train Loss: 0.1860, Val Loss: 1.2145
Epoch 149, accuracy: 0.7570
Epoch 150, accuracy: 0.7570
Epoch 150, Train Loss: 0.1894, Val Loss: 1.2145
Epoch 151, accuracy: 0.7570
Epoch 152, accuracy: 0.7570
Epoch 152, Train Loss: 0.1830, Val Loss: 1.2145
Epoch 153, accuracy: 0.7570
Epoch 154, accuracy: 0.7570
Epoch 154, Train Loss: 0.1389, Val Loss: 1.2145
Epoch 155, accuracy: 0.7570
Epoch 156, accuracy: 0.7570
Epoch 156, Train Loss: 0.2500, Val Loss: 1.2145
Epoch 157, accuracy: 0.7570
Epoch 158, accuracy: 0.7570
Epoch 158, Train Loss: 0.1421, Val Loss: 1.2145
Epoch 159, accuracy: 0.7570
Epoch 160, accuracy: 0.7570
Epoch 160, Train Loss: 0.1507, Val Loss: 1.2145
Epoch 161, accuracy: 0.7570
Epoch 162, accuracy: 0.7570
Epoch 162, Train Loss: 0.1468, Val Loss: 1.2145
Epoch 163, accuracy: 0.7570
Epoch 164, accuracy: 0.7570
Epoch 164, Train Loss: 0.1790, Val Loss: 1.2145
Epoch 165, accuracy: 0.7570
Epoch 166, accuracy: 0.7570
Epoch 166, Train Loss: 0.1846, Val Loss: 1.2145
Epoch 167, accuracy: 0.7570
Epoch 168, accuracy: 0.7570
Epoch 168, Train Loss: 0.1215, Val Loss: 1.2145
Epoch 169, accuracy: 0.7570
Epoch 170, accuracy: 0.7570
Epoch 170, Train Loss: 0.1733, Val Loss: 1.2145
Epoch 171, accuracy: 0.7570
Epoch 172, accuracy: 0.7570
Epoch 172, Train Loss: 0.1678, Val Loss: 1.2145
Epoch 173, accuracy: 0.7570
Epoch 174, accuracy: 0.7570
Epoch 174, Train Loss: 0.1543, Val Loss: 1.2145
Epoch 175, accuracy: 0.7570
Epoch 176, accuracy: 0.7570
Epoch 176, Train Loss: 0.2106, Val Loss: 1.2145
Epoch 177, accuracy: 0.7570
Epoch 178, accuracy: 0.7570
Epoch 178, Train Loss: 0.1491, Val Loss: 1.2145
Epoch 179, accuracy: 0.7570
Epoch 180, accuracy: 0.7570
Epoch 180, Train Loss: 0.2272, Val Loss: 1.2145
Epoch 181, accuracy: 0.7570
Epoch 182, accuracy: 0.7570
Epoch 182, Train Loss: 0.1818, Val Loss: 1.2145
Epoch 183, accuracy: 0.7570
Epoch 184, accuracy: 0.7570
Epoch 184, Train Loss: 0.2385, Val Loss: 1.2145
Epoch 185, accuracy: 0.7570
Epoch 186, accuracy: 0.7570
Epoch 186, Train Loss: 0.1973, Val Loss: 1.2145
Epoch 187, accuracy: 0.7570
Epoch 188, accuracy: 0.7570
Epoch 188, Train Loss: 0.2658, Val Loss: 1.2145
Epoch 189, accuracy: 0.7570
Epoch 190, accuracy: 0.7570
Epoch 190, Train Loss: 0.1354, Val Loss: 1.2145
Epoch 191, accuracy: 0.7570
Epoch 192, accuracy: 0.7570
Epoch 192, Train Loss: 0.1726, Val Loss: 1.2145
Epoch 193, accuracy: 0.7570
Epoch 194, accuracy: 0.7570
Epoch 194, Train Loss: 0.2196, Val Loss: 1.2145
Epoch 195, accuracy: 0.7570
Epoch 196, accuracy: 0.7570
Epoch 196, Train Loss: 0.2466, Val Loss: 1.2145
Epoch 197, accuracy: 0.7570
Epoch 198, accuracy: 0.7570
Epoch 198, Train Loss: 0.1980, Val Loss: 1.2145
Epoch 199, accuracy: 0.7570
Loaded best model with val_loss = 0.9669360518455505
test :accuracy 0.7690, f1_macro: 0.7632, f1_micro: 0.7690, auc: 0.9466
Training mamba3 with 7 layers...
可训练参数: 1248173_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.5289
Epoch 0, accuracy: 0.4820
Epoch 0, Train Loss: 2.0591, Val Loss: 1.5289
✅ Epoch 1: New best model saved with val_loss = 1.2912
Epoch 1, accuracy: 0.3920
✅ Epoch 2: New best model saved with val_loss = 1.2115
Epoch 2, accuracy: 0.5480
Epoch 2, Train Loss: 1.1051, Val Loss: 1.2115
✅ Epoch 3: New best model saved with val_loss = 1.1843
Epoch 3, accuracy: 0.5450
✅ Epoch 4: New best model saved with val_loss = 1.0669
Epoch 4, accuracy: 0.6090
Epoch 4, Train Loss: 0.8401, Val Loss: 1.0669
✅ Epoch 5: New best model saved with val_loss = 1.0119
Epoch 5, accuracy: 0.6800
Epoch 6, accuracy: 0.6960
Epoch 6, Train Loss: 0.5653, Val Loss: 1.0287
Epoch 7, accuracy: 0.7050
Epoch 8, accuracy: 0.7190
Epoch 8, Train Loss: 0.5521, Val Loss: 1.0308
Epoch 9, accuracy: 0.7090
Epoch 10, accuracy: 0.6980
Epoch 10, Train Loss: 0.5170, Val Loss: 1.1135
Epoch 11, accuracy: 0.6890
Epoch 12, accuracy: 0.6880
Epoch 12, Train Loss: 0.4242, Val Loss: 1.1651
Epoch 13, accuracy: 0.6880
Epoch 14, accuracy: 0.6900
Epoch 14, Train Loss: 0.3960, Val Loss: 1.1663
Epoch 15, accuracy: 0.6930
Epoch 16, accuracy: 0.6950
Epoch 16, Train Loss: 0.3627, Val Loss: 1.1583
Epoch 17, accuracy: 0.6990
Epoch 18, accuracy: 0.7000
Epoch 18, Train Loss: 0.2881, Val Loss: 1.1556
Epoch 19, accuracy: 0.7000
Epoch 20, accuracy: 0.7000
Epoch 20, Train Loss: 0.3661, Val Loss: 1.1549
Epoch 21, accuracy: 0.7010
Epoch 22, accuracy: 0.7010
Epoch 22, Train Loss: 0.4275, Val Loss: 1.1545
Epoch 23, accuracy: 0.7010
Epoch 24, accuracy: 0.7010
Epoch 24, Train Loss: 0.3899, Val Loss: 1.1543
Epoch 25, accuracy: 0.7010
Epoch 26, accuracy: 0.7010
Epoch 26, Train Loss: 0.4619, Val Loss: 1.1542
Epoch 27, accuracy: 0.7010
Epoch 28, accuracy: 0.7010
Epoch 28, Train Loss: 0.3551, Val Loss: 1.1541
Epoch 29, accuracy: 0.7010
Epoch 30, accuracy: 0.7010
Epoch 30, Train Loss: 0.4974, Val Loss: 1.1540
Epoch 31, accuracy: 0.7010
Epoch 32, accuracy: 0.7010
Epoch 32, Train Loss: 0.4057, Val Loss: 1.1540
Epoch 33, accuracy: 0.7010
Epoch 34, accuracy: 0.7010
Epoch 34, Train Loss: 0.3683, Val Loss: 1.1539
Epoch 35, accuracy: 0.7000
Epoch 36, accuracy: 0.7000
Epoch 36, Train Loss: 0.3999, Val Loss: 1.1539
Epoch 37, accuracy: 0.7000
Epoch 38, accuracy: 0.7000
Epoch 38, Train Loss: 0.3668, Val Loss: 1.1539
Epoch 39, accuracy: 0.7000
Epoch 40, accuracy: 0.7000
Epoch 40, Train Loss: 0.3991, Val Loss: 1.1539
Epoch 41, accuracy: 0.7000
Epoch 42, accuracy: 0.7000
Epoch 42, Train Loss: 0.3484, Val Loss: 1.1539
Epoch 43, accuracy: 0.7000
Epoch 44, accuracy: 0.7000
Epoch 44, Train Loss: 0.4726, Val Loss: 1.1539
Epoch 45, accuracy: 0.7000
Epoch 46, accuracy: 0.7000
Epoch 46, Train Loss: 0.3531, Val Loss: 1.1539
Epoch 47, accuracy: 0.7000
Epoch 48, accuracy: 0.7000
Epoch 48, Train Loss: 0.3677, Val Loss: 1.1539
Epoch 49, accuracy: 0.7000
Epoch 50, accuracy: 0.7000
Epoch 50, Train Loss: 0.3855, Val Loss: 1.1539
Epoch 51, accuracy: 0.7000
Epoch 52, accuracy: 0.7000
Epoch 52, Train Loss: 0.3856, Val Loss: 1.1539
Epoch 53, accuracy: 0.7000
Epoch 54, accuracy: 0.7000
Epoch 54, Train Loss: 0.4630, Val Loss: 1.1539
Epoch 55, accuracy: 0.7000
Epoch 56, accuracy: 0.7000
Epoch 56, Train Loss: 0.3574, Val Loss: 1.1539
Epoch 57, accuracy: 0.7000
Epoch 58, accuracy: 0.7000
Epoch 58, Train Loss: 0.4090, Val Loss: 1.1539
Epoch 59, accuracy: 0.7000
Epoch 60, accuracy: 0.7000
Epoch 60, Train Loss: 0.3877, Val Loss: 1.1539
Epoch 61, accuracy: 0.7000
Epoch 62, accuracy: 0.7000
Epoch 62, Train Loss: 0.3469, Val Loss: 1.1539
Epoch 63, accuracy: 0.7000
Epoch 64, accuracy: 0.7000
Epoch 64, Train Loss: 0.3098, Val Loss: 1.1539
Epoch 65, accuracy: 0.7000
Epoch 66, accuracy: 0.7000
Epoch 66, Train Loss: 0.4287, Val Loss: 1.1539
Epoch 67, accuracy: 0.7000
Epoch 68, accuracy: 0.7000
Epoch 68, Train Loss: 0.4267, Val Loss: 1.1539
Epoch 69, accuracy: 0.7000
Epoch 70, accuracy: 0.7000
Epoch 70, Train Loss: 0.4225, Val Loss: 1.1539
Epoch 71, accuracy: 0.7000
Epoch 72, accuracy: 0.7000
Epoch 72, Train Loss: 0.4583, Val Loss: 1.1539
Epoch 73, accuracy: 0.7000
Epoch 74, accuracy: 0.7000
Epoch 74, Train Loss: 0.3352, Val Loss: 1.1539
Epoch 75, accuracy: 0.7000
Epoch 76, accuracy: 0.7000
Epoch 76, Train Loss: 0.4149, Val Loss: 1.1539
Epoch 77, accuracy: 0.7000
Epoch 78, accuracy: 0.7000
Epoch 78, Train Loss: 0.4036, Val Loss: 1.1539
Epoch 79, accuracy: 0.7000
Epoch 80, accuracy: 0.7000
Epoch 80, Train Loss: 0.4017, Val Loss: 1.1539
Epoch 81, accuracy: 0.7000
Epoch 82, accuracy: 0.7000
Epoch 82, Train Loss: 0.4193, Val Loss: 1.1539
Epoch 83, accuracy: 0.7000
Epoch 84, accuracy: 0.7000
Epoch 84, Train Loss: 0.3926, Val Loss: 1.1539
Epoch 85, accuracy: 0.7000
Epoch 86, accuracy: 0.7000
Epoch 86, Train Loss: 0.4142, Val Loss: 1.1539
Epoch 87, accuracy: 0.7000
Epoch 88, accuracy: 0.7000
Epoch 88, Train Loss: 0.3716, Val Loss: 1.1539
Epoch 89, accuracy: 0.7000
Epoch 90, accuracy: 0.7000
Epoch 90, Train Loss: 0.4916, Val Loss: 1.1539
Epoch 91, accuracy: 0.7000
Epoch 92, accuracy: 0.7000
Epoch 92, Train Loss: 0.4081, Val Loss: 1.1539
Epoch 93, accuracy: 0.7000
Epoch 94, accuracy: 0.7000
Epoch 94, Train Loss: 0.3478, Val Loss: 1.1539
Epoch 95, accuracy: 0.7000
Epoch 96, accuracy: 0.7000
Epoch 96, Train Loss: 0.3481, Val Loss: 1.1539
Epoch 97, accuracy: 0.7000
Epoch 98, accuracy: 0.7000
Epoch 98, Train Loss: 0.3666, Val Loss: 1.1539
Epoch 99, accuracy: 0.7000
Epoch 100, accuracy: 0.7000
Epoch 100, Train Loss: 0.3897, Val Loss: 1.1539
Epoch 101, accuracy: 0.7000
Epoch 102, accuracy: 0.7000
Epoch 102, Train Loss: 0.3440, Val Loss: 1.1539
Epoch 103, accuracy: 0.7000
Epoch 104, accuracy: 0.7000
Epoch 104, Train Loss: 0.3840, Val Loss: 1.1539
Epoch 105, accuracy: 0.7000
Epoch 106, accuracy: 0.7000
Epoch 106, Train Loss: 0.4681, Val Loss: 1.1539
Epoch 107, accuracy: 0.7000
Epoch 108, accuracy: 0.7000
Epoch 108, Train Loss: 0.3991, Val Loss: 1.1539
Epoch 109, accuracy: 0.7000
Epoch 110, accuracy: 0.7000
Epoch 110, Train Loss: 0.3398, Val Loss: 1.1539
Epoch 111, accuracy: 0.7000
Epoch 112, accuracy: 0.7000
Epoch 112, Train Loss: 0.3705, Val Loss: 1.1539
Epoch 113, accuracy: 0.7000
Epoch 114, accuracy: 0.7000
Epoch 114, Train Loss: 0.4079, Val Loss: 1.1539
Epoch 115, accuracy: 0.7000
Epoch 116, accuracy: 0.7000
Epoch 116, Train Loss: 0.3916, Val Loss: 1.1539
Epoch 117, accuracy: 0.7000
Epoch 118, accuracy: 0.7000
Epoch 118, Train Loss: 0.4196, Val Loss: 1.1539
Epoch 119, accuracy: 0.7000
Epoch 120, accuracy: 0.7000
Epoch 120, Train Loss: 0.3387, Val Loss: 1.1539
Epoch 121, accuracy: 0.7000
Epoch 122, accuracy: 0.7000
Epoch 122, Train Loss: 0.4415, Val Loss: 1.1539
Epoch 123, accuracy: 0.7000
Epoch 124, accuracy: 0.7000
Epoch 124, Train Loss: 0.3965, Val Loss: 1.1539
Epoch 125, accuracy: 0.7000
Epoch 126, accuracy: 0.7000
Epoch 126, Train Loss: 0.3000, Val Loss: 1.1539
Epoch 127, accuracy: 0.7000
Epoch 128, accuracy: 0.7000
Epoch 128, Train Loss: 0.3947, Val Loss: 1.1539
Epoch 129, accuracy: 0.7000
Epoch 130, accuracy: 0.7000
Epoch 130, Train Loss: 0.3480, Val Loss: 1.1539
Epoch 131, accuracy: 0.7000
Epoch 132, accuracy: 0.7000
Epoch 132, Train Loss: 0.3677, Val Loss: 1.1539
Epoch 133, accuracy: 0.7000
Epoch 134, accuracy: 0.7000
Epoch 134, Train Loss: 0.4115, Val Loss: 1.1539
Epoch 135, accuracy: 0.7000
Epoch 136, accuracy: 0.7000
Epoch 136, Train Loss: 0.4576, Val Loss: 1.1539
Epoch 137, accuracy: 0.7000
Epoch 138, accuracy: 0.7000
Epoch 138, Train Loss: 0.4310, Val Loss: 1.1539
Epoch 139, accuracy: 0.7000
Epoch 140, accuracy: 0.7000
Epoch 140, Train Loss: 0.3798, Val Loss: 1.1539
Epoch 141, accuracy: 0.7000
Epoch 142, accuracy: 0.7000
Epoch 142, Train Loss: 0.4275, Val Loss: 1.1539
Epoch 143, accuracy: 0.7000
Epoch 144, accuracy: 0.7000
Epoch 144, Train Loss: 0.3531, Val Loss: 1.1539
Epoch 145, accuracy: 0.7000
Epoch 146, accuracy: 0.7000
Epoch 146, Train Loss: 0.4660, Val Loss: 1.1539
Epoch 147, accuracy: 0.7000
Epoch 148, accuracy: 0.7000
Epoch 148, Train Loss: 0.3343, Val Loss: 1.1539
Epoch 149, accuracy: 0.7000
Epoch 150, accuracy: 0.7000
Epoch 150, Train Loss: 0.3853, Val Loss: 1.1539
Epoch 151, accuracy: 0.7000
Epoch 152, accuracy: 0.7000
Epoch 152, Train Loss: 0.4320, Val Loss: 1.1539
Epoch 153, accuracy: 0.7000
Epoch 154, accuracy: 0.7000
Epoch 154, Train Loss: 0.4906, Val Loss: 1.1539
Epoch 155, accuracy: 0.7000
Epoch 156, accuracy: 0.7000
Epoch 156, Train Loss: 0.4106, Val Loss: 1.1539
Epoch 157, accuracy: 0.7000
Epoch 158, accuracy: 0.7000
Epoch 158, Train Loss: 0.4268, Val Loss: 1.1539
Epoch 159, accuracy: 0.7000
Epoch 160, accuracy: 0.7000
Epoch 160, Train Loss: 0.3209, Val Loss: 1.1539
Epoch 161, accuracy: 0.7000
Epoch 162, accuracy: 0.7000
Epoch 162, Train Loss: 0.3740, Val Loss: 1.1539
Epoch 163, accuracy: 0.7000
Epoch 164, accuracy: 0.7000
Epoch 164, Train Loss: 0.3644, Val Loss: 1.1539
Epoch 165, accuracy: 0.7000
Epoch 166, accuracy: 0.7000
Epoch 166, Train Loss: 0.3657, Val Loss: 1.1539
Epoch 167, accuracy: 0.7000
Epoch 168, accuracy: 0.7000
Epoch 168, Train Loss: 0.4285, Val Loss: 1.1539
Epoch 169, accuracy: 0.7000
Epoch 170, accuracy: 0.7000
Epoch 170, Train Loss: 0.3639, Val Loss: 1.1539
Epoch 171, accuracy: 0.7000
Epoch 172, accuracy: 0.7000
Epoch 172, Train Loss: 0.3947, Val Loss: 1.1539
Epoch 173, accuracy: 0.7000
Epoch 174, accuracy: 0.7000
Epoch 174, Train Loss: 0.3585, Val Loss: 1.1539
Epoch 175, accuracy: 0.7000
Epoch 176, accuracy: 0.7000
Epoch 176, Train Loss: 0.4499, Val Loss: 1.1539
Epoch 177, accuracy: 0.7000
Epoch 178, accuracy: 0.7000
Epoch 178, Train Loss: 0.3571, Val Loss: 1.1539
Epoch 179, accuracy: 0.7000
Epoch 180, accuracy: 0.7000
Epoch 180, Train Loss: 0.4248, Val Loss: 1.1539
Epoch 181, accuracy: 0.7000
Epoch 182, accuracy: 0.7000
Epoch 182, Train Loss: 0.2956, Val Loss: 1.1539
Epoch 183, accuracy: 0.7000
Epoch 184, accuracy: 0.7000
Epoch 184, Train Loss: 0.3407, Val Loss: 1.1539
Epoch 185, accuracy: 0.7000
Epoch 186, accuracy: 0.7000
Epoch 186, Train Loss: 0.3312, Val Loss: 1.1539
Epoch 187, accuracy: 0.7000
Epoch 188, accuracy: 0.7000
Epoch 188, Train Loss: 0.3679, Val Loss: 1.1539
Epoch 189, accuracy: 0.7000
Epoch 190, accuracy: 0.7000
Epoch 190, Train Loss: 0.3954, Val Loss: 1.1539
Epoch 191, accuracy: 0.7000
Epoch 192, accuracy: 0.7000
Epoch 192, Train Loss: 0.3773, Val Loss: 1.1539
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
/root/miniconda3/lib/python3.12/site-packages/torch_geometric/sampler/neighbor_sampler.py:61: UserWarning: Using 'NeighborSampler' without a 'pyg-lib' installation is deprecated and will be removed soon. Please install 'pyg-lib' for accelerated neighborhood sampling
  warnings.warn(f"Using '{self.__class__.__name__}' without a "
Epoch 193, accuracy: 0.7000
Epoch 194, accuracy: 0.7000
Epoch 194, Train Loss: 0.4453, Val Loss: 1.1539
Epoch 195, accuracy: 0.7000
Epoch 196, accuracy: 0.7000
Epoch 196, Train Loss: 0.3238, Val Loss: 1.1539
Epoch 197, accuracy: 0.7000
Epoch 198, accuracy: 0.7000
Epoch 198, Train Loss: 0.4644, Val Loss: 1.1539
Epoch 199, accuracy: 0.7000
Loaded best model with val_loss = 1.0119355916976929
test :accuracy 0.6800, f1_macro: 0.6839, f1_micro: 0.6800, auc: 0.9228
Final Results: {'GAT_3_Cora': np.float64(0.808), 'GAT_4_Cora': np.float64(0.807), 'GAT_5_Cora': np.float64(0.742), 'GAT_6_Cora': np.float64(0.766), 'GAT_7_Cora': np.float64(0.672), 'mamba3_3_Cora': np.float64(0.791), 'mamba3_4_Cora': np.float64(0.725), 'mamba3_5_Cora': np.float64(0.776), 'mamba3_6_Cora': np.float64(0.769), 'mamba3_7_Cora': np.float64(0.68)} ['707363_GAT_0', '856867_GAT_0', '1006371_GAT_0', '1155875_GAT_0', '1305379_GAT_0', '915885_mamba3_0', '998957_mamba3_0', '1082029_mamba3_0', '1165101_mamba3_0', '1248173_mamba3_0']
GAT_3_Cora: Accuracy = 0.8037 ± 0.0038
GAT_4_Cora: Accuracy = 0.7833 ± 0.0276
GAT_5_Cora: Accuracy = 0.7700 ± 0.0252
GAT_6_Cora: Accuracy = 0.7733 ± 0.0297
GAT_7_Cora: Accuracy = 0.6723 ± 0.0075
mamba3_3_Cora: Accuracy = 0.7783 ± 0.0142
mamba3_4_Cora: Accuracy = 0.7580 ± 0.0286
mamba3_5_Cora: Accuracy = 0.7807 ± 0.0064
mamba3_6_Cora: Accuracy = 0.7813 ± 0.0108
mamba3_7_Cora: Accuracy = 0.7550 ± 0.0655
========== Running baseline 1/3 ==========
Training GAT with 3 layers...
可训练参数: 1578142_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.6731
Epoch 0, accuracy: 0.6240
Epoch 0, Train Loss: 1.8054, Val Loss: 1.6731
✅ Epoch 1: New best model saved with val_loss = 1.4164
Epoch 1, accuracy: 0.6760
✅ Epoch 2: New best model saved with val_loss = 1.0661
Epoch 2, accuracy: 0.6880
Epoch 2, Train Loss: 1.0421, Val Loss: 1.0661
✅ Epoch 3: New best model saved with val_loss = 0.9268
Epoch 3, accuracy: 0.7010
Epoch 4, accuracy: 0.6530
Epoch 4, Train Loss: 0.1762, Val Loss: 1.1817
Epoch 5, accuracy: 0.6610
Epoch 6, accuracy: 0.6280
Epoch 6, Train Loss: 0.0900, Val Loss: 1.8280
Epoch 7, accuracy: 0.5990
Epoch 8, accuracy: 0.5540
Epoch 8, Train Loss: 0.0859, Val Loss: 2.7404
Epoch 9, accuracy: 0.5190
Epoch 10, accuracy: 0.5200
Epoch 10, Train Loss: 0.0362, Val Loss: 3.2074
Epoch 11, accuracy: 0.5260
Epoch 12, accuracy: 0.5310
Epoch 12, Train Loss: 0.0193, Val Loss: 3.2211
Epoch 13, accuracy: 0.5370
Epoch 14, accuracy: 0.5480
Epoch 14, Train Loss: 0.0332, Val Loss: 3.1654
Epoch 15, accuracy: 0.5540
Epoch 16, accuracy: 0.5540
Epoch 16, Train Loss: 0.0267, Val Loss: 3.1131
Epoch 17, accuracy: 0.5540
Epoch 18, accuracy: 0.5540
Epoch 18, Train Loss: 0.0128, Val Loss: 3.1016
Epoch 19, accuracy: 0.5570
Epoch 20, accuracy: 0.5580
Epoch 20, Train Loss: 0.0067, Val Loss: 3.0899
Epoch 21, accuracy: 0.5610
Epoch 22, accuracy: 0.5610
Epoch 22, Train Loss: 0.0162, Val Loss: 3.0837
Epoch 23, accuracy: 0.5610
Epoch 24, accuracy: 0.5610
Epoch 24, Train Loss: 0.0201, Val Loss: 3.0825
Epoch 25, accuracy: 0.5610
Epoch 26, accuracy: 0.5620
Epoch 26, Train Loss: 0.0147, Val Loss: 3.0811
Epoch 27, accuracy: 0.5620
Epoch 28, accuracy: 0.5620
Epoch 28, Train Loss: 0.0073, Val Loss: 3.0802
Epoch 29, accuracy: 0.5620
Epoch 30, accuracy: 0.5620
Epoch 30, Train Loss: 0.0113, Val Loss: 3.0800
Epoch 31, accuracy: 0.5620
Epoch 32, accuracy: 0.5620
Epoch 32, Train Loss: 0.0250, Val Loss: 3.0798
Epoch 33, accuracy: 0.5610
Epoch 34, accuracy: 0.5610
Epoch 34, Train Loss: 0.0294, Val Loss: 3.0797
Epoch 35, accuracy: 0.5610
Epoch 36, accuracy: 0.5610
Epoch 36, Train Loss: 0.0173, Val Loss: 3.0797
Epoch 37, accuracy: 0.5610
Epoch 38, accuracy: 0.5610
Epoch 38, Train Loss: 0.0130, Val Loss: 3.0796
Epoch 39, accuracy: 0.5610
Epoch 40, accuracy: 0.5610
Epoch 40, Train Loss: 0.0151, Val Loss: 3.0796
Epoch 41, accuracy: 0.5610
Epoch 42, accuracy: 0.5610
Epoch 42, Train Loss: 0.0270, Val Loss: 3.0796
Epoch 43, accuracy: 0.5610
Epoch 44, accuracy: 0.5610
Epoch 44, Train Loss: 0.0238, Val Loss: 3.0796
Epoch 45, accuracy: 0.5610
Epoch 46, accuracy: 0.5610
Epoch 46, Train Loss: 0.0319, Val Loss: 3.0796
Epoch 47, accuracy: 0.5610
Epoch 48, accuracy: 0.5610
Epoch 48, Train Loss: 0.0141, Val Loss: 3.0796
Epoch 49, accuracy: 0.5610
Epoch 50, accuracy: 0.5610
Epoch 50, Train Loss: 0.0115, Val Loss: 3.0796
Epoch 51, accuracy: 0.5610
Epoch 52, accuracy: 0.5610
Epoch 52, Train Loss: 0.0092, Val Loss: 3.0796
Epoch 53, accuracy: 0.5610
Epoch 54, accuracy: 0.5610
Epoch 54, Train Loss: 0.0099, Val Loss: 3.0796
Epoch 55, accuracy: 0.5610
Epoch 56, accuracy: 0.5610
Epoch 56, Train Loss: 0.0200, Val Loss: 3.0796
Epoch 57, accuracy: 0.5610
Epoch 58, accuracy: 0.5610
Epoch 58, Train Loss: 0.0084, Val Loss: 3.0796
Epoch 59, accuracy: 0.5610
Epoch 60, accuracy: 0.5610
Epoch 60, Train Loss: 0.0232, Val Loss: 3.0796
Epoch 61, accuracy: 0.5610
Epoch 62, accuracy: 0.5610
Epoch 62, Train Loss: 0.0084, Val Loss: 3.0796
Epoch 63, accuracy: 0.5610
Epoch 64, accuracy: 0.5610
Epoch 64, Train Loss: 0.0357, Val Loss: 3.0796
Epoch 65, accuracy: 0.5610
Epoch 66, accuracy: 0.5610
Epoch 66, Train Loss: 0.0111, Val Loss: 3.0796
Epoch 67, accuracy: 0.5610
Epoch 68, accuracy: 0.5610
Epoch 68, Train Loss: 0.0129, Val Loss: 3.0796
Epoch 69, accuracy: 0.5610
Epoch 70, accuracy: 0.5610
Epoch 70, Train Loss: 0.0092, Val Loss: 3.0796
Epoch 71, accuracy: 0.5610
Epoch 72, accuracy: 0.5610
Epoch 72, Train Loss: 0.0188, Val Loss: 3.0796
Epoch 73, accuracy: 0.5610
Epoch 74, accuracy: 0.5610
Epoch 74, Train Loss: 0.0124, Val Loss: 3.0796
Epoch 75, accuracy: 0.5610
Epoch 76, accuracy: 0.5610
Epoch 76, Train Loss: 0.0450, Val Loss: 3.0796
Epoch 77, accuracy: 0.5610
Epoch 78, accuracy: 0.5610
Epoch 78, Train Loss: 0.0135, Val Loss: 3.0796
Epoch 79, accuracy: 0.5610
Epoch 80, accuracy: 0.5610
Epoch 80, Train Loss: 0.0100, Val Loss: 3.0796
Epoch 81, accuracy: 0.5610
Epoch 82, accuracy: 0.5610
Epoch 82, Train Loss: 0.0231, Val Loss: 3.0796
Epoch 83, accuracy: 0.5610
Epoch 84, accuracy: 0.5610
Epoch 84, Train Loss: 0.0164, Val Loss: 3.0796
Epoch 85, accuracy: 0.5610
Epoch 86, accuracy: 0.5610
Epoch 86, Train Loss: 0.0185, Val Loss: 3.0796
Epoch 87, accuracy: 0.5610
Epoch 88, accuracy: 0.5610
Epoch 88, Train Loss: 0.0215, Val Loss: 3.0796
Epoch 89, accuracy: 0.5610
Epoch 90, accuracy: 0.5610
Epoch 90, Train Loss: 0.0238, Val Loss: 3.0796
Epoch 91, accuracy: 0.5610
Epoch 92, accuracy: 0.5610
Epoch 92, Train Loss: 0.0089, Val Loss: 3.0796
Epoch 93, accuracy: 0.5610
Epoch 94, accuracy: 0.5610
Epoch 94, Train Loss: 0.0106, Val Loss: 3.0796
Epoch 95, accuracy: 0.5610
Epoch 96, accuracy: 0.5610
Epoch 96, Train Loss: 0.0154, Val Loss: 3.0796
Epoch 97, accuracy: 0.5610
Epoch 98, accuracy: 0.5610
Epoch 98, Train Loss: 0.0248, Val Loss: 3.0796
Epoch 99, accuracy: 0.5610
Epoch 100, accuracy: 0.5610
Epoch 100, Train Loss: 0.0225, Val Loss: 3.0796
Epoch 101, accuracy: 0.5610
Epoch 102, accuracy: 0.5610
Epoch 102, Train Loss: 0.0091, Val Loss: 3.0796
Epoch 103, accuracy: 0.5610
Epoch 104, accuracy: 0.5610
Epoch 104, Train Loss: 0.0160, Val Loss: 3.0796
Epoch 105, accuracy: 0.5610
Epoch 106, accuracy: 0.5610
Epoch 106, Train Loss: 0.0178, Val Loss: 3.0796
Epoch 107, accuracy: 0.5610
Epoch 108, accuracy: 0.5610
Epoch 108, Train Loss: 0.0090, Val Loss: 3.0796
Epoch 109, accuracy: 0.5610
Epoch 110, accuracy: 0.5610
Epoch 110, Train Loss: 0.0125, Val Loss: 3.0796
Epoch 111, accuracy: 0.5610
Epoch 112, accuracy: 0.5610
Epoch 112, Train Loss: 0.0143, Val Loss: 3.0796
Epoch 113, accuracy: 0.5610
Epoch 114, accuracy: 0.5610
Epoch 114, Train Loss: 0.0183, Val Loss: 3.0796
Epoch 115, accuracy: 0.5610
Epoch 116, accuracy: 0.5610
Epoch 116, Train Loss: 0.0153, Val Loss: 3.0796
Epoch 117, accuracy: 0.5610
Epoch 118, accuracy: 0.5610
Epoch 118, Train Loss: 0.0113, Val Loss: 3.0796
Epoch 119, accuracy: 0.5610
Epoch 120, accuracy: 0.5610
Epoch 120, Train Loss: 0.0117, Val Loss: 3.0795
Epoch 121, accuracy: 0.5610
Epoch 122, accuracy: 0.5610
Epoch 122, Train Loss: 0.0239, Val Loss: 3.0795
Epoch 123, accuracy: 0.5610
Epoch 124, accuracy: 0.5610
Epoch 124, Train Loss: 0.0301, Val Loss: 3.0795
Epoch 125, accuracy: 0.5610
Epoch 126, accuracy: 0.5610
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 126, Train Loss: 0.0208, Val Loss: 3.0795
Epoch 127, accuracy: 0.5610
Epoch 128, accuracy: 0.5610
Epoch 128, Train Loss: 0.0348, Val Loss: 3.0795
Epoch 129, accuracy: 0.5610
Epoch 130, accuracy: 0.5610
Epoch 130, Train Loss: 0.0198, Val Loss: 3.0795
Epoch 131, accuracy: 0.5610
Epoch 132, accuracy: 0.5610
Epoch 132, Train Loss: 0.0112, Val Loss: 3.0795
Epoch 133, accuracy: 0.5610
Epoch 134, accuracy: 0.5610
Epoch 134, Train Loss: 0.0121, Val Loss: 3.0795
Epoch 135, accuracy: 0.5610
Epoch 136, accuracy: 0.5610
Epoch 136, Train Loss: 0.0149, Val Loss: 3.0795
Epoch 137, accuracy: 0.5610
Epoch 138, accuracy: 0.5610
Epoch 138, Train Loss: 0.0166, Val Loss: 3.0795
Epoch 139, accuracy: 0.5610
Epoch 140, accuracy: 0.5610
Epoch 140, Train Loss: 0.0077, Val Loss: 3.0795
Epoch 141, accuracy: 0.5610
Epoch 142, accuracy: 0.5610
Epoch 142, Train Loss: 0.0178, Val Loss: 3.0795
Epoch 143, accuracy: 0.5610
Epoch 144, accuracy: 0.5610
Epoch 144, Train Loss: 0.0067, Val Loss: 3.0795
Epoch 145, accuracy: 0.5610
Epoch 146, accuracy: 0.5610
Epoch 146, Train Loss: 0.0140, Val Loss: 3.0795
Epoch 147, accuracy: 0.5610
Epoch 148, accuracy: 0.5610
Epoch 148, Train Loss: 0.0132, Val Loss: 3.0795
Epoch 149, accuracy: 0.5610
Epoch 150, accuracy: 0.5610
Epoch 150, Train Loss: 0.0116, Val Loss: 3.0795
Epoch 151, accuracy: 0.5610
Epoch 152, accuracy: 0.5610
Epoch 152, Train Loss: 0.0343, Val Loss: 3.0795
Epoch 153, accuracy: 0.5610
Epoch 154, accuracy: 0.5610
Epoch 154, Train Loss: 0.0162, Val Loss: 3.0795
Epoch 155, accuracy: 0.5610
Epoch 156, accuracy: 0.5610
Epoch 156, Train Loss: 0.0262, Val Loss: 3.0795
Epoch 157, accuracy: 0.5610
Epoch 158, accuracy: 0.5610
Epoch 158, Train Loss: 0.0191, Val Loss: 3.0795
Epoch 159, accuracy: 0.5610
Epoch 160, accuracy: 0.5610
Epoch 160, Train Loss: 0.0126, Val Loss: 3.0795
Epoch 161, accuracy: 0.5610
Epoch 162, accuracy: 0.5610
Epoch 162, Train Loss: 0.0256, Val Loss: 3.0795
Epoch 163, accuracy: 0.5610
Epoch 164, accuracy: 0.5610
Epoch 164, Train Loss: 0.0052, Val Loss: 3.0795
Epoch 165, accuracy: 0.5610
Epoch 166, accuracy: 0.5610
Epoch 166, Train Loss: 0.0089, Val Loss: 3.0795
Epoch 167, accuracy: 0.5610
Epoch 168, accuracy: 0.5610
Epoch 168, Train Loss: 0.0172, Val Loss: 3.0795
Epoch 169, accuracy: 0.5610
Epoch 170, accuracy: 0.5610
Epoch 170, Train Loss: 0.0232, Val Loss: 3.0795
Epoch 171, accuracy: 0.5610
Epoch 172, accuracy: 0.5610
Epoch 172, Train Loss: 0.0112, Val Loss: 3.0795
Epoch 173, accuracy: 0.5610
Epoch 174, accuracy: 0.5610
Epoch 174, Train Loss: 0.0397, Val Loss: 3.0795
Epoch 175, accuracy: 0.5610
Epoch 176, accuracy: 0.5610
Epoch 176, Train Loss: 0.0078, Val Loss: 3.0795
Epoch 177, accuracy: 0.5610
Epoch 178, accuracy: 0.5610
Epoch 178, Train Loss: 0.0291, Val Loss: 3.0795
Epoch 179, accuracy: 0.5610
Epoch 180, accuracy: 0.5610
Epoch 180, Train Loss: 0.0166, Val Loss: 3.0795
Epoch 181, accuracy: 0.5610
Epoch 182, accuracy: 0.5610
Epoch 182, Train Loss: 0.0517, Val Loss: 3.0795
Epoch 183, accuracy: 0.5610
Epoch 184, accuracy: 0.5610
Epoch 184, Train Loss: 0.0104, Val Loss: 3.0795
Epoch 185, accuracy: 0.5610
Epoch 186, accuracy: 0.5610
Epoch 186, Train Loss: 0.0214, Val Loss: 3.0795
Epoch 187, accuracy: 0.5610
Epoch 188, accuracy: 0.5610
Epoch 188, Train Loss: 0.0073, Val Loss: 3.0795
Epoch 189, accuracy: 0.5610
Epoch 190, accuracy: 0.5610
Epoch 190, Train Loss: 0.0249, Val Loss: 3.0795
Epoch 191, accuracy: 0.5610
Epoch 192, accuracy: 0.5610
Epoch 192, Train Loss: 0.0289, Val Loss: 3.0795
Epoch 193, accuracy: 0.5610
Epoch 194, accuracy: 0.5610
Epoch 194, Train Loss: 0.0179, Val Loss: 3.0795
Epoch 195, accuracy: 0.5610
Epoch 196, accuracy: 0.5610
Epoch 196, Train Loss: 0.0196, Val Loss: 3.0795
Epoch 197, accuracy: 0.5610
Epoch 198, accuracy: 0.5610
Epoch 198, Train Loss: 0.0072, Val Loss: 3.0795
Epoch 199, accuracy: 0.5610
Loaded best model with val_loss = 0.9268207550048828
test :accuracy 0.7010, f1_macro: 0.6610, f1_micro: 0.7010, auc: 0.8888
Training GAT with 4 layers...
可训练参数: 1727518_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.7136
Epoch 0, accuracy: 0.5110
Epoch 0, Train Loss: 1.7922, Val Loss: 1.7136
✅ Epoch 1: New best model saved with val_loss = 1.4315
Epoch 1, accuracy: 0.6390
✅ Epoch 2: New best model saved with val_loss = 1.0349
Epoch 2, accuracy: 0.6960
Epoch 2, Train Loss: 1.2265, Val Loss: 1.0349
Epoch 3, accuracy: 0.5880
Epoch 4, accuracy: 0.6720
Epoch 4, Train Loss: 0.2693, Val Loss: 1.4389
Epoch 5, accuracy: 0.6050
Epoch 6, accuracy: 0.5810
Epoch 6, Train Loss: 0.2407, Val Loss: 2.6510
Epoch 7, accuracy: 0.6770
Epoch 8, accuracy: 0.6630
Epoch 8, Train Loss: 0.3372, Val Loss: 2.2641
Epoch 9, accuracy: 0.6650
Epoch 10, accuracy: 0.6620
Epoch 10, Train Loss: 0.1387, Val Loss: 2.3484
Epoch 11, accuracy: 0.6580
Epoch 12, accuracy: 0.6530
Epoch 12, Train Loss: 0.0890, Val Loss: 2.4206
Epoch 13, accuracy: 0.6450
Epoch 14, accuracy: 0.6420
Epoch 14, Train Loss: 0.0861, Val Loss: 2.4909
Epoch 15, accuracy: 0.6410
Epoch 16, accuracy: 0.6420
Epoch 16, Train Loss: 0.0719, Val Loss: 2.4933
Epoch 17, accuracy: 0.6420
Epoch 18, accuracy: 0.6440
Epoch 18, Train Loss: 0.0627, Val Loss: 2.4861
Epoch 19, accuracy: 0.6450
Epoch 20, accuracy: 0.6450
Epoch 20, Train Loss: 0.1034, Val Loss: 2.4729
Epoch 21, accuracy: 0.6450
Epoch 22, accuracy: 0.6470
Epoch 22, Train Loss: 0.0618, Val Loss: 2.4712
Epoch 23, accuracy: 0.6470
Epoch 24, accuracy: 0.6470
Epoch 24, Train Loss: 0.0995, Val Loss: 2.4696
Epoch 25, accuracy: 0.6470
Epoch 26, accuracy: 0.6470
Epoch 26, Train Loss: 0.1205, Val Loss: 2.4681
Epoch 27, accuracy: 0.6470
Epoch 28, accuracy: 0.6470
Epoch 28, Train Loss: 0.0883, Val Loss: 2.4679
Epoch 29, accuracy: 0.6470
Epoch 30, accuracy: 0.6470
Epoch 30, Train Loss: 0.0954, Val Loss: 2.4678
Epoch 31, accuracy: 0.6470
Epoch 32, accuracy: 0.6470
Epoch 32, Train Loss: 0.0778, Val Loss: 2.4676
Epoch 33, accuracy: 0.6470
Epoch 34, accuracy: 0.6470
Epoch 34, Train Loss: 0.0478, Val Loss: 2.4676
Epoch 35, accuracy: 0.6470
Epoch 36, accuracy: 0.6470
Epoch 36, Train Loss: 0.0849, Val Loss: 2.4675
Epoch 37, accuracy: 0.6470
Epoch 38, accuracy: 0.6470
Epoch 38, Train Loss: 0.0664, Val Loss: 2.4675
Epoch 39, accuracy: 0.6470
Epoch 40, accuracy: 0.6470
Epoch 40, Train Loss: 0.1064, Val Loss: 2.4675
Epoch 41, accuracy: 0.6470
Epoch 42, accuracy: 0.6470
Epoch 42, Train Loss: 0.0489, Val Loss: 2.4675
Epoch 43, accuracy: 0.6470
Epoch 44, accuracy: 0.6470
Epoch 44, Train Loss: 0.0721, Val Loss: 2.4675
Epoch 45, accuracy: 0.6470
Epoch 46, accuracy: 0.6470
Epoch 46, Train Loss: 0.1245, Val Loss: 2.4675
Epoch 47, accuracy: 0.6470
Epoch 48, accuracy: 0.6470
Epoch 48, Train Loss: 0.0674, Val Loss: 2.4675
Epoch 49, accuracy: 0.6470
Epoch 50, accuracy: 0.6470
Epoch 50, Train Loss: 0.0443, Val Loss: 2.4675
Epoch 51, accuracy: 0.6470
Epoch 52, accuracy: 0.6470
Epoch 52, Train Loss: 0.0403, Val Loss: 2.4675
Epoch 53, accuracy: 0.6470
Epoch 54, accuracy: 0.6470
Epoch 54, Train Loss: 0.1078, Val Loss: 2.4675
Epoch 55, accuracy: 0.6470
Epoch 56, accuracy: 0.6470
Epoch 56, Train Loss: 0.0592, Val Loss: 2.4675
Epoch 57, accuracy: 0.6470
Epoch 58, accuracy: 0.6470
Epoch 58, Train Loss: 0.0684, Val Loss: 2.4675
Epoch 59, accuracy: 0.6470
Epoch 60, accuracy: 0.6470
Epoch 60, Train Loss: 0.0617, Val Loss: 2.4675
Epoch 61, accuracy: 0.6470
Epoch 62, accuracy: 0.6470
Epoch 62, Train Loss: 0.0464, Val Loss: 2.4675
Epoch 63, accuracy: 0.6470
Epoch 64, accuracy: 0.6470
Epoch 64, Train Loss: 0.0604, Val Loss: 2.4675
Epoch 65, accuracy: 0.6470
Epoch 66, accuracy: 0.6470
Epoch 66, Train Loss: 0.0814, Val Loss: 2.4675
Epoch 67, accuracy: 0.6470
Epoch 68, accuracy: 0.6470
Epoch 68, Train Loss: 0.0609, Val Loss: 2.4675
Epoch 69, accuracy: 0.6470
Epoch 70, accuracy: 0.6470
Epoch 70, Train Loss: 0.0437, Val Loss: 2.4675
Epoch 71, accuracy: 0.6470
Epoch 72, accuracy: 0.6470
Epoch 72, Train Loss: 0.0961, Val Loss: 2.4675
Epoch 73, accuracy: 0.6470
Epoch 74, accuracy: 0.6470
Epoch 74, Train Loss: 0.0652, Val Loss: 2.4675
Epoch 75, accuracy: 0.6470
Epoch 76, accuracy: 0.6470
Epoch 76, Train Loss: 0.0444, Val Loss: 2.4675
Epoch 77, accuracy: 0.6470
Epoch 78, accuracy: 0.6470
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 78, Train Loss: 0.0552, Val Loss: 2.4675
Epoch 79, accuracy: 0.6470
Epoch 80, accuracy: 0.6470
Epoch 80, Train Loss: 0.0554, Val Loss: 2.4675
Epoch 81, accuracy: 0.6470
Epoch 82, accuracy: 0.6470
Epoch 82, Train Loss: 0.0552, Val Loss: 2.4675
Epoch 83, accuracy: 0.6470
Epoch 84, accuracy: 0.6470
Epoch 84, Train Loss: 0.0634, Val Loss: 2.4675
Epoch 85, accuracy: 0.6470
Epoch 86, accuracy: 0.6470
Epoch 86, Train Loss: 0.0631, Val Loss: 2.4675
Epoch 87, accuracy: 0.6470
Epoch 88, accuracy: 0.6470
Epoch 88, Train Loss: 0.0580, Val Loss: 2.4675
Epoch 89, accuracy: 0.6470
Epoch 90, accuracy: 0.6470
Epoch 90, Train Loss: 0.0450, Val Loss: 2.4675
Epoch 91, accuracy: 0.6470
Epoch 92, accuracy: 0.6470
Epoch 92, Train Loss: 0.0532, Val Loss: 2.4675
Epoch 93, accuracy: 0.6470
Epoch 94, accuracy: 0.6470
Epoch 94, Train Loss: 0.0913, Val Loss: 2.4675
Epoch 95, accuracy: 0.6470
Epoch 96, accuracy: 0.6470
Epoch 96, Train Loss: 0.0618, Val Loss: 2.4674
Epoch 97, accuracy: 0.6470
Epoch 98, accuracy: 0.6470
Epoch 98, Train Loss: 0.0673, Val Loss: 2.4674
Epoch 99, accuracy: 0.6470
Epoch 100, accuracy: 0.6470
Epoch 100, Train Loss: 0.0940, Val Loss: 2.4674
Epoch 101, accuracy: 0.6470
Epoch 102, accuracy: 0.6470
Epoch 102, Train Loss: 0.0657, Val Loss: 2.4674
Epoch 103, accuracy: 0.6470
Epoch 104, accuracy: 0.6470
Epoch 104, Train Loss: 0.1186, Val Loss: 2.4674
Epoch 105, accuracy: 0.6470
Epoch 106, accuracy: 0.6470
Epoch 106, Train Loss: 0.0558, Val Loss: 2.4674
Epoch 107, accuracy: 0.6470
Epoch 108, accuracy: 0.6470
Epoch 108, Train Loss: 0.0766, Val Loss: 2.4674
Epoch 109, accuracy: 0.6470
Epoch 110, accuracy: 0.6470
Epoch 110, Train Loss: 0.0648, Val Loss: 2.4674
Epoch 111, accuracy: 0.6470
Epoch 112, accuracy: 0.6470
Epoch 112, Train Loss: 0.0598, Val Loss: 2.4674
Epoch 113, accuracy: 0.6470
Epoch 114, accuracy: 0.6470
Epoch 114, Train Loss: 0.1082, Val Loss: 2.4674
Epoch 115, accuracy: 0.6470
Epoch 116, accuracy: 0.6470
Epoch 116, Train Loss: 0.0563, Val Loss: 2.4674
Epoch 117, accuracy: 0.6470
Epoch 118, accuracy: 0.6470
Epoch 118, Train Loss: 0.0600, Val Loss: 2.4674
Epoch 119, accuracy: 0.6470
Epoch 120, accuracy: 0.6470
Epoch 120, Train Loss: 0.0545, Val Loss: 2.4674
Epoch 121, accuracy: 0.6470
Epoch 122, accuracy: 0.6470
Epoch 122, Train Loss: 0.0935, Val Loss: 2.4674
Epoch 123, accuracy: 0.6470
Epoch 124, accuracy: 0.6470
Epoch 124, Train Loss: 0.0984, Val Loss: 2.4674
Epoch 125, accuracy: 0.6470
Epoch 126, accuracy: 0.6470
Epoch 126, Train Loss: 0.0710, Val Loss: 2.4674
Epoch 127, accuracy: 0.6470
Epoch 128, accuracy: 0.6470
Epoch 128, Train Loss: 0.0763, Val Loss: 2.4674
Epoch 129, accuracy: 0.6470
Epoch 130, accuracy: 0.6470
Epoch 130, Train Loss: 0.0568, Val Loss: 2.4674
Epoch 131, accuracy: 0.6470
Epoch 132, accuracy: 0.6470
Epoch 132, Train Loss: 0.0874, Val Loss: 2.4674
Epoch 133, accuracy: 0.6470
Epoch 134, accuracy: 0.6470
Epoch 134, Train Loss: 0.1040, Val Loss: 2.4674
Epoch 135, accuracy: 0.6470
Epoch 136, accuracy: 0.6470
Epoch 136, Train Loss: 0.0437, Val Loss: 2.4674
Epoch 137, accuracy: 0.6470
Epoch 138, accuracy: 0.6470
Epoch 138, Train Loss: 0.0549, Val Loss: 2.4674
Epoch 139, accuracy: 0.6470
Epoch 140, accuracy: 0.6470
Epoch 140, Train Loss: 0.0618, Val Loss: 2.4674
Epoch 141, accuracy: 0.6470
Epoch 142, accuracy: 0.6470
Epoch 142, Train Loss: 0.0415, Val Loss: 2.4674
Epoch 143, accuracy: 0.6470
Epoch 144, accuracy: 0.6470
Epoch 144, Train Loss: 0.1092, Val Loss: 2.4674
Epoch 145, accuracy: 0.6470
Epoch 146, accuracy: 0.6470
Epoch 146, Train Loss: 0.0531, Val Loss: 2.4674
Epoch 147, accuracy: 0.6470
Epoch 148, accuracy: 0.6470
Epoch 148, Train Loss: 0.0599, Val Loss: 2.4674
Epoch 149, accuracy: 0.6470
Epoch 150, accuracy: 0.6470
Epoch 150, Train Loss: 0.0962, Val Loss: 2.4674
Epoch 151, accuracy: 0.6470
Epoch 152, accuracy: 0.6470
Epoch 152, Train Loss: 0.0689, Val Loss: 2.4674
Epoch 153, accuracy: 0.6470
Epoch 154, accuracy: 0.6470
Epoch 154, Train Loss: 0.1345, Val Loss: 2.4674
Epoch 155, accuracy: 0.6470
Epoch 156, accuracy: 0.6470
Epoch 156, Train Loss: 0.0566, Val Loss: 2.4674
Epoch 157, accuracy: 0.6470
Epoch 158, accuracy: 0.6470
Epoch 158, Train Loss: 0.0621, Val Loss: 2.4674
Epoch 159, accuracy: 0.6470
Epoch 160, accuracy: 0.6470
Epoch 160, Train Loss: 0.0619, Val Loss: 2.4674
Epoch 161, accuracy: 0.6470
Epoch 162, accuracy: 0.6470
Epoch 162, Train Loss: 0.0967, Val Loss: 2.4674
Epoch 163, accuracy: 0.6470
Epoch 164, accuracy: 0.6470
Epoch 164, Train Loss: 0.0853, Val Loss: 2.4674
Epoch 165, accuracy: 0.6470
Epoch 166, accuracy: 0.6470
Epoch 166, Train Loss: 0.0632, Val Loss: 2.4674
Epoch 167, accuracy: 0.6470
Epoch 168, accuracy: 0.6470
Epoch 168, Train Loss: 0.0542, Val Loss: 2.4674
Epoch 169, accuracy: 0.6470
Epoch 170, accuracy: 0.6470
Epoch 170, Train Loss: 0.0506, Val Loss: 2.4674
Epoch 171, accuracy: 0.6470
Epoch 172, accuracy: 0.6470
Epoch 172, Train Loss: 0.0437, Val Loss: 2.4674
Epoch 173, accuracy: 0.6470
Epoch 174, accuracy: 0.6470
Epoch 174, Train Loss: 0.0517, Val Loss: 2.4674
Epoch 175, accuracy: 0.6470
Epoch 176, accuracy: 0.6470
Epoch 176, Train Loss: 0.0693, Val Loss: 2.4673
Epoch 177, accuracy: 0.6470
Epoch 178, accuracy: 0.6470
Epoch 178, Train Loss: 0.1079, Val Loss: 2.4673
Epoch 179, accuracy: 0.6470
Epoch 180, accuracy: 0.6470
Epoch 180, Train Loss: 0.0545, Val Loss: 2.4673
Epoch 181, accuracy: 0.6470
Epoch 182, accuracy: 0.6470
Epoch 182, Train Loss: 0.0438, Val Loss: 2.4673
Epoch 183, accuracy: 0.6470
Epoch 184, accuracy: 0.6470
Epoch 184, Train Loss: 0.0628, Val Loss: 2.4673
Epoch 185, accuracy: 0.6470
Epoch 186, accuracy: 0.6470
Epoch 186, Train Loss: 0.0512, Val Loss: 2.4673
Epoch 187, accuracy: 0.6470
Epoch 188, accuracy: 0.6470
Epoch 188, Train Loss: 0.0977, Val Loss: 2.4673
Epoch 189, accuracy: 0.6470
Epoch 190, accuracy: 0.6470
Epoch 190, Train Loss: 0.0620, Val Loss: 2.4673
Epoch 191, accuracy: 0.6470
Epoch 192, accuracy: 0.6470
Epoch 192, Train Loss: 0.0674, Val Loss: 2.4673
Epoch 193, accuracy: 0.6470
Epoch 194, accuracy: 0.6470
Epoch 194, Train Loss: 0.0840, Val Loss: 2.4673
Epoch 195, accuracy: 0.6470
Epoch 196, accuracy: 0.6470
Epoch 196, Train Loss: 0.0464, Val Loss: 2.4673
Epoch 197, accuracy: 0.6470
Epoch 198, accuracy: 0.6470
Epoch 198, Train Loss: 0.0859, Val Loss: 2.4673
Epoch 199, accuracy: 0.6470
Loaded best model with val_loss = 1.034936547279358
test :accuracy 0.6960, f1_macro: 0.6581, f1_micro: 0.6960, auc: 0.9006
Training GAT with 5 layers...
可训练参数: 1876894_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.7738
Epoch 0, accuracy: 0.3210
Epoch 0, Train Loss: 1.7974, Val Loss: 1.7738
✅ Epoch 1: New best model saved with val_loss = 1.5878
Epoch 1, accuracy: 0.6090
✅ Epoch 2: New best model saved with val_loss = 1.1938
Epoch 2, accuracy: 0.6790
Epoch 2, Train Loss: 1.4778, Val Loss: 1.1938
Epoch 3, accuracy: 0.5410
Epoch 4, accuracy: 0.4580
Epoch 4, Train Loss: 0.6050, Val Loss: 2.6075
Epoch 5, accuracy: 0.6250
Epoch 6, accuracy: 0.6200
Epoch 6, Train Loss: 0.2705, Val Loss: 1.6389
Epoch 7, accuracy: 0.5340
Epoch 8, accuracy: 0.5490
Epoch 8, Train Loss: 0.3625, Val Loss: 1.6535
Epoch 9, accuracy: 0.5690
Epoch 10, accuracy: 0.5870
Epoch 10, Train Loss: 0.2334, Val Loss: 1.5355
Epoch 11, accuracy: 0.5970
Epoch 12, accuracy: 0.6160
Epoch 12, Train Loss: 0.1629, Val Loss: 1.4256
Epoch 13, accuracy: 0.6300
Epoch 14, accuracy: 0.6380
Epoch 14, Train Loss: 0.1780, Val Loss: 1.3604
Epoch 15, accuracy: 0.6380
Epoch 16, accuracy: 0.6390
Epoch 16, Train Loss: 0.1359, Val Loss: 1.3561
Epoch 17, accuracy: 0.6400
Epoch 18, accuracy: 0.6400
Epoch 18, Train Loss: 0.1347, Val Loss: 1.3526
Epoch 19, accuracy: 0.6410
Epoch 20, accuracy: 0.6410
Epoch 20, Train Loss: 0.1220, Val Loss: 1.3502
Epoch 21, accuracy: 0.6410
Epoch 22, accuracy: 0.6410
Epoch 22, Train Loss: 0.1532, Val Loss: 1.3501
Epoch 23, accuracy: 0.6400
Epoch 24, accuracy: 0.6400
Epoch 24, Train Loss: 0.1219, Val Loss: 1.3500
Epoch 25, accuracy: 0.6400
Epoch 26, accuracy: 0.6400
Epoch 26, Train Loss: 0.1623, Val Loss: 1.3499
Epoch 27, accuracy: 0.6400
Epoch 28, accuracy: 0.6400
Epoch 28, Train Loss: 0.1419, Val Loss: 1.3499
Epoch 29, accuracy: 0.6400
Epoch 30, accuracy: 0.6400
Epoch 30, Train Loss: 0.1346, Val Loss: 1.3500
Epoch 31, accuracy: 0.6400
Epoch 32, accuracy: 0.6400
Epoch 32, Train Loss: 0.1255, Val Loss: 1.3500
Epoch 33, accuracy: 0.6400
Epoch 34, accuracy: 0.6400
Epoch 34, Train Loss: 0.1529, Val Loss: 1.3500
Epoch 35, accuracy: 0.6400
Epoch 36, accuracy: 0.6400
Epoch 36, Train Loss: 0.1429, Val Loss: 1.3500
Epoch 37, accuracy: 0.6400
Epoch 38, accuracy: 0.6400
Epoch 38, Train Loss: 0.1557, Val Loss: 1.3500
Epoch 39, accuracy: 0.6400
Epoch 40, accuracy: 0.6400
Epoch 40, Train Loss: 0.1360, Val Loss: 1.3500
Epoch 41, accuracy: 0.6400
Epoch 42, accuracy: 0.6400
Epoch 42, Train Loss: 0.1311, Val Loss: 1.3500
Epoch 43, accuracy: 0.6400
Epoch 44, accuracy: 0.6400
Epoch 44, Train Loss: 0.1463, Val Loss: 1.3500
Epoch 45, accuracy: 0.6400
Epoch 46, accuracy: 0.6400
Epoch 46, Train Loss: 0.1437, Val Loss: 1.3500
Epoch 47, accuracy: 0.6400
Epoch 48, accuracy: 0.6400
Epoch 48, Train Loss: 0.1323, Val Loss: 1.3500
Epoch 49, accuracy: 0.6400
Epoch 50, accuracy: 0.6400
Epoch 50, Train Loss: 0.1464, Val Loss: 1.3500
Epoch 51, accuracy: 0.6400
Epoch 52, accuracy: 0.6400
Epoch 52, Train Loss: 0.1457, Val Loss: 1.3500
Epoch 53, accuracy: 0.6400
Epoch 54, accuracy: 0.6400
Epoch 54, Train Loss: 0.1360, Val Loss: 1.3500
Epoch 55, accuracy: 0.6400
Epoch 56, accuracy: 0.6400
Epoch 56, Train Loss: 0.1414, Val Loss: 1.3500
Epoch 57, accuracy: 0.6400
Epoch 58, accuracy: 0.6400
Epoch 58, Train Loss: 0.1240, Val Loss: 1.3500
Epoch 59, accuracy: 0.6400
Epoch 60, accuracy: 0.6400
Epoch 60, Train Loss: 0.1359, Val Loss: 1.3500
Epoch 61, accuracy: 0.6400
Epoch 62, accuracy: 0.6400
Epoch 62, Train Loss: 0.1289, Val Loss: 1.3500
Epoch 63, accuracy: 0.6400
Epoch 64, accuracy: 0.6400
Epoch 64, Train Loss: 0.1345, Val Loss: 1.3500
Epoch 65, accuracy: 0.6400
Epoch 66, accuracy: 0.6400
Epoch 66, Train Loss: 0.1215, Val Loss: 1.3500
Epoch 67, accuracy: 0.6400
Epoch 68, accuracy: 0.6400
Epoch 68, Train Loss: 0.1261, Val Loss: 1.3500
Epoch 69, accuracy: 0.6400
Epoch 70, accuracy: 0.6400
Epoch 70, Train Loss: 0.1254, Val Loss: 1.3500
Epoch 71, accuracy: 0.6400
Epoch 72, accuracy: 0.6400
Epoch 72, Train Loss: 0.1401, Val Loss: 1.3500
Epoch 73, accuracy: 0.6400
Epoch 74, accuracy: 0.6400
Epoch 74, Train Loss: 0.1410, Val Loss: 1.3500
Epoch 75, accuracy: 0.6400
Epoch 76, accuracy: 0.6400
Epoch 76, Train Loss: 0.1297, Val Loss: 1.3500
Epoch 77, accuracy: 0.6400
Epoch 78, accuracy: 0.6400
Epoch 78, Train Loss: 0.1350, Val Loss: 1.3500
Epoch 79, accuracy: 0.6400
Epoch 80, accuracy: 0.6400
Epoch 80, Train Loss: 0.1416, Val Loss: 1.3500
Epoch 81, accuracy: 0.6400
Epoch 82, accuracy: 0.6400
Epoch 82, Train Loss: 0.1307, Val Loss: 1.3500
Epoch 83, accuracy: 0.6400
Epoch 84, accuracy: 0.6400
Epoch 84, Train Loss: 0.1296, Val Loss: 1.3500
Epoch 85, accuracy: 0.6400
Epoch 86, accuracy: 0.6400
Epoch 86, Train Loss: 0.1459, Val Loss: 1.3500
Epoch 87, accuracy: 0.6400
Epoch 88, accuracy: 0.6400
Epoch 88, Train Loss: 0.1495, Val Loss: 1.3500
Epoch 89, accuracy: 0.6400
Epoch 90, accuracy: 0.6400
Epoch 90, Train Loss: 0.1366, Val Loss: 1.3500
Epoch 91, accuracy: 0.6400
Epoch 92, accuracy: 0.6400
Epoch 92, Train Loss: 0.1328, Val Loss: 1.3500
Epoch 93, accuracy: 0.6400
Epoch 94, accuracy: 0.6400
Epoch 94, Train Loss: 0.1432, Val Loss: 1.3500
Epoch 95, accuracy: 0.6400
Epoch 96, accuracy: 0.6400
Epoch 96, Train Loss: 0.1448, Val Loss: 1.3500
Epoch 97, accuracy: 0.6400
Epoch 98, accuracy: 0.6400
Epoch 98, Train Loss: 0.1414, Val Loss: 1.3500
Epoch 99, accuracy: 0.6400
Epoch 100, accuracy: 0.6400
Epoch 100, Train Loss: 0.1384, Val Loss: 1.3500
Epoch 101, accuracy: 0.6400
Epoch 102, accuracy: 0.6400
Epoch 102, Train Loss: 0.1464, Val Loss: 1.3500
Epoch 103, accuracy: 0.6400
Epoch 104, accuracy: 0.6400
Epoch 104, Train Loss: 0.1398, Val Loss: 1.3500
Epoch 105, accuracy: 0.6400
Epoch 106, accuracy: 0.6400
Epoch 106, Train Loss: 0.1463, Val Loss: 1.3500
Epoch 107, accuracy: 0.6400
Epoch 108, accuracy: 0.6400
Epoch 108, Train Loss: 0.1326, Val Loss: 1.3500
Epoch 109, accuracy: 0.6400
Epoch 110, accuracy: 0.6400
Epoch 110, Train Loss: 0.1412, Val Loss: 1.3500
Epoch 111, accuracy: 0.6400
Epoch 112, accuracy: 0.6400
Epoch 112, Train Loss: 0.1278, Val Loss: 1.3500
Epoch 113, accuracy: 0.6400
Epoch 114, accuracy: 0.6400
Epoch 114, Train Loss: 0.1592, Val Loss: 1.3500
Epoch 115, accuracy: 0.6400
Epoch 116, accuracy: 0.6400
Epoch 116, Train Loss: 0.1472, Val Loss: 1.3500
Epoch 117, accuracy: 0.6400
Epoch 118, accuracy: 0.6400
Epoch 118, Train Loss: 0.1288, Val Loss: 1.3500
Epoch 119, accuracy: 0.6400
Epoch 120, accuracy: 0.6400
Epoch 120, Train Loss: 0.1337, Val Loss: 1.3500
Epoch 121, accuracy: 0.6400
Epoch 122, accuracy: 0.6400
Epoch 122, Train Loss: 0.1362, Val Loss: 1.3500
Epoch 123, accuracy: 0.6400
Epoch 124, accuracy: 0.6400
Epoch 124, Train Loss: 0.1361, Val Loss: 1.3500
Epoch 125, accuracy: 0.6400
Epoch 126, accuracy: 0.6400
Epoch 126, Train Loss: 0.1400, Val Loss: 1.3500
Epoch 127, accuracy: 0.6400
Epoch 128, accuracy: 0.6400
Epoch 128, Train Loss: 0.1315, Val Loss: 1.3500
Epoch 129, accuracy: 0.6400
Epoch 130, accuracy: 0.6400
Epoch 130, Train Loss: 0.1366, Val Loss: 1.3500
Epoch 131, accuracy: 0.6400
Epoch 132, accuracy: 0.6400
Epoch 132, Train Loss: 0.1226, Val Loss: 1.3500
Epoch 133, accuracy: 0.6400
Epoch 134, accuracy: 0.6400
Epoch 134, Train Loss: 0.1437, Val Loss: 1.3500
Epoch 135, accuracy: 0.6400
Epoch 136, accuracy: 0.6400
Epoch 136, Train Loss: 0.1248, Val Loss: 1.3500
Epoch 137, accuracy: 0.6400
Epoch 138, accuracy: 0.6400
Epoch 138, Train Loss: 0.1323, Val Loss: 1.3500
Epoch 139, accuracy: 0.6400
Epoch 140, accuracy: 0.6400
Epoch 140, Train Loss: 0.1221, Val Loss: 1.3500
Epoch 141, accuracy: 0.6400
Epoch 142, accuracy: 0.6400
Epoch 142, Train Loss: 0.1408, Val Loss: 1.3500
Epoch 143, accuracy: 0.6400
Epoch 144, accuracy: 0.6400
Epoch 144, Train Loss: 0.1345, Val Loss: 1.3500
Epoch 145, accuracy: 0.6400
Epoch 146, accuracy: 0.6400
Epoch 146, Train Loss: 0.1323, Val Loss: 1.3500
Epoch 147, accuracy: 0.6400
Epoch 148, accuracy: 0.6400
Epoch 148, Train Loss: 0.1476, Val Loss: 1.3500
Epoch 149, accuracy: 0.6400
Epoch 150, accuracy: 0.6400
Epoch 150, Train Loss: 0.1415, Val Loss: 1.3500
Epoch 151, accuracy: 0.6400
Epoch 152, accuracy: 0.6400
Epoch 152, Train Loss: 0.1381, Val Loss: 1.3500
Epoch 153, accuracy: 0.6400
Epoch 154, accuracy: 0.6400
Epoch 154, Train Loss: 0.1410, Val Loss: 1.3500
Epoch 155, accuracy: 0.6400
Epoch 156, accuracy: 0.6400
Epoch 156, Train Loss: 0.1248, Val Loss: 1.3500
Epoch 157, accuracy: 0.6400
Epoch 158, accuracy: 0.6400
Epoch 158, Train Loss: 0.1359, Val Loss: 1.3500
Epoch 159, accuracy: 0.6400
Epoch 160, accuracy: 0.6400
Epoch 160, Train Loss: 0.1394, Val Loss: 1.3500
Epoch 161, accuracy: 0.6400
Epoch 162, accuracy: 0.6400
Epoch 162, Train Loss: 0.1329, Val Loss: 1.3500
Epoch 163, accuracy: 0.6400
Epoch 164, accuracy: 0.6400
Epoch 164, Train Loss: 0.1385, Val Loss: 1.3500
Epoch 165, accuracy: 0.6400
Epoch 166, accuracy: 0.6400
Epoch 166, Train Loss: 0.1323, Val Loss: 1.3500
Epoch 167, accuracy: 0.6400
Epoch 168, accuracy: 0.6400
Epoch 168, Train Loss: 0.1436, Val Loss: 1.3500
Epoch 169, accuracy: 0.6400
Epoch 170, accuracy: 0.6400
Epoch 170, Train Loss: 0.1430, Val Loss: 1.3500
Epoch 171, accuracy: 0.6400
Epoch 172, accuracy: 0.6400
Epoch 172, Train Loss: 0.1452, Val Loss: 1.3500
Epoch 173, accuracy: 0.6400
Epoch 174, accuracy: 0.6400
Epoch 174, Train Loss: 0.1367, Val Loss: 1.3500
Epoch 175, accuracy: 0.6400
Epoch 176, accuracy: 0.6400
Epoch 176, Train Loss: 0.1305, Val Loss: 1.3500
Epoch 177, accuracy: 0.6400
Epoch 178, accuracy: 0.6400
Epoch 178, Train Loss: 0.1370, Val Loss: 1.3500
Epoch 179, accuracy: 0.6400
Epoch 180, accuracy: 0.6400
Epoch 180, Train Loss: 0.1177, Val Loss: 1.3500
Epoch 181, accuracy: 0.6400
Epoch 182, accuracy: 0.6400
Epoch 182, Train Loss: 0.1403, Val Loss: 1.3500
Epoch 183, accuracy: 0.6400
Epoch 184, accuracy: 0.6400
Epoch 184, Train Loss: 0.1472, Val Loss: 1.3500
Epoch 185, accuracy: 0.6400
Epoch 186, accuracy: 0.6400
Epoch 186, Train Loss: 0.1392, Val Loss: 1.3500
Epoch 187, accuracy: 0.6400
Epoch 188, accuracy: 0.6400
Epoch 188, Train Loss: 0.1491, Val Loss: 1.3500
Epoch 189, accuracy: 0.6400
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 190, accuracy: 0.6400
Epoch 190, Train Loss: 0.1426, Val Loss: 1.3500
Epoch 191, accuracy: 0.6400
Epoch 192, accuracy: 0.6400
Epoch 192, Train Loss: 0.1131, Val Loss: 1.3500
Epoch 193, accuracy: 0.6400
Epoch 194, accuracy: 0.6400
Epoch 194, Train Loss: 0.1299, Val Loss: 1.3500
Epoch 195, accuracy: 0.6400
Epoch 196, accuracy: 0.6400
Epoch 196, Train Loss: 0.1383, Val Loss: 1.3500
Epoch 197, accuracy: 0.6400
Epoch 198, accuracy: 0.6400
Epoch 198, Train Loss: 0.1260, Val Loss: 1.3500
Epoch 199, accuracy: 0.6400
Loaded best model with val_loss = 1.1937938928604126
test :accuracy 0.6790, f1_macro: 0.6406, f1_micro: 0.6790, auc: 0.8865
Training GAT with 6 layers...
可训练参数: 2026270_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.8042
Epoch 0, accuracy: 0.1250
Epoch 0, Train Loss: 1.7940, Val Loss: 1.8042
✅ Epoch 1: New best model saved with val_loss = 1.7327
Epoch 1, accuracy: 0.1940
✅ Epoch 2: New best model saved with val_loss = 1.4882
Epoch 2, accuracy: 0.5800
Epoch 2, Train Loss: 1.6410, Val Loss: 1.4882
Epoch 3, accuracy: 0.3850
✅ Epoch 4: New best model saved with val_loss = 1.2877
Epoch 4, accuracy: 0.6400
Epoch 4, Train Loss: 1.2661, Val Loss: 1.2877
Epoch 5, accuracy: 0.6030
✅ Epoch 6: New best model saved with val_loss = 1.0824
Epoch 6, accuracy: 0.6600
Epoch 6, Train Loss: 0.7701, Val Loss: 1.0824
Epoch 7, accuracy: 0.6450
Epoch 8, accuracy: 0.5560
Epoch 8, Train Loss: 0.3478, Val Loss: 1.3603
Epoch 9, accuracy: 0.5990
Epoch 10, accuracy: 0.6060
Epoch 10, Train Loss: 0.2469, Val Loss: 1.6711
Epoch 11, accuracy: 0.6130
Epoch 12, accuracy: 0.6290
Epoch 12, Train Loss: 0.1698, Val Loss: 2.0640
Epoch 13, accuracy: 0.6290
Epoch 14, accuracy: 0.6310
Epoch 14, Train Loss: 0.1765, Val Loss: 2.0767
Epoch 15, accuracy: 0.6310
Epoch 16, accuracy: 0.6320
Epoch 16, Train Loss: 0.1221, Val Loss: 2.0865
Epoch 17, accuracy: 0.6280
Epoch 18, accuracy: 0.6240
Epoch 18, Train Loss: 0.1096, Val Loss: 2.1173
Epoch 19, accuracy: 0.6240
Epoch 20, accuracy: 0.6230
Epoch 20, Train Loss: 0.1072, Val Loss: 2.1210
Epoch 21, accuracy: 0.6220
Epoch 22, accuracy: 0.6220
Epoch 22, Train Loss: 0.0861, Val Loss: 2.1247
Epoch 23, accuracy: 0.6220
Epoch 24, accuracy: 0.6220
Epoch 24, Train Loss: 0.0871, Val Loss: 2.1297
Epoch 25, accuracy: 0.6220
Epoch 26, accuracy: 0.6220
Epoch 26, Train Loss: 0.1153, Val Loss: 2.1298
Epoch 27, accuracy: 0.6220
Epoch 28, accuracy: 0.6220
Epoch 28, Train Loss: 0.0820, Val Loss: 2.1296
Epoch 29, accuracy: 0.6220
Epoch 30, accuracy: 0.6220
Epoch 30, Train Loss: 0.1066, Val Loss: 2.1296
Epoch 31, accuracy: 0.6220
Epoch 32, accuracy: 0.6220
Epoch 32, Train Loss: 0.1343, Val Loss: 2.1296
Epoch 33, accuracy: 0.6220
Epoch 34, accuracy: 0.6220
Epoch 34, Train Loss: 0.0881, Val Loss: 2.1297
Epoch 35, accuracy: 0.6220
Epoch 36, accuracy: 0.6220
Epoch 36, Train Loss: 0.0765, Val Loss: 2.1297
Epoch 37, accuracy: 0.6220
Epoch 38, accuracy: 0.6220
Epoch 38, Train Loss: 0.0802, Val Loss: 2.1297
Epoch 39, accuracy: 0.6220
Epoch 40, accuracy: 0.6220
Epoch 40, Train Loss: 0.0827, Val Loss: 2.1297
Epoch 41, accuracy: 0.6220
Epoch 42, accuracy: 0.6220
Epoch 42, Train Loss: 0.0936, Val Loss: 2.1297
Epoch 43, accuracy: 0.6220
Epoch 44, accuracy: 0.6220
Epoch 44, Train Loss: 0.0800, Val Loss: 2.1297
Epoch 45, accuracy: 0.6220
Epoch 46, accuracy: 0.6220
Epoch 46, Train Loss: 0.0866, Val Loss: 2.1297
Epoch 47, accuracy: 0.6220
Epoch 48, accuracy: 0.6220
Epoch 48, Train Loss: 0.0655, Val Loss: 2.1297
Epoch 49, accuracy: 0.6220
Epoch 50, accuracy: 0.6220
Epoch 50, Train Loss: 0.0835, Val Loss: 2.1297
Epoch 51, accuracy: 0.6220
Epoch 52, accuracy: 0.6220
Epoch 52, Train Loss: 0.0905, Val Loss: 2.1297
Epoch 53, accuracy: 0.6220
Epoch 54, accuracy: 0.6220
Epoch 54, Train Loss: 0.0816, Val Loss: 2.1297
Epoch 55, accuracy: 0.6220
Epoch 56, accuracy: 0.6220
Epoch 56, Train Loss: 0.0924, Val Loss: 2.1297
Epoch 57, accuracy: 0.6220
Epoch 58, accuracy: 0.6220
Epoch 58, Train Loss: 0.0810, Val Loss: 2.1297
Epoch 59, accuracy: 0.6220
Epoch 60, accuracy: 0.6220
Epoch 60, Train Loss: 0.0715, Val Loss: 2.1297
Epoch 61, accuracy: 0.6220
Epoch 62, accuracy: 0.6220
Epoch 62, Train Loss: 0.0884, Val Loss: 2.1297
Epoch 63, accuracy: 0.6220
Epoch 64, accuracy: 0.6220
Epoch 64, Train Loss: 0.0869, Val Loss: 2.1297
Epoch 65, accuracy: 0.6220
Epoch 66, accuracy: 0.6220
Epoch 66, Train Loss: 0.1130, Val Loss: 2.1297
Epoch 67, accuracy: 0.6220
Epoch 68, accuracy: 0.6220
Epoch 68, Train Loss: 0.0866, Val Loss: 2.1297
Epoch 69, accuracy: 0.6220
Epoch 70, accuracy: 0.6220
Epoch 70, Train Loss: 0.0743, Val Loss: 2.1297
Epoch 71, accuracy: 0.6220
Epoch 72, accuracy: 0.6220
Epoch 72, Train Loss: 0.0725, Val Loss: 2.1297
Epoch 73, accuracy: 0.6220
Epoch 74, accuracy: 0.6220
Epoch 74, Train Loss: 0.0916, Val Loss: 2.1297
Epoch 75, accuracy: 0.6220
Epoch 76, accuracy: 0.6220
Epoch 76, Train Loss: 0.0697, Val Loss: 2.1297
Epoch 77, accuracy: 0.6220
Epoch 78, accuracy: 0.6220
Epoch 78, Train Loss: 0.1313, Val Loss: 2.1297
Epoch 79, accuracy: 0.6220
Epoch 80, accuracy: 0.6220
Epoch 80, Train Loss: 0.0941, Val Loss: 2.1297
Epoch 81, accuracy: 0.6220
Epoch 82, accuracy: 0.6220
Epoch 82, Train Loss: 0.0792, Val Loss: 2.1297
Epoch 83, accuracy: 0.6220
Epoch 84, accuracy: 0.6220
Epoch 84, Train Loss: 0.0833, Val Loss: 2.1297
Epoch 85, accuracy: 0.6220
Epoch 86, accuracy: 0.6220
Epoch 86, Train Loss: 0.0947, Val Loss: 2.1297
Epoch 87, accuracy: 0.6220
Epoch 88, accuracy: 0.6220
Epoch 88, Train Loss: 0.1341, Val Loss: 2.1297
Epoch 89, accuracy: 0.6220
Epoch 90, accuracy: 0.6220
Epoch 90, Train Loss: 0.0781, Val Loss: 2.1297
Epoch 91, accuracy: 0.6220
Epoch 92, accuracy: 0.6220
Epoch 92, Train Loss: 0.0613, Val Loss: 2.1297
Epoch 93, accuracy: 0.6220
Epoch 94, accuracy: 0.6220
Epoch 94, Train Loss: 0.0703, Val Loss: 2.1297
Epoch 95, accuracy: 0.6220
Epoch 96, accuracy: 0.6220
Epoch 96, Train Loss: 0.0763, Val Loss: 2.1297
Epoch 97, accuracy: 0.6220
Epoch 98, accuracy: 0.6220
Epoch 98, Train Loss: 0.0806, Val Loss: 2.1297
Epoch 99, accuracy: 0.6220
Epoch 100, accuracy: 0.6220
Epoch 100, Train Loss: 0.0992, Val Loss: 2.1297
Epoch 101, accuracy: 0.6220
Epoch 102, accuracy: 0.6220
Epoch 102, Train Loss: 0.0653, Val Loss: 2.1297
Epoch 103, accuracy: 0.6220
Epoch 104, accuracy: 0.6220
Epoch 104, Train Loss: 0.0748, Val Loss: 2.1298
Epoch 105, accuracy: 0.6220
Epoch 106, accuracy: 0.6220
Epoch 106, Train Loss: 0.0862, Val Loss: 2.1298
Epoch 107, accuracy: 0.6220
Epoch 108, accuracy: 0.6220
Epoch 108, Train Loss: 0.0687, Val Loss: 2.1298
Epoch 109, accuracy: 0.6220
Epoch 110, accuracy: 0.6220
Epoch 110, Train Loss: 0.1099, Val Loss: 2.1298
Epoch 111, accuracy: 0.6220
Epoch 112, accuracy: 0.6220
Epoch 112, Train Loss: 0.0632, Val Loss: 2.1298
Epoch 113, accuracy: 0.6220
Epoch 114, accuracy: 0.6220
Epoch 114, Train Loss: 0.0807, Val Loss: 2.1298
Epoch 115, accuracy: 0.6220
Epoch 116, accuracy: 0.6220
Epoch 116, Train Loss: 0.0983, Val Loss: 2.1298
Epoch 117, accuracy: 0.6220
Epoch 118, accuracy: 0.6220
Epoch 118, Train Loss: 0.0900, Val Loss: 2.1298
Epoch 119, accuracy: 0.6220
Epoch 120, accuracy: 0.6220
Epoch 120, Train Loss: 0.0828, Val Loss: 2.1298
Epoch 121, accuracy: 0.6220
Epoch 122, accuracy: 0.6220
Epoch 122, Train Loss: 0.0769, Val Loss: 2.1298
Epoch 123, accuracy: 0.6220
Epoch 124, accuracy: 0.6220
Epoch 124, Train Loss: 0.1020, Val Loss: 2.1298
Epoch 125, accuracy: 0.6220
Epoch 126, accuracy: 0.6220
Epoch 126, Train Loss: 0.0764, Val Loss: 2.1298
Epoch 127, accuracy: 0.6220
Epoch 128, accuracy: 0.6220
Epoch 128, Train Loss: 0.0729, Val Loss: 2.1298
Epoch 129, accuracy: 0.6220
Epoch 130, accuracy: 0.6220
Epoch 130, Train Loss: 0.1030, Val Loss: 2.1298
Epoch 131, accuracy: 0.6220
Epoch 132, accuracy: 0.6220
Epoch 132, Train Loss: 0.0830, Val Loss: 2.1298
Epoch 133, accuracy: 0.6220
Epoch 134, accuracy: 0.6220
Epoch 134, Train Loss: 0.1004, Val Loss: 2.1298
Epoch 135, accuracy: 0.6220
Epoch 136, accuracy: 0.6220
Epoch 136, Train Loss: 0.0662, Val Loss: 2.1298
Epoch 137, accuracy: 0.6220
Epoch 138, accuracy: 0.6220
Epoch 138, Train Loss: 0.0962, Val Loss: 2.1298
Epoch 139, accuracy: 0.6220
Epoch 140, accuracy: 0.6220
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 140, Train Loss: 0.0781, Val Loss: 2.1298
Epoch 141, accuracy: 0.6220
Epoch 142, accuracy: 0.6220
Epoch 142, Train Loss: 0.0844, Val Loss: 2.1298
Epoch 143, accuracy: 0.6220
Epoch 144, accuracy: 0.6220
Epoch 144, Train Loss: 0.0783, Val Loss: 2.1298
Epoch 145, accuracy: 0.6220
Epoch 146, accuracy: 0.6220
Epoch 146, Train Loss: 0.0978, Val Loss: 2.1298
Epoch 147, accuracy: 0.6220
Epoch 148, accuracy: 0.6220
Epoch 148, Train Loss: 0.0822, Val Loss: 2.1298
Epoch 149, accuracy: 0.6220
Epoch 150, accuracy: 0.6220
Epoch 150, Train Loss: 0.1097, Val Loss: 2.1298
Epoch 151, accuracy: 0.6220
Epoch 152, accuracy: 0.6220
Epoch 152, Train Loss: 0.0905, Val Loss: 2.1298
Epoch 153, accuracy: 0.6220
Epoch 154, accuracy: 0.6220
Epoch 154, Train Loss: 0.1130, Val Loss: 2.1298
Epoch 155, accuracy: 0.6220
Epoch 156, accuracy: 0.6220
Epoch 156, Train Loss: 0.0951, Val Loss: 2.1298
Epoch 157, accuracy: 0.6220
Epoch 158, accuracy: 0.6220
Epoch 158, Train Loss: 0.0773, Val Loss: 2.1298
Epoch 159, accuracy: 0.6220
Epoch 160, accuracy: 0.6220
Epoch 160, Train Loss: 0.0799, Val Loss: 2.1298
Epoch 161, accuracy: 0.6220
Epoch 162, accuracy: 0.6220
Epoch 162, Train Loss: 0.0916, Val Loss: 2.1298
Epoch 163, accuracy: 0.6220
Epoch 164, accuracy: 0.6220
Epoch 164, Train Loss: 0.0740, Val Loss: 2.1298
Epoch 165, accuracy: 0.6220
Epoch 166, accuracy: 0.6220
Epoch 166, Train Loss: 0.1026, Val Loss: 2.1298
Epoch 167, accuracy: 0.6220
Epoch 168, accuracy: 0.6220
Epoch 168, Train Loss: 0.0687, Val Loss: 2.1298
Epoch 169, accuracy: 0.6220
Epoch 170, accuracy: 0.6220
Epoch 170, Train Loss: 0.0975, Val Loss: 2.1298
Epoch 171, accuracy: 0.6220
Epoch 172, accuracy: 0.6220
Epoch 172, Train Loss: 0.0996, Val Loss: 2.1298
Epoch 173, accuracy: 0.6220
Epoch 174, accuracy: 0.6220
Epoch 174, Train Loss: 0.1141, Val Loss: 2.1298
Epoch 175, accuracy: 0.6220
Epoch 176, accuracy: 0.6220
Epoch 176, Train Loss: 0.0805, Val Loss: 2.1298
Epoch 177, accuracy: 0.6220
Epoch 178, accuracy: 0.6220
Epoch 178, Train Loss: 0.1166, Val Loss: 2.1298
Epoch 179, accuracy: 0.6220
Epoch 180, accuracy: 0.6220
Epoch 180, Train Loss: 0.0674, Val Loss: 2.1298
Epoch 181, accuracy: 0.6220
Epoch 182, accuracy: 0.6220
Epoch 182, Train Loss: 0.0797, Val Loss: 2.1298
Epoch 183, accuracy: 0.6220
Epoch 184, accuracy: 0.6220
Epoch 184, Train Loss: 0.0634, Val Loss: 2.1298
Epoch 185, accuracy: 0.6220
Epoch 186, accuracy: 0.6220
Epoch 186, Train Loss: 0.0742, Val Loss: 2.1298
Epoch 187, accuracy: 0.6220
Epoch 188, accuracy: 0.6220
Epoch 188, Train Loss: 0.0913, Val Loss: 2.1298
Epoch 189, accuracy: 0.6220
Epoch 190, accuracy: 0.6220
Epoch 190, Train Loss: 0.0750, Val Loss: 2.1298
Epoch 191, accuracy: 0.6220
Epoch 192, accuracy: 0.6220
Epoch 192, Train Loss: 0.1256, Val Loss: 2.1298
Epoch 193, accuracy: 0.6220
Epoch 194, accuracy: 0.6220
Epoch 194, Train Loss: 0.0932, Val Loss: 2.1298
Epoch 195, accuracy: 0.6220
Epoch 196, accuracy: 0.6220
Epoch 196, Train Loss: 0.1001, Val Loss: 2.1298
Epoch 197, accuracy: 0.6220
Epoch 198, accuracy: 0.6220
Epoch 198, Train Loss: 0.0883, Val Loss: 2.1298
Epoch 199, accuracy: 0.6220
Loaded best model with val_loss = 1.082406997680664
test :accuracy 0.6600, f1_macro: 0.6012, f1_micro: 0.6600, auc: 0.8710
Training GAT with 7 layers...
可训练参数: 2175646_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.8082
Epoch 0, accuracy: 0.0790
Epoch 0, Train Loss: 1.7936, Val Loss: 1.8082
✅ Epoch 1: New best model saved with val_loss = 1.7500
Epoch 1, accuracy: 0.2310
✅ Epoch 2: New best model saved with val_loss = 1.7411
Epoch 2, accuracy: 0.1700
Epoch 2, Train Loss: 1.7175, Val Loss: 1.7411
✅ Epoch 3: New best model saved with val_loss = 1.7211
Epoch 3, accuracy: 0.2310
✅ Epoch 4: New best model saved with val_loss = 1.6377
Epoch 4, accuracy: 0.3230
Epoch 4, Train Loss: 1.8530, Val Loss: 1.6377
✅ Epoch 5: New best model saved with val_loss = 1.6006
Epoch 5, accuracy: 0.3820
✅ Epoch 6: New best model saved with val_loss = 1.4597
Epoch 6, accuracy: 0.4610
Epoch 6, Train Loss: 1.4012, Val Loss: 1.4597
✅ Epoch 7: New best model saved with val_loss = 1.3311
Epoch 7, accuracy: 0.5090
Epoch 8, accuracy: 0.5390
Epoch 8, Train Loss: 0.8636, Val Loss: 1.4026
Epoch 9, accuracy: 0.4830
Epoch 10, accuracy: 0.5820
Epoch 10, Train Loss: 0.5526, Val Loss: 1.6102
Epoch 11, accuracy: 0.6050
Epoch 12, accuracy: 0.6210
Epoch 12, Train Loss: 0.5365, Val Loss: 1.9197
Epoch 13, accuracy: 0.5970
Epoch 14, accuracy: 0.6030
Epoch 14, Train Loss: 0.3418, Val Loss: 1.8213
Epoch 15, accuracy: 0.6180
Epoch 16, accuracy: 0.6300
Epoch 16, Train Loss: 0.2591, Val Loss: 1.7849
Epoch 17, accuracy: 0.6290
Epoch 18, accuracy: 0.6250
Epoch 18, Train Loss: 0.1584, Val Loss: 1.8123
Epoch 19, accuracy: 0.6240
Epoch 20, accuracy: 0.6260
Epoch 20, Train Loss: 0.1654, Val Loss: 1.8528
Epoch 21, accuracy: 0.6260
Epoch 22, accuracy: 0.6270
Epoch 22, Train Loss: 0.1766, Val Loss: 1.8581
Epoch 23, accuracy: 0.6270
Epoch 24, accuracy: 0.6270
Epoch 24, Train Loss: 0.1861, Val Loss: 1.8608
Epoch 25, accuracy: 0.6280
Epoch 26, accuracy: 0.6280
Epoch 26, Train Loss: 0.1471, Val Loss: 1.8612
Epoch 27, accuracy: 0.6280
Epoch 28, accuracy: 0.6280
Epoch 28, Train Loss: 0.1707, Val Loss: 1.8612
Epoch 29, accuracy: 0.6280
Epoch 30, accuracy: 0.6280
Epoch 30, Train Loss: 0.1605, Val Loss: 1.8611
Epoch 31, accuracy: 0.6280
Epoch 32, accuracy: 0.6280
Epoch 32, Train Loss: 0.1678, Val Loss: 1.8611
Epoch 33, accuracy: 0.6280
Epoch 34, accuracy: 0.6280
Epoch 34, Train Loss: 0.1752, Val Loss: 1.8610
Epoch 35, accuracy: 0.6280
Epoch 36, accuracy: 0.6280
Epoch 36, Train Loss: 0.1925, Val Loss: 1.8610
Epoch 37, accuracy: 0.6280
Epoch 38, accuracy: 0.6280
Epoch 38, Train Loss: 0.2027, Val Loss: 1.8610
Epoch 39, accuracy: 0.6280
Epoch 40, accuracy: 0.6280
Epoch 40, Train Loss: 0.1662, Val Loss: 1.8609
Epoch 41, accuracy: 0.6280
Epoch 42, accuracy: 0.6280
Epoch 42, Train Loss: 0.1910, Val Loss: 1.8609
Epoch 43, accuracy: 0.6280
Epoch 44, accuracy: 0.6280
Epoch 44, Train Loss: 0.1605, Val Loss: 1.8609
Epoch 45, accuracy: 0.6280
Epoch 46, accuracy: 0.6280
Epoch 46, Train Loss: 0.1665, Val Loss: 1.8609
Epoch 47, accuracy: 0.6280
Epoch 48, accuracy: 0.6280
Epoch 48, Train Loss: 0.2279, Val Loss: 1.8609
Epoch 49, accuracy: 0.6280
Epoch 50, accuracy: 0.6280
Epoch 50, Train Loss: 0.1541, Val Loss: 1.8609
Epoch 51, accuracy: 0.6280
Epoch 52, accuracy: 0.6280
Epoch 52, Train Loss: 0.1877, Val Loss: 1.8609
Epoch 53, accuracy: 0.6280
Epoch 54, accuracy: 0.6280
Epoch 54, Train Loss: 0.1612, Val Loss: 1.8609
Epoch 55, accuracy: 0.6280
Epoch 56, accuracy: 0.6280
Epoch 56, Train Loss: 0.1644, Val Loss: 1.8609
Epoch 57, accuracy: 0.6280
Epoch 58, accuracy: 0.6280
Epoch 58, Train Loss: 0.1802, Val Loss: 1.8609
Epoch 59, accuracy: 0.6280
Epoch 60, accuracy: 0.6280
Epoch 60, Train Loss: 0.1605, Val Loss: 1.8609
Epoch 61, accuracy: 0.6280
Epoch 62, accuracy: 0.6280
Epoch 62, Train Loss: 0.1734, Val Loss: 1.8609
Epoch 63, accuracy: 0.6280
Epoch 64, accuracy: 0.6280
Epoch 64, Train Loss: 0.1531, Val Loss: 1.8609
Epoch 65, accuracy: 0.6280
Epoch 66, accuracy: 0.6280
Epoch 66, Train Loss: 0.1542, Val Loss: 1.8609
Epoch 67, accuracy: 0.6280
Epoch 68, accuracy: 0.6280
Epoch 68, Train Loss: 0.1815, Val Loss: 1.8609
Epoch 69, accuracy: 0.6280
Epoch 70, accuracy: 0.6280
Epoch 70, Train Loss: 0.1508, Val Loss: 1.8609
Epoch 71, accuracy: 0.6280
Epoch 72, accuracy: 0.6280
Epoch 72, Train Loss: 0.1652, Val Loss: 1.8609
Epoch 73, accuracy: 0.6280
Epoch 74, accuracy: 0.6280
Epoch 74, Train Loss: 0.1714, Val Loss: 1.8609
Epoch 75, accuracy: 0.6280
Epoch 76, accuracy: 0.6280
Epoch 76, Train Loss: 0.1370, Val Loss: 1.8609
Epoch 77, accuracy: 0.6280
Epoch 78, accuracy: 0.6280
Epoch 78, Train Loss: 0.1659, Val Loss: 1.8609
Epoch 79, accuracy: 0.6280
Epoch 80, accuracy: 0.6280
Epoch 80, Train Loss: 0.2037, Val Loss: 1.8609
Epoch 81, accuracy: 0.6280
Epoch 82, accuracy: 0.6280
Epoch 82, Train Loss: 0.1656, Val Loss: 1.8609
Epoch 83, accuracy: 0.6280
Epoch 84, accuracy: 0.6280
Epoch 84, Train Loss: 0.1660, Val Loss: 1.8609
Epoch 85, accuracy: 0.6280
Epoch 86, accuracy: 0.6280
Epoch 86, Train Loss: 0.1798, Val Loss: 1.8609
Epoch 87, accuracy: 0.6280
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 88, accuracy: 0.6280
Epoch 88, Train Loss: 0.1577, Val Loss: 1.8609
Epoch 89, accuracy: 0.6280
Epoch 90, accuracy: 0.6280
Epoch 90, Train Loss: 0.1701, Val Loss: 1.8609
Epoch 91, accuracy: 0.6280
Epoch 92, accuracy: 0.6280
Epoch 92, Train Loss: 0.1452, Val Loss: 1.8609
Epoch 93, accuracy: 0.6280
Epoch 94, accuracy: 0.6280
Epoch 94, Train Loss: 0.1647, Val Loss: 1.8609
Epoch 95, accuracy: 0.6280
Epoch 96, accuracy: 0.6280
Epoch 96, Train Loss: 0.1967, Val Loss: 1.8609
Epoch 97, accuracy: 0.6280
Epoch 98, accuracy: 0.6280
Epoch 98, Train Loss: 0.1704, Val Loss: 1.8609
Epoch 99, accuracy: 0.6280
Epoch 100, accuracy: 0.6280
Epoch 100, Train Loss: 0.1696, Val Loss: 1.8609
Epoch 101, accuracy: 0.6280
Epoch 102, accuracy: 0.6280
Epoch 102, Train Loss: 0.1726, Val Loss: 1.8609
Epoch 103, accuracy: 0.6280
Epoch 104, accuracy: 0.6280
Epoch 104, Train Loss: 0.1672, Val Loss: 1.8609
Epoch 105, accuracy: 0.6280
Epoch 106, accuracy: 0.6280
Epoch 106, Train Loss: 0.1879, Val Loss: 1.8609
Epoch 107, accuracy: 0.6280
Epoch 108, accuracy: 0.6280
Epoch 108, Train Loss: 0.1600, Val Loss: 1.8609
Epoch 109, accuracy: 0.6280
Epoch 110, accuracy: 0.6280
Epoch 110, Train Loss: 0.1454, Val Loss: 1.8609
Epoch 111, accuracy: 0.6280
Epoch 112, accuracy: 0.6280
Epoch 112, Train Loss: 0.1562, Val Loss: 1.8609
Epoch 113, accuracy: 0.6280
Epoch 114, accuracy: 0.6280
Epoch 114, Train Loss: 0.1848, Val Loss: 1.8609
Epoch 115, accuracy: 0.6280
Epoch 116, accuracy: 0.6280
Epoch 116, Train Loss: 0.1797, Val Loss: 1.8609
Epoch 117, accuracy: 0.6280
Epoch 118, accuracy: 0.6280
Epoch 118, Train Loss: 0.2041, Val Loss: 1.8609
Epoch 119, accuracy: 0.6280
Epoch 120, accuracy: 0.6280
Epoch 120, Train Loss: 0.1712, Val Loss: 1.8609
Epoch 121, accuracy: 0.6280
Epoch 122, accuracy: 0.6280
Epoch 122, Train Loss: 0.1555, Val Loss: 1.8609
Epoch 123, accuracy: 0.6280
Epoch 124, accuracy: 0.6280
Epoch 124, Train Loss: 0.1601, Val Loss: 1.8609
Epoch 125, accuracy: 0.6280
Epoch 126, accuracy: 0.6280
Epoch 126, Train Loss: 0.1533, Val Loss: 1.8609
Epoch 127, accuracy: 0.6280
Epoch 128, accuracy: 0.6280
Epoch 128, Train Loss: 0.1745, Val Loss: 1.8609
Epoch 129, accuracy: 0.6280
Epoch 130, accuracy: 0.6280
Epoch 130, Train Loss: 0.1660, Val Loss: 1.8609
Epoch 131, accuracy: 0.6280
Epoch 132, accuracy: 0.6280
Epoch 132, Train Loss: 0.1384, Val Loss: 1.8609
Epoch 133, accuracy: 0.6280
Epoch 134, accuracy: 0.6280
Epoch 134, Train Loss: 0.1289, Val Loss: 1.8609
Epoch 135, accuracy: 0.6280
Epoch 136, accuracy: 0.6280
Epoch 136, Train Loss: 0.1745, Val Loss: 1.8609
Epoch 137, accuracy: 0.6280
Epoch 138, accuracy: 0.6280
Epoch 138, Train Loss: 0.1904, Val Loss: 1.8609
Epoch 139, accuracy: 0.6280
Epoch 140, accuracy: 0.6280
Epoch 140, Train Loss: 0.1517, Val Loss: 1.8609
Epoch 141, accuracy: 0.6280
Epoch 142, accuracy: 0.6280
Epoch 142, Train Loss: 0.1918, Val Loss: 1.8609
Epoch 143, accuracy: 0.6280
Epoch 144, accuracy: 0.6280
Epoch 144, Train Loss: 0.1682, Val Loss: 1.8609
Epoch 145, accuracy: 0.6280
Epoch 146, accuracy: 0.6280
Epoch 146, Train Loss: 0.1701, Val Loss: 1.8609
Epoch 147, accuracy: 0.6280
Epoch 148, accuracy: 0.6280
Epoch 148, Train Loss: 0.1622, Val Loss: 1.8609
Epoch 149, accuracy: 0.6280
Epoch 150, accuracy: 0.6280
Epoch 150, Train Loss: 0.1709, Val Loss: 1.8609
Epoch 151, accuracy: 0.6280
Epoch 152, accuracy: 0.6280
Epoch 152, Train Loss: 0.1766, Val Loss: 1.8609
Epoch 153, accuracy: 0.6280
Epoch 154, accuracy: 0.6280
Epoch 154, Train Loss: 0.1665, Val Loss: 1.8609
Epoch 155, accuracy: 0.6280
Epoch 156, accuracy: 0.6280
Epoch 156, Train Loss: 0.1625, Val Loss: 1.8609
Epoch 157, accuracy: 0.6280
Epoch 158, accuracy: 0.6280
Epoch 158, Train Loss: 0.1604, Val Loss: 1.8609
Epoch 159, accuracy: 0.6280
Epoch 160, accuracy: 0.6280
Epoch 160, Train Loss: 0.1957, Val Loss: 1.8609
Epoch 161, accuracy: 0.6280
Epoch 162, accuracy: 0.6280
Epoch 162, Train Loss: 0.1564, Val Loss: 1.8609
Epoch 163, accuracy: 0.6280
Epoch 164, accuracy: 0.6280
Epoch 164, Train Loss: 0.1939, Val Loss: 1.8609
Epoch 165, accuracy: 0.6280
Epoch 166, accuracy: 0.6280
Epoch 166, Train Loss: 0.1751, Val Loss: 1.8609
Epoch 167, accuracy: 0.6280
Epoch 168, accuracy: 0.6280
Epoch 168, Train Loss: 0.1694, Val Loss: 1.8609
Epoch 169, accuracy: 0.6280
Epoch 170, accuracy: 0.6280
Epoch 170, Train Loss: 0.1573, Val Loss: 1.8609
Epoch 171, accuracy: 0.6280
Epoch 172, accuracy: 0.6280
Epoch 172, Train Loss: 0.1899, Val Loss: 1.8609
Epoch 173, accuracy: 0.6280
Epoch 174, accuracy: 0.6280
Epoch 174, Train Loss: 0.1700, Val Loss: 1.8609
Epoch 175, accuracy: 0.6280
Epoch 176, accuracy: 0.6280
Epoch 176, Train Loss: 0.1729, Val Loss: 1.8609
Epoch 177, accuracy: 0.6280
Epoch 178, accuracy: 0.6280
Epoch 178, Train Loss: 0.1416, Val Loss: 1.8609
Epoch 179, accuracy: 0.6280
Epoch 180, accuracy: 0.6280
Epoch 180, Train Loss: 0.1482, Val Loss: 1.8609
Epoch 181, accuracy: 0.6280
Epoch 182, accuracy: 0.6280
Epoch 182, Train Loss: 0.1910, Val Loss: 1.8609
Epoch 183, accuracy: 0.6280
Epoch 184, accuracy: 0.6280
Epoch 184, Train Loss: 0.1760, Val Loss: 1.8609
Epoch 185, accuracy: 0.6280
Epoch 186, accuracy: 0.6280
Epoch 186, Train Loss: 0.1617, Val Loss: 1.8609
Epoch 187, accuracy: 0.6280
Epoch 188, accuracy: 0.6280
Epoch 188, Train Loss: 0.1961, Val Loss: 1.8609
Epoch 189, accuracy: 0.6280
Epoch 190, accuracy: 0.6280
Epoch 190, Train Loss: 0.1747, Val Loss: 1.8609
Epoch 191, accuracy: 0.6280
Epoch 192, accuracy: 0.6280
Epoch 192, Train Loss: 0.1469, Val Loss: 1.8609
Epoch 193, accuracy: 0.6280
Epoch 194, accuracy: 0.6280
Epoch 194, Train Loss: 0.1686, Val Loss: 1.8609
Epoch 195, accuracy: 0.6280
Epoch 196, accuracy: 0.6280
Epoch 196, Train Loss: 0.1338, Val Loss: 1.8609
Epoch 197, accuracy: 0.6280
Epoch 198, accuracy: 0.6280
Epoch 198, Train Loss: 0.1546, Val Loss: 1.8609
Epoch 199, accuracy: 0.6280
Loaded best model with val_loss = 1.3311247825622559
test :accuracy 0.5090, f1_macro: 0.4538, f1_micro: 0.5090, auc: 0.8648
Training mamba3 with 3 layers...
可训练参数: 1568702_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.5081
Epoch 0, accuracy: 0.3350
Epoch 0, Train Loss: 1.8590, Val Loss: 1.5081
Epoch 1, accuracy: 0.1370
✅ Epoch 2: New best model saved with val_loss = 1.2868
Epoch 2, accuracy: 0.5280
Epoch 2, Train Loss: 1.3684, Val Loss: 1.2868
✅ Epoch 3: New best model saved with val_loss = 1.2267
Epoch 3, accuracy: 0.5600
✅ Epoch 4: New best model saved with val_loss = 1.1277
Epoch 4, accuracy: 0.6320
Epoch 4, Train Loss: 0.6989, Val Loss: 1.1277
✅ Epoch 5: New best model saved with val_loss = 1.1106
Epoch 5, accuracy: 0.6780
Epoch 6, accuracy: 0.6770
Epoch 6, Train Loss: 0.4628, Val Loss: 1.1678
Epoch 7, accuracy: 0.6550
Epoch 8, accuracy: 0.6410
Epoch 8, Train Loss: 0.3330, Val Loss: 1.3487
Epoch 9, accuracy: 0.6490
Epoch 10, accuracy: 0.6440
Epoch 10, Train Loss: 0.2610, Val Loss: 1.4004
Epoch 11, accuracy: 0.6390
Epoch 12, accuracy: 0.6390
Epoch 12, Train Loss: 0.2181, Val Loss: 1.4621
Epoch 13, accuracy: 0.6360
Epoch 14, accuracy: 0.6350
Epoch 14, Train Loss: 0.1747, Val Loss: 1.4584
Epoch 15, accuracy: 0.6360
Epoch 16, accuracy: 0.6400
Epoch 16, Train Loss: 0.1502, Val Loss: 1.4551
Epoch 17, accuracy: 0.6380
Epoch 18, accuracy: 0.6390
Epoch 18, Train Loss: 0.2613, Val Loss: 1.4567
Epoch 19, accuracy: 0.6390
Epoch 20, accuracy: 0.6390
Epoch 20, Train Loss: 0.1884, Val Loss: 1.4563
Epoch 21, accuracy: 0.6390
Epoch 22, accuracy: 0.6400
Epoch 22, Train Loss: 0.1619, Val Loss: 1.4560
Epoch 23, accuracy: 0.6400
Epoch 24, accuracy: 0.6400
Epoch 24, Train Loss: 0.1409, Val Loss: 1.4557
Epoch 25, accuracy: 0.6400
Epoch 26, accuracy: 0.6400
Epoch 26, Train Loss: 0.1355, Val Loss: 1.4556
Epoch 27, accuracy: 0.6400
Epoch 28, accuracy: 0.6400
Epoch 28, Train Loss: 0.2000, Val Loss: 1.4555
Epoch 29, accuracy: 0.6400
Epoch 30, accuracy: 0.6400
Epoch 30, Train Loss: 0.1590, Val Loss: 1.4554
Epoch 31, accuracy: 0.6400
Epoch 32, accuracy: 0.6400
Epoch 32, Train Loss: 0.1701, Val Loss: 1.4554
Epoch 33, accuracy: 0.6400
Epoch 34, accuracy: 0.6400
Epoch 34, Train Loss: 0.1746, Val Loss: 1.4554
Epoch 35, accuracy: 0.6400
Epoch 36, accuracy: 0.6400
Epoch 36, Train Loss: 0.1884, Val Loss: 1.4554
Epoch 37, accuracy: 0.6400
Epoch 38, accuracy: 0.6400
Epoch 38, Train Loss: 0.2762, Val Loss: 1.4554
Epoch 39, accuracy: 0.6400
Epoch 40, accuracy: 0.6400
Epoch 40, Train Loss: 0.1399, Val Loss: 1.4554
Epoch 41, accuracy: 0.6400
Epoch 42, accuracy: 0.6400
Epoch 42, Train Loss: 0.1902, Val Loss: 1.4554
Epoch 43, accuracy: 0.6400
Epoch 44, accuracy: 0.6400
Epoch 44, Train Loss: 0.2152, Val Loss: 1.4554
Epoch 45, accuracy: 0.6400
Epoch 46, accuracy: 0.6400
Epoch 46, Train Loss: 0.2139, Val Loss: 1.4554
Epoch 47, accuracy: 0.6400
Epoch 48, accuracy: 0.6400
Epoch 48, Train Loss: 0.2447, Val Loss: 1.4554
Epoch 49, accuracy: 0.6400
Epoch 50, accuracy: 0.6400
Epoch 50, Train Loss: 0.1961, Val Loss: 1.4554
Epoch 51, accuracy: 0.6400
Epoch 52, accuracy: 0.6400
Epoch 52, Train Loss: 0.1586, Val Loss: 1.4554
Epoch 53, accuracy: 0.6400
Epoch 54, accuracy: 0.6400
Epoch 54, Train Loss: 0.1766, Val Loss: 1.4554
Epoch 55, accuracy: 0.6400
Epoch 56, accuracy: 0.6400
Epoch 56, Train Loss: 0.1676, Val Loss: 1.4554
Epoch 57, accuracy: 0.6400
Epoch 58, accuracy: 0.6400
Epoch 58, Train Loss: 0.1806, Val Loss: 1.4554
Epoch 59, accuracy: 0.6400
Epoch 60, accuracy: 0.6400
Epoch 60, Train Loss: 0.1541, Val Loss: 1.4554
Epoch 61, accuracy: 0.6400
Epoch 62, accuracy: 0.6400
Epoch 62, Train Loss: 0.2056, Val Loss: 1.4554
Epoch 63, accuracy: 0.6400
Epoch 64, accuracy: 0.6400
Epoch 64, Train Loss: 0.1657, Val Loss: 1.4554
Epoch 65, accuracy: 0.6400
Epoch 66, accuracy: 0.6400
Epoch 66, Train Loss: 0.2157, Val Loss: 1.4554
Epoch 67, accuracy: 0.6400
Epoch 68, accuracy: 0.6400
Epoch 68, Train Loss: 0.2289, Val Loss: 1.4554
Epoch 69, accuracy: 0.6400
Epoch 70, accuracy: 0.6400
Epoch 70, Train Loss: 0.1535, Val Loss: 1.4554
Epoch 71, accuracy: 0.6400
Epoch 72, accuracy: 0.6400
Epoch 72, Train Loss: 0.1186, Val Loss: 1.4554
Epoch 73, accuracy: 0.6400
Epoch 74, accuracy: 0.6400
Epoch 74, Train Loss: 0.1746, Val Loss: 1.4554
Epoch 75, accuracy: 0.6400
Epoch 76, accuracy: 0.6400
Epoch 76, Train Loss: 0.1658, Val Loss: 1.4554
Epoch 77, accuracy: 0.6400
Epoch 78, accuracy: 0.6400
Epoch 78, Train Loss: 0.1927, Val Loss: 1.4554
Epoch 79, accuracy: 0.6400
Epoch 80, accuracy: 0.6400
Epoch 80, Train Loss: 0.1869, Val Loss: 1.4554
Epoch 81, accuracy: 0.6400
Epoch 82, accuracy: 0.6400
Epoch 82, Train Loss: 0.1260, Val Loss: 1.4554
Epoch 83, accuracy: 0.6400
Epoch 84, accuracy: 0.6400
Epoch 84, Train Loss: 0.1726, Val Loss: 1.4554
Epoch 85, accuracy: 0.6400
Epoch 86, accuracy: 0.6400
Epoch 86, Train Loss: 0.1681, Val Loss: 1.4554
Epoch 87, accuracy: 0.6400
Epoch 88, accuracy: 0.6400
Epoch 88, Train Loss: 0.2303, Val Loss: 1.4554
Epoch 89, accuracy: 0.6400
Epoch 90, accuracy: 0.6400
Epoch 90, Train Loss: 0.1970, Val Loss: 1.4554
Epoch 91, accuracy: 0.6400
Epoch 92, accuracy: 0.6400
Epoch 92, Train Loss: 0.1463, Val Loss: 1.4554
Epoch 93, accuracy: 0.6400
Epoch 94, accuracy: 0.6400
Epoch 94, Train Loss: 0.2469, Val Loss: 1.4554
Epoch 95, accuracy: 0.6400
Epoch 96, accuracy: 0.6400
Epoch 96, Train Loss: 0.2317, Val Loss: 1.4554
Epoch 97, accuracy: 0.6400
Epoch 98, accuracy: 0.6400
Epoch 98, Train Loss: 0.1404, Val Loss: 1.4554
Epoch 99, accuracy: 0.6400
Epoch 100, accuracy: 0.6400
Epoch 100, Train Loss: 0.2014, Val Loss: 1.4554
Epoch 101, accuracy: 0.6400
Epoch 102, accuracy: 0.6400
Epoch 102, Train Loss: 0.2246, Val Loss: 1.4554
Epoch 103, accuracy: 0.6400
Epoch 104, accuracy: 0.6400
Epoch 104, Train Loss: 0.2735, Val Loss: 1.4554
Epoch 105, accuracy: 0.6400
Epoch 106, accuracy: 0.6400
Epoch 106, Train Loss: 0.1346, Val Loss: 1.4554
Epoch 107, accuracy: 0.6400
Epoch 108, accuracy: 0.6400
Epoch 108, Train Loss: 0.2098, Val Loss: 1.4554
Epoch 109, accuracy: 0.6400
Epoch 110, accuracy: 0.6400
Epoch 110, Train Loss: 0.2609, Val Loss: 1.4554
Epoch 111, accuracy: 0.6400
Epoch 112, accuracy: 0.6400
Epoch 112, Train Loss: 0.1733, Val Loss: 1.4554
Epoch 113, accuracy: 0.6400
Epoch 114, accuracy: 0.6400
Epoch 114, Train Loss: 0.1459, Val Loss: 1.4554
Epoch 115, accuracy: 0.6400
Epoch 116, accuracy: 0.6400
Epoch 116, Train Loss: 0.2341, Val Loss: 1.4554
Epoch 117, accuracy: 0.6400
Epoch 118, accuracy: 0.6400
Epoch 118, Train Loss: 0.2232, Val Loss: 1.4554
Epoch 119, accuracy: 0.6400
Epoch 120, accuracy: 0.6400
Epoch 120, Train Loss: 0.2655, Val Loss: 1.4554
Epoch 121, accuracy: 0.6400
Epoch 122, accuracy: 0.6400
Epoch 122, Train Loss: 0.1334, Val Loss: 1.4554
Epoch 123, accuracy: 0.6400
Epoch 124, accuracy: 0.6400
Epoch 124, Train Loss: 0.1585, Val Loss: 1.4554
Epoch 125, accuracy: 0.6400
Epoch 126, accuracy: 0.6400
Epoch 126, Train Loss: 0.1580, Val Loss: 1.4554
Epoch 127, accuracy: 0.6400
Epoch 128, accuracy: 0.6400
Epoch 128, Train Loss: 0.2060, Val Loss: 1.4554
Epoch 129, accuracy: 0.6400
Epoch 130, accuracy: 0.6400
Epoch 130, Train Loss: 0.2765, Val Loss: 1.4554
Epoch 131, accuracy: 0.6400
Epoch 132, accuracy: 0.6400
Epoch 132, Train Loss: 0.2533, Val Loss: 1.4554
Epoch 133, accuracy: 0.6400
Epoch 134, accuracy: 0.6400
Epoch 134, Train Loss: 0.1917, Val Loss: 1.4554
Epoch 135, accuracy: 0.6400
Epoch 136, accuracy: 0.6400
Epoch 136, Train Loss: 0.1280, Val Loss: 1.4554
Epoch 137, accuracy: 0.6400
Epoch 138, accuracy: 0.6400
Epoch 138, Train Loss: 0.2280, Val Loss: 1.4554
Epoch 139, accuracy: 0.6400
Epoch 140, accuracy: 0.6400
Epoch 140, Train Loss: 0.2398, Val Loss: 1.4554
Epoch 141, accuracy: 0.6400
Epoch 142, accuracy: 0.6400
Epoch 142, Train Loss: 0.1809, Val Loss: 1.4554
Epoch 143, accuracy: 0.6400
Epoch 144, accuracy: 0.6400
Epoch 144, Train Loss: 0.1640, Val Loss: 1.4554
Epoch 145, accuracy: 0.6400
Epoch 146, accuracy: 0.6400
Epoch 146, Train Loss: 0.1920, Val Loss: 1.4554
Epoch 147, accuracy: 0.6400
Epoch 148, accuracy: 0.6400
Epoch 148, Train Loss: 0.1179, Val Loss: 1.4554
Epoch 149, accuracy: 0.6400
Epoch 150, accuracy: 0.6400
Epoch 150, Train Loss: 0.1770, Val Loss: 1.4554
Epoch 151, accuracy: 0.6400
Epoch 152, accuracy: 0.6400
Epoch 152, Train Loss: 0.2260, Val Loss: 1.4554
Epoch 153, accuracy: 0.6400
Epoch 154, accuracy: 0.6400
Epoch 154, Train Loss: 0.1806, Val Loss: 1.4554
Epoch 155, accuracy: 0.6400
Epoch 156, accuracy: 0.6400
Epoch 156, Train Loss: 0.2149, Val Loss: 1.4554
Epoch 157, accuracy: 0.6400
Epoch 158, accuracy: 0.6400
Epoch 158, Train Loss: 0.1490, Val Loss: 1.4554
Epoch 159, accuracy: 0.6400
Epoch 160, accuracy: 0.6400
Epoch 160, Train Loss: 0.1705, Val Loss: 1.4554
Epoch 161, accuracy: 0.6400
Epoch 162, accuracy: 0.6400
Epoch 162, Train Loss: 0.1695, Val Loss: 1.4554
Epoch 163, accuracy: 0.6400
Epoch 164, accuracy: 0.6400
Epoch 164, Train Loss: 0.1468, Val Loss: 1.4554
Epoch 165, accuracy: 0.6400
Epoch 166, accuracy: 0.6400
Epoch 166, Train Loss: 0.2069, Val Loss: 1.4554
Epoch 167, accuracy: 0.6400
Epoch 168, accuracy: 0.6400
Epoch 168, Train Loss: 0.1605, Val Loss: 1.4554
Epoch 169, accuracy: 0.6400
Epoch 170, accuracy: 0.6400
Epoch 170, Train Loss: 0.1489, Val Loss: 1.4554
Epoch 171, accuracy: 0.6400
Epoch 172, accuracy: 0.6400
Epoch 172, Train Loss: 0.1221, Val Loss: 1.4554
Epoch 173, accuracy: 0.6400
Epoch 174, accuracy: 0.6400
Epoch 174, Train Loss: 0.1627, Val Loss: 1.4554
Epoch 175, accuracy: 0.6400
Epoch 176, accuracy: 0.6400
Epoch 176, Train Loss: 0.2284, Val Loss: 1.4554
Epoch 177, accuracy: 0.6400
Epoch 178, accuracy: 0.6400
Epoch 178, Train Loss: 0.1790, Val Loss: 1.4554
Epoch 179, accuracy: 0.6400
Epoch 180, accuracy: 0.6400
Epoch 180, Train Loss: 0.1615, Val Loss: 1.4554
Epoch 181, accuracy: 0.6400
Epoch 182, accuracy: 0.6400
Epoch 182, Train Loss: 0.1617, Val Loss: 1.4554
Epoch 183, accuracy: 0.6400
Epoch 184, accuracy: 0.6400
Epoch 184, Train Loss: 0.1807, Val Loss: 1.4554
Epoch 185, accuracy: 0.6400
Epoch 186, accuracy: 0.6400
Epoch 186, Train Loss: 0.1601, Val Loss: 1.4554
Epoch 187, accuracy: 0.6400
Epoch 188, accuracy: 0.6400
Epoch 188, Train Loss: 0.1880, Val Loss: 1.4554
Epoch 189, accuracy: 0.6400
Epoch 190, accuracy: 0.6400
Epoch 190, Train Loss: 0.2270, Val Loss: 1.4554
Epoch 191, accuracy: 0.6400
Epoch 192, accuracy: 0.6400
Epoch 192, Train Loss: 0.1784, Val Loss: 1.4554
Epoch 193, accuracy: 0.6400
Epoch 194, accuracy: 0.6400
Epoch 194, Train Loss: 0.2200, Val Loss: 1.4554
Epoch 195, accuracy: 0.6400
Epoch 196, accuracy: 0.6400
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 196, Train Loss: 0.1456, Val Loss: 1.4554
Epoch 197, accuracy: 0.6400
Epoch 198, accuracy: 0.6400
Epoch 198, Train Loss: 0.2048, Val Loss: 1.4554
Epoch 199, accuracy: 0.6400
Loaded best model with val_loss = 1.1106232404708862
test :accuracy 0.6780, f1_macro: 0.6298, f1_micro: 0.6780, auc: 0.8643
Training mamba3 with 4 layers...
可训练参数: 1651646_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.4705
Epoch 0, accuracy: 0.3990
Epoch 0, Train Loss: 1.8673, Val Loss: 1.4705
Epoch 1, accuracy: 0.3580
✅ Epoch 2: New best model saved with val_loss = 1.3146
Epoch 2, accuracy: 0.5040
Epoch 2, Train Loss: 1.4463, Val Loss: 1.3146
✅ Epoch 3: New best model saved with val_loss = 1.2082
Epoch 3, accuracy: 0.5600
✅ Epoch 4: New best model saved with val_loss = 1.1854
Epoch 4, accuracy: 0.5960
Epoch 4, Train Loss: 0.8596, Val Loss: 1.1854
Epoch 5, accuracy: 0.5560
Epoch 6, accuracy: 0.5850
Epoch 6, Train Loss: 0.5352, Val Loss: 1.2946
Epoch 7, accuracy: 0.6220
Epoch 8, accuracy: 0.6190
Epoch 8, Train Loss: 0.4223, Val Loss: 1.2890
Epoch 9, accuracy: 0.6180
Epoch 10, accuracy: 0.6210
Epoch 10, Train Loss: 0.4012, Val Loss: 1.3207
Epoch 11, accuracy: 0.6200
Epoch 12, accuracy: 0.6250
Epoch 12, Train Loss: 0.3222, Val Loss: 1.3278
Epoch 13, accuracy: 0.6270
Epoch 14, accuracy: 0.6300
Epoch 14, Train Loss: 0.4009, Val Loss: 1.3333
Epoch 15, accuracy: 0.6310
Epoch 16, accuracy: 0.6380
Epoch 16, Train Loss: 0.2417, Val Loss: 1.3328
Epoch 17, accuracy: 0.6390
Epoch 18, accuracy: 0.6390
Epoch 18, Train Loss: 0.2970, Val Loss: 1.3327
Epoch 19, accuracy: 0.6390
Epoch 20, accuracy: 0.6400
Epoch 20, Train Loss: 0.1943, Val Loss: 1.3323
Epoch 21, accuracy: 0.6400
Epoch 22, accuracy: 0.6400
Epoch 22, Train Loss: 0.2233, Val Loss: 1.3324
Epoch 23, accuracy: 0.6400
Epoch 24, accuracy: 0.6400
Epoch 24, Train Loss: 0.2958, Val Loss: 1.3324
Epoch 25, accuracy: 0.6400
Epoch 26, accuracy: 0.6400
Epoch 26, Train Loss: 0.2555, Val Loss: 1.3325
Epoch 27, accuracy: 0.6400
Epoch 28, accuracy: 0.6400
Epoch 28, Train Loss: 0.2448, Val Loss: 1.3326
Epoch 29, accuracy: 0.6400
Epoch 30, accuracy: 0.6400
Epoch 30, Train Loss: 0.2553, Val Loss: 1.3326
Epoch 31, accuracy: 0.6400
Epoch 32, accuracy: 0.6400
Epoch 32, Train Loss: 0.2754, Val Loss: 1.3326
Epoch 33, accuracy: 0.6400
Epoch 34, accuracy: 0.6400
Epoch 34, Train Loss: 0.2580, Val Loss: 1.3327
Epoch 35, accuracy: 0.6400
Epoch 36, accuracy: 0.6400
Epoch 36, Train Loss: 0.3055, Val Loss: 1.3327
Epoch 37, accuracy: 0.6400
Epoch 38, accuracy: 0.6400
Epoch 38, Train Loss: 0.2630, Val Loss: 1.3327
Epoch 39, accuracy: 0.6400
Epoch 40, accuracy: 0.6400
Epoch 40, Train Loss: 0.2385, Val Loss: 1.3327
Epoch 41, accuracy: 0.6400
Epoch 42, accuracy: 0.6400
Epoch 42, Train Loss: 0.2236, Val Loss: 1.3327
Epoch 43, accuracy: 0.6400
Epoch 44, accuracy: 0.6400
Epoch 44, Train Loss: 0.2247, Val Loss: 1.3327
Epoch 45, accuracy: 0.6400
Epoch 46, accuracy: 0.6400
Epoch 46, Train Loss: 0.2464, Val Loss: 1.3327
Epoch 47, accuracy: 0.6400
Epoch 48, accuracy: 0.6400
Epoch 48, Train Loss: 0.2217, Val Loss: 1.3327
Epoch 49, accuracy: 0.6400
Epoch 50, accuracy: 0.6400
Epoch 50, Train Loss: 0.2966, Val Loss: 1.3327
Epoch 51, accuracy: 0.6400
Epoch 52, accuracy: 0.6400
Epoch 52, Train Loss: 0.2705, Val Loss: 1.3327
Epoch 53, accuracy: 0.6400
Epoch 54, accuracy: 0.6400
Epoch 54, Train Loss: 0.2893, Val Loss: 1.3327
Epoch 55, accuracy: 0.6400
Epoch 56, accuracy: 0.6400
Epoch 56, Train Loss: 0.2801, Val Loss: 1.3327
Epoch 57, accuracy: 0.6400
Epoch 58, accuracy: 0.6400
Epoch 58, Train Loss: 0.2455, Val Loss: 1.3327
Epoch 59, accuracy: 0.6400
Epoch 60, accuracy: 0.6400
Epoch 60, Train Loss: 0.2391, Val Loss: 1.3327
Epoch 61, accuracy: 0.6400
Epoch 62, accuracy: 0.6400
Epoch 62, Train Loss: 0.2368, Val Loss: 1.3327
Epoch 63, accuracy: 0.6400
Epoch 64, accuracy: 0.6400
Epoch 64, Train Loss: 0.2638, Val Loss: 1.3327
Epoch 65, accuracy: 0.6400
Epoch 66, accuracy: 0.6400
Epoch 66, Train Loss: 0.3220, Val Loss: 1.3327
Epoch 67, accuracy: 0.6400
Epoch 68, accuracy: 0.6400
Epoch 68, Train Loss: 0.2812, Val Loss: 1.3327
Epoch 69, accuracy: 0.6400
Epoch 70, accuracy: 0.6400
Epoch 70, Train Loss: 0.2711, Val Loss: 1.3327
Epoch 71, accuracy: 0.6400
Epoch 72, accuracy: 0.6400
Epoch 72, Train Loss: 0.2422, Val Loss: 1.3327
Epoch 73, accuracy: 0.6400
Epoch 74, accuracy: 0.6400
Epoch 74, Train Loss: 0.2459, Val Loss: 1.3327
Epoch 75, accuracy: 0.6400
Epoch 76, accuracy: 0.6400
Epoch 76, Train Loss: 0.2577, Val Loss: 1.3327
Epoch 77, accuracy: 0.6400
Epoch 78, accuracy: 0.6400
Epoch 78, Train Loss: 0.2749, Val Loss: 1.3327
Epoch 79, accuracy: 0.6400
Epoch 80, accuracy: 0.6400
Epoch 80, Train Loss: 0.2843, Val Loss: 1.3327
Epoch 81, accuracy: 0.6400
Epoch 82, accuracy: 0.6400
Epoch 82, Train Loss: 0.2689, Val Loss: 1.3327
Epoch 83, accuracy: 0.6400
Epoch 84, accuracy: 0.6400
Epoch 84, Train Loss: 0.3634, Val Loss: 1.3327
Epoch 85, accuracy: 0.6400
Epoch 86, accuracy: 0.6400
Epoch 86, Train Loss: 0.2547, Val Loss: 1.3327
Epoch 87, accuracy: 0.6400
Epoch 88, accuracy: 0.6400
Epoch 88, Train Loss: 0.2628, Val Loss: 1.3327
Epoch 89, accuracy: 0.6400
Epoch 90, accuracy: 0.6400
Epoch 90, Train Loss: 0.2690, Val Loss: 1.3327
Epoch 91, accuracy: 0.6400
Epoch 92, accuracy: 0.6400
Epoch 92, Train Loss: 0.2802, Val Loss: 1.3327
Epoch 93, accuracy: 0.6400
Epoch 94, accuracy: 0.6400
Epoch 94, Train Loss: 0.2437, Val Loss: 1.3327
Epoch 95, accuracy: 0.6400
Epoch 96, accuracy: 0.6400
Epoch 96, Train Loss: 0.3449, Val Loss: 1.3327
Epoch 97, accuracy: 0.6400
Epoch 98, accuracy: 0.6400
Epoch 98, Train Loss: 0.2881, Val Loss: 1.3327
Epoch 99, accuracy: 0.6400
Epoch 100, accuracy: 0.6400
Epoch 100, Train Loss: 0.3073, Val Loss: 1.3327
Epoch 101, accuracy: 0.6400
Epoch 102, accuracy: 0.6400
Epoch 102, Train Loss: 0.2758, Val Loss: 1.3327
Epoch 103, accuracy: 0.6400
Epoch 104, accuracy: 0.6400
Epoch 104, Train Loss: 0.2334, Val Loss: 1.3327
Epoch 105, accuracy: 0.6400
Epoch 106, accuracy: 0.6400
Epoch 106, Train Loss: 0.1937, Val Loss: 1.3327
Epoch 107, accuracy: 0.6400
Epoch 108, accuracy: 0.6400
Epoch 108, Train Loss: 0.2416, Val Loss: 1.3327
Epoch 109, accuracy: 0.6400
Epoch 110, accuracy: 0.6400
Epoch 110, Train Loss: 0.2867, Val Loss: 1.3327
Epoch 111, accuracy: 0.6400
Epoch 112, accuracy: 0.6400
Epoch 112, Train Loss: 0.1913, Val Loss: 1.3327
Epoch 113, accuracy: 0.6400
Epoch 114, accuracy: 0.6400
Epoch 114, Train Loss: 0.2512, Val Loss: 1.3327
Epoch 115, accuracy: 0.6400
Epoch 116, accuracy: 0.6400
Epoch 116, Train Loss: 0.2823, Val Loss: 1.3327
Epoch 117, accuracy: 0.6400
Epoch 118, accuracy: 0.6400
Epoch 118, Train Loss: 0.1917, Val Loss: 1.3327
Epoch 119, accuracy: 0.6400
Epoch 120, accuracy: 0.6400
Epoch 120, Train Loss: 0.2806, Val Loss: 1.3327
Epoch 121, accuracy: 0.6400
Epoch 122, accuracy: 0.6400
Epoch 122, Train Loss: 0.2237, Val Loss: 1.3327
Epoch 123, accuracy: 0.6400
Epoch 124, accuracy: 0.6400
Epoch 124, Train Loss: 0.2865, Val Loss: 1.3327
Epoch 125, accuracy: 0.6400
Epoch 126, accuracy: 0.6400
Epoch 126, Train Loss: 0.3070, Val Loss: 1.3327
Epoch 127, accuracy: 0.6400
Epoch 128, accuracy: 0.6400
Epoch 128, Train Loss: 0.2552, Val Loss: 1.3327
Epoch 129, accuracy: 0.6400
Epoch 130, accuracy: 0.6400
Epoch 130, Train Loss: 0.2718, Val Loss: 1.3327
Epoch 131, accuracy: 0.6400
Epoch 132, accuracy: 0.6400
Epoch 132, Train Loss: 0.2723, Val Loss: 1.3327
Epoch 133, accuracy: 0.6400
Epoch 134, accuracy: 0.6400
Epoch 134, Train Loss: 0.2829, Val Loss: 1.3327
Epoch 135, accuracy: 0.6400
Epoch 136, accuracy: 0.6400
Epoch 136, Train Loss: 0.2342, Val Loss: 1.3327
Epoch 137, accuracy: 0.6400
Epoch 138, accuracy: 0.6400
Epoch 138, Train Loss: 0.3247, Val Loss: 1.3327
Epoch 139, accuracy: 0.6400
Epoch 140, accuracy: 0.6400
Epoch 140, Train Loss: 0.2463, Val Loss: 1.3327
Epoch 141, accuracy: 0.6400
Epoch 142, accuracy: 0.6400
Epoch 142, Train Loss: 0.1782, Val Loss: 1.3327
Epoch 143, accuracy: 0.6400
Epoch 144, accuracy: 0.6400
Epoch 144, Train Loss: 0.3322, Val Loss: 1.3327
Epoch 145, accuracy: 0.6400
Epoch 146, accuracy: 0.6400
Epoch 146, Train Loss: 0.2815, Val Loss: 1.3327
Epoch 147, accuracy: 0.6400
Epoch 148, accuracy: 0.6400
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 148, Train Loss: 0.2468, Val Loss: 1.3327
Epoch 149, accuracy: 0.6400
Epoch 150, accuracy: 0.6400
Epoch 150, Train Loss: 0.2931, Val Loss: 1.3327
Epoch 151, accuracy: 0.6400
Epoch 152, accuracy: 0.6400
Epoch 152, Train Loss: 0.3180, Val Loss: 1.3327
Epoch 153, accuracy: 0.6400
Epoch 154, accuracy: 0.6400
Epoch 154, Train Loss: 0.2168, Val Loss: 1.3327
Epoch 155, accuracy: 0.6400
Epoch 156, accuracy: 0.6400
Epoch 156, Train Loss: 0.3086, Val Loss: 1.3327
Epoch 157, accuracy: 0.6400
Epoch 158, accuracy: 0.6400
Epoch 158, Train Loss: 0.2276, Val Loss: 1.3327
Epoch 159, accuracy: 0.6400
Epoch 160, accuracy: 0.6400
Epoch 160, Train Loss: 0.2722, Val Loss: 1.3327
Epoch 161, accuracy: 0.6400
Epoch 162, accuracy: 0.6400
Epoch 162, Train Loss: 0.2602, Val Loss: 1.3327
Epoch 163, accuracy: 0.6400
Epoch 164, accuracy: 0.6400
Epoch 164, Train Loss: 0.2058, Val Loss: 1.3327
Epoch 165, accuracy: 0.6400
Epoch 166, accuracy: 0.6400
Epoch 166, Train Loss: 0.2784, Val Loss: 1.3327
Epoch 167, accuracy: 0.6400
Epoch 168, accuracy: 0.6400
Epoch 168, Train Loss: 0.3442, Val Loss: 1.3327
Epoch 169, accuracy: 0.6400
Epoch 170, accuracy: 0.6400
Epoch 170, Train Loss: 0.2669, Val Loss: 1.3327
Epoch 171, accuracy: 0.6400
Epoch 172, accuracy: 0.6400
Epoch 172, Train Loss: 0.3185, Val Loss: 1.3327
Epoch 173, accuracy: 0.6400
Epoch 174, accuracy: 0.6400
Epoch 174, Train Loss: 0.2386, Val Loss: 1.3327
Epoch 175, accuracy: 0.6400
Epoch 176, accuracy: 0.6400
Epoch 176, Train Loss: 0.2638, Val Loss: 1.3327
Epoch 177, accuracy: 0.6400
Epoch 178, accuracy: 0.6400
Epoch 178, Train Loss: 0.3043, Val Loss: 1.3327
Epoch 179, accuracy: 0.6400
Epoch 180, accuracy: 0.6400
Epoch 180, Train Loss: 0.3065, Val Loss: 1.3327
Epoch 181, accuracy: 0.6400
Epoch 182, accuracy: 0.6400
Epoch 182, Train Loss: 0.3085, Val Loss: 1.3327
Epoch 183, accuracy: 0.6400
Epoch 184, accuracy: 0.6400
Epoch 184, Train Loss: 0.2801, Val Loss: 1.3327
Epoch 185, accuracy: 0.6400
Epoch 186, accuracy: 0.6400
Epoch 186, Train Loss: 0.2658, Val Loss: 1.3327
Epoch 187, accuracy: 0.6400
Epoch 188, accuracy: 0.6400
Epoch 188, Train Loss: 0.2903, Val Loss: 1.3327
Epoch 189, accuracy: 0.6400
Epoch 190, accuracy: 0.6400
Epoch 190, Train Loss: 0.2322, Val Loss: 1.3327
Epoch 191, accuracy: 0.6400
Epoch 192, accuracy: 0.6400
Epoch 192, Train Loss: 0.3635, Val Loss: 1.3327
Epoch 193, accuracy: 0.6400
Epoch 194, accuracy: 0.6400
Epoch 194, Train Loss: 0.3723, Val Loss: 1.3327
Epoch 195, accuracy: 0.6400
Epoch 196, accuracy: 0.6400
Epoch 196, Train Loss: 0.2350, Val Loss: 1.3327
Epoch 197, accuracy: 0.6400
Epoch 198, accuracy: 0.6400
Epoch 198, Train Loss: 0.2816, Val Loss: 1.3327
Epoch 199, accuracy: 0.6400
Loaded best model with val_loss = 1.1854047775268555
test :accuracy 0.5960, f1_macro: 0.5728, f1_micro: 0.5960, auc: 0.8560
Training mamba3 with 5 layers...
可训练参数: 1734590_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.3430
Epoch 0, accuracy: 0.4860
Epoch 0, Train Loss: 1.8192, Val Loss: 1.3430
Epoch 1, accuracy: 0.2000
✅ Epoch 2: New best model saved with val_loss = 1.2037
Epoch 2, accuracy: 0.5920
Epoch 2, Train Loss: 1.3021, Val Loss: 1.2037
✅ Epoch 3: New best model saved with val_loss = 1.1379
Epoch 3, accuracy: 0.5600
✅ Epoch 4: New best model saved with val_loss = 1.1210
Epoch 4, accuracy: 0.5960
Epoch 4, Train Loss: 0.7608, Val Loss: 1.1210
✅ Epoch 5: New best model saved with val_loss = 1.0729
Epoch 5, accuracy: 0.6300
✅ Epoch 6: New best model saved with val_loss = 1.0554
Epoch 6, accuracy: 0.6550
Epoch 6, Train Loss: 0.4514, Val Loss: 1.0554
Epoch 7, accuracy: 0.6660
Epoch 8, accuracy: 0.6660
Epoch 8, Train Loss: 0.3066, Val Loss: 1.2118
Epoch 9, accuracy: 0.6600
Epoch 10, accuracy: 0.6620
Epoch 10, Train Loss: 0.2978, Val Loss: 1.2952
Epoch 11, accuracy: 0.6610
Epoch 12, accuracy: 0.6430
Epoch 12, Train Loss: 0.2366, Val Loss: 1.3882
Epoch 13, accuracy: 0.6410
Epoch 14, accuracy: 0.6430
Epoch 14, Train Loss: 0.2501, Val Loss: 1.3986
Epoch 15, accuracy: 0.6420
Epoch 16, accuracy: 0.6460
Epoch 16, Train Loss: 0.2808, Val Loss: 1.4051
Epoch 17, accuracy: 0.6450
Epoch 18, accuracy: 0.6500
Epoch 18, Train Loss: 0.2222, Val Loss: 1.4117
Epoch 19, accuracy: 0.6500
Epoch 20, accuracy: 0.6500
Epoch 20, Train Loss: 0.2026, Val Loss: 1.4121
Epoch 21, accuracy: 0.6510
Epoch 22, accuracy: 0.6520
Epoch 22, Train Loss: 0.2565, Val Loss: 1.4125
Epoch 23, accuracy: 0.6530
Epoch 24, accuracy: 0.6530
Epoch 24, Train Loss: 0.2809, Val Loss: 1.4125
Epoch 25, accuracy: 0.6530
Epoch 26, accuracy: 0.6530
Epoch 26, Train Loss: 0.2480, Val Loss: 1.4124
Epoch 27, accuracy: 0.6530
Epoch 28, accuracy: 0.6530
Epoch 28, Train Loss: 0.1975, Val Loss: 1.4124
Epoch 29, accuracy: 0.6530
Epoch 30, accuracy: 0.6530
Epoch 30, Train Loss: 0.3168, Val Loss: 1.4124
Epoch 31, accuracy: 0.6530
Epoch 32, accuracy: 0.6530
Epoch 32, Train Loss: 0.2188, Val Loss: 1.4124
Epoch 33, accuracy: 0.6530
Epoch 34, accuracy: 0.6530
Epoch 34, Train Loss: 0.1702, Val Loss: 1.4124
Epoch 35, accuracy: 0.6530
Epoch 36, accuracy: 0.6530
Epoch 36, Train Loss: 0.2069, Val Loss: 1.4124
Epoch 37, accuracy: 0.6530
Epoch 38, accuracy: 0.6530
Epoch 38, Train Loss: 0.2475, Val Loss: 1.4124
Epoch 39, accuracy: 0.6530
Epoch 40, accuracy: 0.6530
Epoch 40, Train Loss: 0.2866, Val Loss: 1.4124
Epoch 41, accuracy: 0.6530
Epoch 42, accuracy: 0.6530
Epoch 42, Train Loss: 0.1676, Val Loss: 1.4124
Epoch 43, accuracy: 0.6530
Epoch 44, accuracy: 0.6530
Epoch 44, Train Loss: 0.2528, Val Loss: 1.4124
Epoch 45, accuracy: 0.6530
Epoch 46, accuracy: 0.6530
Epoch 46, Train Loss: 0.2590, Val Loss: 1.4124
Epoch 47, accuracy: 0.6530
Epoch 48, accuracy: 0.6530
Epoch 48, Train Loss: 0.2639, Val Loss: 1.4124
Epoch 49, accuracy: 0.6530
Epoch 50, accuracy: 0.6530
Epoch 50, Train Loss: 0.2277, Val Loss: 1.4124
Epoch 51, accuracy: 0.6530
Epoch 52, accuracy: 0.6530
Epoch 52, Train Loss: 0.2358, Val Loss: 1.4124
Epoch 53, accuracy: 0.6530
Epoch 54, accuracy: 0.6530
Epoch 54, Train Loss: 0.2389, Val Loss: 1.4124
Epoch 55, accuracy: 0.6530
Epoch 56, accuracy: 0.6530
Epoch 56, Train Loss: 0.2613, Val Loss: 1.4124
Epoch 57, accuracy: 0.6530
Epoch 58, accuracy: 0.6530
Epoch 58, Train Loss: 0.1927, Val Loss: 1.4124
Epoch 59, accuracy: 0.6530
Epoch 60, accuracy: 0.6530
Epoch 60, Train Loss: 0.2340, Val Loss: 1.4124
Epoch 61, accuracy: 0.6530
Epoch 62, accuracy: 0.6530
Epoch 62, Train Loss: 0.2986, Val Loss: 1.4124
Epoch 63, accuracy: 0.6530
Epoch 64, accuracy: 0.6530
Epoch 64, Train Loss: 0.2346, Val Loss: 1.4124
Epoch 65, accuracy: 0.6530
Epoch 66, accuracy: 0.6530
Epoch 66, Train Loss: 0.1910, Val Loss: 1.4124
Epoch 67, accuracy: 0.6530
Epoch 68, accuracy: 0.6530
Epoch 68, Train Loss: 0.1899, Val Loss: 1.4124
Epoch 69, accuracy: 0.6530
Epoch 70, accuracy: 0.6530
Epoch 70, Train Loss: 0.2820, Val Loss: 1.4124
Epoch 71, accuracy: 0.6530
Epoch 72, accuracy: 0.6530
Epoch 72, Train Loss: 0.1664, Val Loss: 1.4124
Epoch 73, accuracy: 0.6530
Epoch 74, accuracy: 0.6530
Epoch 74, Train Loss: 0.2780, Val Loss: 1.4124
Epoch 75, accuracy: 0.6530
Epoch 76, accuracy: 0.6530
Epoch 76, Train Loss: 0.1763, Val Loss: 1.4124
Epoch 77, accuracy: 0.6530
Epoch 78, accuracy: 0.6530
Epoch 78, Train Loss: 0.2069, Val Loss: 1.4124
Epoch 79, accuracy: 0.6530
Epoch 80, accuracy: 0.6530
Epoch 80, Train Loss: 0.1925, Val Loss: 1.4124
Epoch 81, accuracy: 0.6530
Epoch 82, accuracy: 0.6530
Epoch 82, Train Loss: 0.2452, Val Loss: 1.4124
Epoch 83, accuracy: 0.6530
Epoch 84, accuracy: 0.6530
Epoch 84, Train Loss: 0.2424, Val Loss: 1.4124
Epoch 85, accuracy: 0.6530
Epoch 86, accuracy: 0.6530
Epoch 86, Train Loss: 0.2847, Val Loss: 1.4124
Epoch 87, accuracy: 0.6530
Epoch 88, accuracy: 0.6530
Epoch 88, Train Loss: 0.1861, Val Loss: 1.4124
Epoch 89, accuracy: 0.6530
Epoch 90, accuracy: 0.6530
Epoch 90, Train Loss: 0.2164, Val Loss: 1.4124
Epoch 91, accuracy: 0.6530
Epoch 92, accuracy: 0.6530
Epoch 92, Train Loss: 0.2154, Val Loss: 1.4124
Epoch 93, accuracy: 0.6530
Epoch 94, accuracy: 0.6530
Epoch 94, Train Loss: 0.2599, Val Loss: 1.4124
Epoch 95, accuracy: 0.6530
Epoch 96, accuracy: 0.6530
Epoch 96, Train Loss: 0.2634, Val Loss: 1.4124
Epoch 97, accuracy: 0.6530
Epoch 98, accuracy: 0.6530
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 98, Train Loss: 0.2060, Val Loss: 1.4124
Epoch 99, accuracy: 0.6530
Epoch 100, accuracy: 0.6530
Epoch 100, Train Loss: 0.2833, Val Loss: 1.4124
Epoch 101, accuracy: 0.6530
Epoch 102, accuracy: 0.6530
Epoch 102, Train Loss: 0.1932, Val Loss: 1.4124
Epoch 103, accuracy: 0.6530
Epoch 104, accuracy: 0.6530
Epoch 104, Train Loss: 0.1764, Val Loss: 1.4124
Epoch 105, accuracy: 0.6530
Epoch 106, accuracy: 0.6530
Epoch 106, Train Loss: 0.2598, Val Loss: 1.4124
Epoch 107, accuracy: 0.6530
Epoch 108, accuracy: 0.6530
Epoch 108, Train Loss: 0.2092, Val Loss: 1.4124
Epoch 109, accuracy: 0.6530
Epoch 110, accuracy: 0.6530
Epoch 110, Train Loss: 0.2610, Val Loss: 1.4124
Epoch 111, accuracy: 0.6530
Epoch 112, accuracy: 0.6530
Epoch 112, Train Loss: 0.2262, Val Loss: 1.4124
Epoch 113, accuracy: 0.6530
Epoch 114, accuracy: 0.6530
Epoch 114, Train Loss: 0.1518, Val Loss: 1.4124
Epoch 115, accuracy: 0.6530
Epoch 116, accuracy: 0.6530
Epoch 116, Train Loss: 0.1751, Val Loss: 1.4124
Epoch 117, accuracy: 0.6530
Epoch 118, accuracy: 0.6530
Epoch 118, Train Loss: 0.2117, Val Loss: 1.4124
Epoch 119, accuracy: 0.6530
Epoch 120, accuracy: 0.6530
Epoch 120, Train Loss: 0.2162, Val Loss: 1.4124
Epoch 121, accuracy: 0.6530
Epoch 122, accuracy: 0.6530
Epoch 122, Train Loss: 0.2470, Val Loss: 1.4124
Epoch 123, accuracy: 0.6530
Epoch 124, accuracy: 0.6530
Epoch 124, Train Loss: 0.2191, Val Loss: 1.4124
Epoch 125, accuracy: 0.6530
Epoch 126, accuracy: 0.6530
Epoch 126, Train Loss: 0.2323, Val Loss: 1.4124
Epoch 127, accuracy: 0.6530
Epoch 128, accuracy: 0.6530
Epoch 128, Train Loss: 0.1895, Val Loss: 1.4124
Epoch 129, accuracy: 0.6530
Epoch 130, accuracy: 0.6530
Epoch 130, Train Loss: 0.1726, Val Loss: 1.4124
Epoch 131, accuracy: 0.6530
Epoch 132, accuracy: 0.6530
Epoch 132, Train Loss: 0.2625, Val Loss: 1.4124
Epoch 133, accuracy: 0.6530
Epoch 134, accuracy: 0.6530
Epoch 134, Train Loss: 0.1580, Val Loss: 1.4124
Epoch 135, accuracy: 0.6530
Epoch 136, accuracy: 0.6530
Epoch 136, Train Loss: 0.2553, Val Loss: 1.4124
Epoch 137, accuracy: 0.6530
Epoch 138, accuracy: 0.6530
Epoch 138, Train Loss: 0.2526, Val Loss: 1.4124
Epoch 139, accuracy: 0.6530
Epoch 140, accuracy: 0.6530
Epoch 140, Train Loss: 0.2231, Val Loss: 1.4124
Epoch 141, accuracy: 0.6530
Epoch 142, accuracy: 0.6530
Epoch 142, Train Loss: 0.1778, Val Loss: 1.4124
Epoch 143, accuracy: 0.6530
Epoch 144, accuracy: 0.6530
Epoch 144, Train Loss: 0.1991, Val Loss: 1.4124
Epoch 145, accuracy: 0.6530
Epoch 146, accuracy: 0.6530
Epoch 146, Train Loss: 0.2134, Val Loss: 1.4124
Epoch 147, accuracy: 0.6530
Epoch 148, accuracy: 0.6530
Epoch 148, Train Loss: 0.1983, Val Loss: 1.4124
Epoch 149, accuracy: 0.6530
Epoch 150, accuracy: 0.6530
Epoch 150, Train Loss: 0.2327, Val Loss: 1.4124
Epoch 151, accuracy: 0.6530
Epoch 152, accuracy: 0.6530
Epoch 152, Train Loss: 0.2180, Val Loss: 1.4124
Epoch 153, accuracy: 0.6530
Epoch 154, accuracy: 0.6530
Epoch 154, Train Loss: 0.2363, Val Loss: 1.4124
Epoch 155, accuracy: 0.6530
Epoch 156, accuracy: 0.6530
Epoch 156, Train Loss: 0.2006, Val Loss: 1.4124
Epoch 157, accuracy: 0.6530
Epoch 158, accuracy: 0.6530
Epoch 158, Train Loss: 0.3112, Val Loss: 1.4124
Epoch 159, accuracy: 0.6530
Epoch 160, accuracy: 0.6530
Epoch 160, Train Loss: 0.3088, Val Loss: 1.4124
Epoch 161, accuracy: 0.6530
Epoch 162, accuracy: 0.6530
Epoch 162, Train Loss: 0.2534, Val Loss: 1.4124
Epoch 163, accuracy: 0.6530
Epoch 164, accuracy: 0.6530
Epoch 164, Train Loss: 0.2041, Val Loss: 1.4124
Epoch 165, accuracy: 0.6530
Epoch 166, accuracy: 0.6530
Epoch 166, Train Loss: 0.2533, Val Loss: 1.4124
Epoch 167, accuracy: 0.6530
Epoch 168, accuracy: 0.6530
Epoch 168, Train Loss: 0.2113, Val Loss: 1.4124
Epoch 169, accuracy: 0.6530
Epoch 170, accuracy: 0.6530
Epoch 170, Train Loss: 0.2842, Val Loss: 1.4124
Epoch 171, accuracy: 0.6530
Epoch 172, accuracy: 0.6530
Epoch 172, Train Loss: 0.2906, Val Loss: 1.4124
Epoch 173, accuracy: 0.6530
Epoch 174, accuracy: 0.6530
Epoch 174, Train Loss: 0.1659, Val Loss: 1.4124
Epoch 175, accuracy: 0.6530
Epoch 176, accuracy: 0.6530
Epoch 176, Train Loss: 0.2302, Val Loss: 1.4124
Epoch 177, accuracy: 0.6530
Epoch 178, accuracy: 0.6530
Epoch 178, Train Loss: 0.2691, Val Loss: 1.4124
Epoch 179, accuracy: 0.6530
Epoch 180, accuracy: 0.6530
Epoch 180, Train Loss: 0.2156, Val Loss: 1.4124
Epoch 181, accuracy: 0.6530
Epoch 182, accuracy: 0.6530
Epoch 182, Train Loss: 0.3431, Val Loss: 1.4124
Epoch 183, accuracy: 0.6530
Epoch 184, accuracy: 0.6530
Epoch 184, Train Loss: 0.2344, Val Loss: 1.4124
Epoch 185, accuracy: 0.6530
Epoch 186, accuracy: 0.6530
Epoch 186, Train Loss: 0.1777, Val Loss: 1.4124
Epoch 187, accuracy: 0.6530
Epoch 188, accuracy: 0.6530
Epoch 188, Train Loss: 0.2381, Val Loss: 1.4124
Epoch 189, accuracy: 0.6530
Epoch 190, accuracy: 0.6530
Epoch 190, Train Loss: 0.1906, Val Loss: 1.4124
Epoch 191, accuracy: 0.6530
Epoch 192, accuracy: 0.6530
Epoch 192, Train Loss: 0.2875, Val Loss: 1.4124
Epoch 193, accuracy: 0.6530
Epoch 194, accuracy: 0.6530
Epoch 194, Train Loss: 0.2642, Val Loss: 1.4124
Epoch 195, accuracy: 0.6530
Epoch 196, accuracy: 0.6530
Epoch 196, Train Loss: 0.1961, Val Loss: 1.4124
Epoch 197, accuracy: 0.6530
Epoch 198, accuracy: 0.6530
Epoch 198, Train Loss: 0.2169, Val Loss: 1.4124
Epoch 199, accuracy: 0.6530
Loaded best model with val_loss = 1.0554410219192505
test :accuracy 0.6550, f1_macro: 0.6150, f1_micro: 0.6550, auc: 0.8684
Training mamba3 with 6 layers...
可训练参数: 1817534_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.6817
Epoch 0, accuracy: 0.2250
Epoch 0, Train Loss: 1.8534, Val Loss: 1.6817
Epoch 1, accuracy: 0.2090
✅ Epoch 2: New best model saved with val_loss = 1.6035
Epoch 2, accuracy: 0.2890
Epoch 2, Train Loss: 1.7027, Val Loss: 1.6035
✅ Epoch 3: New best model saved with val_loss = 1.4300
Epoch 3, accuracy: 0.5690
✅ Epoch 4: New best model saved with val_loss = 1.4296
Epoch 4, accuracy: 0.5780
Epoch 4, Train Loss: 1.0095, Val Loss: 1.4296
✅ Epoch 5: New best model saved with val_loss = 1.3929
Epoch 5, accuracy: 0.5920
✅ Epoch 6: New best model saved with val_loss = 1.3575
Epoch 6, accuracy: 0.6030
Epoch 6, Train Loss: 0.7688, Val Loss: 1.3575
✅ Epoch 7: New best model saved with val_loss = 1.3412
Epoch 7, accuracy: 0.6180
✅ Epoch 8: New best model saved with val_loss = 1.3305
Epoch 8, accuracy: 0.6110
Epoch 8, Train Loss: 0.7252, Val Loss: 1.3305
Epoch 9, accuracy: 0.6080
Epoch 10, accuracy: 0.6080
Epoch 10, Train Loss: 0.6347, Val Loss: 1.3353
✅ Epoch 11: New best model saved with val_loss = 1.3279
Epoch 11, accuracy: 0.6270
✅ Epoch 12: New best model saved with val_loss = 1.3219
Epoch 12, accuracy: 0.6210
Epoch 12, Train Loss: 0.6148, Val Loss: 1.3219
Epoch 13, accuracy: 0.6280
Epoch 14, accuracy: 0.6390
Epoch 14, Train Loss: 0.4757, Val Loss: 1.3391
Epoch 15, accuracy: 0.6470
Epoch 16, accuracy: 0.6390
Epoch 16, Train Loss: 0.3110, Val Loss: 1.4196
Epoch 17, accuracy: 0.6360
Epoch 18, accuracy: 0.6270
Epoch 18, Train Loss: 0.3459, Val Loss: 1.5440
Epoch 19, accuracy: 0.6270
Epoch 20, accuracy: 0.6270
Epoch 20, Train Loss: 0.3396, Val Loss: 1.5497
Epoch 21, accuracy: 0.6270
Epoch 22, accuracy: 0.6260
Epoch 22, Train Loss: 0.4027, Val Loss: 1.5533
Epoch 23, accuracy: 0.6270
Epoch 24, accuracy: 0.6250
Epoch 24, Train Loss: 0.2700, Val Loss: 1.5599
Epoch 25, accuracy: 0.6240
Epoch 26, accuracy: 0.6230
Epoch 26, Train Loss: 0.3639, Val Loss: 1.5609
Epoch 27, accuracy: 0.6220
Epoch 28, accuracy: 0.6210
Epoch 28, Train Loss: 0.4146, Val Loss: 1.5616
Epoch 29, accuracy: 0.6210
Epoch 30, accuracy: 0.6250
Epoch 30, Train Loss: 0.2971, Val Loss: 1.5620
Epoch 31, accuracy: 0.6250
Epoch 32, accuracy: 0.6240
Epoch 32, Train Loss: 0.2863, Val Loss: 1.5620
Epoch 33, accuracy: 0.6240
Epoch 34, accuracy: 0.6240
Epoch 34, Train Loss: 0.2518, Val Loss: 1.5620
Epoch 35, accuracy: 0.6240
Epoch 36, accuracy: 0.6240
Epoch 36, Train Loss: 0.2820, Val Loss: 1.5620
Epoch 37, accuracy: 0.6240
Epoch 38, accuracy: 0.6240
Epoch 38, Train Loss: 0.2899, Val Loss: 1.5620
Epoch 39, accuracy: 0.6240
Epoch 40, accuracy: 0.6240
Epoch 40, Train Loss: 0.2755, Val Loss: 1.5620
Epoch 41, accuracy: 0.6240
Epoch 42, accuracy: 0.6240
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 42, Train Loss: 0.3105, Val Loss: 1.5620
Epoch 43, accuracy: 0.6240
Epoch 44, accuracy: 0.6240
Epoch 44, Train Loss: 0.2661, Val Loss: 1.5620
Epoch 45, accuracy: 0.6240
Epoch 46, accuracy: 0.6240
Epoch 46, Train Loss: 0.2234, Val Loss: 1.5620
Epoch 47, accuracy: 0.6240
Epoch 48, accuracy: 0.6240
Epoch 48, Train Loss: 0.1607, Val Loss: 1.5620
Epoch 49, accuracy: 0.6240
Epoch 50, accuracy: 0.6240
Epoch 50, Train Loss: 0.3732, Val Loss: 1.5620
Epoch 51, accuracy: 0.6240
Epoch 52, accuracy: 0.6240
Epoch 52, Train Loss: 0.2789, Val Loss: 1.5620
Epoch 53, accuracy: 0.6240
Epoch 54, accuracy: 0.6240
Epoch 54, Train Loss: 0.3364, Val Loss: 1.5620
Epoch 55, accuracy: 0.6240
Epoch 56, accuracy: 0.6240
Epoch 56, Train Loss: 0.4034, Val Loss: 1.5620
Epoch 57, accuracy: 0.6240
Epoch 58, accuracy: 0.6240
Epoch 58, Train Loss: 0.3207, Val Loss: 1.5620
Epoch 59, accuracy: 0.6240
Epoch 60, accuracy: 0.6240
Epoch 60, Train Loss: 0.3324, Val Loss: 1.5620
Epoch 61, accuracy: 0.6240
Epoch 62, accuracy: 0.6240
Epoch 62, Train Loss: 0.2624, Val Loss: 1.5620
Epoch 63, accuracy: 0.6240
Epoch 64, accuracy: 0.6240
Epoch 64, Train Loss: 0.2231, Val Loss: 1.5620
Epoch 65, accuracy: 0.6240
Epoch 66, accuracy: 0.6240
Epoch 66, Train Loss: 0.3128, Val Loss: 1.5620
Epoch 67, accuracy: 0.6240
Epoch 68, accuracy: 0.6240
Epoch 68, Train Loss: 0.2801, Val Loss: 1.5620
Epoch 69, accuracy: 0.6240
Epoch 70, accuracy: 0.6240
Epoch 70, Train Loss: 0.3296, Val Loss: 1.5620
Epoch 71, accuracy: 0.6240
Epoch 72, accuracy: 0.6240
Epoch 72, Train Loss: 0.4213, Val Loss: 1.5620
Epoch 73, accuracy: 0.6240
Epoch 74, accuracy: 0.6240
Epoch 74, Train Loss: 0.3581, Val Loss: 1.5620
Epoch 75, accuracy: 0.6240
Epoch 76, accuracy: 0.6240
Epoch 76, Train Loss: 0.2406, Val Loss: 1.5620
Epoch 77, accuracy: 0.6240
Epoch 78, accuracy: 0.6240
Epoch 78, Train Loss: 0.2774, Val Loss: 1.5620
Epoch 79, accuracy: 0.6240
Epoch 80, accuracy: 0.6240
Epoch 80, Train Loss: 0.1892, Val Loss: 1.5620
Epoch 81, accuracy: 0.6240
Epoch 82, accuracy: 0.6240
Epoch 82, Train Loss: 0.3121, Val Loss: 1.5620
Epoch 83, accuracy: 0.6240
Epoch 84, accuracy: 0.6240
Epoch 84, Train Loss: 0.2108, Val Loss: 1.5620
Epoch 85, accuracy: 0.6240
Epoch 86, accuracy: 0.6240
Epoch 86, Train Loss: 0.4039, Val Loss: 1.5620
Epoch 87, accuracy: 0.6240
Epoch 88, accuracy: 0.6240
Epoch 88, Train Loss: 0.2708, Val Loss: 1.5620
Epoch 89, accuracy: 0.6240
Epoch 90, accuracy: 0.6240
Epoch 90, Train Loss: 0.3448, Val Loss: 1.5620
Epoch 91, accuracy: 0.6240
Epoch 92, accuracy: 0.6240
Epoch 92, Train Loss: 0.3427, Val Loss: 1.5620
Epoch 93, accuracy: 0.6240
Epoch 94, accuracy: 0.6240
Epoch 94, Train Loss: 0.3145, Val Loss: 1.5620
Epoch 95, accuracy: 0.6240
Epoch 96, accuracy: 0.6240
Epoch 96, Train Loss: 0.3721, Val Loss: 1.5620
Epoch 97, accuracy: 0.6240
Epoch 98, accuracy: 0.6240
Epoch 98, Train Loss: 0.3210, Val Loss: 1.5620
Epoch 99, accuracy: 0.6240
Epoch 100, accuracy: 0.6240
Epoch 100, Train Loss: 0.3075, Val Loss: 1.5620
Epoch 101, accuracy: 0.6240
Epoch 102, accuracy: 0.6240
Epoch 102, Train Loss: 0.2672, Val Loss: 1.5620
Epoch 103, accuracy: 0.6240
Epoch 104, accuracy: 0.6240
Epoch 104, Train Loss: 0.2450, Val Loss: 1.5620
Epoch 105, accuracy: 0.6240
Epoch 106, accuracy: 0.6240
Epoch 106, Train Loss: 0.2750, Val Loss: 1.5620
Epoch 107, accuracy: 0.6240
Epoch 108, accuracy: 0.6240
Epoch 108, Train Loss: 0.4123, Val Loss: 1.5620
Epoch 109, accuracy: 0.6240
Epoch 110, accuracy: 0.6240
Epoch 110, Train Loss: 0.3020, Val Loss: 1.5620
Epoch 111, accuracy: 0.6240
Epoch 112, accuracy: 0.6240
Epoch 112, Train Loss: 0.3173, Val Loss: 1.5620
Epoch 113, accuracy: 0.6240
Epoch 114, accuracy: 0.6240
Epoch 114, Train Loss: 0.3224, Val Loss: 1.5620
Epoch 115, accuracy: 0.6240
Epoch 116, accuracy: 0.6240
Epoch 116, Train Loss: 0.3282, Val Loss: 1.5620
Epoch 117, accuracy: 0.6240
Epoch 118, accuracy: 0.6240
Epoch 118, Train Loss: 0.3046, Val Loss: 1.5620
Epoch 119, accuracy: 0.6240
Epoch 120, accuracy: 0.6240
Epoch 120, Train Loss: 0.3354, Val Loss: 1.5620
Epoch 121, accuracy: 0.6240
Epoch 122, accuracy: 0.6240
Epoch 122, Train Loss: 0.2402, Val Loss: 1.5620
Epoch 123, accuracy: 0.6240
Epoch 124, accuracy: 0.6240
Epoch 124, Train Loss: 0.2846, Val Loss: 1.5620
Epoch 125, accuracy: 0.6240
Epoch 126, accuracy: 0.6240
Epoch 126, Train Loss: 0.3742, Val Loss: 1.5620
Epoch 127, accuracy: 0.6240
Epoch 128, accuracy: 0.6240
Epoch 128, Train Loss: 0.2775, Val Loss: 1.5620
Epoch 129, accuracy: 0.6240
Epoch 130, accuracy: 0.6240
Epoch 130, Train Loss: 0.2582, Val Loss: 1.5620
Epoch 131, accuracy: 0.6240
Epoch 132, accuracy: 0.6240
Epoch 132, Train Loss: 0.4004, Val Loss: 1.5620
Epoch 133, accuracy: 0.6240
Epoch 134, accuracy: 0.6240
Epoch 134, Train Loss: 0.2698, Val Loss: 1.5620
Epoch 135, accuracy: 0.6240
Epoch 136, accuracy: 0.6240
Epoch 136, Train Loss: 0.2891, Val Loss: 1.5620
Epoch 137, accuracy: 0.6240
Epoch 138, accuracy: 0.6240
Epoch 138, Train Loss: 0.3376, Val Loss: 1.5620
Epoch 139, accuracy: 0.6240
Epoch 140, accuracy: 0.6240
Epoch 140, Train Loss: 0.2902, Val Loss: 1.5620
Epoch 141, accuracy: 0.6240
Epoch 142, accuracy: 0.6240
Epoch 142, Train Loss: 0.2795, Val Loss: 1.5620
Epoch 143, accuracy: 0.6240
Epoch 144, accuracy: 0.6240
Epoch 144, Train Loss: 0.2584, Val Loss: 1.5620
Epoch 145, accuracy: 0.6240
Epoch 146, accuracy: 0.6240
Epoch 146, Train Loss: 0.3014, Val Loss: 1.5620
Epoch 147, accuracy: 0.6240
Epoch 148, accuracy: 0.6240
Epoch 148, Train Loss: 0.3605, Val Loss: 1.5620
Epoch 149, accuracy: 0.6240
Epoch 150, accuracy: 0.6240
Epoch 150, Train Loss: 0.3281, Val Loss: 1.5620
Epoch 151, accuracy: 0.6240
Epoch 152, accuracy: 0.6240
Epoch 152, Train Loss: 0.3936, Val Loss: 1.5620
Epoch 153, accuracy: 0.6240
Epoch 154, accuracy: 0.6240
Epoch 154, Train Loss: 0.2491, Val Loss: 1.5620
Epoch 155, accuracy: 0.6240
Epoch 156, accuracy: 0.6240
Epoch 156, Train Loss: 0.2255, Val Loss: 1.5620
Epoch 157, accuracy: 0.6240
Epoch 158, accuracy: 0.6240
Epoch 158, Train Loss: 0.3037, Val Loss: 1.5620
Epoch 159, accuracy: 0.6240
Epoch 160, accuracy: 0.6240
Epoch 160, Train Loss: 0.2889, Val Loss: 1.5620
Epoch 161, accuracy: 0.6240
Epoch 162, accuracy: 0.6240
Epoch 162, Train Loss: 0.3335, Val Loss: 1.5620
Epoch 163, accuracy: 0.6240
Epoch 164, accuracy: 0.6240
Epoch 164, Train Loss: 0.3262, Val Loss: 1.5620
Epoch 165, accuracy: 0.6240
Epoch 166, accuracy: 0.6240
Epoch 166, Train Loss: 0.3530, Val Loss: 1.5620
Epoch 167, accuracy: 0.6240
Epoch 168, accuracy: 0.6240
Epoch 168, Train Loss: 0.3944, Val Loss: 1.5620
Epoch 169, accuracy: 0.6240
Epoch 170, accuracy: 0.6240
Epoch 170, Train Loss: 0.2955, Val Loss: 1.5620
Epoch 171, accuracy: 0.6240
Epoch 172, accuracy: 0.6240
Epoch 172, Train Loss: 0.3814, Val Loss: 1.5620
Epoch 173, accuracy: 0.6240
Epoch 174, accuracy: 0.6240
Epoch 174, Train Loss: 0.3023, Val Loss: 1.5620
Epoch 175, accuracy: 0.6240
Epoch 176, accuracy: 0.6240
Epoch 176, Train Loss: 0.3613, Val Loss: 1.5620
Epoch 177, accuracy: 0.6240
Epoch 178, accuracy: 0.6240
Epoch 178, Train Loss: 0.3170, Val Loss: 1.5620
Epoch 179, accuracy: 0.6240
Epoch 180, accuracy: 0.6240
Epoch 180, Train Loss: 0.2940, Val Loss: 1.5620
Epoch 181, accuracy: 0.6240
Epoch 182, accuracy: 0.6240
Epoch 182, Train Loss: 0.2522, Val Loss: 1.5620
Epoch 183, accuracy: 0.6240
Epoch 184, accuracy: 0.6240
Epoch 184, Train Loss: 0.2812, Val Loss: 1.5620
Epoch 185, accuracy: 0.6240
Epoch 186, accuracy: 0.6240
Epoch 186, Train Loss: 0.2962, Val Loss: 1.5620
Epoch 187, accuracy: 0.6240
Epoch 188, accuracy: 0.6240
Epoch 188, Train Loss: 0.2946, Val Loss: 1.5620
Epoch 189, accuracy: 0.6240
Epoch 190, accuracy: 0.6240
Epoch 190, Train Loss: 0.3357, Val Loss: 1.5620
Epoch 191, accuracy: 0.6240
Epoch 192, accuracy: 0.6240
Epoch 192, Train Loss: 0.3242, Val Loss: 1.5620
Epoch 193, accuracy: 0.6240
Epoch 194, accuracy: 0.6240
Epoch 194, Train Loss: 0.3544, Val Loss: 1.5620
Epoch 195, accuracy: 0.6240
Epoch 196, accuracy: 0.6240
Epoch 196, Train Loss: 0.2797, Val Loss: 1.5620
Epoch 197, accuracy: 0.6240
Epoch 198, accuracy: 0.6240
Epoch 198, Train Loss: 0.3000, Val Loss: 1.5620
Epoch 199, accuracy: 0.6240
Loaded best model with val_loss = 1.321889042854309
test :accuracy 0.6210, f1_macro: 0.5875, f1_micro: 0.6210, auc: 0.8334
Training mamba3 with 7 layers...
可训练参数: 1900478_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.5651
Epoch 0, accuracy: 0.4200
Epoch 0, Train Loss: 1.8962, Val Loss: 1.5651
✅ Epoch 1: New best model saved with val_loss = 1.3192
Epoch 1, accuracy: 0.5780
Epoch 2, accuracy: 0.5470
Epoch 2, Train Loss: 1.1370, Val Loss: 1.3327
✅ Epoch 3: New best model saved with val_loss = 1.1809
Epoch 3, accuracy: 0.6150
Epoch 4, accuracy: 0.6110
Epoch 4, Train Loss: 0.6237, Val Loss: 1.1894
Epoch 5, accuracy: 0.5970
Epoch 6, accuracy: 0.5970
Epoch 6, Train Loss: 0.7096, Val Loss: 1.1901
Epoch 7, accuracy: 0.6180
Epoch 8, accuracy: 0.6350
Epoch 8, Train Loss: 0.5229, Val Loss: 1.2084
Epoch 9, accuracy: 0.6330
Epoch 10, accuracy: 0.6320
Epoch 10, Train Loss: 0.4509, Val Loss: 1.2737
Epoch 11, accuracy: 0.6330
Epoch 12, accuracy: 0.6340
Epoch 12, Train Loss: 0.4710, Val Loss: 1.2882
Epoch 13, accuracy: 0.6340
Epoch 14, accuracy: 0.6350
Epoch 14, Train Loss: 0.4145, Val Loss: 1.3039
Epoch 15, accuracy: 0.6360
Epoch 16, accuracy: 0.6360
Epoch 16, Train Loss: 0.3346, Val Loss: 1.3121
Epoch 17, accuracy: 0.6370
Epoch 18, accuracy: 0.6380
Epoch 18, Train Loss: 0.3468, Val Loss: 1.3135
Epoch 19, accuracy: 0.6370
Epoch 20, accuracy: 0.6370
Epoch 20, Train Loss: 0.3108, Val Loss: 1.3145
Epoch 21, accuracy: 0.6380
Epoch 22, accuracy: 0.6380
Epoch 22, Train Loss: 0.4386, Val Loss: 1.3151
Epoch 23, accuracy: 0.6380
Epoch 24, accuracy: 0.6380
Epoch 24, Train Loss: 0.3247, Val Loss: 1.3152
Epoch 25, accuracy: 0.6380
Epoch 26, accuracy: 0.6380
Epoch 26, Train Loss: 0.4130, Val Loss: 1.3153
Epoch 27, accuracy: 0.6380
Epoch 28, accuracy: 0.6380
Epoch 28, Train Loss: 0.3227, Val Loss: 1.3153
Epoch 29, accuracy: 0.6370
Epoch 30, accuracy: 0.6370
Epoch 30, Train Loss: 0.3863, Val Loss: 1.3153
Epoch 31, accuracy: 0.6370
Epoch 32, accuracy: 0.6370
Epoch 32, Train Loss: 0.3460, Val Loss: 1.3154
Epoch 33, accuracy: 0.6370
Epoch 34, accuracy: 0.6370
Epoch 34, Train Loss: 0.3228, Val Loss: 1.3154
Epoch 35, accuracy: 0.6370
Epoch 36, accuracy: 0.6370
Epoch 36, Train Loss: 0.3990, Val Loss: 1.3154
Epoch 37, accuracy: 0.6370
Epoch 38, accuracy: 0.6370
Epoch 38, Train Loss: 0.2987, Val Loss: 1.3154
Epoch 39, accuracy: 0.6370
Epoch 40, accuracy: 0.6370
Epoch 40, Train Loss: 0.3818, Val Loss: 1.3154
Epoch 41, accuracy: 0.6370
Epoch 42, accuracy: 0.6370
Epoch 42, Train Loss: 0.4408, Val Loss: 1.3154
Epoch 43, accuracy: 0.6370
Epoch 44, accuracy: 0.6370
Epoch 44, Train Loss: 0.3892, Val Loss: 1.3154
Epoch 45, accuracy: 0.6370
Epoch 46, accuracy: 0.6370
Epoch 46, Train Loss: 0.4319, Val Loss: 1.3154
Epoch 47, accuracy: 0.6370
Epoch 48, accuracy: 0.6370
Epoch 48, Train Loss: 0.4729, Val Loss: 1.3154
Epoch 49, accuracy: 0.6370
Epoch 50, accuracy: 0.6370
Epoch 50, Train Loss: 0.4052, Val Loss: 1.3154
Epoch 51, accuracy: 0.6370
Epoch 52, accuracy: 0.6370
Epoch 52, Train Loss: 0.3965, Val Loss: 1.3154
Epoch 53, accuracy: 0.6370
Epoch 54, accuracy: 0.6370
Epoch 54, Train Loss: 0.3647, Val Loss: 1.3154
Epoch 55, accuracy: 0.6370
Epoch 56, accuracy: 0.6370
Epoch 56, Train Loss: 0.4041, Val Loss: 1.3154
Epoch 57, accuracy: 0.6370
Epoch 58, accuracy: 0.6370
Epoch 58, Train Loss: 0.3659, Val Loss: 1.3154
Epoch 59, accuracy: 0.6370
Epoch 60, accuracy: 0.6370
Epoch 60, Train Loss: 0.4250, Val Loss: 1.3154
Epoch 61, accuracy: 0.6370
Epoch 62, accuracy: 0.6370
Epoch 62, Train Loss: 0.3632, Val Loss: 1.3154
Epoch 63, accuracy: 0.6370
Epoch 64, accuracy: 0.6370
Epoch 64, Train Loss: 0.4527, Val Loss: 1.3154
Epoch 65, accuracy: 0.6370
Epoch 66, accuracy: 0.6370
Epoch 66, Train Loss: 0.3380, Val Loss: 1.3154
Epoch 67, accuracy: 0.6370
Epoch 68, accuracy: 0.6370
Epoch 68, Train Loss: 0.3781, Val Loss: 1.3154
Epoch 69, accuracy: 0.6370
Epoch 70, accuracy: 0.6370
Epoch 70, Train Loss: 0.3828, Val Loss: 1.3154
Epoch 71, accuracy: 0.6370
Epoch 72, accuracy: 0.6370
Epoch 72, Train Loss: 0.3955, Val Loss: 1.3154
Epoch 73, accuracy: 0.6370
Epoch 74, accuracy: 0.6370
Epoch 74, Train Loss: 0.3571, Val Loss: 1.3154
Epoch 75, accuracy: 0.6370
Epoch 76, accuracy: 0.6370
Epoch 76, Train Loss: 0.3812, Val Loss: 1.3154
Epoch 77, accuracy: 0.6370
Epoch 78, accuracy: 0.6370
Epoch 78, Train Loss: 0.3882, Val Loss: 1.3154
Epoch 79, accuracy: 0.6370
Epoch 80, accuracy: 0.6370
Epoch 80, Train Loss: 0.4523, Val Loss: 1.3154
Epoch 81, accuracy: 0.6370
Epoch 82, accuracy: 0.6370
Epoch 82, Train Loss: 0.4166, Val Loss: 1.3154
Epoch 83, accuracy: 0.6370
Epoch 84, accuracy: 0.6370
Epoch 84, Train Loss: 0.3861, Val Loss: 1.3154
Epoch 85, accuracy: 0.6370
Epoch 86, accuracy: 0.6370
Epoch 86, Train Loss: 0.4281, Val Loss: 1.3154
Epoch 87, accuracy: 0.6370
Epoch 88, accuracy: 0.6370
Epoch 88, Train Loss: 0.3751, Val Loss: 1.3154
Epoch 89, accuracy: 0.6370
Epoch 90, accuracy: 0.6370
Epoch 90, Train Loss: 0.3873, Val Loss: 1.3154
Epoch 91, accuracy: 0.6370
Epoch 92, accuracy: 0.6370
Epoch 92, Train Loss: 0.4120, Val Loss: 1.3154
Epoch 93, accuracy: 0.6370
Epoch 94, accuracy: 0.6370
Epoch 94, Train Loss: 0.3911, Val Loss: 1.3154
Epoch 95, accuracy: 0.6370
Epoch 96, accuracy: 0.6370
Epoch 96, Train Loss: 0.4178, Val Loss: 1.3154
Epoch 97, accuracy: 0.6370
Epoch 98, accuracy: 0.6370
Epoch 98, Train Loss: 0.4215, Val Loss: 1.3154
Epoch 99, accuracy: 0.6370
Epoch 100, accuracy: 0.6370
Epoch 100, Train Loss: 0.4428, Val Loss: 1.3154
Epoch 101, accuracy: 0.6370
Epoch 102, accuracy: 0.6370
Epoch 102, Train Loss: 0.3895, Val Loss: 1.3154
Epoch 103, accuracy: 0.6370
Epoch 104, accuracy: 0.6370
Epoch 104, Train Loss: 0.3706, Val Loss: 1.3154
Epoch 105, accuracy: 0.6370
Epoch 106, accuracy: 0.6370
Epoch 106, Train Loss: 0.4103, Val Loss: 1.3154
Epoch 107, accuracy: 0.6370
Epoch 108, accuracy: 0.6370
Epoch 108, Train Loss: 0.3294, Val Loss: 1.3154
Epoch 109, accuracy: 0.6370
Epoch 110, accuracy: 0.6370
Epoch 110, Train Loss: 0.3566, Val Loss: 1.3154
Epoch 111, accuracy: 0.6370
Epoch 112, accuracy: 0.6370
Epoch 112, Train Loss: 0.4359, Val Loss: 1.3154
Epoch 113, accuracy: 0.6370
Epoch 114, accuracy: 0.6370
Epoch 114, Train Loss: 0.4293, Val Loss: 1.3154
Epoch 115, accuracy: 0.6370
Epoch 116, accuracy: 0.6370
Epoch 116, Train Loss: 0.3675, Val Loss: 1.3154
Epoch 117, accuracy: 0.6370
Epoch 118, accuracy: 0.6370
Epoch 118, Train Loss: 0.3334, Val Loss: 1.3154
Epoch 119, accuracy: 0.6370
Epoch 120, accuracy: 0.6370
Epoch 120, Train Loss: 0.3222, Val Loss: 1.3154
Epoch 121, accuracy: 0.6370
Epoch 122, accuracy: 0.6370
Epoch 122, Train Loss: 0.3706, Val Loss: 1.3154
Epoch 123, accuracy: 0.6370
Epoch 124, accuracy: 0.6370
Epoch 124, Train Loss: 0.3531, Val Loss: 1.3154
Epoch 125, accuracy: 0.6370
Epoch 126, accuracy: 0.6370
Epoch 126, Train Loss: 0.3752, Val Loss: 1.3154
Epoch 127, accuracy: 0.6370
Epoch 128, accuracy: 0.6370
Epoch 128, Train Loss: 0.3430, Val Loss: 1.3154
Epoch 129, accuracy: 0.6370
Epoch 130, accuracy: 0.6370
Epoch 130, Train Loss: 0.4139, Val Loss: 1.3154
Epoch 131, accuracy: 0.6370
Epoch 132, accuracy: 0.6370
Epoch 132, Train Loss: 0.4017, Val Loss: 1.3154
Epoch 133, accuracy: 0.6370
Epoch 134, accuracy: 0.6370
Epoch 134, Train Loss: 0.4511, Val Loss: 1.3154
Epoch 135, accuracy: 0.6370
Epoch 136, accuracy: 0.6370
Epoch 136, Train Loss: 0.3471, Val Loss: 1.3154
Epoch 137, accuracy: 0.6370
Epoch 138, accuracy: 0.6370
Epoch 138, Train Loss: 0.4108, Val Loss: 1.3154
Epoch 139, accuracy: 0.6370
Epoch 140, accuracy: 0.6370
Epoch 140, Train Loss: 0.3799, Val Loss: 1.3154
Epoch 141, accuracy: 0.6370
Epoch 142, accuracy: 0.6370
Epoch 142, Train Loss: 0.4311, Val Loss: 1.3154
Epoch 143, accuracy: 0.6370
Epoch 144, accuracy: 0.6370
Epoch 144, Train Loss: 0.3737, Val Loss: 1.3154
Epoch 145, accuracy: 0.6370
Epoch 146, accuracy: 0.6370
Epoch 146, Train Loss: 0.3853, Val Loss: 1.3154
Epoch 147, accuracy: 0.6370
Epoch 148, accuracy: 0.6370
Epoch 148, Train Loss: 0.4658, Val Loss: 1.3154
Epoch 149, accuracy: 0.6370
Epoch 150, accuracy: 0.6370
Epoch 150, Train Loss: 0.3184, Val Loss: 1.3154
Epoch 151, accuracy: 0.6370
Epoch 152, accuracy: 0.6370
Epoch 152, Train Loss: 0.3621, Val Loss: 1.3154
Epoch 153, accuracy: 0.6370
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
/root/miniconda3/lib/python3.12/site-packages/torch_geometric/sampler/neighbor_sampler.py:61: UserWarning: Using 'NeighborSampler' without a 'pyg-lib' installation is deprecated and will be removed soon. Please install 'pyg-lib' for accelerated neighborhood sampling
  warnings.warn(f"Using '{self.__class__.__name__}' without a "
Epoch 154, accuracy: 0.6370
Epoch 154, Train Loss: 0.3542, Val Loss: 1.3154
Epoch 155, accuracy: 0.6370
Epoch 156, accuracy: 0.6370
Epoch 156, Train Loss: 0.3501, Val Loss: 1.3154
Epoch 157, accuracy: 0.6370
Epoch 158, accuracy: 0.6370
Epoch 158, Train Loss: 0.4713, Val Loss: 1.3154
Epoch 159, accuracy: 0.6370
Epoch 160, accuracy: 0.6370
Epoch 160, Train Loss: 0.4513, Val Loss: 1.3154
Epoch 161, accuracy: 0.6370
Epoch 162, accuracy: 0.6370
Epoch 162, Train Loss: 0.3981, Val Loss: 1.3154
Epoch 163, accuracy: 0.6370
Epoch 164, accuracy: 0.6370
Epoch 164, Train Loss: 0.3268, Val Loss: 1.3154
Epoch 165, accuracy: 0.6370
Epoch 166, accuracy: 0.6370
Epoch 166, Train Loss: 0.3281, Val Loss: 1.3154
Epoch 167, accuracy: 0.6370
Epoch 168, accuracy: 0.6370
Epoch 168, Train Loss: 0.3966, Val Loss: 1.3154
Epoch 169, accuracy: 0.6370
Epoch 170, accuracy: 0.6370
Epoch 170, Train Loss: 0.3629, Val Loss: 1.3154
Epoch 171, accuracy: 0.6370
Epoch 172, accuracy: 0.6370
Epoch 172, Train Loss: 0.3273, Val Loss: 1.3154
Epoch 173, accuracy: 0.6370
Epoch 174, accuracy: 0.6370
Epoch 174, Train Loss: 0.3263, Val Loss: 1.3154
Epoch 175, accuracy: 0.6370
Epoch 176, accuracy: 0.6370
Epoch 176, Train Loss: 0.4297, Val Loss: 1.3154
Epoch 177, accuracy: 0.6370
Epoch 178, accuracy: 0.6370
Epoch 178, Train Loss: 0.3731, Val Loss: 1.3154
Epoch 179, accuracy: 0.6370
Epoch 180, accuracy: 0.6370
Epoch 180, Train Loss: 0.3682, Val Loss: 1.3154
Epoch 181, accuracy: 0.6370
Epoch 182, accuracy: 0.6370
Epoch 182, Train Loss: 0.4954, Val Loss: 1.3154
Epoch 183, accuracy: 0.6370
Epoch 184, accuracy: 0.6370
Epoch 184, Train Loss: 0.3566, Val Loss: 1.3154
Epoch 185, accuracy: 0.6370
Epoch 186, accuracy: 0.6370
Epoch 186, Train Loss: 0.4121, Val Loss: 1.3154
Epoch 187, accuracy: 0.6370
Epoch 188, accuracy: 0.6370
Epoch 188, Train Loss: 0.3562, Val Loss: 1.3154
Epoch 189, accuracy: 0.6370
Epoch 190, accuracy: 0.6370
Epoch 190, Train Loss: 0.4251, Val Loss: 1.3154
Epoch 191, accuracy: 0.6370
Epoch 192, accuracy: 0.6370
Epoch 192, Train Loss: 0.3265, Val Loss: 1.3154
Epoch 193, accuracy: 0.6370
Epoch 194, accuracy: 0.6370
Epoch 194, Train Loss: 0.3617, Val Loss: 1.3154
Epoch 195, accuracy: 0.6370
Epoch 196, accuracy: 0.6370
Epoch 196, Train Loss: 0.4142, Val Loss: 1.3154
Epoch 197, accuracy: 0.6370
Epoch 198, accuracy: 0.6370
Epoch 198, Train Loss: 0.4040, Val Loss: 1.3154
Epoch 199, accuracy: 0.6370
Loaded best model with val_loss = 1.1809041500091553
test :accuracy 0.6150, f1_macro: 0.5846, f1_micro: 0.6150, auc: 0.8484
Final Results: {'GAT_3_Citeseer': np.float64(0.701), 'GAT_4_Citeseer': np.float64(0.696), 'GAT_5_Citeseer': np.float64(0.679), 'GAT_6_Citeseer': np.float64(0.66), 'GAT_7_Citeseer': np.float64(0.509), 'mamba3_3_Citeseer': np.float64(0.678), 'mamba3_4_Citeseer': np.float64(0.596), 'mamba3_5_Citeseer': np.float64(0.655), 'mamba3_6_Citeseer': np.float64(0.621), 'mamba3_7_Citeseer': np.float64(0.615)} ['1578142_GAT_0', '1727518_GAT_0', '1876894_GAT_0', '2026270_GAT_0', '2175646_GAT_0', '1568702_mamba3_0', '1651646_mamba3_0', '1734590_mamba3_0', '1817534_mamba3_0', '1900478_mamba3_0']
========== Running baseline 2/3 ==========
Training GAT with 3 layers...
可训练参数: 1578142_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.6387
Epoch 0, accuracy: 0.6550
Epoch 0, Train Loss: 1.7946, Val Loss: 1.6387
✅ Epoch 1: New best model saved with val_loss = 1.3442
Epoch 1, accuracy: 0.6860
✅ Epoch 2: New best model saved with val_loss = 1.0266
Epoch 2, accuracy: 0.7110
Epoch 2, Train Loss: 0.9566, Val Loss: 1.0266
Epoch 3, accuracy: 0.6460
Epoch 4, accuracy: 0.6290
Epoch 4, Train Loss: 0.1712, Val Loss: 1.2325
Epoch 5, accuracy: 0.6480
Epoch 6, accuracy: 0.6190
Epoch 6, Train Loss: 0.0645, Val Loss: 1.9618
Epoch 7, accuracy: 0.5970
Epoch 8, accuracy: 0.6180
Epoch 8, Train Loss: 0.0760, Val Loss: 2.2631
Epoch 9, accuracy: 0.6230
Epoch 10, accuracy: 0.6270
Epoch 10, Train Loss: 0.0853, Val Loss: 2.2163
Epoch 11, accuracy: 0.6280
Epoch 12, accuracy: 0.6340
Epoch 12, Train Loss: 0.0468, Val Loss: 2.2299
Epoch 13, accuracy: 0.6350
Epoch 14, accuracy: 0.6330
Epoch 14, Train Loss: 0.0352, Val Loss: 2.2951
Epoch 15, accuracy: 0.6340
Epoch 16, accuracy: 0.6350
Epoch 16, Train Loss: 0.0064, Val Loss: 2.3058
Epoch 17, accuracy: 0.6350
Epoch 18, accuracy: 0.6340
Epoch 18, Train Loss: 0.0350, Val Loss: 2.3145
Epoch 19, accuracy: 0.6340
Epoch 20, accuracy: 0.6340
Epoch 20, Train Loss: 0.0461, Val Loss: 2.3227
Epoch 21, accuracy: 0.6340
Epoch 22, accuracy: 0.6340
Epoch 22, Train Loss: 0.0253, Val Loss: 2.3233
Epoch 23, accuracy: 0.6340
Epoch 24, accuracy: 0.6340
Epoch 24, Train Loss: 0.0736, Val Loss: 2.3238
Epoch 25, accuracy: 0.6340
Epoch 26, accuracy: 0.6340
Epoch 26, Train Loss: 0.0481, Val Loss: 2.3244
Epoch 27, accuracy: 0.6340
Epoch 28, accuracy: 0.6340
Epoch 28, Train Loss: 0.0358, Val Loss: 2.3245
Epoch 29, accuracy: 0.6340
Epoch 30, accuracy: 0.6340
Epoch 30, Train Loss: 0.0368, Val Loss: 2.3245
Epoch 31, accuracy: 0.6340
Epoch 32, accuracy: 0.6340
Epoch 32, Train Loss: 0.0178, Val Loss: 2.3246
Epoch 33, accuracy: 0.6340
Epoch 34, accuracy: 0.6340
Epoch 34, Train Loss: 0.0290, Val Loss: 2.3246
Epoch 35, accuracy: 0.6340
Epoch 36, accuracy: 0.6340
Epoch 36, Train Loss: 0.0820, Val Loss: 2.3246
Epoch 37, accuracy: 0.6340
Epoch 38, accuracy: 0.6340
Epoch 38, Train Loss: 0.0342, Val Loss: 2.3246
Epoch 39, accuracy: 0.6340
Epoch 40, accuracy: 0.6340
Epoch 40, Train Loss: 0.0242, Val Loss: 2.3246
Epoch 41, accuracy: 0.6340
Epoch 42, accuracy: 0.6340
Epoch 42, Train Loss: 0.0172, Val Loss: 2.3246
Epoch 43, accuracy: 0.6340
Epoch 44, accuracy: 0.6340
Epoch 44, Train Loss: 0.0094, Val Loss: 2.3246
Epoch 45, accuracy: 0.6340
Epoch 46, accuracy: 0.6340
Epoch 46, Train Loss: 0.0235, Val Loss: 2.3246
Epoch 47, accuracy: 0.6340
Epoch 48, accuracy: 0.6340
Epoch 48, Train Loss: 0.0542, Val Loss: 2.3246
Epoch 49, accuracy: 0.6340
Epoch 50, accuracy: 0.6340
Epoch 50, Train Loss: 0.0523, Val Loss: 2.3246
Epoch 51, accuracy: 0.6340
Epoch 52, accuracy: 0.6340
Epoch 52, Train Loss: 0.0548, Val Loss: 2.3246
Epoch 53, accuracy: 0.6340
Epoch 54, accuracy: 0.6340
Epoch 54, Train Loss: 0.0212, Val Loss: 2.3246
Epoch 55, accuracy: 0.6340
Epoch 56, accuracy: 0.6340
Epoch 56, Train Loss: 0.0674, Val Loss: 2.3246
Epoch 57, accuracy: 0.6340
Epoch 58, accuracy: 0.6340
Epoch 58, Train Loss: 0.0505, Val Loss: 2.3246
Epoch 59, accuracy: 0.6340
Epoch 60, accuracy: 0.6340
Epoch 60, Train Loss: 0.0646, Val Loss: 2.3245
Epoch 61, accuracy: 0.6340
Epoch 62, accuracy: 0.6340
Epoch 62, Train Loss: 0.0159, Val Loss: 2.3245
Epoch 63, accuracy: 0.6340
Epoch 64, accuracy: 0.6340
Epoch 64, Train Loss: 0.0193, Val Loss: 2.3245
Epoch 65, accuracy: 0.6340
Epoch 66, accuracy: 0.6340
Epoch 66, Train Loss: 0.0317, Val Loss: 2.3245
Epoch 67, accuracy: 0.6340
Epoch 68, accuracy: 0.6340
Epoch 68, Train Loss: 0.0385, Val Loss: 2.3245
Epoch 69, accuracy: 0.6340
Epoch 70, accuracy: 0.6340
Epoch 70, Train Loss: 0.0270, Val Loss: 2.3245
Epoch 71, accuracy: 0.6340
Epoch 72, accuracy: 0.6340
Epoch 72, Train Loss: 0.0605, Val Loss: 2.3245
Epoch 73, accuracy: 0.6340
Epoch 74, accuracy: 0.6340
Epoch 74, Train Loss: 0.0234, Val Loss: 2.3245
Epoch 75, accuracy: 0.6340
Epoch 76, accuracy: 0.6340
Epoch 76, Train Loss: 0.0568, Val Loss: 2.3245
Epoch 77, accuracy: 0.6340
Epoch 78, accuracy: 0.6340
Epoch 78, Train Loss: 0.0322, Val Loss: 2.3245
Epoch 79, accuracy: 0.6340
Epoch 80, accuracy: 0.6340
Epoch 80, Train Loss: 0.0271, Val Loss: 2.3245
Epoch 81, accuracy: 0.6340
Epoch 82, accuracy: 0.6340
Epoch 82, Train Loss: 0.0268, Val Loss: 2.3245
Epoch 83, accuracy: 0.6340
Epoch 84, accuracy: 0.6340
Epoch 84, Train Loss: 0.0606, Val Loss: 2.3245
Epoch 85, accuracy: 0.6340
Epoch 86, accuracy: 0.6340
Epoch 86, Train Loss: 0.0254, Val Loss: 2.3245
Epoch 87, accuracy: 0.6340
Epoch 88, accuracy: 0.6340
Epoch 88, Train Loss: 0.0648, Val Loss: 2.3245
Epoch 89, accuracy: 0.6340
Epoch 90, accuracy: 0.6340
Epoch 90, Train Loss: 0.0352, Val Loss: 2.3245
Epoch 91, accuracy: 0.6340
Epoch 92, accuracy: 0.6340
Epoch 92, Train Loss: 0.0706, Val Loss: 2.3245
Epoch 93, accuracy: 0.6340
Epoch 94, accuracy: 0.6340
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 94, Train Loss: 0.0337, Val Loss: 2.3245
Epoch 95, accuracy: 0.6340
Epoch 96, accuracy: 0.6340
Epoch 96, Train Loss: 0.0457, Val Loss: 2.3245
Epoch 97, accuracy: 0.6340
Epoch 98, accuracy: 0.6340
Epoch 98, Train Loss: 0.0275, Val Loss: 2.3245
Epoch 99, accuracy: 0.6340
Epoch 100, accuracy: 0.6340
Epoch 100, Train Loss: 0.0379, Val Loss: 2.3245
Epoch 101, accuracy: 0.6340
Epoch 102, accuracy: 0.6340
Epoch 102, Train Loss: 0.0271, Val Loss: 2.3245
Epoch 103, accuracy: 0.6340
Epoch 104, accuracy: 0.6340
Epoch 104, Train Loss: 0.0818, Val Loss: 2.3245
Epoch 105, accuracy: 0.6340
Epoch 106, accuracy: 0.6340
Epoch 106, Train Loss: 0.0223, Val Loss: 2.3245
Epoch 107, accuracy: 0.6340
Epoch 108, accuracy: 0.6340
Epoch 108, Train Loss: 0.0788, Val Loss: 2.3245
Epoch 109, accuracy: 0.6340
Epoch 110, accuracy: 0.6340
Epoch 110, Train Loss: 0.0327, Val Loss: 2.3245
Epoch 111, accuracy: 0.6340
Epoch 112, accuracy: 0.6340
Epoch 112, Train Loss: 0.0242, Val Loss: 2.3245
Epoch 113, accuracy: 0.6340
Epoch 114, accuracy: 0.6340
Epoch 114, Train Loss: 0.0544, Val Loss: 2.3245
Epoch 115, accuracy: 0.6340
Epoch 116, accuracy: 0.6340
Epoch 116, Train Loss: 0.0275, Val Loss: 2.3245
Epoch 117, accuracy: 0.6340
Epoch 118, accuracy: 0.6340
Epoch 118, Train Loss: 0.0578, Val Loss: 2.3245
Epoch 119, accuracy: 0.6340
Epoch 120, accuracy: 0.6340
Epoch 120, Train Loss: 0.0211, Val Loss: 2.3245
Epoch 121, accuracy: 0.6340
Epoch 122, accuracy: 0.6340
Epoch 122, Train Loss: 0.0215, Val Loss: 2.3245
Epoch 123, accuracy: 0.6340
Epoch 124, accuracy: 0.6340
Epoch 124, Train Loss: 0.0380, Val Loss: 2.3245
Epoch 125, accuracy: 0.6340
Epoch 126, accuracy: 0.6340
Epoch 126, Train Loss: 0.0503, Val Loss: 2.3245
Epoch 127, accuracy: 0.6340
Epoch 128, accuracy: 0.6340
Epoch 128, Train Loss: 0.0719, Val Loss: 2.3245
Epoch 129, accuracy: 0.6340
Epoch 130, accuracy: 0.6340
Epoch 130, Train Loss: 0.0156, Val Loss: 2.3245
Epoch 131, accuracy: 0.6340
Epoch 132, accuracy: 0.6340
Epoch 132, Train Loss: 0.0326, Val Loss: 2.3245
Epoch 133, accuracy: 0.6340
Epoch 134, accuracy: 0.6340
Epoch 134, Train Loss: 0.0456, Val Loss: 2.3245
Epoch 135, accuracy: 0.6340
Epoch 136, accuracy: 0.6340
Epoch 136, Train Loss: 0.0593, Val Loss: 2.3245
Epoch 137, accuracy: 0.6340
Epoch 138, accuracy: 0.6340
Epoch 138, Train Loss: 0.0563, Val Loss: 2.3245
Epoch 139, accuracy: 0.6340
Epoch 140, accuracy: 0.6340
Epoch 140, Train Loss: 0.0243, Val Loss: 2.3245
Epoch 141, accuracy: 0.6340
Epoch 142, accuracy: 0.6340
Epoch 142, Train Loss: 0.0738, Val Loss: 2.3245
Epoch 143, accuracy: 0.6340
Epoch 144, accuracy: 0.6340
Epoch 144, Train Loss: 0.0480, Val Loss: 2.3245
Epoch 145, accuracy: 0.6340
Epoch 146, accuracy: 0.6340
Epoch 146, Train Loss: 0.0583, Val Loss: 2.3245
Epoch 147, accuracy: 0.6340
Epoch 148, accuracy: 0.6340
Epoch 148, Train Loss: 0.0256, Val Loss: 2.3245
Epoch 149, accuracy: 0.6340
Epoch 150, accuracy: 0.6340
Epoch 150, Train Loss: 0.0318, Val Loss: 2.3245
Epoch 151, accuracy: 0.6340
Epoch 152, accuracy: 0.6340
Epoch 152, Train Loss: 0.0526, Val Loss: 2.3245
Epoch 153, accuracy: 0.6340
Epoch 154, accuracy: 0.6340
Epoch 154, Train Loss: 0.0230, Val Loss: 2.3245
Epoch 155, accuracy: 0.6340
Epoch 156, accuracy: 0.6340
Epoch 156, Train Loss: 0.0271, Val Loss: 2.3245
Epoch 157, accuracy: 0.6340
Epoch 158, accuracy: 0.6340
Epoch 158, Train Loss: 0.0796, Val Loss: 2.3245
Epoch 159, accuracy: 0.6340
Epoch 160, accuracy: 0.6340
Epoch 160, Train Loss: 0.0594, Val Loss: 2.3245
Epoch 161, accuracy: 0.6340
Epoch 162, accuracy: 0.6340
Epoch 162, Train Loss: 0.0348, Val Loss: 2.3245
Epoch 163, accuracy: 0.6340
Epoch 164, accuracy: 0.6340
Epoch 164, Train Loss: 0.0243, Val Loss: 2.3245
Epoch 165, accuracy: 0.6340
Epoch 166, accuracy: 0.6340
Epoch 166, Train Loss: 0.0942, Val Loss: 2.3245
Epoch 167, accuracy: 0.6340
Epoch 168, accuracy: 0.6340
Epoch 168, Train Loss: 0.0444, Val Loss: 2.3245
Epoch 169, accuracy: 0.6340
Epoch 170, accuracy: 0.6340
Epoch 170, Train Loss: 0.0376, Val Loss: 2.3245
Epoch 171, accuracy: 0.6340
Epoch 172, accuracy: 0.6340
Epoch 172, Train Loss: 0.0128, Val Loss: 2.3245
Epoch 173, accuracy: 0.6340
Epoch 174, accuracy: 0.6340
Epoch 174, Train Loss: 0.0492, Val Loss: 2.3245
Epoch 175, accuracy: 0.6340
Epoch 176, accuracy: 0.6340
Epoch 176, Train Loss: 0.0568, Val Loss: 2.3245
Epoch 177, accuracy: 0.6340
Epoch 178, accuracy: 0.6340
Epoch 178, Train Loss: 0.0180, Val Loss: 2.3245
Epoch 179, accuracy: 0.6340
Epoch 180, accuracy: 0.6340
Epoch 180, Train Loss: 0.0677, Val Loss: 2.3245
Epoch 181, accuracy: 0.6340
Epoch 182, accuracy: 0.6340
Epoch 182, Train Loss: 0.0571, Val Loss: 2.3245
Epoch 183, accuracy: 0.6340
Epoch 184, accuracy: 0.6340
Epoch 184, Train Loss: 0.0783, Val Loss: 2.3245
Epoch 185, accuracy: 0.6340
Epoch 186, accuracy: 0.6340
Epoch 186, Train Loss: 0.0501, Val Loss: 2.3245
Epoch 187, accuracy: 0.6340
Epoch 188, accuracy: 0.6340
Epoch 188, Train Loss: 0.0688, Val Loss: 2.3245
Epoch 189, accuracy: 0.6340
Epoch 190, accuracy: 0.6340
Epoch 190, Train Loss: 0.0490, Val Loss: 2.3245
Epoch 191, accuracy: 0.6340
Epoch 192, accuracy: 0.6340
Epoch 192, Train Loss: 0.0220, Val Loss: 2.3245
Epoch 193, accuracy: 0.6340
Epoch 194, accuracy: 0.6340
Epoch 194, Train Loss: 0.0223, Val Loss: 2.3245
Epoch 195, accuracy: 0.6340
Epoch 196, accuracy: 0.6340
Epoch 196, Train Loss: 0.0258, Val Loss: 2.3245
Epoch 197, accuracy: 0.6340
Epoch 198, accuracy: 0.6340
Epoch 198, Train Loss: 0.0361, Val Loss: 2.3245
Epoch 199, accuracy: 0.6340
Loaded best model with val_loss = 1.0265759229660034
test :accuracy 0.7110, f1_macro: 0.6712, f1_micro: 0.7110, auc: 0.8928
Training GAT with 4 layers...
可训练参数: 1727518_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.7319
Epoch 0, accuracy: 0.4460
Epoch 0, Train Loss: 1.7947, Val Loss: 1.7319
✅ Epoch 1: New best model saved with val_loss = 1.4722
Epoch 1, accuracy: 0.6390
✅ Epoch 2: New best model saved with val_loss = 1.0835
Epoch 2, accuracy: 0.6450
Epoch 2, Train Loss: 1.2235, Val Loss: 1.0835
✅ Epoch 3: New best model saved with val_loss = 1.0093
Epoch 3, accuracy: 0.6950
Epoch 4, accuracy: 0.3650
Epoch 4, Train Loss: 0.3142, Val Loss: 3.3451
Epoch 5, accuracy: 0.7000
Epoch 6, accuracy: 0.6430
Epoch 6, Train Loss: 0.2869, Val Loss: 2.0680
Epoch 7, accuracy: 0.6570
Epoch 8, accuracy: 0.6700
Epoch 8, Train Loss: 0.2941, Val Loss: 1.7398
Epoch 9, accuracy: 0.6620
Epoch 10, accuracy: 0.6620
Epoch 10, Train Loss: 0.1122, Val Loss: 1.7154
Epoch 11, accuracy: 0.6570
Epoch 12, accuracy: 0.6590
Epoch 12, Train Loss: 0.1597, Val Loss: 1.7110
Epoch 13, accuracy: 0.6550
Epoch 14, accuracy: 0.6540
Epoch 14, Train Loss: 0.0933, Val Loss: 1.7029
Epoch 15, accuracy: 0.6510
Epoch 16, accuracy: 0.6490
Epoch 16, Train Loss: 0.0823, Val Loss: 1.7000
Epoch 17, accuracy: 0.6490
Epoch 18, accuracy: 0.6500
Epoch 18, Train Loss: 0.0662, Val Loss: 1.6992
Epoch 19, accuracy: 0.6510
Epoch 20, accuracy: 0.6520
Epoch 20, Train Loss: 0.0911, Val Loss: 1.6977
Epoch 21, accuracy: 0.6520
Epoch 22, accuracy: 0.6510
Epoch 22, Train Loss: 0.0878, Val Loss: 1.6968
Epoch 23, accuracy: 0.6510
Epoch 24, accuracy: 0.6500
Epoch 24, Train Loss: 0.0867, Val Loss: 1.6966
Epoch 25, accuracy: 0.6500
Epoch 26, accuracy: 0.6500
Epoch 26, Train Loss: 0.0813, Val Loss: 1.6964
Epoch 27, accuracy: 0.6500
Epoch 28, accuracy: 0.6500
Epoch 28, Train Loss: 0.0662, Val Loss: 1.6963
Epoch 29, accuracy: 0.6500
Epoch 30, accuracy: 0.6500
Epoch 30, Train Loss: 0.0780, Val Loss: 1.6962
Epoch 31, accuracy: 0.6500
Epoch 32, accuracy: 0.6500
Epoch 32, Train Loss: 0.0646, Val Loss: 1.6962
Epoch 33, accuracy: 0.6500
Epoch 34, accuracy: 0.6500
Epoch 34, Train Loss: 0.1043, Val Loss: 1.6962
Epoch 35, accuracy: 0.6500
Epoch 36, accuracy: 0.6500
Epoch 36, Train Loss: 0.0752, Val Loss: 1.6962
Epoch 37, accuracy: 0.6500
Epoch 38, accuracy: 0.6500
Epoch 38, Train Loss: 0.0719, Val Loss: 1.6962
Epoch 39, accuracy: 0.6500
Epoch 40, accuracy: 0.6500
Epoch 40, Train Loss: 0.0884, Val Loss: 1.6962
Epoch 41, accuracy: 0.6500
Epoch 42, accuracy: 0.6500
Epoch 42, Train Loss: 0.0658, Val Loss: 1.6962
Epoch 43, accuracy: 0.6500
Epoch 44, accuracy: 0.6500
Epoch 44, Train Loss: 0.0965, Val Loss: 1.6962
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 45, accuracy: 0.6500
Epoch 46, accuracy: 0.6500
Epoch 46, Train Loss: 0.0875, Val Loss: 1.6962
Epoch 47, accuracy: 0.6500
Epoch 48, accuracy: 0.6500
Epoch 48, Train Loss: 0.0827, Val Loss: 1.6962
Epoch 49, accuracy: 0.6500
Epoch 50, accuracy: 0.6500
Epoch 50, Train Loss: 0.0841, Val Loss: 1.6962
Epoch 51, accuracy: 0.6500
Epoch 52, accuracy: 0.6500
Epoch 52, Train Loss: 0.0844, Val Loss: 1.6962
Epoch 53, accuracy: 0.6500
Epoch 54, accuracy: 0.6500
Epoch 54, Train Loss: 0.0765, Val Loss: 1.6962
Epoch 55, accuracy: 0.6500
Epoch 56, accuracy: 0.6500
Epoch 56, Train Loss: 0.0721, Val Loss: 1.6962
Epoch 57, accuracy: 0.6500
Epoch 58, accuracy: 0.6500
Epoch 58, Train Loss: 0.0962, Val Loss: 1.6962
Epoch 59, accuracy: 0.6500
Epoch 60, accuracy: 0.6500
Epoch 60, Train Loss: 0.0480, Val Loss: 1.6962
Epoch 61, accuracy: 0.6500
Epoch 62, accuracy: 0.6500
Epoch 62, Train Loss: 0.0659, Val Loss: 1.6962
Epoch 63, accuracy: 0.6500
Epoch 64, accuracy: 0.6500
Epoch 64, Train Loss: 0.0757, Val Loss: 1.6962
Epoch 65, accuracy: 0.6500
Epoch 66, accuracy: 0.6500
Epoch 66, Train Loss: 0.0989, Val Loss: 1.6962
Epoch 67, accuracy: 0.6500
Epoch 68, accuracy: 0.6500
Epoch 68, Train Loss: 0.0846, Val Loss: 1.6962
Epoch 69, accuracy: 0.6500
Epoch 70, accuracy: 0.6500
Epoch 70, Train Loss: 0.0611, Val Loss: 1.6962
Epoch 71, accuracy: 0.6500
Epoch 72, accuracy: 0.6500
Epoch 72, Train Loss: 0.0817, Val Loss: 1.6962
Epoch 73, accuracy: 0.6500
Epoch 74, accuracy: 0.6500
Epoch 74, Train Loss: 0.0746, Val Loss: 1.6962
Epoch 75, accuracy: 0.6500
Epoch 76, accuracy: 0.6500
Epoch 76, Train Loss: 0.0929, Val Loss: 1.6962
Epoch 77, accuracy: 0.6500
Epoch 78, accuracy: 0.6500
Epoch 78, Train Loss: 0.0824, Val Loss: 1.6962
Epoch 79, accuracy: 0.6500
Epoch 80, accuracy: 0.6500
Epoch 80, Train Loss: 0.0871, Val Loss: 1.6962
Epoch 81, accuracy: 0.6500
Epoch 82, accuracy: 0.6500
Epoch 82, Train Loss: 0.0804, Val Loss: 1.6962
Epoch 83, accuracy: 0.6500
Epoch 84, accuracy: 0.6500
Epoch 84, Train Loss: 0.0795, Val Loss: 1.6962
Epoch 85, accuracy: 0.6500
Epoch 86, accuracy: 0.6500
Epoch 86, Train Loss: 0.0694, Val Loss: 1.6962
Epoch 87, accuracy: 0.6500
Epoch 88, accuracy: 0.6500
Epoch 88, Train Loss: 0.0771, Val Loss: 1.6962
Epoch 89, accuracy: 0.6500
Epoch 90, accuracy: 0.6500
Epoch 90, Train Loss: 0.0700, Val Loss: 1.6962
Epoch 91, accuracy: 0.6500
Epoch 92, accuracy: 0.6500
Epoch 92, Train Loss: 0.0729, Val Loss: 1.6962
Epoch 93, accuracy: 0.6500
Epoch 94, accuracy: 0.6500
Epoch 94, Train Loss: 0.0651, Val Loss: 1.6962
Epoch 95, accuracy: 0.6500
Epoch 96, accuracy: 0.6500
Epoch 96, Train Loss: 0.0889, Val Loss: 1.6962
Epoch 97, accuracy: 0.6500
Epoch 98, accuracy: 0.6500
Epoch 98, Train Loss: 0.0805, Val Loss: 1.6962
Epoch 99, accuracy: 0.6500
Epoch 100, accuracy: 0.6500
Epoch 100, Train Loss: 0.0616, Val Loss: 1.6962
Epoch 101, accuracy: 0.6500
Epoch 102, accuracy: 0.6500
Epoch 102, Train Loss: 0.0917, Val Loss: 1.6962
Epoch 103, accuracy: 0.6500
Epoch 104, accuracy: 0.6500
Epoch 104, Train Loss: 0.0851, Val Loss: 1.6962
Epoch 105, accuracy: 0.6500
Epoch 106, accuracy: 0.6500
Epoch 106, Train Loss: 0.0785, Val Loss: 1.6962
Epoch 107, accuracy: 0.6500
Epoch 108, accuracy: 0.6500
Epoch 108, Train Loss: 0.0963, Val Loss: 1.6962
Epoch 109, accuracy: 0.6500
Epoch 110, accuracy: 0.6500
Epoch 110, Train Loss: 0.0712, Val Loss: 1.6962
Epoch 111, accuracy: 0.6500
Epoch 112, accuracy: 0.6500
Epoch 112, Train Loss: 0.0679, Val Loss: 1.6962
Epoch 113, accuracy: 0.6500
Epoch 114, accuracy: 0.6500
Epoch 114, Train Loss: 0.0796, Val Loss: 1.6962
Epoch 115, accuracy: 0.6500
Epoch 116, accuracy: 0.6500
Epoch 116, Train Loss: 0.0687, Val Loss: 1.6962
Epoch 117, accuracy: 0.6500
Epoch 118, accuracy: 0.6500
Epoch 118, Train Loss: 0.0653, Val Loss: 1.6962
Epoch 119, accuracy: 0.6500
Epoch 120, accuracy: 0.6500
Epoch 120, Train Loss: 0.0796, Val Loss: 1.6962
Epoch 121, accuracy: 0.6500
Epoch 122, accuracy: 0.6500
Epoch 122, Train Loss: 0.0899, Val Loss: 1.6962
Epoch 123, accuracy: 0.6500
Epoch 124, accuracy: 0.6500
Epoch 124, Train Loss: 0.0585, Val Loss: 1.6962
Epoch 125, accuracy: 0.6500
Epoch 126, accuracy: 0.6500
Epoch 126, Train Loss: 0.0980, Val Loss: 1.6962
Epoch 127, accuracy: 0.6500
Epoch 128, accuracy: 0.6500
Epoch 128, Train Loss: 0.0668, Val Loss: 1.6962
Epoch 129, accuracy: 0.6500
Epoch 130, accuracy: 0.6500
Epoch 130, Train Loss: 0.0853, Val Loss: 1.6962
Epoch 131, accuracy: 0.6500
Epoch 132, accuracy: 0.6500
Epoch 132, Train Loss: 0.0822, Val Loss: 1.6962
Epoch 133, accuracy: 0.6500
Epoch 134, accuracy: 0.6500
Epoch 134, Train Loss: 0.0731, Val Loss: 1.6962
Epoch 135, accuracy: 0.6500
Epoch 136, accuracy: 0.6500
Epoch 136, Train Loss: 0.0774, Val Loss: 1.6962
Epoch 137, accuracy: 0.6500
Epoch 138, accuracy: 0.6500
Epoch 138, Train Loss: 0.1071, Val Loss: 1.6962
Epoch 139, accuracy: 0.6500
Epoch 140, accuracy: 0.6500
Epoch 140, Train Loss: 0.1007, Val Loss: 1.6962
Epoch 141, accuracy: 0.6500
Epoch 142, accuracy: 0.6500
Epoch 142, Train Loss: 0.0884, Val Loss: 1.6962
Epoch 143, accuracy: 0.6500
Epoch 144, accuracy: 0.6500
Epoch 144, Train Loss: 0.1067, Val Loss: 1.6962
Epoch 145, accuracy: 0.6500
Epoch 146, accuracy: 0.6500
Epoch 146, Train Loss: 0.0639, Val Loss: 1.6962
Epoch 147, accuracy: 0.6500
Epoch 148, accuracy: 0.6500
Epoch 148, Train Loss: 0.0772, Val Loss: 1.6962
Epoch 149, accuracy: 0.6500
Epoch 150, accuracy: 0.6500
Epoch 150, Train Loss: 0.0838, Val Loss: 1.6962
Epoch 151, accuracy: 0.6500
Epoch 152, accuracy: 0.6500
Epoch 152, Train Loss: 0.0669, Val Loss: 1.6962
Epoch 153, accuracy: 0.6500
Epoch 154, accuracy: 0.6500
Epoch 154, Train Loss: 0.1057, Val Loss: 1.6962
Epoch 155, accuracy: 0.6500
Epoch 156, accuracy: 0.6500
Epoch 156, Train Loss: 0.0780, Val Loss: 1.6962
Epoch 157, accuracy: 0.6500
Epoch 158, accuracy: 0.6500
Epoch 158, Train Loss: 0.0960, Val Loss: 1.6962
Epoch 159, accuracy: 0.6500
Epoch 160, accuracy: 0.6500
Epoch 160, Train Loss: 0.0747, Val Loss: 1.6962
Epoch 161, accuracy: 0.6500
Epoch 162, accuracy: 0.6500
Epoch 162, Train Loss: 0.0817, Val Loss: 1.6962
Epoch 163, accuracy: 0.6500
Epoch 164, accuracy: 0.6500
Epoch 164, Train Loss: 0.0719, Val Loss: 1.6962
Epoch 165, accuracy: 0.6500
Epoch 166, accuracy: 0.6500
Epoch 166, Train Loss: 0.0752, Val Loss: 1.6962
Epoch 167, accuracy: 0.6500
Epoch 168, accuracy: 0.6500
Epoch 168, Train Loss: 0.0771, Val Loss: 1.6962
Epoch 169, accuracy: 0.6500
Epoch 170, accuracy: 0.6500
Epoch 170, Train Loss: 0.0743, Val Loss: 1.6962
Epoch 171, accuracy: 0.6500
Epoch 172, accuracy: 0.6500
Epoch 172, Train Loss: 0.0871, Val Loss: 1.6962
Epoch 173, accuracy: 0.6500
Epoch 174, accuracy: 0.6500
Epoch 174, Train Loss: 0.0732, Val Loss: 1.6962
Epoch 175, accuracy: 0.6500
Epoch 176, accuracy: 0.6500
Epoch 176, Train Loss: 0.0699, Val Loss: 1.6962
Epoch 177, accuracy: 0.6500
Epoch 178, accuracy: 0.6500
Epoch 178, Train Loss: 0.0758, Val Loss: 1.6962
Epoch 179, accuracy: 0.6500
Epoch 180, accuracy: 0.6500
Epoch 180, Train Loss: 0.0969, Val Loss: 1.6962
Epoch 181, accuracy: 0.6500
Epoch 182, accuracy: 0.6500
Epoch 182, Train Loss: 0.0859, Val Loss: 1.6962
Epoch 183, accuracy: 0.6500
Epoch 184, accuracy: 0.6500
Epoch 184, Train Loss: 0.0962, Val Loss: 1.6962
Epoch 185, accuracy: 0.6500
Epoch 186, accuracy: 0.6500
Epoch 186, Train Loss: 0.0900, Val Loss: 1.6962
Epoch 187, accuracy: 0.6500
Epoch 188, accuracy: 0.6500
Epoch 188, Train Loss: 0.0940, Val Loss: 1.6962
Epoch 189, accuracy: 0.6500
Epoch 190, accuracy: 0.6500
Epoch 190, Train Loss: 0.0896, Val Loss: 1.6962
Epoch 191, accuracy: 0.6500
Epoch 192, accuracy: 0.6500
Epoch 192, Train Loss: 0.0815, Val Loss: 1.6962
Epoch 193, accuracy: 0.6500
Epoch 194, accuracy: 0.6500
Epoch 194, Train Loss: 0.0860, Val Loss: 1.6961
Epoch 195, accuracy: 0.6500
Epoch 196, accuracy: 0.6500
Epoch 196, Train Loss: 0.0963, Val Loss: 1.6961
Epoch 197, accuracy: 0.6500
Epoch 198, accuracy: 0.6500
Epoch 198, Train Loss: 0.0933, Val Loss: 1.6961
Epoch 199, accuracy: 0.6500
Loaded best model with val_loss = 1.0093008279800415
test :accuracy 0.6950, f1_macro: 0.6491, f1_micro: 0.6950, auc: 0.8916
Training GAT with 5 layers...
可训练参数: 1876894_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.7715
Epoch 0, accuracy: 0.2320
Epoch 0, Train Loss: 1.7870, Val Loss: 1.7715
✅ Epoch 1: New best model saved with val_loss = 1.6425
Epoch 1, accuracy: 0.4780
✅ Epoch 2: New best model saved with val_loss = 1.2170
Epoch 2, accuracy: 0.6410
Epoch 2, Train Loss: 1.4836, Val Loss: 1.2170
Epoch 3, accuracy: 0.5480
Epoch 4, accuracy: 0.5530
Epoch 4, Train Loss: 0.4883, Val Loss: 2.2941
Epoch 5, accuracy: 0.3940
Epoch 6, accuracy: 0.4950
Epoch 6, Train Loss: 1.1841, Val Loss: 2.3702
Epoch 7, accuracy: 0.5310
Epoch 8, accuracy: 0.6540
Epoch 8, Train Loss: 0.8391, Val Loss: 1.3701
Epoch 9, accuracy: 0.6570
Epoch 10, accuracy: 0.6670
Epoch 10, Train Loss: 0.4283, Val Loss: 1.3139
Epoch 11, accuracy: 0.6690
Epoch 12, accuracy: 0.6750
Epoch 12, Train Loss: 0.3544, Val Loss: 1.2763
Epoch 13, accuracy: 0.6720
Epoch 14, accuracy: 0.6730
Epoch 14, Train Loss: 0.2628, Val Loss: 1.2505
Epoch 15, accuracy: 0.6730
Epoch 16, accuracy: 0.6730
Epoch 16, Train Loss: 0.2670, Val Loss: 1.2484
Epoch 17, accuracy: 0.6740
Epoch 18, accuracy: 0.6730
Epoch 18, Train Loss: 0.2337, Val Loss: 1.2463
Epoch 19, accuracy: 0.6730
Epoch 20, accuracy: 0.6730
Epoch 20, Train Loss: 0.2674, Val Loss: 1.2442
Epoch 21, accuracy: 0.6720
Epoch 22, accuracy: 0.6720
Epoch 22, Train Loss: 0.2613, Val Loss: 1.2440
Epoch 23, accuracy: 0.6720
Epoch 24, accuracy: 0.6720
Epoch 24, Train Loss: 0.2516, Val Loss: 1.2438
Epoch 25, accuracy: 0.6720
Epoch 26, accuracy: 0.6720
Epoch 26, Train Loss: 0.2762, Val Loss: 1.2436
Epoch 27, accuracy: 0.6720
Epoch 28, accuracy: 0.6720
Epoch 28, Train Loss: 0.2503, Val Loss: 1.2436
Epoch 29, accuracy: 0.6720
Epoch 30, accuracy: 0.6720
Epoch 30, Train Loss: 0.2267, Val Loss: 1.2436
Epoch 31, accuracy: 0.6720
Epoch 32, accuracy: 0.6720
Epoch 32, Train Loss: 0.2767, Val Loss: 1.2436
Epoch 33, accuracy: 0.6720
Epoch 34, accuracy: 0.6720
Epoch 34, Train Loss: 0.2445, Val Loss: 1.2436
Epoch 35, accuracy: 0.6720
Epoch 36, accuracy: 0.6720
Epoch 36, Train Loss: 0.2250, Val Loss: 1.2436
Epoch 37, accuracy: 0.6720
Epoch 38, accuracy: 0.6720
Epoch 38, Train Loss: 0.2389, Val Loss: 1.2436
Epoch 39, accuracy: 0.6720
Epoch 40, accuracy: 0.6720
Epoch 40, Train Loss: 0.2406, Val Loss: 1.2436
Epoch 41, accuracy: 0.6720
Epoch 42, accuracy: 0.6720
Epoch 42, Train Loss: 0.2374, Val Loss: 1.2436
Epoch 43, accuracy: 0.6720
Epoch 44, accuracy: 0.6720
Epoch 44, Train Loss: 0.2466, Val Loss: 1.2436
Epoch 45, accuracy: 0.6720
Epoch 46, accuracy: 0.6720
Epoch 46, Train Loss: 0.2506, Val Loss: 1.2436
Epoch 47, accuracy: 0.6720
Epoch 48, accuracy: 0.6720
Epoch 48, Train Loss: 0.2311, Val Loss: 1.2436
Epoch 49, accuracy: 0.6720
Epoch 50, accuracy: 0.6720
Epoch 50, Train Loss: 0.2480, Val Loss: 1.2436
Epoch 51, accuracy: 0.6720
Epoch 52, accuracy: 0.6720
Epoch 52, Train Loss: 0.2443, Val Loss: 1.2436
Epoch 53, accuracy: 0.6720
Epoch 54, accuracy: 0.6720
Epoch 54, Train Loss: 0.2504, Val Loss: 1.2436
Epoch 55, accuracy: 0.6720
Epoch 56, accuracy: 0.6720
Epoch 56, Train Loss: 0.2444, Val Loss: 1.2436
Epoch 57, accuracy: 0.6720
Epoch 58, accuracy: 0.6720
Epoch 58, Train Loss: 0.2470, Val Loss: 1.2436
Epoch 59, accuracy: 0.6720
Epoch 60, accuracy: 0.6720
Epoch 60, Train Loss: 0.2505, Val Loss: 1.2436
Epoch 61, accuracy: 0.6720
Epoch 62, accuracy: 0.6720
Epoch 62, Train Loss: 0.2334, Val Loss: 1.2436
Epoch 63, accuracy: 0.6720
Epoch 64, accuracy: 0.6720
Epoch 64, Train Loss: 0.2385, Val Loss: 1.2436
Epoch 65, accuracy: 0.6720
Epoch 66, accuracy: 0.6720
Epoch 66, Train Loss: 0.2495, Val Loss: 1.2436
Epoch 67, accuracy: 0.6720
Epoch 68, accuracy: 0.6720
Epoch 68, Train Loss: 0.2643, Val Loss: 1.2436
Epoch 69, accuracy: 0.6720
Epoch 70, accuracy: 0.6720
Epoch 70, Train Loss: 0.2334, Val Loss: 1.2436
Epoch 71, accuracy: 0.6720
Epoch 72, accuracy: 0.6720
Epoch 72, Train Loss: 0.2300, Val Loss: 1.2436
Epoch 73, accuracy: 0.6720
Epoch 74, accuracy: 0.6720
Epoch 74, Train Loss: 0.2360, Val Loss: 1.2436
Epoch 75, accuracy: 0.6720
Epoch 76, accuracy: 0.6720
Epoch 76, Train Loss: 0.2307, Val Loss: 1.2436
Epoch 77, accuracy: 0.6720
Epoch 78, accuracy: 0.6720
Epoch 78, Train Loss: 0.2700, Val Loss: 1.2436
Epoch 79, accuracy: 0.6720
Epoch 80, accuracy: 0.6720
Epoch 80, Train Loss: 0.2584, Val Loss: 1.2436
Epoch 81, accuracy: 0.6720
Epoch 82, accuracy: 0.6720
Epoch 82, Train Loss: 0.2193, Val Loss: 1.2436
Epoch 83, accuracy: 0.6720
Epoch 84, accuracy: 0.6720
Epoch 84, Train Loss: 0.2616, Val Loss: 1.2436
Epoch 85, accuracy: 0.6720
Epoch 86, accuracy: 0.6720
Epoch 86, Train Loss: 0.2345, Val Loss: 1.2436
Epoch 87, accuracy: 0.6720
Epoch 88, accuracy: 0.6720
Epoch 88, Train Loss: 0.2437, Val Loss: 1.2436
Epoch 89, accuracy: 0.6720
Epoch 90, accuracy: 0.6720
Epoch 90, Train Loss: 0.2310, Val Loss: 1.2436
Epoch 91, accuracy: 0.6720
Epoch 92, accuracy: 0.6720
Epoch 92, Train Loss: 0.2342, Val Loss: 1.2436
Epoch 93, accuracy: 0.6720
Epoch 94, accuracy: 0.6720
Epoch 94, Train Loss: 0.2627, Val Loss: 1.2436
Epoch 95, accuracy: 0.6720
Epoch 96, accuracy: 0.6720
Epoch 96, Train Loss: 0.2546, Val Loss: 1.2436
Epoch 97, accuracy: 0.6720
Epoch 98, accuracy: 0.6720
Epoch 98, Train Loss: 0.2504, Val Loss: 1.2436
Epoch 99, accuracy: 0.6720
Epoch 100, accuracy: 0.6720
Epoch 100, Train Loss: 0.2523, Val Loss: 1.2436
Epoch 101, accuracy: 0.6720
Epoch 102, accuracy: 0.6720
Epoch 102, Train Loss: 0.2456, Val Loss: 1.2436
Epoch 103, accuracy: 0.6720
Epoch 104, accuracy: 0.6720
Epoch 104, Train Loss: 0.2627, Val Loss: 1.2436
Epoch 105, accuracy: 0.6720
Epoch 106, accuracy: 0.6720
Epoch 106, Train Loss: 0.2378, Val Loss: 1.2436
Epoch 107, accuracy: 0.6720
Epoch 108, accuracy: 0.6720
Epoch 108, Train Loss: 0.2709, Val Loss: 1.2436
Epoch 109, accuracy: 0.6720
Epoch 110, accuracy: 0.6720
Epoch 110, Train Loss: 0.2398, Val Loss: 1.2436
Epoch 111, accuracy: 0.6720
Epoch 112, accuracy: 0.6720
Epoch 112, Train Loss: 0.2703, Val Loss: 1.2436
Epoch 113, accuracy: 0.6720
Epoch 114, accuracy: 0.6720
Epoch 114, Train Loss: 0.2656, Val Loss: 1.2436
Epoch 115, accuracy: 0.6720
Epoch 116, accuracy: 0.6720
Epoch 116, Train Loss: 0.2402, Val Loss: 1.2436
Epoch 117, accuracy: 0.6720
Epoch 118, accuracy: 0.6720
Epoch 118, Train Loss: 0.2340, Val Loss: 1.2436
Epoch 119, accuracy: 0.6720
Epoch 120, accuracy: 0.6720
Epoch 120, Train Loss: 0.2408, Val Loss: 1.2436
Epoch 121, accuracy: 0.6720
Epoch 122, accuracy: 0.6720
Epoch 122, Train Loss: 0.2564, Val Loss: 1.2436
Epoch 123, accuracy: 0.6720
Epoch 124, accuracy: 0.6720
Epoch 124, Train Loss: 0.2449, Val Loss: 1.2436
Epoch 125, accuracy: 0.6720
Epoch 126, accuracy: 0.6720
Epoch 126, Train Loss: 0.2535, Val Loss: 1.2436
Epoch 127, accuracy: 0.6720
Epoch 128, accuracy: 0.6720
Epoch 128, Train Loss: 0.2451, Val Loss: 1.2436
Epoch 129, accuracy: 0.6720
Epoch 130, accuracy: 0.6720
Epoch 130, Train Loss: 0.2450, Val Loss: 1.2436
Epoch 131, accuracy: 0.6720
Epoch 132, accuracy: 0.6720
Epoch 132, Train Loss: 0.2390, Val Loss: 1.2436
Epoch 133, accuracy: 0.6720
Epoch 134, accuracy: 0.6720
Epoch 134, Train Loss: 0.2388, Val Loss: 1.2436
Epoch 135, accuracy: 0.6720
Epoch 136, accuracy: 0.6720
Epoch 136, Train Loss: 0.2452, Val Loss: 1.2436
Epoch 137, accuracy: 0.6720
Epoch 138, accuracy: 0.6720
Epoch 138, Train Loss: 0.2487, Val Loss: 1.2436
Epoch 139, accuracy: 0.6720
Epoch 140, accuracy: 0.6720
Epoch 140, Train Loss: 0.2471, Val Loss: 1.2436
Epoch 141, accuracy: 0.6720
Epoch 142, accuracy: 0.6720
Epoch 142, Train Loss: 0.2378, Val Loss: 1.2436
Epoch 143, accuracy: 0.6720
Epoch 144, accuracy: 0.6720
Epoch 144, Train Loss: 0.2461, Val Loss: 1.2436
Epoch 145, accuracy: 0.6720
Epoch 146, accuracy: 0.6720
Epoch 146, Train Loss: 0.2382, Val Loss: 1.2436
Epoch 147, accuracy: 0.6720
Epoch 148, accuracy: 0.6720
Epoch 148, Train Loss: 0.2466, Val Loss: 1.2436
Epoch 149, accuracy: 0.6720
Epoch 150, accuracy: 0.6720
Epoch 150, Train Loss: 0.2606, Val Loss: 1.2436
Epoch 151, accuracy: 0.6720
Epoch 152, accuracy: 0.6720
Epoch 152, Train Loss: 0.2474, Val Loss: 1.2436
Epoch 153, accuracy: 0.6720
Epoch 154, accuracy: 0.6720
Epoch 154, Train Loss: 0.2394, Val Loss: 1.2436
Epoch 155, accuracy: 0.6720
Epoch 156, accuracy: 0.6720
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 156, Train Loss: 0.2568, Val Loss: 1.2436
Epoch 157, accuracy: 0.6720
Epoch 158, accuracy: 0.6720
Epoch 158, Train Loss: 0.2265, Val Loss: 1.2436
Epoch 159, accuracy: 0.6720
Epoch 160, accuracy: 0.6720
Epoch 160, Train Loss: 0.2390, Val Loss: 1.2436
Epoch 161, accuracy: 0.6720
Epoch 162, accuracy: 0.6720
Epoch 162, Train Loss: 0.2317, Val Loss: 1.2436
Epoch 163, accuracy: 0.6720
Epoch 164, accuracy: 0.6720
Epoch 164, Train Loss: 0.2396, Val Loss: 1.2436
Epoch 165, accuracy: 0.6720
Epoch 166, accuracy: 0.6720
Epoch 166, Train Loss: 0.2424, Val Loss: 1.2436
Epoch 167, accuracy: 0.6720
Epoch 168, accuracy: 0.6720
Epoch 168, Train Loss: 0.2337, Val Loss: 1.2436
Epoch 169, accuracy: 0.6720
Epoch 170, accuracy: 0.6720
Epoch 170, Train Loss: 0.2779, Val Loss: 1.2436
Epoch 171, accuracy: 0.6720
Epoch 172, accuracy: 0.6720
Epoch 172, Train Loss: 0.2197, Val Loss: 1.2436
Epoch 173, accuracy: 0.6720
Epoch 174, accuracy: 0.6720
Epoch 174, Train Loss: 0.2576, Val Loss: 1.2436
Epoch 175, accuracy: 0.6720
Epoch 176, accuracy: 0.6720
Epoch 176, Train Loss: 0.2494, Val Loss: 1.2436
Epoch 177, accuracy: 0.6720
Epoch 178, accuracy: 0.6720
Epoch 178, Train Loss: 0.2771, Val Loss: 1.2436
Epoch 179, accuracy: 0.6720
Epoch 180, accuracy: 0.6720
Epoch 180, Train Loss: 0.2434, Val Loss: 1.2436
Epoch 181, accuracy: 0.6720
Epoch 182, accuracy: 0.6720
Epoch 182, Train Loss: 0.2378, Val Loss: 1.2436
Epoch 183, accuracy: 0.6720
Epoch 184, accuracy: 0.6720
Epoch 184, Train Loss: 0.2505, Val Loss: 1.2436
Epoch 185, accuracy: 0.6720
Epoch 186, accuracy: 0.6720
Epoch 186, Train Loss: 0.2519, Val Loss: 1.2435
Epoch 187, accuracy: 0.6720
Epoch 188, accuracy: 0.6720
Epoch 188, Train Loss: 0.2454, Val Loss: 1.2435
Epoch 189, accuracy: 0.6720
Epoch 190, accuracy: 0.6720
Epoch 190, Train Loss: 0.2470, Val Loss: 1.2435
Epoch 191, accuracy: 0.6720
Epoch 192, accuracy: 0.6720
Epoch 192, Train Loss: 0.2506, Val Loss: 1.2435
Epoch 193, accuracy: 0.6720
Epoch 194, accuracy: 0.6720
Epoch 194, Train Loss: 0.2497, Val Loss: 1.2435
Epoch 195, accuracy: 0.6720
Epoch 196, accuracy: 0.6720
Epoch 196, Train Loss: 0.2543, Val Loss: 1.2435
Epoch 197, accuracy: 0.6720
Epoch 198, accuracy: 0.6720
Epoch 198, Train Loss: 0.2456, Val Loss: 1.2435
Epoch 199, accuracy: 0.6720
Loaded best model with val_loss = 1.2169681787490845
test :accuracy 0.6410, f1_macro: 0.5935, f1_micro: 0.6410, auc: 0.8919
Training GAT with 6 layers...
可训练参数: 2026270_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.8067
Epoch 0, accuracy: 0.2310
Epoch 0, Train Loss: 1.7913, Val Loss: 1.8067
✅ Epoch 1: New best model saved with val_loss = 1.7475
Epoch 1, accuracy: 0.1620
✅ Epoch 2: New best model saved with val_loss = 1.5703
Epoch 2, accuracy: 0.4040
Epoch 2, Train Loss: 1.6399, Val Loss: 1.5703
✅ Epoch 3: New best model saved with val_loss = 1.4177
Epoch 3, accuracy: 0.4600
✅ Epoch 4: New best model saved with val_loss = 1.2624
Epoch 4, accuracy: 0.5770
Epoch 4, Train Loss: 1.0802, Val Loss: 1.2624
Epoch 5, accuracy: 0.5770
Epoch 6, accuracy: 0.6040
Epoch 6, Train Loss: 0.9333, Val Loss: 1.3403
✅ Epoch 7: New best model saved with val_loss = 1.2132
Epoch 7, accuracy: 0.6260
Epoch 8, accuracy: 0.5970
Epoch 8, Train Loss: 0.2818, Val Loss: 1.4693
Epoch 9, accuracy: 0.5480
Epoch 10, accuracy: 0.5570
Epoch 10, Train Loss: 0.3088, Val Loss: 1.9564
Epoch 11, accuracy: 0.5920
Epoch 12, accuracy: 0.6030
Epoch 12, Train Loss: 0.1899, Val Loss: 1.9660
Epoch 13, accuracy: 0.6390
Epoch 14, accuracy: 0.6420
Epoch 14, Train Loss: 0.1217, Val Loss: 1.9298
Epoch 15, accuracy: 0.6440
Epoch 16, accuracy: 0.6420
Epoch 16, Train Loss: 0.1282, Val Loss: 1.9359
Epoch 17, accuracy: 0.6420
Epoch 18, accuracy: 0.6430
Epoch 18, Train Loss: 0.1269, Val Loss: 1.9444
Epoch 19, accuracy: 0.6410
Epoch 20, accuracy: 0.6410
Epoch 20, Train Loss: 0.1107, Val Loss: 1.9517
Epoch 21, accuracy: 0.6390
Epoch 22, accuracy: 0.6390
Epoch 22, Train Loss: 0.1255, Val Loss: 1.9542
Epoch 23, accuracy: 0.6400
Epoch 24, accuracy: 0.6400
Epoch 24, Train Loss: 0.1146, Val Loss: 1.9571
Epoch 25, accuracy: 0.6400
Epoch 26, accuracy: 0.6400
Epoch 26, Train Loss: 0.1258, Val Loss: 1.9586
Epoch 27, accuracy: 0.6400
Epoch 28, accuracy: 0.6400
Epoch 28, Train Loss: 0.1198, Val Loss: 1.9588
Epoch 29, accuracy: 0.6400
Epoch 30, accuracy: 0.6400
Epoch 30, Train Loss: 0.1028, Val Loss: 1.9590
Epoch 31, accuracy: 0.6400
Epoch 32, accuracy: 0.6400
Epoch 32, Train Loss: 0.1333, Val Loss: 1.9590
Epoch 33, accuracy: 0.6400
Epoch 34, accuracy: 0.6400
Epoch 34, Train Loss: 0.0938, Val Loss: 1.9590
Epoch 35, accuracy: 0.6400
Epoch 36, accuracy: 0.6400
Epoch 36, Train Loss: 0.1013, Val Loss: 1.9590
Epoch 37, accuracy: 0.6400
Epoch 38, accuracy: 0.6400
Epoch 38, Train Loss: 0.1171, Val Loss: 1.9590
Epoch 39, accuracy: 0.6400
Epoch 40, accuracy: 0.6400
Epoch 40, Train Loss: 0.1251, Val Loss: 1.9590
Epoch 41, accuracy: 0.6400
Epoch 42, accuracy: 0.6400
Epoch 42, Train Loss: 0.1153, Val Loss: 1.9590
Epoch 43, accuracy: 0.6400
Epoch 44, accuracy: 0.6400
Epoch 44, Train Loss: 0.1068, Val Loss: 1.9590
Epoch 45, accuracy: 0.6400
Epoch 46, accuracy: 0.6400
Epoch 46, Train Loss: 0.1012, Val Loss: 1.9590
Epoch 47, accuracy: 0.6400
Epoch 48, accuracy: 0.6400
Epoch 48, Train Loss: 0.1194, Val Loss: 1.9590
Epoch 49, accuracy: 0.6400
Epoch 50, accuracy: 0.6400
Epoch 50, Train Loss: 0.1216, Val Loss: 1.9590
Epoch 51, accuracy: 0.6400
Epoch 52, accuracy: 0.6400
Epoch 52, Train Loss: 0.1146, Val Loss: 1.9590
Epoch 53, accuracy: 0.6400
Epoch 54, accuracy: 0.6400
Epoch 54, Train Loss: 0.1063, Val Loss: 1.9590
Epoch 55, accuracy: 0.6400
Epoch 56, accuracy: 0.6400
Epoch 56, Train Loss: 0.0953, Val Loss: 1.9590
Epoch 57, accuracy: 0.6400
Epoch 58, accuracy: 0.6400
Epoch 58, Train Loss: 0.1016, Val Loss: 1.9590
Epoch 59, accuracy: 0.6400
Epoch 60, accuracy: 0.6400
Epoch 60, Train Loss: 0.1121, Val Loss: 1.9590
Epoch 61, accuracy: 0.6400
Epoch 62, accuracy: 0.6400
Epoch 62, Train Loss: 0.0971, Val Loss: 1.9590
Epoch 63, accuracy: 0.6400
Epoch 64, accuracy: 0.6400
Epoch 64, Train Loss: 0.1008, Val Loss: 1.9590
Epoch 65, accuracy: 0.6400
Epoch 66, accuracy: 0.6400
Epoch 66, Train Loss: 0.0983, Val Loss: 1.9590
Epoch 67, accuracy: 0.6400
Epoch 68, accuracy: 0.6400
Epoch 68, Train Loss: 0.1159, Val Loss: 1.9590
Epoch 69, accuracy: 0.6400
Epoch 70, accuracy: 0.6400
Epoch 70, Train Loss: 0.1159, Val Loss: 1.9590
Epoch 71, accuracy: 0.6400
Epoch 72, accuracy: 0.6400
Epoch 72, Train Loss: 0.1289, Val Loss: 1.9590
Epoch 73, accuracy: 0.6400
Epoch 74, accuracy: 0.6400
Epoch 74, Train Loss: 0.1193, Val Loss: 1.9590
Epoch 75, accuracy: 0.6400
Epoch 76, accuracy: 0.6400
Epoch 76, Train Loss: 0.0989, Val Loss: 1.9590
Epoch 77, accuracy: 0.6400
Epoch 78, accuracy: 0.6400
Epoch 78, Train Loss: 0.1037, Val Loss: 1.9590
Epoch 79, accuracy: 0.6400
Epoch 80, accuracy: 0.6400
Epoch 80, Train Loss: 0.1042, Val Loss: 1.9590
Epoch 81, accuracy: 0.6400
Epoch 82, accuracy: 0.6400
Epoch 82, Train Loss: 0.0940, Val Loss: 1.9590
Epoch 83, accuracy: 0.6400
Epoch 84, accuracy: 0.6400
Epoch 84, Train Loss: 0.1063, Val Loss: 1.9590
Epoch 85, accuracy: 0.6400
Epoch 86, accuracy: 0.6400
Epoch 86, Train Loss: 0.1311, Val Loss: 1.9590
Epoch 87, accuracy: 0.6400
Epoch 88, accuracy: 0.6400
Epoch 88, Train Loss: 0.0988, Val Loss: 1.9590
Epoch 89, accuracy: 0.6400
Epoch 90, accuracy: 0.6400
Epoch 90, Train Loss: 0.1008, Val Loss: 1.9590
Epoch 91, accuracy: 0.6400
Epoch 92, accuracy: 0.6400
Epoch 92, Train Loss: 0.1122, Val Loss: 1.9590
Epoch 93, accuracy: 0.6400
Epoch 94, accuracy: 0.6400
Epoch 94, Train Loss: 0.1059, Val Loss: 1.9590
Epoch 95, accuracy: 0.6400
Epoch 96, accuracy: 0.6400
Epoch 96, Train Loss: 0.1306, Val Loss: 1.9590
Epoch 97, accuracy: 0.6400
Epoch 98, accuracy: 0.6400
Epoch 98, Train Loss: 0.0911, Val Loss: 1.9590
Epoch 99, accuracy: 0.6400
Epoch 100, accuracy: 0.6400
Epoch 100, Train Loss: 0.1087, Val Loss: 1.9590
Epoch 101, accuracy: 0.6400
Epoch 102, accuracy: 0.6400
Epoch 102, Train Loss: 0.1488, Val Loss: 1.9590
Epoch 103, accuracy: 0.6400
Epoch 104, accuracy: 0.6400
Epoch 104, Train Loss: 0.1127, Val Loss: 1.9590
Epoch 105, accuracy: 0.6400
Epoch 106, accuracy: 0.6400
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 106, Train Loss: 0.0855, Val Loss: 1.9590
Epoch 107, accuracy: 0.6400
Epoch 108, accuracy: 0.6400
Epoch 108, Train Loss: 0.1309, Val Loss: 1.9590
Epoch 109, accuracy: 0.6400
Epoch 110, accuracy: 0.6400
Epoch 110, Train Loss: 0.0887, Val Loss: 1.9590
Epoch 111, accuracy: 0.6400
Epoch 112, accuracy: 0.6400
Epoch 112, Train Loss: 0.1084, Val Loss: 1.9590
Epoch 113, accuracy: 0.6400
Epoch 114, accuracy: 0.6400
Epoch 114, Train Loss: 0.1257, Val Loss: 1.9590
Epoch 115, accuracy: 0.6400
Epoch 116, accuracy: 0.6400
Epoch 116, Train Loss: 0.1031, Val Loss: 1.9590
Epoch 117, accuracy: 0.6400
Epoch 118, accuracy: 0.6400
Epoch 118, Train Loss: 0.1113, Val Loss: 1.9590
Epoch 119, accuracy: 0.6400
Epoch 120, accuracy: 0.6400
Epoch 120, Train Loss: 0.1036, Val Loss: 1.9590
Epoch 121, accuracy: 0.6400
Epoch 122, accuracy: 0.6400
Epoch 122, Train Loss: 0.1071, Val Loss: 1.9590
Epoch 123, accuracy: 0.6400
Epoch 124, accuracy: 0.6400
Epoch 124, Train Loss: 0.1127, Val Loss: 1.9590
Epoch 125, accuracy: 0.6400
Epoch 126, accuracy: 0.6400
Epoch 126, Train Loss: 0.1187, Val Loss: 1.9590
Epoch 127, accuracy: 0.6400
Epoch 128, accuracy: 0.6400
Epoch 128, Train Loss: 0.1203, Val Loss: 1.9590
Epoch 129, accuracy: 0.6400
Epoch 130, accuracy: 0.6400
Epoch 130, Train Loss: 0.0969, Val Loss: 1.9590
Epoch 131, accuracy: 0.6400
Epoch 132, accuracy: 0.6400
Epoch 132, Train Loss: 0.1104, Val Loss: 1.9590
Epoch 133, accuracy: 0.6400
Epoch 134, accuracy: 0.6400
Epoch 134, Train Loss: 0.1091, Val Loss: 1.9590
Epoch 135, accuracy: 0.6400
Epoch 136, accuracy: 0.6400
Epoch 136, Train Loss: 0.0981, Val Loss: 1.9590
Epoch 137, accuracy: 0.6400
Epoch 138, accuracy: 0.6400
Epoch 138, Train Loss: 0.1251, Val Loss: 1.9590
Epoch 139, accuracy: 0.6400
Epoch 140, accuracy: 0.6400
Epoch 140, Train Loss: 0.1038, Val Loss: 1.9590
Epoch 141, accuracy: 0.6400
Epoch 142, accuracy: 0.6400
Epoch 142, Train Loss: 0.1117, Val Loss: 1.9590
Epoch 143, accuracy: 0.6400
Epoch 144, accuracy: 0.6400
Epoch 144, Train Loss: 0.1070, Val Loss: 1.9590
Epoch 145, accuracy: 0.6400
Epoch 146, accuracy: 0.6400
Epoch 146, Train Loss: 0.1086, Val Loss: 1.9590
Epoch 147, accuracy: 0.6400
Epoch 148, accuracy: 0.6400
Epoch 148, Train Loss: 0.1022, Val Loss: 1.9590
Epoch 149, accuracy: 0.6400
Epoch 150, accuracy: 0.6400
Epoch 150, Train Loss: 0.1081, Val Loss: 1.9590
Epoch 151, accuracy: 0.6400
Epoch 152, accuracy: 0.6400
Epoch 152, Train Loss: 0.0963, Val Loss: 1.9590
Epoch 153, accuracy: 0.6400
Epoch 154, accuracy: 0.6400
Epoch 154, Train Loss: 0.1091, Val Loss: 1.9590
Epoch 155, accuracy: 0.6400
Epoch 156, accuracy: 0.6400
Epoch 156, Train Loss: 0.0951, Val Loss: 1.9590
Epoch 157, accuracy: 0.6400
Epoch 158, accuracy: 0.6400
Epoch 158, Train Loss: 0.1084, Val Loss: 1.9590
Epoch 159, accuracy: 0.6400
Epoch 160, accuracy: 0.6400
Epoch 160, Train Loss: 0.1047, Val Loss: 1.9590
Epoch 161, accuracy: 0.6400
Epoch 162, accuracy: 0.6400
Epoch 162, Train Loss: 0.1116, Val Loss: 1.9590
Epoch 163, accuracy: 0.6400
Epoch 164, accuracy: 0.6400
Epoch 164, Train Loss: 0.1168, Val Loss: 1.9590
Epoch 165, accuracy: 0.6400
Epoch 166, accuracy: 0.6400
Epoch 166, Train Loss: 0.1103, Val Loss: 1.9590
Epoch 167, accuracy: 0.6400
Epoch 168, accuracy: 0.6400
Epoch 168, Train Loss: 0.1009, Val Loss: 1.9590
Epoch 169, accuracy: 0.6400
Epoch 170, accuracy: 0.6400
Epoch 170, Train Loss: 0.0968, Val Loss: 1.9590
Epoch 171, accuracy: 0.6400
Epoch 172, accuracy: 0.6400
Epoch 172, Train Loss: 0.1150, Val Loss: 1.9590
Epoch 173, accuracy: 0.6400
Epoch 174, accuracy: 0.6400
Epoch 174, Train Loss: 0.1142, Val Loss: 1.9590
Epoch 175, accuracy: 0.6400
Epoch 176, accuracy: 0.6400
Epoch 176, Train Loss: 0.1144, Val Loss: 1.9590
Epoch 177, accuracy: 0.6400
Epoch 178, accuracy: 0.6400
Epoch 178, Train Loss: 0.0936, Val Loss: 1.9590
Epoch 179, accuracy: 0.6400
Epoch 180, accuracy: 0.6400
Epoch 180, Train Loss: 0.1053, Val Loss: 1.9590
Epoch 181, accuracy: 0.6400
Epoch 182, accuracy: 0.6400
Epoch 182, Train Loss: 0.1150, Val Loss: 1.9590
Epoch 183, accuracy: 0.6400
Epoch 184, accuracy: 0.6400
Epoch 184, Train Loss: 0.1198, Val Loss: 1.9590
Epoch 185, accuracy: 0.6400
Epoch 186, accuracy: 0.6400
Epoch 186, Train Loss: 0.1127, Val Loss: 1.9590
Epoch 187, accuracy: 0.6400
Epoch 188, accuracy: 0.6400
Epoch 188, Train Loss: 0.1167, Val Loss: 1.9590
Epoch 189, accuracy: 0.6400
Epoch 190, accuracy: 0.6400
Epoch 190, Train Loss: 0.1181, Val Loss: 1.9590
Epoch 191, accuracy: 0.6400
Epoch 192, accuracy: 0.6400
Epoch 192, Train Loss: 0.1011, Val Loss: 1.9590
Epoch 193, accuracy: 0.6400
Epoch 194, accuracy: 0.6400
Epoch 194, Train Loss: 0.1095, Val Loss: 1.9590
Epoch 195, accuracy: 0.6400
Epoch 196, accuracy: 0.6400
Epoch 196, Train Loss: 0.0970, Val Loss: 1.9590
Epoch 197, accuracy: 0.6400
Epoch 198, accuracy: 0.6400
Epoch 198, Train Loss: 0.1003, Val Loss: 1.9590
Epoch 199, accuracy: 0.6400
Loaded best model with val_loss = 1.2131928205490112
test :accuracy 0.6260, f1_macro: 0.5951, f1_micro: 0.6260, auc: 0.8632
Training GAT with 7 layers...
可训练参数: 2175646_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.8211
Epoch 0, accuracy: 0.0770
Epoch 0, Train Loss: 1.7884, Val Loss: 1.8211
✅ Epoch 1: New best model saved with val_loss = 1.7229
Epoch 1, accuracy: 0.2090
Epoch 2, accuracy: 0.0770
Epoch 2, Train Loss: 1.7221, Val Loss: 1.7645
✅ Epoch 3: New best model saved with val_loss = 1.5735
Epoch 3, accuracy: 0.3390
Epoch 4, accuracy: 0.2310
Epoch 4, Train Loss: 1.6552, Val Loss: 1.6033
Epoch 5, accuracy: 0.3600
Epoch 6, accuracy: 0.3940
Epoch 6, Train Loss: 1.4581, Val Loss: 1.5887
✅ Epoch 7: New best model saved with val_loss = 1.4546
Epoch 7, accuracy: 0.4480
✅ Epoch 8: New best model saved with val_loss = 1.2883
Epoch 8, accuracy: 0.6060
Epoch 8, Train Loss: 1.0460, Val Loss: 1.2883
Epoch 9, accuracy: 0.6760
Epoch 10, accuracy: 0.6740
Epoch 10, Train Loss: 0.4271, Val Loss: 1.7075
Epoch 11, accuracy: 0.5990
Epoch 12, accuracy: 0.6100
Epoch 12, Train Loss: 0.4241, Val Loss: 4.3534
Epoch 13, accuracy: 0.6290
Epoch 14, accuracy: 0.6720
Epoch 14, Train Loss: 0.5062, Val Loss: 2.8795
Epoch 15, accuracy: 0.6670
Epoch 16, accuracy: 0.6680
Epoch 16, Train Loss: 0.4015, Val Loss: 2.8290
Epoch 17, accuracy: 0.6650
Epoch 18, accuracy: 0.6610
Epoch 18, Train Loss: 0.2449, Val Loss: 2.8157
Epoch 19, accuracy: 0.6600
Epoch 20, accuracy: 0.6520
Epoch 20, Train Loss: 0.1839, Val Loss: 2.8614
Epoch 21, accuracy: 0.6520
Epoch 22, accuracy: 0.6530
Epoch 22, Train Loss: 0.2017, Val Loss: 2.8659
Epoch 23, accuracy: 0.6520
Epoch 24, accuracy: 0.6520
Epoch 24, Train Loss: 0.1888, Val Loss: 2.8696
Epoch 25, accuracy: 0.6510
Epoch 26, accuracy: 0.6510
Epoch 26, Train Loss: 0.1547, Val Loss: 2.8719
Epoch 27, accuracy: 0.6510
Epoch 28, accuracy: 0.6510
Epoch 28, Train Loss: 0.1900, Val Loss: 2.8722
Epoch 29, accuracy: 0.6510
Epoch 30, accuracy: 0.6510
Epoch 30, Train Loss: 0.1557, Val Loss: 2.8723
Epoch 31, accuracy: 0.6510
Epoch 32, accuracy: 0.6510
Epoch 32, Train Loss: 0.1564, Val Loss: 2.8724
Epoch 33, accuracy: 0.6510
Epoch 34, accuracy: 0.6510
Epoch 34, Train Loss: 0.1880, Val Loss: 2.8724
Epoch 35, accuracy: 0.6510
Epoch 36, accuracy: 0.6510
Epoch 36, Train Loss: 0.1970, Val Loss: 2.8724
Epoch 37, accuracy: 0.6510
Epoch 38, accuracy: 0.6510
Epoch 38, Train Loss: 0.1759, Val Loss: 2.8724
Epoch 39, accuracy: 0.6510
Epoch 40, accuracy: 0.6510
Epoch 40, Train Loss: 0.1814, Val Loss: 2.8724
Epoch 41, accuracy: 0.6510
Epoch 42, accuracy: 0.6510
Epoch 42, Train Loss: 0.1704, Val Loss: 2.8724
Epoch 43, accuracy: 0.6510
Epoch 44, accuracy: 0.6510
Epoch 44, Train Loss: 0.1580, Val Loss: 2.8724
Epoch 45, accuracy: 0.6510
Epoch 46, accuracy: 0.6510
Epoch 46, Train Loss: 0.1833, Val Loss: 2.8724
Epoch 47, accuracy: 0.6510
Epoch 48, accuracy: 0.6510
Epoch 48, Train Loss: 0.1659, Val Loss: 2.8724
Epoch 49, accuracy: 0.6510
Epoch 50, accuracy: 0.6510
Epoch 50, Train Loss: 0.2081, Val Loss: 2.8724
Epoch 51, accuracy: 0.6510
Epoch 52, accuracy: 0.6510
Epoch 52, Train Loss: 0.1794, Val Loss: 2.8724
Epoch 53, accuracy: 0.6510
Epoch 54, accuracy: 0.6510
Epoch 54, Train Loss: 0.1496, Val Loss: 2.8724
Epoch 55, accuracy: 0.6510
Epoch 56, accuracy: 0.6510
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 56, Train Loss: 0.1738, Val Loss: 2.8724
Epoch 57, accuracy: 0.6510
Epoch 58, accuracy: 0.6510
Epoch 58, Train Loss: 0.2140, Val Loss: 2.8724
Epoch 59, accuracy: 0.6510
Epoch 60, accuracy: 0.6510
Epoch 60, Train Loss: 0.1478, Val Loss: 2.8724
Epoch 61, accuracy: 0.6510
Epoch 62, accuracy: 0.6510
Epoch 62, Train Loss: 0.1476, Val Loss: 2.8724
Epoch 63, accuracy: 0.6510
Epoch 64, accuracy: 0.6510
Epoch 64, Train Loss: 0.1658, Val Loss: 2.8724
Epoch 65, accuracy: 0.6510
Epoch 66, accuracy: 0.6510
Epoch 66, Train Loss: 0.1685, Val Loss: 2.8724
Epoch 67, accuracy: 0.6510
Epoch 68, accuracy: 0.6510
Epoch 68, Train Loss: 0.1776, Val Loss: 2.8724
Epoch 69, accuracy: 0.6510
Epoch 70, accuracy: 0.6510
Epoch 70, Train Loss: 0.1986, Val Loss: 2.8724
Epoch 71, accuracy: 0.6510
Epoch 72, accuracy: 0.6510
Epoch 72, Train Loss: 0.1514, Val Loss: 2.8724
Epoch 73, accuracy: 0.6510
Epoch 74, accuracy: 0.6510
Epoch 74, Train Loss: 0.1760, Val Loss: 2.8724
Epoch 75, accuracy: 0.6510
Epoch 76, accuracy: 0.6510
Epoch 76, Train Loss: 0.1596, Val Loss: 2.8724
Epoch 77, accuracy: 0.6510
Epoch 78, accuracy: 0.6510
Epoch 78, Train Loss: 0.1549, Val Loss: 2.8724
Epoch 79, accuracy: 0.6510
Epoch 80, accuracy: 0.6510
Epoch 80, Train Loss: 0.1593, Val Loss: 2.8724
Epoch 81, accuracy: 0.6510
Epoch 82, accuracy: 0.6510
Epoch 82, Train Loss: 0.1231, Val Loss: 2.8724
Epoch 83, accuracy: 0.6510
Epoch 84, accuracy: 0.6510
Epoch 84, Train Loss: 0.1682, Val Loss: 2.8724
Epoch 85, accuracy: 0.6510
Epoch 86, accuracy: 0.6510
Epoch 86, Train Loss: 0.1621, Val Loss: 2.8724
Epoch 87, accuracy: 0.6510
Epoch 88, accuracy: 0.6510
Epoch 88, Train Loss: 0.1437, Val Loss: 2.8724
Epoch 89, accuracy: 0.6510
Epoch 90, accuracy: 0.6510
Epoch 90, Train Loss: 0.1683, Val Loss: 2.8724
Epoch 91, accuracy: 0.6510
Epoch 92, accuracy: 0.6510
Epoch 92, Train Loss: 0.1486, Val Loss: 2.8724
Epoch 93, accuracy: 0.6510
Epoch 94, accuracy: 0.6510
Epoch 94, Train Loss: 0.1838, Val Loss: 2.8724
Epoch 95, accuracy: 0.6510
Epoch 96, accuracy: 0.6510
Epoch 96, Train Loss: 0.2390, Val Loss: 2.8724
Epoch 97, accuracy: 0.6510
Epoch 98, accuracy: 0.6510
Epoch 98, Train Loss: 0.1596, Val Loss: 2.8724
Epoch 99, accuracy: 0.6510
Epoch 100, accuracy: 0.6510
Epoch 100, Train Loss: 0.1422, Val Loss: 2.8724
Epoch 101, accuracy: 0.6510
Epoch 102, accuracy: 0.6510
Epoch 102, Train Loss: 0.2056, Val Loss: 2.8724
Epoch 103, accuracy: 0.6510
Epoch 104, accuracy: 0.6510
Epoch 104, Train Loss: 0.1904, Val Loss: 2.8724
Epoch 105, accuracy: 0.6510
Epoch 106, accuracy: 0.6510
Epoch 106, Train Loss: 0.1541, Val Loss: 2.8724
Epoch 107, accuracy: 0.6510
Epoch 108, accuracy: 0.6510
Epoch 108, Train Loss: 0.1668, Val Loss: 2.8724
Epoch 109, accuracy: 0.6510
Epoch 110, accuracy: 0.6510
Epoch 110, Train Loss: 0.1883, Val Loss: 2.8724
Epoch 111, accuracy: 0.6510
Epoch 112, accuracy: 0.6510
Epoch 112, Train Loss: 0.1522, Val Loss: 2.8724
Epoch 113, accuracy: 0.6510
Epoch 114, accuracy: 0.6510
Epoch 114, Train Loss: 0.1728, Val Loss: 2.8724
Epoch 115, accuracy: 0.6510
Epoch 116, accuracy: 0.6510
Epoch 116, Train Loss: 0.1605, Val Loss: 2.8724
Epoch 117, accuracy: 0.6510
Epoch 118, accuracy: 0.6510
Epoch 118, Train Loss: 0.2229, Val Loss: 2.8724
Epoch 119, accuracy: 0.6510
Epoch 120, accuracy: 0.6510
Epoch 120, Train Loss: 0.1788, Val Loss: 2.8724
Epoch 121, accuracy: 0.6510
Epoch 122, accuracy: 0.6510
Epoch 122, Train Loss: 0.1591, Val Loss: 2.8724
Epoch 123, accuracy: 0.6510
Epoch 124, accuracy: 0.6510
Epoch 124, Train Loss: 0.2192, Val Loss: 2.8724
Epoch 125, accuracy: 0.6510
Epoch 126, accuracy: 0.6510
Epoch 126, Train Loss: 0.1561, Val Loss: 2.8724
Epoch 127, accuracy: 0.6510
Epoch 128, accuracy: 0.6510
Epoch 128, Train Loss: 0.1666, Val Loss: 2.8724
Epoch 129, accuracy: 0.6510
Epoch 130, accuracy: 0.6510
Epoch 130, Train Loss: 0.1575, Val Loss: 2.8724
Epoch 131, accuracy: 0.6510
Epoch 132, accuracy: 0.6510
Epoch 132, Train Loss: 0.1693, Val Loss: 2.8724
Epoch 133, accuracy: 0.6510
Epoch 134, accuracy: 0.6510
Epoch 134, Train Loss: 0.1294, Val Loss: 2.8724
Epoch 135, accuracy: 0.6510
Epoch 136, accuracy: 0.6510
Epoch 136, Train Loss: 0.1563, Val Loss: 2.8724
Epoch 137, accuracy: 0.6510
Epoch 138, accuracy: 0.6510
Epoch 138, Train Loss: 0.1790, Val Loss: 2.8724
Epoch 139, accuracy: 0.6510
Epoch 140, accuracy: 0.6510
Epoch 140, Train Loss: 0.1803, Val Loss: 2.8724
Epoch 141, accuracy: 0.6510
Epoch 142, accuracy: 0.6510
Epoch 142, Train Loss: 0.1113, Val Loss: 2.8724
Epoch 143, accuracy: 0.6510
Epoch 144, accuracy: 0.6510
Epoch 144, Train Loss: 0.1396, Val Loss: 2.8724
Epoch 145, accuracy: 0.6510
Epoch 146, accuracy: 0.6510
Epoch 146, Train Loss: 0.1644, Val Loss: 2.8724
Epoch 147, accuracy: 0.6510
Epoch 148, accuracy: 0.6510
Epoch 148, Train Loss: 0.1982, Val Loss: 2.8724
Epoch 149, accuracy: 0.6510
Epoch 150, accuracy: 0.6510
Epoch 150, Train Loss: 0.2308, Val Loss: 2.8724
Epoch 151, accuracy: 0.6510
Epoch 152, accuracy: 0.6510
Epoch 152, Train Loss: 0.1756, Val Loss: 2.8724
Epoch 153, accuracy: 0.6510
Epoch 154, accuracy: 0.6510
Epoch 154, Train Loss: 0.1637, Val Loss: 2.8724
Epoch 155, accuracy: 0.6510
Epoch 156, accuracy: 0.6510
Epoch 156, Train Loss: 0.1561, Val Loss: 2.8724
Epoch 157, accuracy: 0.6510
Epoch 158, accuracy: 0.6510
Epoch 158, Train Loss: 0.1952, Val Loss: 2.8724
Epoch 159, accuracy: 0.6510
Epoch 160, accuracy: 0.6510
Epoch 160, Train Loss: 0.1483, Val Loss: 2.8724
Epoch 161, accuracy: 0.6510
Epoch 162, accuracy: 0.6510
Epoch 162, Train Loss: 0.1488, Val Loss: 2.8724
Epoch 163, accuracy: 0.6510
Epoch 164, accuracy: 0.6510
Epoch 164, Train Loss: 0.1847, Val Loss: 2.8724
Epoch 165, accuracy: 0.6510
Epoch 166, accuracy: 0.6510
Epoch 166, Train Loss: 0.1788, Val Loss: 2.8724
Epoch 167, accuracy: 0.6510
Epoch 168, accuracy: 0.6510
Epoch 168, Train Loss: 0.1930, Val Loss: 2.8724
Epoch 169, accuracy: 0.6510
Epoch 170, accuracy: 0.6510
Epoch 170, Train Loss: 0.1882, Val Loss: 2.8724
Epoch 171, accuracy: 0.6510
Epoch 172, accuracy: 0.6510
Epoch 172, Train Loss: 0.1568, Val Loss: 2.8724
Epoch 173, accuracy: 0.6510
Epoch 174, accuracy: 0.6510
Epoch 174, Train Loss: 0.1681, Val Loss: 2.8724
Epoch 175, accuracy: 0.6510
Epoch 176, accuracy: 0.6510
Epoch 176, Train Loss: 0.1411, Val Loss: 2.8724
Epoch 177, accuracy: 0.6510
Epoch 178, accuracy: 0.6510
Epoch 178, Train Loss: 0.1772, Val Loss: 2.8724
Epoch 179, accuracy: 0.6510
Epoch 180, accuracy: 0.6510
Epoch 180, Train Loss: 0.1333, Val Loss: 2.8724
Epoch 181, accuracy: 0.6510
Epoch 182, accuracy: 0.6510
Epoch 182, Train Loss: 0.2043, Val Loss: 2.8724
Epoch 183, accuracy: 0.6510
Epoch 184, accuracy: 0.6510
Epoch 184, Train Loss: 0.1248, Val Loss: 2.8724
Epoch 185, accuracy: 0.6510
Epoch 186, accuracy: 0.6510
Epoch 186, Train Loss: 0.1667, Val Loss: 2.8724
Epoch 187, accuracy: 0.6510
Epoch 188, accuracy: 0.6510
Epoch 188, Train Loss: 0.1487, Val Loss: 2.8724
Epoch 189, accuracy: 0.6510
Epoch 190, accuracy: 0.6510
Epoch 190, Train Loss: 0.2003, Val Loss: 2.8724
Epoch 191, accuracy: 0.6510
Epoch 192, accuracy: 0.6510
Epoch 192, Train Loss: 0.1965, Val Loss: 2.8724
Epoch 193, accuracy: 0.6510
Epoch 194, accuracy: 0.6510
Epoch 194, Train Loss: 0.1335, Val Loss: 2.8724
Epoch 195, accuracy: 0.6510
Epoch 196, accuracy: 0.6510
Epoch 196, Train Loss: 0.1459, Val Loss: 2.8724
Epoch 197, accuracy: 0.6510
Epoch 198, accuracy: 0.6510
Epoch 198, Train Loss: 0.2794, Val Loss: 2.8724
Epoch 199, accuracy: 0.6510
Loaded best model with val_loss = 1.2882838249206543
test :accuracy 0.6060, f1_macro: 0.5863, f1_micro: 0.6060, auc: 0.8533
Training mamba3 with 3 layers...
可训练参数: 1568702_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.6432
Epoch 0, accuracy: 0.3900
Epoch 0, Train Loss: 1.9228, Val Loss: 1.6432
✅ Epoch 1: New best model saved with val_loss = 1.5687
Epoch 1, accuracy: 0.3810
✅ Epoch 2: New best model saved with val_loss = 1.4164
Epoch 2, accuracy: 0.4170
Epoch 2, Train Loss: 1.1961, Val Loss: 1.4164
✅ Epoch 3: New best model saved with val_loss = 1.3035
Epoch 3, accuracy: 0.5690
Epoch 4, accuracy: 0.5830
Epoch 4, Train Loss: 0.8977, Val Loss: 1.3612
Epoch 5, accuracy: 0.5960
Epoch 6, accuracy: 0.5980
Epoch 6, Train Loss: 0.5394, Val Loss: 1.5196
Epoch 7, accuracy: 0.6070
Epoch 8, accuracy: 0.6240
Epoch 8, Train Loss: 0.4508, Val Loss: 1.5233
Epoch 9, accuracy: 0.6350
Epoch 10, accuracy: 0.6350
Epoch 10, Train Loss: 0.2926, Val Loss: 1.5250
Epoch 11, accuracy: 0.6350
Epoch 12, accuracy: 0.6330
Epoch 12, Train Loss: 0.3443, Val Loss: 1.5287
Epoch 13, accuracy: 0.6370
Epoch 14, accuracy: 0.6380
Epoch 14, Train Loss: 0.3674, Val Loss: 1.5326
Epoch 15, accuracy: 0.6360
Epoch 16, accuracy: 0.6360
Epoch 16, Train Loss: 0.2788, Val Loss: 1.5335
Epoch 17, accuracy: 0.6360
Epoch 18, accuracy: 0.6370
Epoch 18, Train Loss: 0.2950, Val Loss: 1.5334
Epoch 19, accuracy: 0.6380
Epoch 20, accuracy: 0.6380
Epoch 20, Train Loss: 0.3598, Val Loss: 1.5334
Epoch 21, accuracy: 0.6370
Epoch 22, accuracy: 0.6380
Epoch 22, Train Loss: 0.2957, Val Loss: 1.5334
Epoch 23, accuracy: 0.6380
Epoch 24, accuracy: 0.6380
Epoch 24, Train Loss: 0.2235, Val Loss: 1.5334
Epoch 25, accuracy: 0.6380
Epoch 26, accuracy: 0.6380
Epoch 26, Train Loss: 0.2599, Val Loss: 1.5335
Epoch 27, accuracy: 0.6380
Epoch 28, accuracy: 0.6380
Epoch 28, Train Loss: 0.2446, Val Loss: 1.5335
Epoch 29, accuracy: 0.6380
Epoch 30, accuracy: 0.6380
Epoch 30, Train Loss: 0.2741, Val Loss: 1.5335
Epoch 31, accuracy: 0.6380
Epoch 32, accuracy: 0.6380
Epoch 32, Train Loss: 0.3227, Val Loss: 1.5335
Epoch 33, accuracy: 0.6380
Epoch 34, accuracy: 0.6380
Epoch 34, Train Loss: 0.2556, Val Loss: 1.5335
Epoch 35, accuracy: 0.6380
Epoch 36, accuracy: 0.6380
Epoch 36, Train Loss: 0.2622, Val Loss: 1.5335
Epoch 37, accuracy: 0.6380
Epoch 38, accuracy: 0.6380
Epoch 38, Train Loss: 0.3494, Val Loss: 1.5335
Epoch 39, accuracy: 0.6380
Epoch 40, accuracy: 0.6380
Epoch 40, Train Loss: 0.2731, Val Loss: 1.5335
Epoch 41, accuracy: 0.6380
Epoch 42, accuracy: 0.6380
Epoch 42, Train Loss: 0.2776, Val Loss: 1.5335
Epoch 43, accuracy: 0.6380
Epoch 44, accuracy: 0.6380
Epoch 44, Train Loss: 0.2632, Val Loss: 1.5335
Epoch 45, accuracy: 0.6380
Epoch 46, accuracy: 0.6380
Epoch 46, Train Loss: 0.2933, Val Loss: 1.5335
Epoch 47, accuracy: 0.6380
Epoch 48, accuracy: 0.6380
Epoch 48, Train Loss: 0.2684, Val Loss: 1.5335
Epoch 49, accuracy: 0.6380
Epoch 50, accuracy: 0.6380
Epoch 50, Train Loss: 0.2371, Val Loss: 1.5335
Epoch 51, accuracy: 0.6380
Epoch 52, accuracy: 0.6380
Epoch 52, Train Loss: 0.2708, Val Loss: 1.5335
Epoch 53, accuracy: 0.6380
Epoch 54, accuracy: 0.6380
Epoch 54, Train Loss: 0.2834, Val Loss: 1.5335
Epoch 55, accuracy: 0.6380
Epoch 56, accuracy: 0.6380
Epoch 56, Train Loss: 0.2677, Val Loss: 1.5335
Epoch 57, accuracy: 0.6380
Epoch 58, accuracy: 0.6380
Epoch 58, Train Loss: 0.2261, Val Loss: 1.5335
Epoch 59, accuracy: 0.6380
Epoch 60, accuracy: 0.6380
Epoch 60, Train Loss: 0.3036, Val Loss: 1.5335
Epoch 61, accuracy: 0.6380
Epoch 62, accuracy: 0.6380
Epoch 62, Train Loss: 0.3168, Val Loss: 1.5335
Epoch 63, accuracy: 0.6380
Epoch 64, accuracy: 0.6380
Epoch 64, Train Loss: 0.3044, Val Loss: 1.5335
Epoch 65, accuracy: 0.6380
Epoch 66, accuracy: 0.6380
Epoch 66, Train Loss: 0.3471, Val Loss: 1.5335
Epoch 67, accuracy: 0.6380
Epoch 68, accuracy: 0.6380
Epoch 68, Train Loss: 0.2297, Val Loss: 1.5335
Epoch 69, accuracy: 0.6380
Epoch 70, accuracy: 0.6380
Epoch 70, Train Loss: 0.2647, Val Loss: 1.5335
Epoch 71, accuracy: 0.6380
Epoch 72, accuracy: 0.6380
Epoch 72, Train Loss: 0.2753, Val Loss: 1.5335
Epoch 73, accuracy: 0.6380
Epoch 74, accuracy: 0.6380
Epoch 74, Train Loss: 0.2475, Val Loss: 1.5335
Epoch 75, accuracy: 0.6380
Epoch 76, accuracy: 0.6380
Epoch 76, Train Loss: 0.2303, Val Loss: 1.5335
Epoch 77, accuracy: 0.6380
Epoch 78, accuracy: 0.6380
Epoch 78, Train Loss: 0.2690, Val Loss: 1.5335
Epoch 79, accuracy: 0.6380
Epoch 80, accuracy: 0.6380
Epoch 80, Train Loss: 0.3093, Val Loss: 1.5335
Epoch 81, accuracy: 0.6380
Epoch 82, accuracy: 0.6380
Epoch 82, Train Loss: 0.2986, Val Loss: 1.5335
Epoch 83, accuracy: 0.6380
Epoch 84, accuracy: 0.6380
Epoch 84, Train Loss: 0.2763, Val Loss: 1.5335
Epoch 85, accuracy: 0.6380
Epoch 86, accuracy: 0.6380
Epoch 86, Train Loss: 0.2374, Val Loss: 1.5335
Epoch 87, accuracy: 0.6380
Epoch 88, accuracy: 0.6380
Epoch 88, Train Loss: 0.2331, Val Loss: 1.5335
Epoch 89, accuracy: 0.6380
Epoch 90, accuracy: 0.6380
Epoch 90, Train Loss: 0.3412, Val Loss: 1.5335
Epoch 91, accuracy: 0.6380
Epoch 92, accuracy: 0.6380
Epoch 92, Train Loss: 0.2748, Val Loss: 1.5335
Epoch 93, accuracy: 0.6380
Epoch 94, accuracy: 0.6380
Epoch 94, Train Loss: 0.2206, Val Loss: 1.5335
Epoch 95, accuracy: 0.6380
Epoch 96, accuracy: 0.6380
Epoch 96, Train Loss: 0.2417, Val Loss: 1.5335
Epoch 97, accuracy: 0.6380
Epoch 98, accuracy: 0.6380
Epoch 98, Train Loss: 0.2731, Val Loss: 1.5335
Epoch 99, accuracy: 0.6380
Epoch 100, accuracy: 0.6380
Epoch 100, Train Loss: 0.3047, Val Loss: 1.5335
Epoch 101, accuracy: 0.6380
Epoch 102, accuracy: 0.6380
Epoch 102, Train Loss: 0.2410, Val Loss: 1.5335
Epoch 103, accuracy: 0.6380
Epoch 104, accuracy: 0.6380
Epoch 104, Train Loss: 0.2244, Val Loss: 1.5335
Epoch 105, accuracy: 0.6380
Epoch 106, accuracy: 0.6380
Epoch 106, Train Loss: 0.2630, Val Loss: 1.5335
Epoch 107, accuracy: 0.6380
Epoch 108, accuracy: 0.6380
Epoch 108, Train Loss: 0.2827, Val Loss: 1.5335
Epoch 109, accuracy: 0.6380
Epoch 110, accuracy: 0.6380
Epoch 110, Train Loss: 0.2901, Val Loss: 1.5335
Epoch 111, accuracy: 0.6380
Epoch 112, accuracy: 0.6380
Epoch 112, Train Loss: 0.2795, Val Loss: 1.5335
Epoch 113, accuracy: 0.6380
Epoch 114, accuracy: 0.6380
Epoch 114, Train Loss: 0.2307, Val Loss: 1.5335
Epoch 115, accuracy: 0.6380
Epoch 116, accuracy: 0.6380
Epoch 116, Train Loss: 0.2780, Val Loss: 1.5335
Epoch 117, accuracy: 0.6380
Epoch 118, accuracy: 0.6380
Epoch 118, Train Loss: 0.2466, Val Loss: 1.5335
Epoch 119, accuracy: 0.6380
Epoch 120, accuracy: 0.6380
Epoch 120, Train Loss: 0.3184, Val Loss: 1.5335
Epoch 121, accuracy: 0.6380
Epoch 122, accuracy: 0.6380
Epoch 122, Train Loss: 0.2821, Val Loss: 1.5335
Epoch 123, accuracy: 0.6380
Epoch 124, accuracy: 0.6380
Epoch 124, Train Loss: 0.3137, Val Loss: 1.5335
Epoch 125, accuracy: 0.6380
Epoch 126, accuracy: 0.6380
Epoch 126, Train Loss: 0.3372, Val Loss: 1.5335
Epoch 127, accuracy: 0.6380
Epoch 128, accuracy: 0.6380
Epoch 128, Train Loss: 0.2775, Val Loss: 1.5335
Epoch 129, accuracy: 0.6380
Epoch 130, accuracy: 0.6380
Epoch 130, Train Loss: 0.2861, Val Loss: 1.5335
Epoch 131, accuracy: 0.6380
Epoch 132, accuracy: 0.6380
Epoch 132, Train Loss: 0.3016, Val Loss: 1.5335
Epoch 133, accuracy: 0.6380
Epoch 134, accuracy: 0.6380
Epoch 134, Train Loss: 0.3311, Val Loss: 1.5335
Epoch 135, accuracy: 0.6380
Epoch 136, accuracy: 0.6380
Epoch 136, Train Loss: 0.2548, Val Loss: 1.5335
Epoch 137, accuracy: 0.6380
Epoch 138, accuracy: 0.6380
Epoch 138, Train Loss: 0.2490, Val Loss: 1.5335
Epoch 139, accuracy: 0.6380
Epoch 140, accuracy: 0.6380
Epoch 140, Train Loss: 0.2773, Val Loss: 1.5335
Epoch 141, accuracy: 0.6380
Epoch 142, accuracy: 0.6380
Epoch 142, Train Loss: 0.2814, Val Loss: 1.5335
Epoch 143, accuracy: 0.6380
Epoch 144, accuracy: 0.6380
Epoch 144, Train Loss: 0.2644, Val Loss: 1.5335
Epoch 145, accuracy: 0.6380
Epoch 146, accuracy: 0.6380
Epoch 146, Train Loss: 0.3057, Val Loss: 1.5335
Epoch 147, accuracy: 0.6380
Epoch 148, accuracy: 0.6380
Epoch 148, Train Loss: 0.3244, Val Loss: 1.5335
Epoch 149, accuracy: 0.6380
Epoch 150, accuracy: 0.6380
Epoch 150, Train Loss: 0.2455, Val Loss: 1.5335
Epoch 151, accuracy: 0.6380
Epoch 152, accuracy: 0.6380
Epoch 152, Train Loss: 0.2292, Val Loss: 1.5335
Epoch 153, accuracy: 0.6380
Epoch 154, accuracy: 0.6380
Epoch 154, Train Loss: 0.2957, Val Loss: 1.5335
Epoch 155, accuracy: 0.6380
Epoch 156, accuracy: 0.6380
Epoch 156, Train Loss: 0.2711, Val Loss: 1.5335
Epoch 157, accuracy: 0.6380
Epoch 158, accuracy: 0.6380
Epoch 158, Train Loss: 0.3096, Val Loss: 1.5335
Epoch 159, accuracy: 0.6380
Epoch 160, accuracy: 0.6380
Epoch 160, Train Loss: 0.2227, Val Loss: 1.5335
Epoch 161, accuracy: 0.6380
Epoch 162, accuracy: 0.6380
Epoch 162, Train Loss: 0.3110, Val Loss: 1.5335
Epoch 163, accuracy: 0.6380
Epoch 164, accuracy: 0.6380
Epoch 164, Train Loss: 0.2466, Val Loss: 1.5335
Epoch 165, accuracy: 0.6380
Epoch 166, accuracy: 0.6380
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 166, Train Loss: 0.2324, Val Loss: 1.5335
Epoch 167, accuracy: 0.6380
Epoch 168, accuracy: 0.6380
Epoch 168, Train Loss: 0.2625, Val Loss: 1.5335
Epoch 169, accuracy: 0.6380
Epoch 170, accuracy: 0.6380
Epoch 170, Train Loss: 0.2667, Val Loss: 1.5335
Epoch 171, accuracy: 0.6380
Epoch 172, accuracy: 0.6380
Epoch 172, Train Loss: 0.3125, Val Loss: 1.5335
Epoch 173, accuracy: 0.6380
Epoch 174, accuracy: 0.6380
Epoch 174, Train Loss: 0.2850, Val Loss: 1.5335
Epoch 175, accuracy: 0.6380
Epoch 176, accuracy: 0.6380
Epoch 176, Train Loss: 0.2467, Val Loss: 1.5335
Epoch 177, accuracy: 0.6380
Epoch 178, accuracy: 0.6380
Epoch 178, Train Loss: 0.2825, Val Loss: 1.5335
Epoch 179, accuracy: 0.6380
Epoch 180, accuracy: 0.6380
Epoch 180, Train Loss: 0.2607, Val Loss: 1.5335
Epoch 181, accuracy: 0.6380
Epoch 182, accuracy: 0.6380
Epoch 182, Train Loss: 0.2830, Val Loss: 1.5335
Epoch 183, accuracy: 0.6380
Epoch 184, accuracy: 0.6380
Epoch 184, Train Loss: 0.3234, Val Loss: 1.5335
Epoch 185, accuracy: 0.6380
Epoch 186, accuracy: 0.6380
Epoch 186, Train Loss: 0.2227, Val Loss: 1.5335
Epoch 187, accuracy: 0.6380
Epoch 188, accuracy: 0.6380
Epoch 188, Train Loss: 0.2420, Val Loss: 1.5335
Epoch 189, accuracy: 0.6380
Epoch 190, accuracy: 0.6380
Epoch 190, Train Loss: 0.2997, Val Loss: 1.5335
Epoch 191, accuracy: 0.6380
Epoch 192, accuracy: 0.6380
Epoch 192, Train Loss: 0.2950, Val Loss: 1.5335
Epoch 193, accuracy: 0.6380
Epoch 194, accuracy: 0.6380
Epoch 194, Train Loss: 0.2862, Val Loss: 1.5335
Epoch 195, accuracy: 0.6380
Epoch 196, accuracy: 0.6380
Epoch 196, Train Loss: 0.2891, Val Loss: 1.5335
Epoch 197, accuracy: 0.6380
Epoch 198, accuracy: 0.6380
Epoch 198, Train Loss: 0.2295, Val Loss: 1.5335
Epoch 199, accuracy: 0.6380
Loaded best model with val_loss = 1.3034945726394653
test :accuracy 0.5690, f1_macro: 0.5357, f1_micro: 0.5690, auc: 0.8317
Training mamba3 with 4 layers...
可训练参数: 1651646_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.5379
Epoch 0, accuracy: 0.4010
Epoch 0, Train Loss: 1.8816, Val Loss: 1.5379
✅ Epoch 1: New best model saved with val_loss = 1.3422
Epoch 1, accuracy: 0.5690
✅ Epoch 2: New best model saved with val_loss = 1.2748
Epoch 2, accuracy: 0.5410
Epoch 2, Train Loss: 0.9885, Val Loss: 1.2748
✅ Epoch 3: New best model saved with val_loss = 1.1409
Epoch 3, accuracy: 0.6000
✅ Epoch 4: New best model saved with val_loss = 1.1337
Epoch 4, accuracy: 0.6220
Epoch 4, Train Loss: 0.7670, Val Loss: 1.1337
✅ Epoch 5: New best model saved with val_loss = 1.1102
Epoch 5, accuracy: 0.6570
Epoch 6, accuracy: 0.6690
Epoch 6, Train Loss: 0.4528, Val Loss: 1.1390
Epoch 7, accuracy: 0.6710
Epoch 8, accuracy: 0.6650
Epoch 8, Train Loss: 0.3801, Val Loss: 1.2106
Epoch 9, accuracy: 0.6510
Epoch 10, accuracy: 0.6680
Epoch 10, Train Loss: 0.2229, Val Loss: 1.3178
Epoch 11, accuracy: 0.6670
Epoch 12, accuracy: 0.6670
Epoch 12, Train Loss: 0.2808, Val Loss: 1.3457
Epoch 13, accuracy: 0.6690
Epoch 14, accuracy: 0.6690
Epoch 14, Train Loss: 0.2664, Val Loss: 1.3519
Epoch 15, accuracy: 0.6690
Epoch 16, accuracy: 0.6680
Epoch 16, Train Loss: 0.1897, Val Loss: 1.3596
Epoch 17, accuracy: 0.6680
Epoch 18, accuracy: 0.6680
Epoch 18, Train Loss: 0.1776, Val Loss: 1.3641
Epoch 19, accuracy: 0.6680
Epoch 20, accuracy: 0.6680
Epoch 20, Train Loss: 0.2309, Val Loss: 1.3648
Epoch 21, accuracy: 0.6690
Epoch 22, accuracy: 0.6680
Epoch 22, Train Loss: 0.2598, Val Loss: 1.3653
Epoch 23, accuracy: 0.6690
Epoch 24, accuracy: 0.6690
Epoch 24, Train Loss: 0.2425, Val Loss: 1.3656
Epoch 25, accuracy: 0.6690
Epoch 26, accuracy: 0.6690
Epoch 26, Train Loss: 0.1827, Val Loss: 1.3657
Epoch 27, accuracy: 0.6690
Epoch 28, accuracy: 0.6690
Epoch 28, Train Loss: 0.2018, Val Loss: 1.3657
Epoch 29, accuracy: 0.6690
Epoch 30, accuracy: 0.6690
Epoch 30, Train Loss: 0.2402, Val Loss: 1.3657
Epoch 31, accuracy: 0.6690
Epoch 32, accuracy: 0.6690
Epoch 32, Train Loss: 0.1756, Val Loss: 1.3657
Epoch 33, accuracy: 0.6690
Epoch 34, accuracy: 0.6690
Epoch 34, Train Loss: 0.2511, Val Loss: 1.3657
Epoch 35, accuracy: 0.6690
Epoch 36, accuracy: 0.6690
Epoch 36, Train Loss: 0.1902, Val Loss: 1.3657
Epoch 37, accuracy: 0.6690
Epoch 38, accuracy: 0.6690
Epoch 38, Train Loss: 0.1970, Val Loss: 1.3657
Epoch 39, accuracy: 0.6690
Epoch 40, accuracy: 0.6690
Epoch 40, Train Loss: 0.2040, Val Loss: 1.3657
Epoch 41, accuracy: 0.6690
Epoch 42, accuracy: 0.6690
Epoch 42, Train Loss: 0.1982, Val Loss: 1.3657
Epoch 43, accuracy: 0.6690
Epoch 44, accuracy: 0.6690
Epoch 44, Train Loss: 0.1857, Val Loss: 1.3657
Epoch 45, accuracy: 0.6690
Epoch 46, accuracy: 0.6690
Epoch 46, Train Loss: 0.2134, Val Loss: 1.3657
Epoch 47, accuracy: 0.6690
Epoch 48, accuracy: 0.6690
Epoch 48, Train Loss: 0.1823, Val Loss: 1.3657
Epoch 49, accuracy: 0.6690
Epoch 50, accuracy: 0.6690
Epoch 50, Train Loss: 0.2128, Val Loss: 1.3657
Epoch 51, accuracy: 0.6690
Epoch 52, accuracy: 0.6690
Epoch 52, Train Loss: 0.1607, Val Loss: 1.3657
Epoch 53, accuracy: 0.6690
Epoch 54, accuracy: 0.6690
Epoch 54, Train Loss: 0.1801, Val Loss: 1.3657
Epoch 55, accuracy: 0.6690
Epoch 56, accuracy: 0.6690
Epoch 56, Train Loss: 0.1773, Val Loss: 1.3657
Epoch 57, accuracy: 0.6690
Epoch 58, accuracy: 0.6690
Epoch 58, Train Loss: 0.2127, Val Loss: 1.3657
Epoch 59, accuracy: 0.6690
Epoch 60, accuracy: 0.6690
Epoch 60, Train Loss: 0.2473, Val Loss: 1.3657
Epoch 61, accuracy: 0.6690
Epoch 62, accuracy: 0.6690
Epoch 62, Train Loss: 0.1706, Val Loss: 1.3657
Epoch 63, accuracy: 0.6690
Epoch 64, accuracy: 0.6690
Epoch 64, Train Loss: 0.1614, Val Loss: 1.3657
Epoch 65, accuracy: 0.6690
Epoch 66, accuracy: 0.6690
Epoch 66, Train Loss: 0.1790, Val Loss: 1.3657
Epoch 67, accuracy: 0.6690
Epoch 68, accuracy: 0.6690
Epoch 68, Train Loss: 0.1772, Val Loss: 1.3657
Epoch 69, accuracy: 0.6690
Epoch 70, accuracy: 0.6690
Epoch 70, Train Loss: 0.1593, Val Loss: 1.3657
Epoch 71, accuracy: 0.6690
Epoch 72, accuracy: 0.6690
Epoch 72, Train Loss: 0.1483, Val Loss: 1.3657
Epoch 73, accuracy: 0.6690
Epoch 74, accuracy: 0.6690
Epoch 74, Train Loss: 0.1629, Val Loss: 1.3657
Epoch 75, accuracy: 0.6690
Epoch 76, accuracy: 0.6690
Epoch 76, Train Loss: 0.2154, Val Loss: 1.3657
Epoch 77, accuracy: 0.6690
Epoch 78, accuracy: 0.6690
Epoch 78, Train Loss: 0.2855, Val Loss: 1.3657
Epoch 79, accuracy: 0.6690
Epoch 80, accuracy: 0.6690
Epoch 80, Train Loss: 0.1627, Val Loss: 1.3657
Epoch 81, accuracy: 0.6690
Epoch 82, accuracy: 0.6690
Epoch 82, Train Loss: 0.1858, Val Loss: 1.3657
Epoch 83, accuracy: 0.6690
Epoch 84, accuracy: 0.6690
Epoch 84, Train Loss: 0.1641, Val Loss: 1.3657
Epoch 85, accuracy: 0.6690
Epoch 86, accuracy: 0.6690
Epoch 86, Train Loss: 0.1415, Val Loss: 1.3657
Epoch 87, accuracy: 0.6690
Epoch 88, accuracy: 0.6690
Epoch 88, Train Loss: 0.1987, Val Loss: 1.3657
Epoch 89, accuracy: 0.6690
Epoch 90, accuracy: 0.6690
Epoch 90, Train Loss: 0.1121, Val Loss: 1.3657
Epoch 91, accuracy: 0.6690
Epoch 92, accuracy: 0.6690
Epoch 92, Train Loss: 0.1520, Val Loss: 1.3657
Epoch 93, accuracy: 0.6690
Epoch 94, accuracy: 0.6690
Epoch 94, Train Loss: 0.1633, Val Loss: 1.3657
Epoch 95, accuracy: 0.6690
Epoch 96, accuracy: 0.6690
Epoch 96, Train Loss: 0.1947, Val Loss: 1.3657
Epoch 97, accuracy: 0.6690
Epoch 98, accuracy: 0.6690
Epoch 98, Train Loss: 0.2187, Val Loss: 1.3657
Epoch 99, accuracy: 0.6690
Epoch 100, accuracy: 0.6690
Epoch 100, Train Loss: 0.1607, Val Loss: 1.3657
Epoch 101, accuracy: 0.6690
Epoch 102, accuracy: 0.6690
Epoch 102, Train Loss: 0.2001, Val Loss: 1.3657
Epoch 103, accuracy: 0.6690
Epoch 104, accuracy: 0.6690
Epoch 104, Train Loss: 0.2170, Val Loss: 1.3657
Epoch 105, accuracy: 0.6690
Epoch 106, accuracy: 0.6690
Epoch 106, Train Loss: 0.1858, Val Loss: 1.3657
Epoch 107, accuracy: 0.6690
Epoch 108, accuracy: 0.6690
Epoch 108, Train Loss: 0.2597, Val Loss: 1.3657
Epoch 109, accuracy: 0.6690
Epoch 110, accuracy: 0.6690
Epoch 110, Train Loss: 0.1599, Val Loss: 1.3657
Epoch 111, accuracy: 0.6690
Epoch 112, accuracy: 0.6690
Epoch 112, Train Loss: 0.2237, Val Loss: 1.3657
Epoch 113, accuracy: 0.6690
Epoch 114, accuracy: 0.6690
Epoch 114, Train Loss: 0.1495, Val Loss: 1.3657
Epoch 115, accuracy: 0.6690
Epoch 116, accuracy: 0.6690
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 116, Train Loss: 0.2362, Val Loss: 1.3657
Epoch 117, accuracy: 0.6690
Epoch 118, accuracy: 0.6690
Epoch 118, Train Loss: 0.1890, Val Loss: 1.3657
Epoch 119, accuracy: 0.6690
Epoch 120, accuracy: 0.6690
Epoch 120, Train Loss: 0.2039, Val Loss: 1.3657
Epoch 121, accuracy: 0.6690
Epoch 122, accuracy: 0.6690
Epoch 122, Train Loss: 0.2076, Val Loss: 1.3657
Epoch 123, accuracy: 0.6690
Epoch 124, accuracy: 0.6690
Epoch 124, Train Loss: 0.2519, Val Loss: 1.3657
Epoch 125, accuracy: 0.6690
Epoch 126, accuracy: 0.6690
Epoch 126, Train Loss: 0.1631, Val Loss: 1.3657
Epoch 127, accuracy: 0.6690
Epoch 128, accuracy: 0.6690
Epoch 128, Train Loss: 0.2554, Val Loss: 1.3657
Epoch 129, accuracy: 0.6690
Epoch 130, accuracy: 0.6690
Epoch 130, Train Loss: 0.2174, Val Loss: 1.3657
Epoch 131, accuracy: 0.6690
Epoch 132, accuracy: 0.6690
Epoch 132, Train Loss: 0.1945, Val Loss: 1.3657
Epoch 133, accuracy: 0.6690
Epoch 134, accuracy: 0.6690
Epoch 134, Train Loss: 0.2933, Val Loss: 1.3657
Epoch 135, accuracy: 0.6690
Epoch 136, accuracy: 0.6690
Epoch 136, Train Loss: 0.2313, Val Loss: 1.3657
Epoch 137, accuracy: 0.6690
Epoch 138, accuracy: 0.6690
Epoch 138, Train Loss: 0.2699, Val Loss: 1.3657
Epoch 139, accuracy: 0.6690
Epoch 140, accuracy: 0.6690
Epoch 140, Train Loss: 0.1441, Val Loss: 1.3657
Epoch 141, accuracy: 0.6690
Epoch 142, accuracy: 0.6690
Epoch 142, Train Loss: 0.1824, Val Loss: 1.3657
Epoch 143, accuracy: 0.6690
Epoch 144, accuracy: 0.6690
Epoch 144, Train Loss: 0.2280, Val Loss: 1.3657
Epoch 145, accuracy: 0.6690
Epoch 146, accuracy: 0.6690
Epoch 146, Train Loss: 0.2105, Val Loss: 1.3657
Epoch 147, accuracy: 0.6690
Epoch 148, accuracy: 0.6690
Epoch 148, Train Loss: 0.1935, Val Loss: 1.3657
Epoch 149, accuracy: 0.6690
Epoch 150, accuracy: 0.6690
Epoch 150, Train Loss: 0.1837, Val Loss: 1.3657
Epoch 151, accuracy: 0.6690
Epoch 152, accuracy: 0.6690
Epoch 152, Train Loss: 0.1325, Val Loss: 1.3657
Epoch 153, accuracy: 0.6690
Epoch 154, accuracy: 0.6690
Epoch 154, Train Loss: 0.1715, Val Loss: 1.3657
Epoch 155, accuracy: 0.6690
Epoch 156, accuracy: 0.6690
Epoch 156, Train Loss: 0.1502, Val Loss: 1.3657
Epoch 157, accuracy: 0.6690
Epoch 158, accuracy: 0.6690
Epoch 158, Train Loss: 0.2295, Val Loss: 1.3657
Epoch 159, accuracy: 0.6690
Epoch 160, accuracy: 0.6690
Epoch 160, Train Loss: 0.2079, Val Loss: 1.3657
Epoch 161, accuracy: 0.6690
Epoch 162, accuracy: 0.6690
Epoch 162, Train Loss: 0.2600, Val Loss: 1.3657
Epoch 163, accuracy: 0.6690
Epoch 164, accuracy: 0.6690
Epoch 164, Train Loss: 0.2511, Val Loss: 1.3657
Epoch 165, accuracy: 0.6690
Epoch 166, accuracy: 0.6690
Epoch 166, Train Loss: 0.1717, Val Loss: 1.3657
Epoch 167, accuracy: 0.6690
Epoch 168, accuracy: 0.6690
Epoch 168, Train Loss: 0.2013, Val Loss: 1.3657
Epoch 169, accuracy: 0.6690
Epoch 170, accuracy: 0.6690
Epoch 170, Train Loss: 0.1826, Val Loss: 1.3657
Epoch 171, accuracy: 0.6690
Epoch 172, accuracy: 0.6690
Epoch 172, Train Loss: 0.1825, Val Loss: 1.3657
Epoch 173, accuracy: 0.6690
Epoch 174, accuracy: 0.6690
Epoch 174, Train Loss: 0.1264, Val Loss: 1.3657
Epoch 175, accuracy: 0.6690
Epoch 176, accuracy: 0.6690
Epoch 176, Train Loss: 0.1960, Val Loss: 1.3657
Epoch 177, accuracy: 0.6690
Epoch 178, accuracy: 0.6690
Epoch 178, Train Loss: 0.2126, Val Loss: 1.3657
Epoch 179, accuracy: 0.6690
Epoch 180, accuracy: 0.6690
Epoch 180, Train Loss: 0.2304, Val Loss: 1.3657
Epoch 181, accuracy: 0.6690
Epoch 182, accuracy: 0.6690
Epoch 182, Train Loss: 0.2592, Val Loss: 1.3657
Epoch 183, accuracy: 0.6690
Epoch 184, accuracy: 0.6690
Epoch 184, Train Loss: 0.2316, Val Loss: 1.3657
Epoch 185, accuracy: 0.6690
Epoch 186, accuracy: 0.6690
Epoch 186, Train Loss: 0.1909, Val Loss: 1.3657
Epoch 187, accuracy: 0.6690
Epoch 188, accuracy: 0.6690
Epoch 188, Train Loss: 0.1069, Val Loss: 1.3657
Epoch 189, accuracy: 0.6690
Epoch 190, accuracy: 0.6690
Epoch 190, Train Loss: 0.1884, Val Loss: 1.3657
Epoch 191, accuracy: 0.6690
Epoch 192, accuracy: 0.6690
Epoch 192, Train Loss: 0.1940, Val Loss: 1.3657
Epoch 193, accuracy: 0.6690
Epoch 194, accuracy: 0.6690
Epoch 194, Train Loss: 0.2647, Val Loss: 1.3657
Epoch 195, accuracy: 0.6690
Epoch 196, accuracy: 0.6690
Epoch 196, Train Loss: 0.2378, Val Loss: 1.3657
Epoch 197, accuracy: 0.6690
Epoch 198, accuracy: 0.6690
Epoch 198, Train Loss: 0.2208, Val Loss: 1.3657
Epoch 199, accuracy: 0.6690
Loaded best model with val_loss = 1.1101711988449097
test :accuracy 0.6570, f1_macro: 0.6097, f1_micro: 0.6570, auc: 0.8625
Training mamba3 with 5 layers...
可训练参数: 1734590_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.6564
Epoch 0, accuracy: 0.4060
Epoch 0, Train Loss: 1.8497, Val Loss: 1.6564
Epoch 1, accuracy: 0.2620
✅ Epoch 2: New best model saved with val_loss = 1.2088
Epoch 2, accuracy: 0.6010
Epoch 2, Train Loss: 1.1999, Val Loss: 1.2088
✅ Epoch 3: New best model saved with val_loss = 1.0547
Epoch 3, accuracy: 0.6380
✅ Epoch 4: New best model saved with val_loss = 1.0054
Epoch 4, accuracy: 0.6150
Epoch 4, Train Loss: 0.7876, Val Loss: 1.0054
✅ Epoch 5: New best model saved with val_loss = 0.9846
Epoch 5, accuracy: 0.6420
Epoch 6, accuracy: 0.6680
Epoch 6, Train Loss: 0.5231, Val Loss: 1.0473
Epoch 7, accuracy: 0.6590
Epoch 8, accuracy: 0.6400
Epoch 8, Train Loss: 0.4433, Val Loss: 1.2901
Epoch 9, accuracy: 0.6350
Epoch 10, accuracy: 0.6590
Epoch 10, Train Loss: 0.4208, Val Loss: 1.4216
Epoch 11, accuracy: 0.6470
Epoch 12, accuracy: 0.6470
Epoch 12, Train Loss: 0.2554, Val Loss: 1.3199
Epoch 13, accuracy: 0.6450
Epoch 14, accuracy: 0.6430
Epoch 14, Train Loss: 0.3371, Val Loss: 1.3121
Epoch 15, accuracy: 0.6460
Epoch 16, accuracy: 0.6470
Epoch 16, Train Loss: 0.2540, Val Loss: 1.3009
Epoch 17, accuracy: 0.6490
Epoch 18, accuracy: 0.6490
Epoch 18, Train Loss: 0.2411, Val Loss: 1.2968
Epoch 19, accuracy: 0.6490
Epoch 20, accuracy: 0.6490
Epoch 20, Train Loss: 0.3078, Val Loss: 1.2963
Epoch 21, accuracy: 0.6500
Epoch 22, accuracy: 0.6480
Epoch 22, Train Loss: 0.2515, Val Loss: 1.2961
Epoch 23, accuracy: 0.6470
Epoch 24, accuracy: 0.6470
Epoch 24, Train Loss: 0.2621, Val Loss: 1.2964
Epoch 25, accuracy: 0.6470
Epoch 26, accuracy: 0.6470
Epoch 26, Train Loss: 0.2755, Val Loss: 1.2965
Epoch 27, accuracy: 0.6470
Epoch 28, accuracy: 0.6470
Epoch 28, Train Loss: 0.2883, Val Loss: 1.2966
Epoch 29, accuracy: 0.6470
Epoch 30, accuracy: 0.6470
Epoch 30, Train Loss: 0.2720, Val Loss: 1.2967
Epoch 31, accuracy: 0.6470
Epoch 32, accuracy: 0.6470
Epoch 32, Train Loss: 0.3241, Val Loss: 1.2967
Epoch 33, accuracy: 0.6470
Epoch 34, accuracy: 0.6470
Epoch 34, Train Loss: 0.2777, Val Loss: 1.2967
Epoch 35, accuracy: 0.6470
Epoch 36, accuracy: 0.6470
Epoch 36, Train Loss: 0.2491, Val Loss: 1.2968
Epoch 37, accuracy: 0.6470
Epoch 38, accuracy: 0.6470
Epoch 38, Train Loss: 0.3078, Val Loss: 1.2968
Epoch 39, accuracy: 0.6470
Epoch 40, accuracy: 0.6470
Epoch 40, Train Loss: 0.3661, Val Loss: 1.2968
Epoch 41, accuracy: 0.6470
Epoch 42, accuracy: 0.6470
Epoch 42, Train Loss: 0.2845, Val Loss: 1.2968
Epoch 43, accuracy: 0.6470
Epoch 44, accuracy: 0.6470
Epoch 44, Train Loss: 0.2565, Val Loss: 1.2968
Epoch 45, accuracy: 0.6470
Epoch 46, accuracy: 0.6470
Epoch 46, Train Loss: 0.2033, Val Loss: 1.2968
Epoch 47, accuracy: 0.6470
Epoch 48, accuracy: 0.6470
Epoch 48, Train Loss: 0.2169, Val Loss: 1.2968
Epoch 49, accuracy: 0.6470
Epoch 50, accuracy: 0.6470
Epoch 50, Train Loss: 0.2523, Val Loss: 1.2968
Epoch 51, accuracy: 0.6470
Epoch 52, accuracy: 0.6470
Epoch 52, Train Loss: 0.3026, Val Loss: 1.2968
Epoch 53, accuracy: 0.6470
Epoch 54, accuracy: 0.6470
Epoch 54, Train Loss: 0.1992, Val Loss: 1.2968
Epoch 55, accuracy: 0.6470
Epoch 56, accuracy: 0.6470
Epoch 56, Train Loss: 0.2956, Val Loss: 1.2968
Epoch 57, accuracy: 0.6470
Epoch 58, accuracy: 0.6470
Epoch 58, Train Loss: 0.3033, Val Loss: 1.2968
Epoch 59, accuracy: 0.6470
Epoch 60, accuracy: 0.6470
Epoch 60, Train Loss: 0.2180, Val Loss: 1.2968
Epoch 61, accuracy: 0.6470
Epoch 62, accuracy: 0.6470
Epoch 62, Train Loss: 0.1679, Val Loss: 1.2968
Epoch 63, accuracy: 0.6470
Epoch 64, accuracy: 0.6470
Epoch 64, Train Loss: 0.2786, Val Loss: 1.2968
Epoch 65, accuracy: 0.6470
Epoch 66, accuracy: 0.6470
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 66, Train Loss: 0.2883, Val Loss: 1.2968
Epoch 67, accuracy: 0.6470
Epoch 68, accuracy: 0.6470
Epoch 68, Train Loss: 0.2312, Val Loss: 1.2968
Epoch 69, accuracy: 0.6470
Epoch 70, accuracy: 0.6470
Epoch 70, Train Loss: 0.2627, Val Loss: 1.2968
Epoch 71, accuracy: 0.6470
Epoch 72, accuracy: 0.6470
Epoch 72, Train Loss: 0.2755, Val Loss: 1.2968
Epoch 73, accuracy: 0.6470
Epoch 74, accuracy: 0.6470
Epoch 74, Train Loss: 0.3281, Val Loss: 1.2968
Epoch 75, accuracy: 0.6470
Epoch 76, accuracy: 0.6470
Epoch 76, Train Loss: 0.2093, Val Loss: 1.2968
Epoch 77, accuracy: 0.6470
Epoch 78, accuracy: 0.6470
Epoch 78, Train Loss: 0.3039, Val Loss: 1.2968
Epoch 79, accuracy: 0.6470
Epoch 80, accuracy: 0.6470
Epoch 80, Train Loss: 0.3710, Val Loss: 1.2968
Epoch 81, accuracy: 0.6470
Epoch 82, accuracy: 0.6470
Epoch 82, Train Loss: 0.1988, Val Loss: 1.2968
Epoch 83, accuracy: 0.6470
Epoch 84, accuracy: 0.6470
Epoch 84, Train Loss: 0.2523, Val Loss: 1.2968
Epoch 85, accuracy: 0.6470
Epoch 86, accuracy: 0.6470
Epoch 86, Train Loss: 0.1955, Val Loss: 1.2968
Epoch 87, accuracy: 0.6470
Epoch 88, accuracy: 0.6470
Epoch 88, Train Loss: 0.2499, Val Loss: 1.2968
Epoch 89, accuracy: 0.6470
Epoch 90, accuracy: 0.6470
Epoch 90, Train Loss: 0.2707, Val Loss: 1.2968
Epoch 91, accuracy: 0.6470
Epoch 92, accuracy: 0.6470
Epoch 92, Train Loss: 0.1952, Val Loss: 1.2968
Epoch 93, accuracy: 0.6470
Epoch 94, accuracy: 0.6470
Epoch 94, Train Loss: 0.2790, Val Loss: 1.2968
Epoch 95, accuracy: 0.6470
Epoch 96, accuracy: 0.6470
Epoch 96, Train Loss: 0.2418, Val Loss: 1.2968
Epoch 97, accuracy: 0.6470
Epoch 98, accuracy: 0.6470
Epoch 98, Train Loss: 0.2666, Val Loss: 1.2968
Epoch 99, accuracy: 0.6470
Epoch 100, accuracy: 0.6470
Epoch 100, Train Loss: 0.2157, Val Loss: 1.2968
Epoch 101, accuracy: 0.6470
Epoch 102, accuracy: 0.6470
Epoch 102, Train Loss: 0.3037, Val Loss: 1.2968
Epoch 103, accuracy: 0.6470
Epoch 104, accuracy: 0.6470
Epoch 104, Train Loss: 0.2673, Val Loss: 1.2968
Epoch 105, accuracy: 0.6470
Epoch 106, accuracy: 0.6470
Epoch 106, Train Loss: 0.2506, Val Loss: 1.2968
Epoch 107, accuracy: 0.6470
Epoch 108, accuracy: 0.6470
Epoch 108, Train Loss: 0.2521, Val Loss: 1.2968
Epoch 109, accuracy: 0.6470
Epoch 110, accuracy: 0.6470
Epoch 110, Train Loss: 0.2835, Val Loss: 1.2968
Epoch 111, accuracy: 0.6470
Epoch 112, accuracy: 0.6470
Epoch 112, Train Loss: 0.2474, Val Loss: 1.2968
Epoch 113, accuracy: 0.6470
Epoch 114, accuracy: 0.6470
Epoch 114, Train Loss: 0.2159, Val Loss: 1.2968
Epoch 115, accuracy: 0.6470
Epoch 116, accuracy: 0.6470
Epoch 116, Train Loss: 0.3151, Val Loss: 1.2968
Epoch 117, accuracy: 0.6470
Epoch 118, accuracy: 0.6470
Epoch 118, Train Loss: 0.2281, Val Loss: 1.2968
Epoch 119, accuracy: 0.6470
Epoch 120, accuracy: 0.6470
Epoch 120, Train Loss: 0.3080, Val Loss: 1.2968
Epoch 121, accuracy: 0.6470
Epoch 122, accuracy: 0.6470
Epoch 122, Train Loss: 0.2523, Val Loss: 1.2968
Epoch 123, accuracy: 0.6470
Epoch 124, accuracy: 0.6470
Epoch 124, Train Loss: 0.2622, Val Loss: 1.2968
Epoch 125, accuracy: 0.6470
Epoch 126, accuracy: 0.6470
Epoch 126, Train Loss: 0.2695, Val Loss: 1.2968
Epoch 127, accuracy: 0.6470
Epoch 128, accuracy: 0.6470
Epoch 128, Train Loss: 0.2845, Val Loss: 1.2968
Epoch 129, accuracy: 0.6470
Epoch 130, accuracy: 0.6470
Epoch 130, Train Loss: 0.2367, Val Loss: 1.2968
Epoch 131, accuracy: 0.6470
Epoch 132, accuracy: 0.6470
Epoch 132, Train Loss: 0.2444, Val Loss: 1.2968
Epoch 133, accuracy: 0.6470
Epoch 134, accuracy: 0.6470
Epoch 134, Train Loss: 0.1999, Val Loss: 1.2968
Epoch 135, accuracy: 0.6470
Epoch 136, accuracy: 0.6470
Epoch 136, Train Loss: 0.2202, Val Loss: 1.2968
Epoch 137, accuracy: 0.6470
Epoch 138, accuracy: 0.6470
Epoch 138, Train Loss: 0.2740, Val Loss: 1.2968
Epoch 139, accuracy: 0.6470
Epoch 140, accuracy: 0.6470
Epoch 140, Train Loss: 0.2442, Val Loss: 1.2968
Epoch 141, accuracy: 0.6470
Epoch 142, accuracy: 0.6470
Epoch 142, Train Loss: 0.1870, Val Loss: 1.2968
Epoch 143, accuracy: 0.6470
Epoch 144, accuracy: 0.6470
Epoch 144, Train Loss: 0.2456, Val Loss: 1.2968
Epoch 145, accuracy: 0.6470
Epoch 146, accuracy: 0.6470
Epoch 146, Train Loss: 0.2394, Val Loss: 1.2968
Epoch 147, accuracy: 0.6470
Epoch 148, accuracy: 0.6470
Epoch 148, Train Loss: 0.2639, Val Loss: 1.2968
Epoch 149, accuracy: 0.6470
Epoch 150, accuracy: 0.6470
Epoch 150, Train Loss: 0.3146, Val Loss: 1.2968
Epoch 151, accuracy: 0.6470
Epoch 152, accuracy: 0.6470
Epoch 152, Train Loss: 0.3297, Val Loss: 1.2968
Epoch 153, accuracy: 0.6470
Epoch 154, accuracy: 0.6470
Epoch 154, Train Loss: 0.2724, Val Loss: 1.2968
Epoch 155, accuracy: 0.6470
Epoch 156, accuracy: 0.6470
Epoch 156, Train Loss: 0.3122, Val Loss: 1.2968
Epoch 157, accuracy: 0.6470
Epoch 158, accuracy: 0.6470
Epoch 158, Train Loss: 0.1919, Val Loss: 1.2968
Epoch 159, accuracy: 0.6470
Epoch 160, accuracy: 0.6470
Epoch 160, Train Loss: 0.2539, Val Loss: 1.2968
Epoch 161, accuracy: 0.6470
Epoch 162, accuracy: 0.6470
Epoch 162, Train Loss: 0.2196, Val Loss: 1.2968
Epoch 163, accuracy: 0.6470
Epoch 164, accuracy: 0.6470
Epoch 164, Train Loss: 0.1842, Val Loss: 1.2968
Epoch 165, accuracy: 0.6470
Epoch 166, accuracy: 0.6470
Epoch 166, Train Loss: 0.2410, Val Loss: 1.2968
Epoch 167, accuracy: 0.6470
Epoch 168, accuracy: 0.6470
Epoch 168, Train Loss: 0.2848, Val Loss: 1.2968
Epoch 169, accuracy: 0.6470
Epoch 170, accuracy: 0.6470
Epoch 170, Train Loss: 0.2476, Val Loss: 1.2968
Epoch 171, accuracy: 0.6470
Epoch 172, accuracy: 0.6470
Epoch 172, Train Loss: 0.2161, Val Loss: 1.2968
Epoch 173, accuracy: 0.6470
Epoch 174, accuracy: 0.6470
Epoch 174, Train Loss: 0.1957, Val Loss: 1.2968
Epoch 175, accuracy: 0.6470
Epoch 176, accuracy: 0.6470
Epoch 176, Train Loss: 0.3115, Val Loss: 1.2968
Epoch 177, accuracy: 0.6470
Epoch 178, accuracy: 0.6470
Epoch 178, Train Loss: 0.2725, Val Loss: 1.2968
Epoch 179, accuracy: 0.6470
Epoch 180, accuracy: 0.6470
Epoch 180, Train Loss: 0.2307, Val Loss: 1.2968
Epoch 181, accuracy: 0.6470
Epoch 182, accuracy: 0.6470
Epoch 182, Train Loss: 0.3099, Val Loss: 1.2968
Epoch 183, accuracy: 0.6470
Epoch 184, accuracy: 0.6470
Epoch 184, Train Loss: 0.2846, Val Loss: 1.2968
Epoch 185, accuracy: 0.6470
Epoch 186, accuracy: 0.6470
Epoch 186, Train Loss: 0.1682, Val Loss: 1.2968
Epoch 187, accuracy: 0.6470
Epoch 188, accuracy: 0.6470
Epoch 188, Train Loss: 0.2553, Val Loss: 1.2968
Epoch 189, accuracy: 0.6470
Epoch 190, accuracy: 0.6470
Epoch 190, Train Loss: 0.2782, Val Loss: 1.2968
Epoch 191, accuracy: 0.6470
Epoch 192, accuracy: 0.6470
Epoch 192, Train Loss: 0.2526, Val Loss: 1.2968
Epoch 193, accuracy: 0.6470
Epoch 194, accuracy: 0.6470
Epoch 194, Train Loss: 0.2401, Val Loss: 1.2968
Epoch 195, accuracy: 0.6470
Epoch 196, accuracy: 0.6470
Epoch 196, Train Loss: 0.3292, Val Loss: 1.2968
Epoch 197, accuracy: 0.6470
Epoch 198, accuracy: 0.6470
Epoch 198, Train Loss: 0.2720, Val Loss: 1.2968
Epoch 199, accuracy: 0.6470
Loaded best model with val_loss = 0.9845825433731079
test :accuracy 0.6420, f1_macro: 0.6118, f1_micro: 0.6420, auc: 0.8834
Training mamba3 with 6 layers...
可训练参数: 1817534_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.4611
Epoch 0, accuracy: 0.4220
Epoch 0, Train Loss: 1.8962, Val Loss: 1.4611
Epoch 1, accuracy: 0.4580
✅ Epoch 2: New best model saved with val_loss = 1.3631
Epoch 2, accuracy: 0.5020
Epoch 2, Train Loss: 1.1643, Val Loss: 1.3631
✅ Epoch 3: New best model saved with val_loss = 1.1807
Epoch 3, accuracy: 0.5510
✅ Epoch 4: New best model saved with val_loss = 1.1058
Epoch 4, accuracy: 0.5400
Epoch 4, Train Loss: 0.7343, Val Loss: 1.1058
✅ Epoch 5: New best model saved with val_loss = 0.9931
Epoch 5, accuracy: 0.6650
Epoch 6, accuracy: 0.6740
Epoch 6, Train Loss: 0.5744, Val Loss: 1.0127
Epoch 7, accuracy: 0.6090
Epoch 8, accuracy: 0.5900
Epoch 8, Train Loss: 0.4415, Val Loss: 1.2333
Epoch 9, accuracy: 0.5980
Epoch 10, accuracy: 0.6180
Epoch 10, Train Loss: 0.4201, Val Loss: 1.2711
Epoch 11, accuracy: 0.6170
Epoch 12, accuracy: 0.6160
Epoch 12, Train Loss: 0.2883, Val Loss: 1.3442
Epoch 13, accuracy: 0.6200
Epoch 14, accuracy: 0.6190
Epoch 14, Train Loss: 0.3886, Val Loss: 1.3481
Epoch 15, accuracy: 0.6240
Epoch 16, accuracy: 0.6260
Epoch 16, Train Loss: 0.3381, Val Loss: 1.3456
Epoch 17, accuracy: 0.6230
Epoch 18, accuracy: 0.6230
Epoch 18, Train Loss: 0.3208, Val Loss: 1.3444
Epoch 19, accuracy: 0.6230
Epoch 20, accuracy: 0.6250
Epoch 20, Train Loss: 0.2630, Val Loss: 1.3440
Epoch 21, accuracy: 0.6260
Epoch 22, accuracy: 0.6260
Epoch 22, Train Loss: 0.2839, Val Loss: 1.3435
Epoch 23, accuracy: 0.6270
Epoch 24, accuracy: 0.6270
Epoch 24, Train Loss: 0.3041, Val Loss: 1.3431
Epoch 25, accuracy: 0.6270
Epoch 26, accuracy: 0.6270
Epoch 26, Train Loss: 0.3174, Val Loss: 1.3429
Epoch 27, accuracy: 0.6270
Epoch 28, accuracy: 0.6270
Epoch 28, Train Loss: 0.2144, Val Loss: 1.3428
Epoch 29, accuracy: 0.6270
Epoch 30, accuracy: 0.6270
Epoch 30, Train Loss: 0.3968, Val Loss: 1.3427
Epoch 31, accuracy: 0.6270
Epoch 32, accuracy: 0.6270
Epoch 32, Train Loss: 0.3181, Val Loss: 1.3427
Epoch 33, accuracy: 0.6270
Epoch 34, accuracy: 0.6270
Epoch 34, Train Loss: 0.2648, Val Loss: 1.3427
Epoch 35, accuracy: 0.6270
Epoch 36, accuracy: 0.6270
Epoch 36, Train Loss: 0.3130, Val Loss: 1.3427
Epoch 37, accuracy: 0.6270
Epoch 38, accuracy: 0.6270
Epoch 38, Train Loss: 0.2879, Val Loss: 1.3427
Epoch 39, accuracy: 0.6270
Epoch 40, accuracy: 0.6270
Epoch 40, Train Loss: 0.2954, Val Loss: 1.3427
Epoch 41, accuracy: 0.6270
Epoch 42, accuracy: 0.6270
Epoch 42, Train Loss: 0.2724, Val Loss: 1.3427
Epoch 43, accuracy: 0.6270
Epoch 44, accuracy: 0.6270
Epoch 44, Train Loss: 0.2454, Val Loss: 1.3427
Epoch 45, accuracy: 0.6270
Epoch 46, accuracy: 0.6270
Epoch 46, Train Loss: 0.3012, Val Loss: 1.3427
Epoch 47, accuracy: 0.6270
Epoch 48, accuracy: 0.6270
Epoch 48, Train Loss: 0.2807, Val Loss: 1.3427
Epoch 49, accuracy: 0.6270
Epoch 50, accuracy: 0.6270
Epoch 50, Train Loss: 0.3073, Val Loss: 1.3427
Epoch 51, accuracy: 0.6270
Epoch 52, accuracy: 0.6270
Epoch 52, Train Loss: 0.2315, Val Loss: 1.3427
Epoch 53, accuracy: 0.6270
Epoch 54, accuracy: 0.6270
Epoch 54, Train Loss: 0.3553, Val Loss: 1.3427
Epoch 55, accuracy: 0.6270
Epoch 56, accuracy: 0.6270
Epoch 56, Train Loss: 0.2765, Val Loss: 1.3427
Epoch 57, accuracy: 0.6270
Epoch 58, accuracy: 0.6270
Epoch 58, Train Loss: 0.2955, Val Loss: 1.3427
Epoch 59, accuracy: 0.6270
Epoch 60, accuracy: 0.6270
Epoch 60, Train Loss: 0.2723, Val Loss: 1.3427
Epoch 61, accuracy: 0.6270
Epoch 62, accuracy: 0.6270
Epoch 62, Train Loss: 0.3907, Val Loss: 1.3427
Epoch 63, accuracy: 0.6270
Epoch 64, accuracy: 0.6270
Epoch 64, Train Loss: 0.2415, Val Loss: 1.3427
Epoch 65, accuracy: 0.6270
Epoch 66, accuracy: 0.6270
Epoch 66, Train Loss: 0.3852, Val Loss: 1.3427
Epoch 67, accuracy: 0.6270
Epoch 68, accuracy: 0.6270
Epoch 68, Train Loss: 0.4119, Val Loss: 1.3427
Epoch 69, accuracy: 0.6270
Epoch 70, accuracy: 0.6270
Epoch 70, Train Loss: 0.2786, Val Loss: 1.3427
Epoch 71, accuracy: 0.6270
Epoch 72, accuracy: 0.6270
Epoch 72, Train Loss: 0.3098, Val Loss: 1.3427
Epoch 73, accuracy: 0.6270
Epoch 74, accuracy: 0.6270
Epoch 74, Train Loss: 0.3594, Val Loss: 1.3427
Epoch 75, accuracy: 0.6270
Epoch 76, accuracy: 0.6270
Epoch 76, Train Loss: 0.3138, Val Loss: 1.3427
Epoch 77, accuracy: 0.6270
Epoch 78, accuracy: 0.6270
Epoch 78, Train Loss: 0.3223, Val Loss: 1.3427
Epoch 79, accuracy: 0.6270
Epoch 80, accuracy: 0.6270
Epoch 80, Train Loss: 0.3750, Val Loss: 1.3427
Epoch 81, accuracy: 0.6270
Epoch 82, accuracy: 0.6270
Epoch 82, Train Loss: 0.3009, Val Loss: 1.3427
Epoch 83, accuracy: 0.6270
Epoch 84, accuracy: 0.6270
Epoch 84, Train Loss: 0.2862, Val Loss: 1.3427
Epoch 85, accuracy: 0.6270
Epoch 86, accuracy: 0.6270
Epoch 86, Train Loss: 0.2977, Val Loss: 1.3427
Epoch 87, accuracy: 0.6270
Epoch 88, accuracy: 0.6270
Epoch 88, Train Loss: 0.2536, Val Loss: 1.3427
Epoch 89, accuracy: 0.6270
Epoch 90, accuracy: 0.6270
Epoch 90, Train Loss: 0.4040, Val Loss: 1.3427
Epoch 91, accuracy: 0.6270
Epoch 92, accuracy: 0.6270
Epoch 92, Train Loss: 0.3701, Val Loss: 1.3427
Epoch 93, accuracy: 0.6270
Epoch 94, accuracy: 0.6270
Epoch 94, Train Loss: 0.3277, Val Loss: 1.3427
Epoch 95, accuracy: 0.6270
Epoch 96, accuracy: 0.6270
Epoch 96, Train Loss: 0.3397, Val Loss: 1.3427
Epoch 97, accuracy: 0.6270
Epoch 98, accuracy: 0.6270
Epoch 98, Train Loss: 0.3226, Val Loss: 1.3427
Epoch 99, accuracy: 0.6270
Epoch 100, accuracy: 0.6270
Epoch 100, Train Loss: 0.3582, Val Loss: 1.3427
Epoch 101, accuracy: 0.6270
Epoch 102, accuracy: 0.6270
Epoch 102, Train Loss: 0.4053, Val Loss: 1.3427
Epoch 103, accuracy: 0.6270
Epoch 104, accuracy: 0.6270
Epoch 104, Train Loss: 0.3162, Val Loss: 1.3427
Epoch 105, accuracy: 0.6270
Epoch 106, accuracy: 0.6270
Epoch 106, Train Loss: 0.2672, Val Loss: 1.3427
Epoch 107, accuracy: 0.6270
Epoch 108, accuracy: 0.6270
Epoch 108, Train Loss: 0.2816, Val Loss: 1.3427
Epoch 109, accuracy: 0.6270
Epoch 110, accuracy: 0.6270
Epoch 110, Train Loss: 0.2728, Val Loss: 1.3427
Epoch 111, accuracy: 0.6270
Epoch 112, accuracy: 0.6270
Epoch 112, Train Loss: 0.3384, Val Loss: 1.3427
Epoch 113, accuracy: 0.6270
Epoch 114, accuracy: 0.6270
Epoch 114, Train Loss: 0.2526, Val Loss: 1.3427
Epoch 115, accuracy: 0.6270
Epoch 116, accuracy: 0.6270
Epoch 116, Train Loss: 0.2854, Val Loss: 1.3427
Epoch 117, accuracy: 0.6270
Epoch 118, accuracy: 0.6270
Epoch 118, Train Loss: 0.4217, Val Loss: 1.3427
Epoch 119, accuracy: 0.6270
Epoch 120, accuracy: 0.6270
Epoch 120, Train Loss: 0.3409, Val Loss: 1.3427
Epoch 121, accuracy: 0.6270
Epoch 122, accuracy: 0.6270
Epoch 122, Train Loss: 0.3326, Val Loss: 1.3427
Epoch 123, accuracy: 0.6270
Epoch 124, accuracy: 0.6270
Epoch 124, Train Loss: 0.3360, Val Loss: 1.3427
Epoch 125, accuracy: 0.6270
Epoch 126, accuracy: 0.6270
Epoch 126, Train Loss: 0.2903, Val Loss: 1.3427
Epoch 127, accuracy: 0.6270
Epoch 128, accuracy: 0.6270
Epoch 128, Train Loss: 0.3147, Val Loss: 1.3427
Epoch 129, accuracy: 0.6270
Epoch 130, accuracy: 0.6270
Epoch 130, Train Loss: 0.3396, Val Loss: 1.3427
Epoch 131, accuracy: 0.6270
Epoch 132, accuracy: 0.6270
Epoch 132, Train Loss: 0.3813, Val Loss: 1.3427
Epoch 133, accuracy: 0.6270
Epoch 134, accuracy: 0.6270
Epoch 134, Train Loss: 0.3090, Val Loss: 1.3427
Epoch 135, accuracy: 0.6270
Epoch 136, accuracy: 0.6270
Epoch 136, Train Loss: 0.3153, Val Loss: 1.3427
Epoch 137, accuracy: 0.6270
Epoch 138, accuracy: 0.6270
Epoch 138, Train Loss: 0.3552, Val Loss: 1.3427
Epoch 139, accuracy: 0.6270
Epoch 140, accuracy: 0.6270
Epoch 140, Train Loss: 0.3261, Val Loss: 1.3427
Epoch 141, accuracy: 0.6270
Epoch 142, accuracy: 0.6270
Epoch 142, Train Loss: 0.4148, Val Loss: 1.3427
Epoch 143, accuracy: 0.6270
Epoch 144, accuracy: 0.6270
Epoch 144, Train Loss: 0.3186, Val Loss: 1.3427
Epoch 145, accuracy: 0.6270
Epoch 146, accuracy: 0.6270
Epoch 146, Train Loss: 0.3066, Val Loss: 1.3427
Epoch 147, accuracy: 0.6270
Epoch 148, accuracy: 0.6270
Epoch 148, Train Loss: 0.3066, Val Loss: 1.3427
Epoch 149, accuracy: 0.6270
Epoch 150, accuracy: 0.6270
Epoch 150, Train Loss: 0.2746, Val Loss: 1.3427
Epoch 151, accuracy: 0.6270
Epoch 152, accuracy: 0.6270
Epoch 152, Train Loss: 0.2729, Val Loss: 1.3427
Epoch 153, accuracy: 0.6270
Epoch 154, accuracy: 0.6270
Epoch 154, Train Loss: 0.3096, Val Loss: 1.3427
Epoch 155, accuracy: 0.6270
Epoch 156, accuracy: 0.6270
Epoch 156, Train Loss: 0.2890, Val Loss: 1.3427
Epoch 157, accuracy: 0.6270
Epoch 158, accuracy: 0.6270
Epoch 158, Train Loss: 0.3279, Val Loss: 1.3427
Epoch 159, accuracy: 0.6270
Epoch 160, accuracy: 0.6270
Epoch 160, Train Loss: 0.2910, Val Loss: 1.3427
Epoch 161, accuracy: 0.6270
Epoch 162, accuracy: 0.6270
Epoch 162, Train Loss: 0.3865, Val Loss: 1.3427
Epoch 163, accuracy: 0.6270
Epoch 164, accuracy: 0.6270
Epoch 164, Train Loss: 0.3251, Val Loss: 1.3427
Epoch 165, accuracy: 0.6270
Epoch 166, accuracy: 0.6270
Epoch 166, Train Loss: 0.3168, Val Loss: 1.3427
Epoch 167, accuracy: 0.6270
Epoch 168, accuracy: 0.6270
Epoch 168, Train Loss: 0.3459, Val Loss: 1.3427
Epoch 169, accuracy: 0.6270
Epoch 170, accuracy: 0.6270
Epoch 170, Train Loss: 0.3002, Val Loss: 1.3427
Epoch 171, accuracy: 0.6270
Epoch 172, accuracy: 0.6270
Epoch 172, Train Loss: 0.2967, Val Loss: 1.3427
Epoch 173, accuracy: 0.6270
Epoch 174, accuracy: 0.6270
Epoch 174, Train Loss: 0.3568, Val Loss: 1.3427
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 175, accuracy: 0.6270
Epoch 176, accuracy: 0.6270
Epoch 176, Train Loss: 0.4415, Val Loss: 1.3427
Epoch 177, accuracy: 0.6270
Epoch 178, accuracy: 0.6270
Epoch 178, Train Loss: 0.3752, Val Loss: 1.3427
Epoch 179, accuracy: 0.6270
Epoch 180, accuracy: 0.6270
Epoch 180, Train Loss: 0.3452, Val Loss: 1.3427
Epoch 181, accuracy: 0.6270
Epoch 182, accuracy: 0.6270
Epoch 182, Train Loss: 0.3180, Val Loss: 1.3427
Epoch 183, accuracy: 0.6270
Epoch 184, accuracy: 0.6270
Epoch 184, Train Loss: 0.3697, Val Loss: 1.3427
Epoch 185, accuracy: 0.6270
Epoch 186, accuracy: 0.6270
Epoch 186, Train Loss: 0.2822, Val Loss: 1.3427
Epoch 187, accuracy: 0.6270
Epoch 188, accuracy: 0.6270
Epoch 188, Train Loss: 0.3311, Val Loss: 1.3427
Epoch 189, accuracy: 0.6270
Epoch 190, accuracy: 0.6270
Epoch 190, Train Loss: 0.2576, Val Loss: 1.3427
Epoch 191, accuracy: 0.6270
Epoch 192, accuracy: 0.6270
Epoch 192, Train Loss: 0.3173, Val Loss: 1.3427
Epoch 193, accuracy: 0.6270
Epoch 194, accuracy: 0.6270
Epoch 194, Train Loss: 0.3590, Val Loss: 1.3427
Epoch 195, accuracy: 0.6270
Epoch 196, accuracy: 0.6270
Epoch 196, Train Loss: 0.2846, Val Loss: 1.3427
Epoch 197, accuracy: 0.6270
Epoch 198, accuracy: 0.6270
Epoch 198, Train Loss: 0.2457, Val Loss: 1.3427
Epoch 199, accuracy: 0.6270
Loaded best model with val_loss = 0.993125319480896
test :accuracy 0.6650, f1_macro: 0.6092, f1_micro: 0.6650, auc: 0.8664
Training mamba3 with 7 layers...
可训练参数: 1900478_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.5109
Epoch 0, accuracy: 0.3820
Epoch 0, Train Loss: 1.9094, Val Loss: 1.5109
Epoch 1, accuracy: 0.3810
✅ Epoch 2: New best model saved with val_loss = 1.3758
Epoch 2, accuracy: 0.4260
Epoch 2, Train Loss: 1.2567, Val Loss: 1.3758
✅ Epoch 3: New best model saved with val_loss = 1.3134
Epoch 3, accuracy: 0.4630
✅ Epoch 4: New best model saved with val_loss = 1.1875
Epoch 4, accuracy: 0.5240
Epoch 4, Train Loss: 0.8106, Val Loss: 1.1875
✅ Epoch 5: New best model saved with val_loss = 1.1514
Epoch 5, accuracy: 0.5770
✅ Epoch 6: New best model saved with val_loss = 1.1411
Epoch 6, accuracy: 0.6110
Epoch 6, Train Loss: 0.7362, Val Loss: 1.1411
Epoch 7, accuracy: 0.6280
Epoch 8, accuracy: 0.6290
Epoch 8, Train Loss: 0.5320, Val Loss: 1.1483
Epoch 9, accuracy: 0.6240
Epoch 10, accuracy: 0.6240
Epoch 10, Train Loss: 0.5380, Val Loss: 1.1838
Epoch 11, accuracy: 0.6310
Epoch 12, accuracy: 0.6270
Epoch 12, Train Loss: 0.4361, Val Loss: 1.2351
Epoch 13, accuracy: 0.6280
Epoch 14, accuracy: 0.6280
Epoch 14, Train Loss: 0.4780, Val Loss: 1.2397
Epoch 15, accuracy: 0.6280
Epoch 16, accuracy: 0.6260
Epoch 16, Train Loss: 0.4895, Val Loss: 1.2445
Epoch 17, accuracy: 0.6250
Epoch 18, accuracy: 0.6260
Epoch 18, Train Loss: 0.5697, Val Loss: 1.2503
Epoch 19, accuracy: 0.6240
Epoch 20, accuracy: 0.6240
Epoch 20, Train Loss: 0.4644, Val Loss: 1.2510
Epoch 21, accuracy: 0.6240
Epoch 22, accuracy: 0.6240
Epoch 22, Train Loss: 0.5598, Val Loss: 1.2516
Epoch 23, accuracy: 0.6250
Epoch 24, accuracy: 0.6250
Epoch 24, Train Loss: 0.4322, Val Loss: 1.2523
Epoch 25, accuracy: 0.6250
Epoch 26, accuracy: 0.6250
Epoch 26, Train Loss: 0.4251, Val Loss: 1.2523
Epoch 27, accuracy: 0.6250
Epoch 28, accuracy: 0.6250
Epoch 28, Train Loss: 0.5722, Val Loss: 1.2523
Epoch 29, accuracy: 0.6250
Epoch 30, accuracy: 0.6250
Epoch 30, Train Loss: 0.4324, Val Loss: 1.2524
Epoch 31, accuracy: 0.6250
Epoch 32, accuracy: 0.6250
Epoch 32, Train Loss: 0.4941, Val Loss: 1.2524
Epoch 33, accuracy: 0.6250
Epoch 34, accuracy: 0.6250
Epoch 34, Train Loss: 0.4573, Val Loss: 1.2524
Epoch 35, accuracy: 0.6250
Epoch 36, accuracy: 0.6250
Epoch 36, Train Loss: 0.4769, Val Loss: 1.2524
Epoch 37, accuracy: 0.6250
Epoch 38, accuracy: 0.6250
Epoch 38, Train Loss: 0.4722, Val Loss: 1.2524
Epoch 39, accuracy: 0.6250
Epoch 40, accuracy: 0.6250
Epoch 40, Train Loss: 0.5045, Val Loss: 1.2524
Epoch 41, accuracy: 0.6250
Epoch 42, accuracy: 0.6250
Epoch 42, Train Loss: 0.5132, Val Loss: 1.2524
Epoch 43, accuracy: 0.6250
Epoch 44, accuracy: 0.6250
Epoch 44, Train Loss: 0.4803, Val Loss: 1.2524
Epoch 45, accuracy: 0.6250
Epoch 46, accuracy: 0.6250
Epoch 46, Train Loss: 0.4950, Val Loss: 1.2524
Epoch 47, accuracy: 0.6250
Epoch 48, accuracy: 0.6250
Epoch 48, Train Loss: 0.4698, Val Loss: 1.2524
Epoch 49, accuracy: 0.6250
Epoch 50, accuracy: 0.6250
Epoch 50, Train Loss: 0.4522, Val Loss: 1.2524
Epoch 51, accuracy: 0.6250
Epoch 52, accuracy: 0.6250
Epoch 52, Train Loss: 0.5129, Val Loss: 1.2524
Epoch 53, accuracy: 0.6250
Epoch 54, accuracy: 0.6250
Epoch 54, Train Loss: 0.5111, Val Loss: 1.2524
Epoch 55, accuracy: 0.6250
Epoch 56, accuracy: 0.6250
Epoch 56, Train Loss: 0.4283, Val Loss: 1.2524
Epoch 57, accuracy: 0.6250
Epoch 58, accuracy: 0.6250
Epoch 58, Train Loss: 0.4760, Val Loss: 1.2524
Epoch 59, accuracy: 0.6250
Epoch 60, accuracy: 0.6250
Epoch 60, Train Loss: 0.4470, Val Loss: 1.2524
Epoch 61, accuracy: 0.6250
Epoch 62, accuracy: 0.6250
Epoch 62, Train Loss: 0.5519, Val Loss: 1.2524
Epoch 63, accuracy: 0.6250
Epoch 64, accuracy: 0.6250
Epoch 64, Train Loss: 0.5330, Val Loss: 1.2524
Epoch 65, accuracy: 0.6250
Epoch 66, accuracy: 0.6250
Epoch 66, Train Loss: 0.5685, Val Loss: 1.2524
Epoch 67, accuracy: 0.6250
Epoch 68, accuracy: 0.6250
Epoch 68, Train Loss: 0.5613, Val Loss: 1.2524
Epoch 69, accuracy: 0.6250
Epoch 70, accuracy: 0.6250
Epoch 70, Train Loss: 0.4522, Val Loss: 1.2524
Epoch 71, accuracy: 0.6250
Epoch 72, accuracy: 0.6250
Epoch 72, Train Loss: 0.4726, Val Loss: 1.2524
Epoch 73, accuracy: 0.6250
Epoch 74, accuracy: 0.6250
Epoch 74, Train Loss: 0.4894, Val Loss: 1.2524
Epoch 75, accuracy: 0.6250
Epoch 76, accuracy: 0.6250
Epoch 76, Train Loss: 0.4138, Val Loss: 1.2524
Epoch 77, accuracy: 0.6250
Epoch 78, accuracy: 0.6250
Epoch 78, Train Loss: 0.3159, Val Loss: 1.2524
Epoch 79, accuracy: 0.6250
Epoch 80, accuracy: 0.6250
Epoch 80, Train Loss: 0.5131, Val Loss: 1.2524
Epoch 81, accuracy: 0.6250
Epoch 82, accuracy: 0.6250
Epoch 82, Train Loss: 0.4109, Val Loss: 1.2524
Epoch 83, accuracy: 0.6250
Epoch 84, accuracy: 0.6250
Epoch 84, Train Loss: 0.4269, Val Loss: 1.2524
Epoch 85, accuracy: 0.6250
Epoch 86, accuracy: 0.6250
Epoch 86, Train Loss: 0.4179, Val Loss: 1.2524
Epoch 87, accuracy: 0.6250
Epoch 88, accuracy: 0.6250
Epoch 88, Train Loss: 0.4548, Val Loss: 1.2524
Epoch 89, accuracy: 0.6250
Epoch 90, accuracy: 0.6250
Epoch 90, Train Loss: 0.4760, Val Loss: 1.2524
Epoch 91, accuracy: 0.6250
Epoch 92, accuracy: 0.6250
Epoch 92, Train Loss: 0.4953, Val Loss: 1.2524
Epoch 93, accuracy: 0.6250
Epoch 94, accuracy: 0.6250
Epoch 94, Train Loss: 0.4136, Val Loss: 1.2524
Epoch 95, accuracy: 0.6250
Epoch 96, accuracy: 0.6250
Epoch 96, Train Loss: 0.4902, Val Loss: 1.2524
Epoch 97, accuracy: 0.6250
Epoch 98, accuracy: 0.6250
Epoch 98, Train Loss: 0.4924, Val Loss: 1.2524
Epoch 99, accuracy: 0.6250
Epoch 100, accuracy: 0.6250
Epoch 100, Train Loss: 0.6094, Val Loss: 1.2524
Epoch 101, accuracy: 0.6250
Epoch 102, accuracy: 0.6250
Epoch 102, Train Loss: 0.4997, Val Loss: 1.2524
Epoch 103, accuracy: 0.6250
Epoch 104, accuracy: 0.6250
Epoch 104, Train Loss: 0.4170, Val Loss: 1.2524
Epoch 105, accuracy: 0.6250
Epoch 106, accuracy: 0.6250
Epoch 106, Train Loss: 0.5208, Val Loss: 1.2524
Epoch 107, accuracy: 0.6250
Epoch 108, accuracy: 0.6250
Epoch 108, Train Loss: 0.4905, Val Loss: 1.2524
Epoch 109, accuracy: 0.6250
Epoch 110, accuracy: 0.6250
Epoch 110, Train Loss: 0.5152, Val Loss: 1.2524
Epoch 111, accuracy: 0.6250
Epoch 112, accuracy: 0.6250
Epoch 112, Train Loss: 0.4524, Val Loss: 1.2524
Epoch 113, accuracy: 0.6250
Epoch 114, accuracy: 0.6250
Epoch 114, Train Loss: 0.4418, Val Loss: 1.2524
Epoch 115, accuracy: 0.6250
Epoch 116, accuracy: 0.6250
Epoch 116, Train Loss: 0.4839, Val Loss: 1.2524
Epoch 117, accuracy: 0.6250
Epoch 118, accuracy: 0.6250
Epoch 118, Train Loss: 0.4952, Val Loss: 1.2524
Epoch 119, accuracy: 0.6250
Epoch 120, accuracy: 0.6250
Epoch 120, Train Loss: 0.5307, Val Loss: 1.2524
Epoch 121, accuracy: 0.6250
Epoch 122, accuracy: 0.6250
Epoch 122, Train Loss: 0.6315, Val Loss: 1.2524
Epoch 123, accuracy: 0.6250
Epoch 124, accuracy: 0.6250
Epoch 124, Train Loss: 0.5814, Val Loss: 1.2524
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
/root/miniconda3/lib/python3.12/site-packages/torch_geometric/sampler/neighbor_sampler.py:61: UserWarning: Using 'NeighborSampler' without a 'pyg-lib' installation is deprecated and will be removed soon. Please install 'pyg-lib' for accelerated neighborhood sampling
  warnings.warn(f"Using '{self.__class__.__name__}' without a "
Epoch 125, accuracy: 0.6250
Epoch 126, accuracy: 0.6250
Epoch 126, Train Loss: 0.5285, Val Loss: 1.2524
Epoch 127, accuracy: 0.6250
Epoch 128, accuracy: 0.6250
Epoch 128, Train Loss: 0.4266, Val Loss: 1.2524
Epoch 129, accuracy: 0.6250
Epoch 130, accuracy: 0.6250
Epoch 130, Train Loss: 0.4877, Val Loss: 1.2524
Epoch 131, accuracy: 0.6250
Epoch 132, accuracy: 0.6250
Epoch 132, Train Loss: 0.5177, Val Loss: 1.2524
Epoch 133, accuracy: 0.6250
Epoch 134, accuracy: 0.6250
Epoch 134, Train Loss: 0.5357, Val Loss: 1.2524
Epoch 135, accuracy: 0.6250
Epoch 136, accuracy: 0.6250
Epoch 136, Train Loss: 0.4025, Val Loss: 1.2524
Epoch 137, accuracy: 0.6250
Epoch 138, accuracy: 0.6250
Epoch 138, Train Loss: 0.5656, Val Loss: 1.2524
Epoch 139, accuracy: 0.6250
Epoch 140, accuracy: 0.6250
Epoch 140, Train Loss: 0.4859, Val Loss: 1.2524
Epoch 141, accuracy: 0.6250
Epoch 142, accuracy: 0.6250
Epoch 142, Train Loss: 0.5011, Val Loss: 1.2524
Epoch 143, accuracy: 0.6250
Epoch 144, accuracy: 0.6250
Epoch 144, Train Loss: 0.4751, Val Loss: 1.2524
Epoch 145, accuracy: 0.6250
Epoch 146, accuracy: 0.6250
Epoch 146, Train Loss: 0.4684, Val Loss: 1.2524
Epoch 147, accuracy: 0.6250
Epoch 148, accuracy: 0.6250
Epoch 148, Train Loss: 0.4142, Val Loss: 1.2524
Epoch 149, accuracy: 0.6250
Epoch 150, accuracy: 0.6250
Epoch 150, Train Loss: 0.3973, Val Loss: 1.2524
Epoch 151, accuracy: 0.6250
Epoch 152, accuracy: 0.6250
Epoch 152, Train Loss: 0.5523, Val Loss: 1.2524
Epoch 153, accuracy: 0.6250
Epoch 154, accuracy: 0.6250
Epoch 154, Train Loss: 0.4790, Val Loss: 1.2524
Epoch 155, accuracy: 0.6250
Epoch 156, accuracy: 0.6250
Epoch 156, Train Loss: 0.4803, Val Loss: 1.2524
Epoch 157, accuracy: 0.6250
Epoch 158, accuracy: 0.6250
Epoch 158, Train Loss: 0.5247, Val Loss: 1.2524
Epoch 159, accuracy: 0.6250
Epoch 160, accuracy: 0.6250
Epoch 160, Train Loss: 0.4633, Val Loss: 1.2524
Epoch 161, accuracy: 0.6250
Epoch 162, accuracy: 0.6250
Epoch 162, Train Loss: 0.4585, Val Loss: 1.2524
Epoch 163, accuracy: 0.6250
Epoch 164, accuracy: 0.6250
Epoch 164, Train Loss: 0.5571, Val Loss: 1.2524
Epoch 165, accuracy: 0.6250
Epoch 166, accuracy: 0.6250
Epoch 166, Train Loss: 0.4578, Val Loss: 1.2524
Epoch 167, accuracy: 0.6250
Epoch 168, accuracy: 0.6250
Epoch 168, Train Loss: 0.4798, Val Loss: 1.2524
Epoch 169, accuracy: 0.6250
Epoch 170, accuracy: 0.6250
Epoch 170, Train Loss: 0.3944, Val Loss: 1.2524
Epoch 171, accuracy: 0.6250
Epoch 172, accuracy: 0.6250
Epoch 172, Train Loss: 0.4739, Val Loss: 1.2524
Epoch 173, accuracy: 0.6250
Epoch 174, accuracy: 0.6250
Epoch 174, Train Loss: 0.3515, Val Loss: 1.2524
Epoch 175, accuracy: 0.6250
Epoch 176, accuracy: 0.6250
Epoch 176, Train Loss: 0.5224, Val Loss: 1.2524
Epoch 177, accuracy: 0.6250
Epoch 178, accuracy: 0.6250
Epoch 178, Train Loss: 0.4092, Val Loss: 1.2524
Epoch 179, accuracy: 0.6250
Epoch 180, accuracy: 0.6250
Epoch 180, Train Loss: 0.3873, Val Loss: 1.2524
Epoch 181, accuracy: 0.6250
Epoch 182, accuracy: 0.6250
Epoch 182, Train Loss: 0.4520, Val Loss: 1.2524
Epoch 183, accuracy: 0.6250
Epoch 184, accuracy: 0.6250
Epoch 184, Train Loss: 0.5239, Val Loss: 1.2524
Epoch 185, accuracy: 0.6250
Epoch 186, accuracy: 0.6250
Epoch 186, Train Loss: 0.5299, Val Loss: 1.2524
Epoch 187, accuracy: 0.6250
Epoch 188, accuracy: 0.6250
Epoch 188, Train Loss: 0.4512, Val Loss: 1.2524
Epoch 189, accuracy: 0.6250
Epoch 190, accuracy: 0.6250
Epoch 190, Train Loss: 0.4565, Val Loss: 1.2524
Epoch 191, accuracy: 0.6250
Epoch 192, accuracy: 0.6250
Epoch 192, Train Loss: 0.4879, Val Loss: 1.2524
Epoch 193, accuracy: 0.6250
Epoch 194, accuracy: 0.6250
Epoch 194, Train Loss: 0.6110, Val Loss: 1.2524
Epoch 195, accuracy: 0.6250
Epoch 196, accuracy: 0.6250
Epoch 196, Train Loss: 0.4969, Val Loss: 1.2524
Epoch 197, accuracy: 0.6250
Epoch 198, accuracy: 0.6250
Epoch 198, Train Loss: 0.4591, Val Loss: 1.2524
Epoch 199, accuracy: 0.6250
Loaded best model with val_loss = 1.1411343812942505
test :accuracy 0.6110, f1_macro: 0.5668, f1_micro: 0.6110, auc: 0.8440
Final Results: {'GAT_3_Citeseer': np.float64(0.711), 'GAT_4_Citeseer': np.float64(0.695), 'GAT_5_Citeseer': np.float64(0.641), 'GAT_6_Citeseer': np.float64(0.626), 'GAT_7_Citeseer': np.float64(0.606), 'mamba3_3_Citeseer': np.float64(0.569), 'mamba3_4_Citeseer': np.float64(0.657), 'mamba3_5_Citeseer': np.float64(0.642), 'mamba3_6_Citeseer': np.float64(0.665), 'mamba3_7_Citeseer': np.float64(0.611)} ['1578142_GAT_0', '1727518_GAT_0', '1876894_GAT_0', '2026270_GAT_0', '2175646_GAT_0', '1568702_mamba3_0', '1651646_mamba3_0', '1734590_mamba3_0', '1817534_mamba3_0', '1900478_mamba3_0']
========== Running baseline 3/3 ==========
Training GAT with 3 layers...
可训练参数: 1578142_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.6600
Epoch 0, accuracy: 0.6390
Epoch 0, Train Loss: 1.7931, Val Loss: 1.6600
✅ Epoch 1: New best model saved with val_loss = 1.3859
Epoch 1, accuracy: 0.6880
✅ Epoch 2: New best model saved with val_loss = 1.0545
Epoch 2, accuracy: 0.6950
Epoch 2, Train Loss: 1.0080, Val Loss: 1.0545
✅ Epoch 3: New best model saved with val_loss = 0.9705
Epoch 3, accuracy: 0.6840
Epoch 4, accuracy: 0.6380
Epoch 4, Train Loss: 0.1565, Val Loss: 1.1814
Epoch 5, accuracy: 0.5940
Epoch 6, accuracy: 0.6660
Epoch 6, Train Loss: 0.1219, Val Loss: 1.5656
Epoch 7, accuracy: 0.6540
Epoch 8, accuracy: 0.6410
Epoch 8, Train Loss: 0.1240, Val Loss: 2.1494
Epoch 9, accuracy: 0.6190
Epoch 10, accuracy: 0.6120
Epoch 10, Train Loss: 0.0469, Val Loss: 2.5259
Epoch 11, accuracy: 0.6190
Epoch 12, accuracy: 0.6140
Epoch 12, Train Loss: 0.0183, Val Loss: 2.5476
Epoch 13, accuracy: 0.6130
Epoch 14, accuracy: 0.6130
Epoch 14, Train Loss: 0.0285, Val Loss: 2.5545
Epoch 15, accuracy: 0.6150
Epoch 16, accuracy: 0.6140
Epoch 16, Train Loss: 0.0200, Val Loss: 2.5665
Epoch 17, accuracy: 0.6130
Epoch 18, accuracy: 0.6140
Epoch 18, Train Loss: 0.0236, Val Loss: 2.5631
Epoch 19, accuracy: 0.6140
Epoch 20, accuracy: 0.6140
Epoch 20, Train Loss: 0.0265, Val Loss: 2.5582
Epoch 21, accuracy: 0.6120
Epoch 22, accuracy: 0.6120
Epoch 22, Train Loss: 0.0408, Val Loss: 2.5550
Epoch 23, accuracy: 0.6120
Epoch 24, accuracy: 0.6120
Epoch 24, Train Loss: 0.0734, Val Loss: 2.5546
Epoch 25, accuracy: 0.6120
Epoch 26, accuracy: 0.6120
Epoch 26, Train Loss: 0.0414, Val Loss: 2.5543
Epoch 27, accuracy: 0.6120
Epoch 28, accuracy: 0.6120
Epoch 28, Train Loss: 0.0150, Val Loss: 2.5542
Epoch 29, accuracy: 0.6120
Epoch 30, accuracy: 0.6120
Epoch 30, Train Loss: 0.0173, Val Loss: 2.5542
Epoch 31, accuracy: 0.6120
Epoch 32, accuracy: 0.6120
Epoch 32, Train Loss: 0.0259, Val Loss: 2.5541
Epoch 33, accuracy: 0.6120
Epoch 34, accuracy: 0.6120
Epoch 34, Train Loss: 0.0389, Val Loss: 2.5541
Epoch 35, accuracy: 0.6120
Epoch 36, accuracy: 0.6120
Epoch 36, Train Loss: 0.0399, Val Loss: 2.5541
Epoch 37, accuracy: 0.6120
Epoch 38, accuracy: 0.6120
Epoch 38, Train Loss: 0.0297, Val Loss: 2.5541
Epoch 39, accuracy: 0.6120
Epoch 40, accuracy: 0.6120
Epoch 40, Train Loss: 0.1000, Val Loss: 2.5541
Epoch 41, accuracy: 0.6120
Epoch 42, accuracy: 0.6120
Epoch 42, Train Loss: 0.0628, Val Loss: 2.5541
Epoch 43, accuracy: 0.6120
Epoch 44, accuracy: 0.6120
Epoch 44, Train Loss: 0.0208, Val Loss: 2.5541
Epoch 45, accuracy: 0.6120
Epoch 46, accuracy: 0.6120
Epoch 46, Train Loss: 0.0580, Val Loss: 2.5541
Epoch 47, accuracy: 0.6120
Epoch 48, accuracy: 0.6120
Epoch 48, Train Loss: 0.0080, Val Loss: 2.5541
Epoch 49, accuracy: 0.6120
Epoch 50, accuracy: 0.6120
Epoch 50, Train Loss: 0.0328, Val Loss: 2.5541
Epoch 51, accuracy: 0.6120
Epoch 52, accuracy: 0.6120
Epoch 52, Train Loss: 0.0070, Val Loss: 2.5541
Epoch 53, accuracy: 0.6120
Epoch 54, accuracy: 0.6120
Epoch 54, Train Loss: 0.0376, Val Loss: 2.5541
Epoch 55, accuracy: 0.6120
Epoch 56, accuracy: 0.6120
Epoch 56, Train Loss: 0.0075, Val Loss: 2.5541
Epoch 57, accuracy: 0.6120
Epoch 58, accuracy: 0.6120
Epoch 58, Train Loss: 0.0486, Val Loss: 2.5541
Epoch 59, accuracy: 0.6120
Epoch 60, accuracy: 0.6120
Epoch 60, Train Loss: 0.0391, Val Loss: 2.5541
Epoch 61, accuracy: 0.6120
Epoch 62, accuracy: 0.6120
Epoch 62, Train Loss: 0.0164, Val Loss: 2.5541
Epoch 63, accuracy: 0.6120
Epoch 64, accuracy: 0.6120
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 64, Train Loss: 0.0250, Val Loss: 2.5541
Epoch 65, accuracy: 0.6120
Epoch 66, accuracy: 0.6120
Epoch 66, Train Loss: 0.0368, Val Loss: 2.5541
Epoch 67, accuracy: 0.6120
Epoch 68, accuracy: 0.6120
Epoch 68, Train Loss: 0.0428, Val Loss: 2.5541
Epoch 69, accuracy: 0.6120
Epoch 70, accuracy: 0.6120
Epoch 70, Train Loss: 0.0406, Val Loss: 2.5541
Epoch 71, accuracy: 0.6120
Epoch 72, accuracy: 0.6120
Epoch 72, Train Loss: 0.0110, Val Loss: 2.5541
Epoch 73, accuracy: 0.6120
Epoch 74, accuracy: 0.6120
Epoch 74, Train Loss: 0.0532, Val Loss: 2.5541
Epoch 75, accuracy: 0.6120
Epoch 76, accuracy: 0.6120
Epoch 76, Train Loss: 0.0269, Val Loss: 2.5541
Epoch 77, accuracy: 0.6120
Epoch 78, accuracy: 0.6120
Epoch 78, Train Loss: 0.0127, Val Loss: 2.5541
Epoch 79, accuracy: 0.6120
Epoch 80, accuracy: 0.6120
Epoch 80, Train Loss: 0.0220, Val Loss: 2.5541
Epoch 81, accuracy: 0.6120
Epoch 82, accuracy: 0.6120
Epoch 82, Train Loss: 0.0419, Val Loss: 2.5541
Epoch 83, accuracy: 0.6120
Epoch 84, accuracy: 0.6120
Epoch 84, Train Loss: 0.0225, Val Loss: 2.5541
Epoch 85, accuracy: 0.6120
Epoch 86, accuracy: 0.6120
Epoch 86, Train Loss: 0.0295, Val Loss: 2.5541
Epoch 87, accuracy: 0.6120
Epoch 88, accuracy: 0.6120
Epoch 88, Train Loss: 0.0708, Val Loss: 2.5541
Epoch 89, accuracy: 0.6120
Epoch 90, accuracy: 0.6120
Epoch 90, Train Loss: 0.0147, Val Loss: 2.5541
Epoch 91, accuracy: 0.6120
Epoch 92, accuracy: 0.6120
Epoch 92, Train Loss: 0.0207, Val Loss: 2.5541
Epoch 93, accuracy: 0.6120
Epoch 94, accuracy: 0.6120
Epoch 94, Train Loss: 0.0717, Val Loss: 2.5541
Epoch 95, accuracy: 0.6120
Epoch 96, accuracy: 0.6120
Epoch 96, Train Loss: 0.0352, Val Loss: 2.5541
Epoch 97, accuracy: 0.6120
Epoch 98, accuracy: 0.6120
Epoch 98, Train Loss: 0.0266, Val Loss: 2.5541
Epoch 99, accuracy: 0.6120
Epoch 100, accuracy: 0.6120
Epoch 100, Train Loss: 0.0404, Val Loss: 2.5541
Epoch 101, accuracy: 0.6120
Epoch 102, accuracy: 0.6120
Epoch 102, Train Loss: 0.0653, Val Loss: 2.5541
Epoch 103, accuracy: 0.6120
Epoch 104, accuracy: 0.6120
Epoch 104, Train Loss: 0.0133, Val Loss: 2.5541
Epoch 105, accuracy: 0.6120
Epoch 106, accuracy: 0.6120
Epoch 106, Train Loss: 0.0229, Val Loss: 2.5541
Epoch 107, accuracy: 0.6120
Epoch 108, accuracy: 0.6120
Epoch 108, Train Loss: 0.0425, Val Loss: 2.5541
Epoch 109, accuracy: 0.6120
Epoch 110, accuracy: 0.6120
Epoch 110, Train Loss: 0.0606, Val Loss: 2.5541
Epoch 111, accuracy: 0.6120
Epoch 112, accuracy: 0.6120
Epoch 112, Train Loss: 0.0731, Val Loss: 2.5541
Epoch 113, accuracy: 0.6120
Epoch 114, accuracy: 0.6120
Epoch 114, Train Loss: 0.0220, Val Loss: 2.5541
Epoch 115, accuracy: 0.6120
Epoch 116, accuracy: 0.6120
Epoch 116, Train Loss: 0.0286, Val Loss: 2.5541
Epoch 117, accuracy: 0.6120
Epoch 118, accuracy: 0.6120
Epoch 118, Train Loss: 0.0600, Val Loss: 2.5541
Epoch 119, accuracy: 0.6120
Epoch 120, accuracy: 0.6120
Epoch 120, Train Loss: 0.0161, Val Loss: 2.5541
Epoch 121, accuracy: 0.6120
Epoch 122, accuracy: 0.6120
Epoch 122, Train Loss: 0.0216, Val Loss: 2.5541
Epoch 123, accuracy: 0.6120
Epoch 124, accuracy: 0.6120
Epoch 124, Train Loss: 0.0324, Val Loss: 2.5541
Epoch 125, accuracy: 0.6120
Epoch 126, accuracy: 0.6120
Epoch 126, Train Loss: 0.0454, Val Loss: 2.5541
Epoch 127, accuracy: 0.6120
Epoch 128, accuracy: 0.6120
Epoch 128, Train Loss: 0.0559, Val Loss: 2.5541
Epoch 129, accuracy: 0.6120
Epoch 130, accuracy: 0.6120
Epoch 130, Train Loss: 0.0213, Val Loss: 2.5541
Epoch 131, accuracy: 0.6120
Epoch 132, accuracy: 0.6120
Epoch 132, Train Loss: 0.0146, Val Loss: 2.5541
Epoch 133, accuracy: 0.6120
Epoch 134, accuracy: 0.6120
Epoch 134, Train Loss: 0.0340, Val Loss: 2.5541
Epoch 135, accuracy: 0.6120
Epoch 136, accuracy: 0.6120
Epoch 136, Train Loss: 0.0206, Val Loss: 2.5541
Epoch 137, accuracy: 0.6120
Epoch 138, accuracy: 0.6120
Epoch 138, Train Loss: 0.0413, Val Loss: 2.5541
Epoch 139, accuracy: 0.6120
Epoch 140, accuracy: 0.6120
Epoch 140, Train Loss: 0.0096, Val Loss: 2.5541
Epoch 141, accuracy: 0.6120
Epoch 142, accuracy: 0.6120
Epoch 142, Train Loss: 0.0351, Val Loss: 2.5541
Epoch 143, accuracy: 0.6120
Epoch 144, accuracy: 0.6120
Epoch 144, Train Loss: 0.0755, Val Loss: 2.5541
Epoch 145, accuracy: 0.6120
Epoch 146, accuracy: 0.6120
Epoch 146, Train Loss: 0.0364, Val Loss: 2.5541
Epoch 147, accuracy: 0.6120
Epoch 148, accuracy: 0.6120
Epoch 148, Train Loss: 0.0288, Val Loss: 2.5541
Epoch 149, accuracy: 0.6120
Epoch 150, accuracy: 0.6120
Epoch 150, Train Loss: 0.0216, Val Loss: 2.5541
Epoch 151, accuracy: 0.6120
Epoch 152, accuracy: 0.6120
Epoch 152, Train Loss: 0.0203, Val Loss: 2.5541
Epoch 153, accuracy: 0.6120
Epoch 154, accuracy: 0.6120
Epoch 154, Train Loss: 0.0165, Val Loss: 2.5541
Epoch 155, accuracy: 0.6120
Epoch 156, accuracy: 0.6120
Epoch 156, Train Loss: 0.0211, Val Loss: 2.5541
Epoch 157, accuracy: 0.6120
Epoch 158, accuracy: 0.6120
Epoch 158, Train Loss: 0.0126, Val Loss: 2.5541
Epoch 159, accuracy: 0.6120
Epoch 160, accuracy: 0.6120
Epoch 160, Train Loss: 0.0112, Val Loss: 2.5541
Epoch 161, accuracy: 0.6120
Epoch 162, accuracy: 0.6120
Epoch 162, Train Loss: 0.0396, Val Loss: 2.5541
Epoch 163, accuracy: 0.6120
Epoch 164, accuracy: 0.6120
Epoch 164, Train Loss: 0.0336, Val Loss: 2.5541
Epoch 165, accuracy: 0.6120
Epoch 166, accuracy: 0.6120
Epoch 166, Train Loss: 0.0304, Val Loss: 2.5541
Epoch 167, accuracy: 0.6120
Epoch 168, accuracy: 0.6120
Epoch 168, Train Loss: 0.0523, Val Loss: 2.5541
Epoch 169, accuracy: 0.6120
Epoch 170, accuracy: 0.6120
Epoch 170, Train Loss: 0.0269, Val Loss: 2.5541
Epoch 171, accuracy: 0.6120
Epoch 172, accuracy: 0.6120
Epoch 172, Train Loss: 0.0756, Val Loss: 2.5540
Epoch 173, accuracy: 0.6120
Epoch 174, accuracy: 0.6120
Epoch 174, Train Loss: 0.0567, Val Loss: 2.5540
Epoch 175, accuracy: 0.6120
Epoch 176, accuracy: 0.6120
Epoch 176, Train Loss: 0.0343, Val Loss: 2.5540
Epoch 177, accuracy: 0.6120
Epoch 178, accuracy: 0.6120
Epoch 178, Train Loss: 0.0133, Val Loss: 2.5540
Epoch 179, accuracy: 0.6120
Epoch 180, accuracy: 0.6120
Epoch 180, Train Loss: 0.0264, Val Loss: 2.5540
Epoch 181, accuracy: 0.6120
Epoch 182, accuracy: 0.6120
Epoch 182, Train Loss: 0.0100, Val Loss: 2.5540
Epoch 183, accuracy: 0.6120
Epoch 184, accuracy: 0.6120
Epoch 184, Train Loss: 0.0086, Val Loss: 2.5540
Epoch 185, accuracy: 0.6120
Epoch 186, accuracy: 0.6120
Epoch 186, Train Loss: 0.0792, Val Loss: 2.5540
Epoch 187, accuracy: 0.6120
Epoch 188, accuracy: 0.6120
Epoch 188, Train Loss: 0.0322, Val Loss: 2.5540
Epoch 189, accuracy: 0.6120
Epoch 190, accuracy: 0.6120
Epoch 190, Train Loss: 0.0273, Val Loss: 2.5540
Epoch 191, accuracy: 0.6120
Epoch 192, accuracy: 0.6120
Epoch 192, Train Loss: 0.0164, Val Loss: 2.5540
Epoch 193, accuracy: 0.6120
Epoch 194, accuracy: 0.6120
Epoch 194, Train Loss: 0.0351, Val Loss: 2.5540
Epoch 195, accuracy: 0.6120
Epoch 196, accuracy: 0.6120
Epoch 196, Train Loss: 0.0219, Val Loss: 2.5540
Epoch 197, accuracy: 0.6120
Epoch 198, accuracy: 0.6120
Epoch 198, Train Loss: 0.0491, Val Loss: 2.5540
Epoch 199, accuracy: 0.6120
Loaded best model with val_loss = 0.9704645872116089
test :accuracy 0.6840, f1_macro: 0.6525, f1_micro: 0.6840, auc: 0.8911
Training GAT with 4 layers...
可训练参数: 1727518_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.7340
Epoch 0, accuracy: 0.5160
Epoch 0, Train Loss: 1.7947, Val Loss: 1.7340
✅ Epoch 1: New best model saved with val_loss = 1.5080
Epoch 1, accuracy: 0.6270
✅ Epoch 2: New best model saved with val_loss = 1.0469
Epoch 2, accuracy: 0.6950
Epoch 2, Train Loss: 1.2645, Val Loss: 1.0469
Epoch 3, accuracy: 0.6490
Epoch 4, accuracy: 0.6640
Epoch 4, Train Loss: 0.2028, Val Loss: 1.5336
Epoch 5, accuracy: 0.5760
Epoch 6, accuracy: 0.6180
Epoch 6, Train Loss: 0.6420, Val Loss: 2.4122
Epoch 7, accuracy: 0.6300
Epoch 8, accuracy: 0.6420
Epoch 8, Train Loss: 0.2187, Val Loss: 2.5032
Epoch 9, accuracy: 0.6430
Epoch 10, accuracy: 0.6490
Epoch 10, Train Loss: 0.2311, Val Loss: 2.4236
Epoch 11, accuracy: 0.6520
Epoch 12, accuracy: 0.6500
Epoch 12, Train Loss: 0.2045, Val Loss: 2.3117
Epoch 13, accuracy: 0.6480
Epoch 14, accuracy: 0.6500
Epoch 14, Train Loss: 0.0891, Val Loss: 2.2206
Epoch 15, accuracy: 0.6510
Epoch 16, accuracy: 0.6510
Epoch 16, Train Loss: 0.1308, Val Loss: 2.2163
Epoch 17, accuracy: 0.6520
Epoch 18, accuracy: 0.6510
Epoch 18, Train Loss: 0.1279, Val Loss: 2.2131
Epoch 19, accuracy: 0.6510
Epoch 20, accuracy: 0.6500
Epoch 20, Train Loss: 0.0795, Val Loss: 2.2098
Epoch 21, accuracy: 0.6500
Epoch 22, accuracy: 0.6500
Epoch 22, Train Loss: 0.1352, Val Loss: 2.2096
Epoch 23, accuracy: 0.6500
Epoch 24, accuracy: 0.6500
Epoch 24, Train Loss: 0.1445, Val Loss: 2.2094
Epoch 25, accuracy: 0.6500
Epoch 26, accuracy: 0.6500
Epoch 26, Train Loss: 0.1411, Val Loss: 2.2090
Epoch 27, accuracy: 0.6500
Epoch 28, accuracy: 0.6500
Epoch 28, Train Loss: 0.1028, Val Loss: 2.2090
Epoch 29, accuracy: 0.6500
Epoch 30, accuracy: 0.6510
Epoch 30, Train Loss: 0.0588, Val Loss: 2.2089
Epoch 31, accuracy: 0.6510
Epoch 32, accuracy: 0.6510
Epoch 32, Train Loss: 0.0766, Val Loss: 2.2089
Epoch 33, accuracy: 0.6510
Epoch 34, accuracy: 0.6510
Epoch 34, Train Loss: 0.0653, Val Loss: 2.2089
Epoch 35, accuracy: 0.6510
Epoch 36, accuracy: 0.6510
Epoch 36, Train Loss: 0.0321, Val Loss: 2.2089
Epoch 37, accuracy: 0.6510
Epoch 38, accuracy: 0.6510
Epoch 38, Train Loss: 0.0686, Val Loss: 2.2089
Epoch 39, accuracy: 0.6510
Epoch 40, accuracy: 0.6510
Epoch 40, Train Loss: 0.0584, Val Loss: 2.2089
Epoch 41, accuracy: 0.6510
Epoch 42, accuracy: 0.6510
Epoch 42, Train Loss: 0.0433, Val Loss: 2.2089
Epoch 43, accuracy: 0.6510
Epoch 44, accuracy: 0.6510
Epoch 44, Train Loss: 0.0615, Val Loss: 2.2089
Epoch 45, accuracy: 0.6510
Epoch 46, accuracy: 0.6510
Epoch 46, Train Loss: 0.0591, Val Loss: 2.2089
Epoch 47, accuracy: 0.6510
Epoch 48, accuracy: 0.6510
Epoch 48, Train Loss: 0.0554, Val Loss: 2.2089
Epoch 49, accuracy: 0.6510
Epoch 50, accuracy: 0.6510
Epoch 50, Train Loss: 0.1004, Val Loss: 2.2089
Epoch 51, accuracy: 0.6510
Epoch 52, accuracy: 0.6510
Epoch 52, Train Loss: 0.0562, Val Loss: 2.2089
Epoch 53, accuracy: 0.6510
Epoch 54, accuracy: 0.6510
Epoch 54, Train Loss: 0.0851, Val Loss: 2.2089
Epoch 55, accuracy: 0.6510
Epoch 56, accuracy: 0.6510
Epoch 56, Train Loss: 0.1512, Val Loss: 2.2089
Epoch 57, accuracy: 0.6510
Epoch 58, accuracy: 0.6510
Epoch 58, Train Loss: 0.1347, Val Loss: 2.2089
Epoch 59, accuracy: 0.6510
Epoch 60, accuracy: 0.6510
Epoch 60, Train Loss: 0.0776, Val Loss: 2.2089
Epoch 61, accuracy: 0.6510
Epoch 62, accuracy: 0.6510
Epoch 62, Train Loss: 0.0665, Val Loss: 2.2089
Epoch 63, accuracy: 0.6510
Epoch 64, accuracy: 0.6510
Epoch 64, Train Loss: 0.1097, Val Loss: 2.2089
Epoch 65, accuracy: 0.6510
Epoch 66, accuracy: 0.6510
Epoch 66, Train Loss: 0.0830, Val Loss: 2.2089
Epoch 67, accuracy: 0.6510
Epoch 68, accuracy: 0.6510
Epoch 68, Train Loss: 0.0705, Val Loss: 2.2089
Epoch 69, accuracy: 0.6510
Epoch 70, accuracy: 0.6510
Epoch 70, Train Loss: 0.0741, Val Loss: 2.2089
Epoch 71, accuracy: 0.6510
Epoch 72, accuracy: 0.6510
Epoch 72, Train Loss: 0.0875, Val Loss: 2.2089
Epoch 73, accuracy: 0.6510
Epoch 74, accuracy: 0.6510
Epoch 74, Train Loss: 0.0642, Val Loss: 2.2089
Epoch 75, accuracy: 0.6510
Epoch 76, accuracy: 0.6510
Epoch 76, Train Loss: 0.0742, Val Loss: 2.2089
Epoch 77, accuracy: 0.6510
Epoch 78, accuracy: 0.6510
Epoch 78, Train Loss: 0.0549, Val Loss: 2.2089
Epoch 79, accuracy: 0.6510
Epoch 80, accuracy: 0.6510
Epoch 80, Train Loss: 0.0972, Val Loss: 2.2089
Epoch 81, accuracy: 0.6510
Epoch 82, accuracy: 0.6510
Epoch 82, Train Loss: 0.0533, Val Loss: 2.2089
Epoch 83, accuracy: 0.6510
Epoch 84, accuracy: 0.6510
Epoch 84, Train Loss: 0.0636, Val Loss: 2.2089
Epoch 85, accuracy: 0.6510
Epoch 86, accuracy: 0.6510
Epoch 86, Train Loss: 0.0805, Val Loss: 2.2089
Epoch 87, accuracy: 0.6510
Epoch 88, accuracy: 0.6510
Epoch 88, Train Loss: 0.0536, Val Loss: 2.2089
Epoch 89, accuracy: 0.6510
Epoch 90, accuracy: 0.6510
Epoch 90, Train Loss: 0.0789, Val Loss: 2.2089
Epoch 91, accuracy: 0.6510
Epoch 92, accuracy: 0.6510
Epoch 92, Train Loss: 0.0698, Val Loss: 2.2089
Epoch 93, accuracy: 0.6510
Epoch 94, accuracy: 0.6510
Epoch 94, Train Loss: 0.1194, Val Loss: 2.2089
Epoch 95, accuracy: 0.6510
Epoch 96, accuracy: 0.6510
Epoch 96, Train Loss: 0.0800, Val Loss: 2.2089
Epoch 97, accuracy: 0.6510
Epoch 98, accuracy: 0.6510
Epoch 98, Train Loss: 0.0629, Val Loss: 2.2089
Epoch 99, accuracy: 0.6510
Epoch 100, accuracy: 0.6510
Epoch 100, Train Loss: 0.0488, Val Loss: 2.2089
Epoch 101, accuracy: 0.6510
Epoch 102, accuracy: 0.6510
Epoch 102, Train Loss: 0.0776, Val Loss: 2.2089
Epoch 103, accuracy: 0.6510
Epoch 104, accuracy: 0.6510
Epoch 104, Train Loss: 0.0880, Val Loss: 2.2089
Epoch 105, accuracy: 0.6510
Epoch 106, accuracy: 0.6510
Epoch 106, Train Loss: 0.0959, Val Loss: 2.2089
Epoch 107, accuracy: 0.6510
Epoch 108, accuracy: 0.6510
Epoch 108, Train Loss: 0.0849, Val Loss: 2.2089
Epoch 109, accuracy: 0.6510
Epoch 110, accuracy: 0.6510
Epoch 110, Train Loss: 0.0791, Val Loss: 2.2089
Epoch 111, accuracy: 0.6510
Epoch 112, accuracy: 0.6510
Epoch 112, Train Loss: 0.0999, Val Loss: 2.2089
Epoch 113, accuracy: 0.6510
Epoch 114, accuracy: 0.6510
Epoch 114, Train Loss: 0.0567, Val Loss: 2.2089
Epoch 115, accuracy: 0.6510
Epoch 116, accuracy: 0.6510
Epoch 116, Train Loss: 0.0711, Val Loss: 2.2089
Epoch 117, accuracy: 0.6510
Epoch 118, accuracy: 0.6510
Epoch 118, Train Loss: 0.0601, Val Loss: 2.2089
Epoch 119, accuracy: 0.6510
Epoch 120, accuracy: 0.6510
Epoch 120, Train Loss: 0.0544, Val Loss: 2.2089
Epoch 121, accuracy: 0.6510
Epoch 122, accuracy: 0.6510
Epoch 122, Train Loss: 0.0553, Val Loss: 2.2089
Epoch 123, accuracy: 0.6510
Epoch 124, accuracy: 0.6510
Epoch 124, Train Loss: 0.0831, Val Loss: 2.2089
Epoch 125, accuracy: 0.6510
Epoch 126, accuracy: 0.6510
Epoch 126, Train Loss: 0.1290, Val Loss: 2.2089
Epoch 127, accuracy: 0.6510
Epoch 128, accuracy: 0.6510
Epoch 128, Train Loss: 0.0595, Val Loss: 2.2089
Epoch 129, accuracy: 0.6510
Epoch 130, accuracy: 0.6510
Epoch 130, Train Loss: 0.0866, Val Loss: 2.2089
Epoch 131, accuracy: 0.6510
Epoch 132, accuracy: 0.6510
Epoch 132, Train Loss: 0.0920, Val Loss: 2.2089
Epoch 133, accuracy: 0.6510
Epoch 134, accuracy: 0.6510
Epoch 134, Train Loss: 0.0865, Val Loss: 2.2089
Epoch 135, accuracy: 0.6510
Epoch 136, accuracy: 0.6510
Epoch 136, Train Loss: 0.0665, Val Loss: 2.2089
Epoch 137, accuracy: 0.6510
Epoch 138, accuracy: 0.6510
Epoch 138, Train Loss: 0.0651, Val Loss: 2.2089
Epoch 139, accuracy: 0.6510
Epoch 140, accuracy: 0.6510
Epoch 140, Train Loss: 0.0579, Val Loss: 2.2089
Epoch 141, accuracy: 0.6510
Epoch 142, accuracy: 0.6510
Epoch 142, Train Loss: 0.0793, Val Loss: 2.2089
Epoch 143, accuracy: 0.6510
Epoch 144, accuracy: 0.6510
Epoch 144, Train Loss: 0.0654, Val Loss: 2.2089
Epoch 145, accuracy: 0.6510
Epoch 146, accuracy: 0.6510
Epoch 146, Train Loss: 0.0950, Val Loss: 2.2089
Epoch 147, accuracy: 0.6510
Epoch 148, accuracy: 0.6510
Epoch 148, Train Loss: 0.0821, Val Loss: 2.2089
Epoch 149, accuracy: 0.6510
Epoch 150, accuracy: 0.6510
Epoch 150, Train Loss: 0.1031, Val Loss: 2.2089
Epoch 151, accuracy: 0.6510
Epoch 152, accuracy: 0.6510
Epoch 152, Train Loss: 0.0475, Val Loss: 2.2089
Epoch 153, accuracy: 0.6510
Epoch 154, accuracy: 0.6510
Epoch 154, Train Loss: 0.0751, Val Loss: 2.2089
Epoch 155, accuracy: 0.6510
Epoch 156, accuracy: 0.6510
Epoch 156, Train Loss: 0.0877, Val Loss: 2.2089
Epoch 157, accuracy: 0.6510
Epoch 158, accuracy: 0.6510
Epoch 158, Train Loss: 0.0576, Val Loss: 2.2089
Epoch 159, accuracy: 0.6510
Epoch 160, accuracy: 0.6510
Epoch 160, Train Loss: 0.0584, Val Loss: 2.2089
Epoch 161, accuracy: 0.6510
Epoch 162, accuracy: 0.6510
Epoch 162, Train Loss: 0.0516, Val Loss: 2.2089
Epoch 163, accuracy: 0.6510
Epoch 164, accuracy: 0.6510
Epoch 164, Train Loss: 0.1192, Val Loss: 2.2089
Epoch 165, accuracy: 0.6510
Epoch 166, accuracy: 0.6510
Epoch 166, Train Loss: 0.0905, Val Loss: 2.2089
Epoch 167, accuracy: 0.6510
Epoch 168, accuracy: 0.6510
Epoch 168, Train Loss: 0.0942, Val Loss: 2.2089
Epoch 169, accuracy: 0.6510
Epoch 170, accuracy: 0.6510
Epoch 170, Train Loss: 0.0962, Val Loss: 2.2089
Epoch 171, accuracy: 0.6510
Epoch 172, accuracy: 0.6510
Epoch 172, Train Loss: 0.1134, Val Loss: 2.2089
Epoch 173, accuracy: 0.6510
Epoch 174, accuracy: 0.6510
Epoch 174, Train Loss: 0.1096, Val Loss: 2.2089
Epoch 175, accuracy: 0.6510
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 176, accuracy: 0.6510
Epoch 176, Train Loss: 0.0690, Val Loss: 2.2089
Epoch 177, accuracy: 0.6510
Epoch 178, accuracy: 0.6510
Epoch 178, Train Loss: 0.0603, Val Loss: 2.2089
Epoch 179, accuracy: 0.6510
Epoch 180, accuracy: 0.6510
Epoch 180, Train Loss: 0.0391, Val Loss: 2.2089
Epoch 181, accuracy: 0.6510
Epoch 182, accuracy: 0.6510
Epoch 182, Train Loss: 0.0701, Val Loss: 2.2089
Epoch 183, accuracy: 0.6510
Epoch 184, accuracy: 0.6510
Epoch 184, Train Loss: 0.0429, Val Loss: 2.2089
Epoch 185, accuracy: 0.6510
Epoch 186, accuracy: 0.6510
Epoch 186, Train Loss: 0.0789, Val Loss: 2.2089
Epoch 187, accuracy: 0.6510
Epoch 188, accuracy: 0.6510
Epoch 188, Train Loss: 0.1458, Val Loss: 2.2089
Epoch 189, accuracy: 0.6510
Epoch 190, accuracy: 0.6510
Epoch 190, Train Loss: 0.0375, Val Loss: 2.2089
Epoch 191, accuracy: 0.6510
Epoch 192, accuracy: 0.6510
Epoch 192, Train Loss: 0.0516, Val Loss: 2.2089
Epoch 193, accuracy: 0.6510
Epoch 194, accuracy: 0.6510
Epoch 194, Train Loss: 0.1217, Val Loss: 2.2089
Epoch 195, accuracy: 0.6510
Epoch 196, accuracy: 0.6510
Epoch 196, Train Loss: 0.0547, Val Loss: 2.2089
Epoch 197, accuracy: 0.6510
Epoch 198, accuracy: 0.6510
Epoch 198, Train Loss: 0.0737, Val Loss: 2.2089
Epoch 199, accuracy: 0.6510
Loaded best model with val_loss = 1.0468823909759521
test :accuracy 0.6950, f1_macro: 0.6447, f1_micro: 0.6950, auc: 0.8995
Training GAT with 5 layers...
可训练参数: 1876894_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.7852
Epoch 0, accuracy: 0.1910
Epoch 0, Train Loss: 1.7969, Val Loss: 1.7852
✅ Epoch 1: New best model saved with val_loss = 1.6427
Epoch 1, accuracy: 0.5370
✅ Epoch 2: New best model saved with val_loss = 1.2180
Epoch 2, accuracy: 0.6870
Epoch 2, Train Loss: 1.5061, Val Loss: 1.2180
Epoch 3, accuracy: 0.4330
Epoch 4, accuracy: 0.6060
Epoch 4, Train Loss: 0.7203, Val Loss: 1.7525
✅ Epoch 5: New best model saved with val_loss = 1.1976
Epoch 5, accuracy: 0.6780
Epoch 6, accuracy: 0.4240
Epoch 6, Train Loss: 0.1885, Val Loss: 2.1280
Epoch 7, accuracy: 0.5480
Epoch 8, accuracy: 0.5530
Epoch 8, Train Loss: 0.2451, Val Loss: 1.5828
Epoch 9, accuracy: 0.5620
Epoch 10, accuracy: 0.5850
Epoch 10, Train Loss: 0.1749, Val Loss: 1.4860
Epoch 11, accuracy: 0.6050
Epoch 12, accuracy: 0.6070
Epoch 12, Train Loss: 0.1180, Val Loss: 1.4996
Epoch 13, accuracy: 0.6070
Epoch 14, accuracy: 0.6080
Epoch 14, Train Loss: 0.1353, Val Loss: 1.4979
Epoch 15, accuracy: 0.6080
Epoch 16, accuracy: 0.6100
Epoch 16, Train Loss: 0.1110, Val Loss: 1.4957
Epoch 17, accuracy: 0.6150
Epoch 18, accuracy: 0.6150
Epoch 18, Train Loss: 0.1006, Val Loss: 1.4962
Epoch 19, accuracy: 0.6140
Epoch 20, accuracy: 0.6130
Epoch 20, Train Loss: 0.0929, Val Loss: 1.4973
Epoch 21, accuracy: 0.6140
Epoch 22, accuracy: 0.6130
Epoch 22, Train Loss: 0.0992, Val Loss: 1.4985
Epoch 23, accuracy: 0.6120
Epoch 24, accuracy: 0.6120
Epoch 24, Train Loss: 0.1049, Val Loss: 1.4989
Epoch 25, accuracy: 0.6130
Epoch 26, accuracy: 0.6130
Epoch 26, Train Loss: 0.1061, Val Loss: 1.4991
Epoch 27, accuracy: 0.6130
Epoch 28, accuracy: 0.6130
Epoch 28, Train Loss: 0.0901, Val Loss: 1.4993
Epoch 29, accuracy: 0.6130
Epoch 30, accuracy: 0.6130
Epoch 30, Train Loss: 0.0871, Val Loss: 1.4994
Epoch 31, accuracy: 0.6130
Epoch 32, accuracy: 0.6130
Epoch 32, Train Loss: 0.1062, Val Loss: 1.4995
Epoch 33, accuracy: 0.6130
Epoch 34, accuracy: 0.6130
Epoch 34, Train Loss: 0.0976, Val Loss: 1.4995
Epoch 35, accuracy: 0.6130
Epoch 36, accuracy: 0.6130
Epoch 36, Train Loss: 0.0991, Val Loss: 1.4995
Epoch 37, accuracy: 0.6130
Epoch 38, accuracy: 0.6130
Epoch 38, Train Loss: 0.0999, Val Loss: 1.4995
Epoch 39, accuracy: 0.6130
Epoch 40, accuracy: 0.6130
Epoch 40, Train Loss: 0.0904, Val Loss: 1.4995
Epoch 41, accuracy: 0.6130
Epoch 42, accuracy: 0.6130
Epoch 42, Train Loss: 0.0914, Val Loss: 1.4995
Epoch 43, accuracy: 0.6130
Epoch 44, accuracy: 0.6130
Epoch 44, Train Loss: 0.0953, Val Loss: 1.4995
Epoch 45, accuracy: 0.6130
Epoch 46, accuracy: 0.6130
Epoch 46, Train Loss: 0.0924, Val Loss: 1.4995
Epoch 47, accuracy: 0.6130
Epoch 48, accuracy: 0.6130
Epoch 48, Train Loss: 0.1059, Val Loss: 1.4995
Epoch 49, accuracy: 0.6130
Epoch 50, accuracy: 0.6130
Epoch 50, Train Loss: 0.1131, Val Loss: 1.4995
Epoch 51, accuracy: 0.6130
Epoch 52, accuracy: 0.6130
Epoch 52, Train Loss: 0.1010, Val Loss: 1.4995
Epoch 53, accuracy: 0.6130
Epoch 54, accuracy: 0.6130
Epoch 54, Train Loss: 0.0995, Val Loss: 1.4995
Epoch 55, accuracy: 0.6130
Epoch 56, accuracy: 0.6130
Epoch 56, Train Loss: 0.0795, Val Loss: 1.4995
Epoch 57, accuracy: 0.6130
Epoch 58, accuracy: 0.6130
Epoch 58, Train Loss: 0.1062, Val Loss: 1.4995
Epoch 59, accuracy: 0.6130
Epoch 60, accuracy: 0.6130
Epoch 60, Train Loss: 0.0917, Val Loss: 1.4995
Epoch 61, accuracy: 0.6130
Epoch 62, accuracy: 0.6130
Epoch 62, Train Loss: 0.1055, Val Loss: 1.4995
Epoch 63, accuracy: 0.6130
Epoch 64, accuracy: 0.6130
Epoch 64, Train Loss: 0.0999, Val Loss: 1.4995
Epoch 65, accuracy: 0.6130
Epoch 66, accuracy: 0.6130
Epoch 66, Train Loss: 0.1022, Val Loss: 1.4995
Epoch 67, accuracy: 0.6130
Epoch 68, accuracy: 0.6130
Epoch 68, Train Loss: 0.0955, Val Loss: 1.4995
Epoch 69, accuracy: 0.6130
Epoch 70, accuracy: 0.6130
Epoch 70, Train Loss: 0.1058, Val Loss: 1.4995
Epoch 71, accuracy: 0.6130
Epoch 72, accuracy: 0.6130
Epoch 72, Train Loss: 0.0937, Val Loss: 1.4995
Epoch 73, accuracy: 0.6130
Epoch 74, accuracy: 0.6130
Epoch 74, Train Loss: 0.0957, Val Loss: 1.4995
Epoch 75, accuracy: 0.6130
Epoch 76, accuracy: 0.6130
Epoch 76, Train Loss: 0.0782, Val Loss: 1.4995
Epoch 77, accuracy: 0.6130
Epoch 78, accuracy: 0.6130
Epoch 78, Train Loss: 0.0885, Val Loss: 1.4995
Epoch 79, accuracy: 0.6130
Epoch 80, accuracy: 0.6130
Epoch 80, Train Loss: 0.1041, Val Loss: 1.4995
Epoch 81, accuracy: 0.6130
Epoch 82, accuracy: 0.6130
Epoch 82, Train Loss: 0.0943, Val Loss: 1.4995
Epoch 83, accuracy: 0.6130
Epoch 84, accuracy: 0.6130
Epoch 84, Train Loss: 0.1086, Val Loss: 1.4995
Epoch 85, accuracy: 0.6130
Epoch 86, accuracy: 0.6130
Epoch 86, Train Loss: 0.1044, Val Loss: 1.4995
Epoch 87, accuracy: 0.6130
Epoch 88, accuracy: 0.6130
Epoch 88, Train Loss: 0.1031, Val Loss: 1.4995
Epoch 89, accuracy: 0.6130
Epoch 90, accuracy: 0.6130
Epoch 90, Train Loss: 0.1073, Val Loss: 1.4995
Epoch 91, accuracy: 0.6130
Epoch 92, accuracy: 0.6130
Epoch 92, Train Loss: 0.0912, Val Loss: 1.4995
Epoch 93, accuracy: 0.6130
Epoch 94, accuracy: 0.6130
Epoch 94, Train Loss: 0.0970, Val Loss: 1.4995
Epoch 95, accuracy: 0.6130
Epoch 96, accuracy: 0.6130
Epoch 96, Train Loss: 0.0989, Val Loss: 1.4995
Epoch 97, accuracy: 0.6130
Epoch 98, accuracy: 0.6130
Epoch 98, Train Loss: 0.0882, Val Loss: 1.4995
Epoch 99, accuracy: 0.6130
Epoch 100, accuracy: 0.6130
Epoch 100, Train Loss: 0.1146, Val Loss: 1.4995
Epoch 101, accuracy: 0.6130
Epoch 102, accuracy: 0.6130
Epoch 102, Train Loss: 0.0962, Val Loss: 1.4995
Epoch 103, accuracy: 0.6130
Epoch 104, accuracy: 0.6130
Epoch 104, Train Loss: 0.1146, Val Loss: 1.4995
Epoch 105, accuracy: 0.6130
Epoch 106, accuracy: 0.6130
Epoch 106, Train Loss: 0.0923, Val Loss: 1.4995
Epoch 107, accuracy: 0.6130
Epoch 108, accuracy: 0.6130
Epoch 108, Train Loss: 0.1056, Val Loss: 1.4995
Epoch 109, accuracy: 0.6130
Epoch 110, accuracy: 0.6130
Epoch 110, Train Loss: 0.0936, Val Loss: 1.4995
Epoch 111, accuracy: 0.6130
Epoch 112, accuracy: 0.6130
Epoch 112, Train Loss: 0.1052, Val Loss: 1.4995
Epoch 113, accuracy: 0.6130
Epoch 114, accuracy: 0.6130
Epoch 114, Train Loss: 0.1009, Val Loss: 1.4995
Epoch 115, accuracy: 0.6130
Epoch 116, accuracy: 0.6130
Epoch 116, Train Loss: 0.0893, Val Loss: 1.4995
Epoch 117, accuracy: 0.6130
Epoch 118, accuracy: 0.6130
Epoch 118, Train Loss: 0.0923, Val Loss: 1.4995
Epoch 119, accuracy: 0.6130
Epoch 120, accuracy: 0.6130
Epoch 120, Train Loss: 0.0884, Val Loss: 1.4995
Epoch 121, accuracy: 0.6130
Epoch 122, accuracy: 0.6130
Epoch 122, Train Loss: 0.1016, Val Loss: 1.4995
Epoch 123, accuracy: 0.6130
Epoch 124, accuracy: 0.6130
Epoch 124, Train Loss: 0.1005, Val Loss: 1.4995
Epoch 125, accuracy: 0.6130
Epoch 126, accuracy: 0.6130
Epoch 126, Train Loss: 0.0825, Val Loss: 1.4995
Epoch 127, accuracy: 0.6130
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 128, accuracy: 0.6130
Epoch 128, Train Loss: 0.0999, Val Loss: 1.4995
Epoch 129, accuracy: 0.6130
Epoch 130, accuracy: 0.6130
Epoch 130, Train Loss: 0.1024, Val Loss: 1.4995
Epoch 131, accuracy: 0.6130
Epoch 132, accuracy: 0.6130
Epoch 132, Train Loss: 0.0933, Val Loss: 1.4995
Epoch 133, accuracy: 0.6130
Epoch 134, accuracy: 0.6130
Epoch 134, Train Loss: 0.1036, Val Loss: 1.4995
Epoch 135, accuracy: 0.6130
Epoch 136, accuracy: 0.6130
Epoch 136, Train Loss: 0.0961, Val Loss: 1.4995
Epoch 137, accuracy: 0.6130
Epoch 138, accuracy: 0.6130
Epoch 138, Train Loss: 0.0960, Val Loss: 1.4995
Epoch 139, accuracy: 0.6130
Epoch 140, accuracy: 0.6130
Epoch 140, Train Loss: 0.0893, Val Loss: 1.4995
Epoch 141, accuracy: 0.6130
Epoch 142, accuracy: 0.6130
Epoch 142, Train Loss: 0.0896, Val Loss: 1.4995
Epoch 143, accuracy: 0.6130
Epoch 144, accuracy: 0.6130
Epoch 144, Train Loss: 0.0998, Val Loss: 1.4995
Epoch 145, accuracy: 0.6130
Epoch 146, accuracy: 0.6130
Epoch 146, Train Loss: 0.1065, Val Loss: 1.4995
Epoch 147, accuracy: 0.6130
Epoch 148, accuracy: 0.6130
Epoch 148, Train Loss: 0.0925, Val Loss: 1.4995
Epoch 149, accuracy: 0.6130
Epoch 150, accuracy: 0.6130
Epoch 150, Train Loss: 0.1092, Val Loss: 1.4995
Epoch 151, accuracy: 0.6130
Epoch 152, accuracy: 0.6130
Epoch 152, Train Loss: 0.0897, Val Loss: 1.4995
Epoch 153, accuracy: 0.6130
Epoch 154, accuracy: 0.6130
Epoch 154, Train Loss: 0.0947, Val Loss: 1.4995
Epoch 155, accuracy: 0.6130
Epoch 156, accuracy: 0.6130
Epoch 156, Train Loss: 0.0894, Val Loss: 1.4995
Epoch 157, accuracy: 0.6130
Epoch 158, accuracy: 0.6130
Epoch 158, Train Loss: 0.0899, Val Loss: 1.4995
Epoch 159, accuracy: 0.6130
Epoch 160, accuracy: 0.6130
Epoch 160, Train Loss: 0.1009, Val Loss: 1.4995
Epoch 161, accuracy: 0.6130
Epoch 162, accuracy: 0.6130
Epoch 162, Train Loss: 0.0964, Val Loss: 1.4995
Epoch 163, accuracy: 0.6130
Epoch 164, accuracy: 0.6130
Epoch 164, Train Loss: 0.0802, Val Loss: 1.4995
Epoch 165, accuracy: 0.6130
Epoch 166, accuracy: 0.6130
Epoch 166, Train Loss: 0.0966, Val Loss: 1.4995
Epoch 167, accuracy: 0.6130
Epoch 168, accuracy: 0.6130
Epoch 168, Train Loss: 0.0950, Val Loss: 1.4995
Epoch 169, accuracy: 0.6130
Epoch 170, accuracy: 0.6130
Epoch 170, Train Loss: 0.0959, Val Loss: 1.4995
Epoch 171, accuracy: 0.6130
Epoch 172, accuracy: 0.6130
Epoch 172, Train Loss: 0.0891, Val Loss: 1.4995
Epoch 173, accuracy: 0.6130
Epoch 174, accuracy: 0.6130
Epoch 174, Train Loss: 0.0931, Val Loss: 1.4995
Epoch 175, accuracy: 0.6130
Epoch 176, accuracy: 0.6130
Epoch 176, Train Loss: 0.0825, Val Loss: 1.4995
Epoch 177, accuracy: 0.6130
Epoch 178, accuracy: 0.6130
Epoch 178, Train Loss: 0.1164, Val Loss: 1.4995
Epoch 179, accuracy: 0.6130
Epoch 180, accuracy: 0.6130
Epoch 180, Train Loss: 0.0986, Val Loss: 1.4995
Epoch 181, accuracy: 0.6130
Epoch 182, accuracy: 0.6130
Epoch 182, Train Loss: 0.0879, Val Loss: 1.4995
Epoch 183, accuracy: 0.6130
Epoch 184, accuracy: 0.6130
Epoch 184, Train Loss: 0.0753, Val Loss: 1.4995
Epoch 185, accuracy: 0.6130
Epoch 186, accuracy: 0.6130
Epoch 186, Train Loss: 0.0919, Val Loss: 1.4995
Epoch 187, accuracy: 0.6130
Epoch 188, accuracy: 0.6130
Epoch 188, Train Loss: 0.0892, Val Loss: 1.4995
Epoch 189, accuracy: 0.6130
Epoch 190, accuracy: 0.6130
Epoch 190, Train Loss: 0.0894, Val Loss: 1.4995
Epoch 191, accuracy: 0.6130
Epoch 192, accuracy: 0.6130
Epoch 192, Train Loss: 0.1021, Val Loss: 1.4995
Epoch 193, accuracy: 0.6130
Epoch 194, accuracy: 0.6130
Epoch 194, Train Loss: 0.0833, Val Loss: 1.4995
Epoch 195, accuracy: 0.6130
Epoch 196, accuracy: 0.6130
Epoch 196, Train Loss: 0.1068, Val Loss: 1.4995
Epoch 197, accuracy: 0.6130
Epoch 198, accuracy: 0.6130
Epoch 198, Train Loss: 0.0975, Val Loss: 1.4995
Epoch 199, accuracy: 0.6130
Loaded best model with val_loss = 1.19755220413208
test :accuracy 0.6780, f1_macro: 0.6399, f1_micro: 0.6780, auc: 0.8775
Training GAT with 6 layers...
可训练参数: 2026270_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.7894
Epoch 0, accuracy: 0.3170
Epoch 0, Train Loss: 1.7965, Val Loss: 1.7894
✅ Epoch 1: New best model saved with val_loss = 1.7295
Epoch 1, accuracy: 0.2720
✅ Epoch 2: New best model saved with val_loss = 1.4490
Epoch 2, accuracy: 0.5450
Epoch 2, Train Loss: 1.6332, Val Loss: 1.4490
Epoch 3, accuracy: 0.2640
✅ Epoch 4: New best model saved with val_loss = 1.1756
Epoch 4, accuracy: 0.6530
Epoch 4, Train Loss: 1.4299, Val Loss: 1.1756
Epoch 5, accuracy: 0.5590
✅ Epoch 6: New best model saved with val_loss = 1.0891
Epoch 6, accuracy: 0.6180
Epoch 6, Train Loss: 1.1831, Val Loss: 1.0891
✅ Epoch 7: New best model saved with val_loss = 1.0415
Epoch 7, accuracy: 0.6590
Epoch 8, accuracy: 0.6900
Epoch 8, Train Loss: 0.6582, Val Loss: 1.0566
Epoch 9, accuracy: 0.6840
Epoch 10, accuracy: 0.6210
Epoch 10, Train Loss: 0.4588, Val Loss: 1.1696
Epoch 11, accuracy: 0.6100
Epoch 12, accuracy: 0.6150
Epoch 12, Train Loss: 0.2697, Val Loss: 1.4644
Epoch 13, accuracy: 0.5830
Epoch 14, accuracy: 0.5790
Epoch 14, Train Loss: 0.1541, Val Loss: 1.8156
Epoch 15, accuracy: 0.5760
Epoch 16, accuracy: 0.5740
Epoch 16, Train Loss: 0.1279, Val Loss: 1.8699
Epoch 17, accuracy: 0.5690
Epoch 18, accuracy: 0.5680
Epoch 18, Train Loss: 0.1766, Val Loss: 1.8975
Epoch 19, accuracy: 0.5690
Epoch 20, accuracy: 0.5680
Epoch 20, Train Loss: 0.1168, Val Loss: 1.9062
Epoch 21, accuracy: 0.5670
Epoch 22, accuracy: 0.5670
Epoch 22, Train Loss: 0.2224, Val Loss: 1.9057
Epoch 23, accuracy: 0.5680
Epoch 24, accuracy: 0.5680
Epoch 24, Train Loss: 0.1252, Val Loss: 1.9034
Epoch 25, accuracy: 0.5700
Epoch 26, accuracy: 0.5700
Epoch 26, Train Loss: 0.1219, Val Loss: 1.9014
Epoch 27, accuracy: 0.5700
Epoch 28, accuracy: 0.5700
Epoch 28, Train Loss: 0.1146, Val Loss: 1.9011
Epoch 29, accuracy: 0.5700
Epoch 30, accuracy: 0.5700
Epoch 30, Train Loss: 0.1066, Val Loss: 1.9008
Epoch 31, accuracy: 0.5700
Epoch 32, accuracy: 0.5700
Epoch 32, Train Loss: 0.1095, Val Loss: 1.9007
Epoch 33, accuracy: 0.5700
Epoch 34, accuracy: 0.5700
Epoch 34, Train Loss: 0.1622, Val Loss: 1.9006
Epoch 35, accuracy: 0.5700
Epoch 36, accuracy: 0.5700
Epoch 36, Train Loss: 0.1225, Val Loss: 1.9006
Epoch 37, accuracy: 0.5700
Epoch 38, accuracy: 0.5700
Epoch 38, Train Loss: 0.1372, Val Loss: 1.9005
Epoch 39, accuracy: 0.5700
Epoch 40, accuracy: 0.5700
Epoch 40, Train Loss: 0.2596, Val Loss: 1.9005
Epoch 41, accuracy: 0.5700
Epoch 42, accuracy: 0.5700
Epoch 42, Train Loss: 0.1249, Val Loss: 1.9005
Epoch 43, accuracy: 0.5700
Epoch 44, accuracy: 0.5700
Epoch 44, Train Loss: 0.1288, Val Loss: 1.9005
Epoch 45, accuracy: 0.5700
Epoch 46, accuracy: 0.5700
Epoch 46, Train Loss: 0.1184, Val Loss: 1.9005
Epoch 47, accuracy: 0.5700
Epoch 48, accuracy: 0.5700
Epoch 48, Train Loss: 0.1380, Val Loss: 1.9005
Epoch 49, accuracy: 0.5700
Epoch 50, accuracy: 0.5700
Epoch 50, Train Loss: 0.1112, Val Loss: 1.9005
Epoch 51, accuracy: 0.5700
Epoch 52, accuracy: 0.5700
Epoch 52, Train Loss: 0.1225, Val Loss: 1.9005
Epoch 53, accuracy: 0.5700
Epoch 54, accuracy: 0.5700
Epoch 54, Train Loss: 0.1161, Val Loss: 1.9005
Epoch 55, accuracy: 0.5700
Epoch 56, accuracy: 0.5700
Epoch 56, Train Loss: 0.1430, Val Loss: 1.9005
Epoch 57, accuracy: 0.5700
Epoch 58, accuracy: 0.5700
Epoch 58, Train Loss: 0.1069, Val Loss: 1.9005
Epoch 59, accuracy: 0.5700
Epoch 60, accuracy: 0.5700
Epoch 60, Train Loss: 0.1137, Val Loss: 1.9005
Epoch 61, accuracy: 0.5700
Epoch 62, accuracy: 0.5700
Epoch 62, Train Loss: 0.1408, Val Loss: 1.9005
Epoch 63, accuracy: 0.5700
Epoch 64, accuracy: 0.5700
Epoch 64, Train Loss: 0.1165, Val Loss: 1.9005
Epoch 65, accuracy: 0.5700
Epoch 66, accuracy: 0.5700
Epoch 66, Train Loss: 0.1314, Val Loss: 1.9005
Epoch 67, accuracy: 0.5700
Epoch 68, accuracy: 0.5700
Epoch 68, Train Loss: 0.1610, Val Loss: 1.9005
Epoch 69, accuracy: 0.5700
Epoch 70, accuracy: 0.5700
Epoch 70, Train Loss: 0.1860, Val Loss: 1.9005
Epoch 71, accuracy: 0.5700
Epoch 72, accuracy: 0.5700
Epoch 72, Train Loss: 0.1228, Val Loss: 1.9005
Epoch 73, accuracy: 0.5700
Epoch 74, accuracy: 0.5700
Epoch 74, Train Loss: 0.1410, Val Loss: 1.9005
Epoch 75, accuracy: 0.5700
Epoch 76, accuracy: 0.5700
Epoch 76, Train Loss: 0.1568, Val Loss: 1.9005
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 77, accuracy: 0.5700
Epoch 78, accuracy: 0.5700
Epoch 78, Train Loss: 0.1466, Val Loss: 1.9005
Epoch 79, accuracy: 0.5700
Epoch 80, accuracy: 0.5700
Epoch 80, Train Loss: 0.1847, Val Loss: 1.9005
Epoch 81, accuracy: 0.5700
Epoch 82, accuracy: 0.5700
Epoch 82, Train Loss: 0.1372, Val Loss: 1.9005
Epoch 83, accuracy: 0.5700
Epoch 84, accuracy: 0.5700
Epoch 84, Train Loss: 0.1669, Val Loss: 1.9005
Epoch 85, accuracy: 0.5700
Epoch 86, accuracy: 0.5700
Epoch 86, Train Loss: 0.1699, Val Loss: 1.9005
Epoch 87, accuracy: 0.5700
Epoch 88, accuracy: 0.5700
Epoch 88, Train Loss: 0.1386, Val Loss: 1.9005
Epoch 89, accuracy: 0.5700
Epoch 90, accuracy: 0.5700
Epoch 90, Train Loss: 0.1166, Val Loss: 1.9005
Epoch 91, accuracy: 0.5700
Epoch 92, accuracy: 0.5700
Epoch 92, Train Loss: 0.1511, Val Loss: 1.9005
Epoch 93, accuracy: 0.5700
Epoch 94, accuracy: 0.5700
Epoch 94, Train Loss: 0.1256, Val Loss: 1.9005
Epoch 95, accuracy: 0.5700
Epoch 96, accuracy: 0.5710
Epoch 96, Train Loss: 0.1340, Val Loss: 1.9005
Epoch 97, accuracy: 0.5710
Epoch 98, accuracy: 0.5710
Epoch 98, Train Loss: 0.1537, Val Loss: 1.9005
Epoch 99, accuracy: 0.5710
Epoch 100, accuracy: 0.5710
Epoch 100, Train Loss: 0.1081, Val Loss: 1.9005
Epoch 101, accuracy: 0.5710
Epoch 102, accuracy: 0.5710
Epoch 102, Train Loss: 0.1518, Val Loss: 1.9005
Epoch 103, accuracy: 0.5710
Epoch 104, accuracy: 0.5710
Epoch 104, Train Loss: 0.1287, Val Loss: 1.9005
Epoch 105, accuracy: 0.5710
Epoch 106, accuracy: 0.5710
Epoch 106, Train Loss: 0.1307, Val Loss: 1.9005
Epoch 107, accuracy: 0.5710
Epoch 108, accuracy: 0.5710
Epoch 108, Train Loss: 0.1272, Val Loss: 1.9005
Epoch 109, accuracy: 0.5710
Epoch 110, accuracy: 0.5710
Epoch 110, Train Loss: 0.1314, Val Loss: 1.9005
Epoch 111, accuracy: 0.5710
Epoch 112, accuracy: 0.5710
Epoch 112, Train Loss: 0.1107, Val Loss: 1.9005
Epoch 113, accuracy: 0.5710
Epoch 114, accuracy: 0.5710
Epoch 114, Train Loss: 0.1130, Val Loss: 1.9005
Epoch 115, accuracy: 0.5710
Epoch 116, accuracy: 0.5710
Epoch 116, Train Loss: 0.1547, Val Loss: 1.9005
Epoch 117, accuracy: 0.5710
Epoch 118, accuracy: 0.5710
Epoch 118, Train Loss: 0.1188, Val Loss: 1.9005
Epoch 119, accuracy: 0.5710
Epoch 120, accuracy: 0.5710
Epoch 120, Train Loss: 0.1253, Val Loss: 1.9005
Epoch 121, accuracy: 0.5710
Epoch 122, accuracy: 0.5710
Epoch 122, Train Loss: 0.1429, Val Loss: 1.9005
Epoch 123, accuracy: 0.5710
Epoch 124, accuracy: 0.5710
Epoch 124, Train Loss: 0.1587, Val Loss: 1.9005
Epoch 125, accuracy: 0.5710
Epoch 126, accuracy: 0.5710
Epoch 126, Train Loss: 0.1084, Val Loss: 1.9005
Epoch 127, accuracy: 0.5710
Epoch 128, accuracy: 0.5710
Epoch 128, Train Loss: 0.1123, Val Loss: 1.9005
Epoch 129, accuracy: 0.5710
Epoch 130, accuracy: 0.5710
Epoch 130, Train Loss: 0.1218, Val Loss: 1.9005
Epoch 131, accuracy: 0.5710
Epoch 132, accuracy: 0.5710
Epoch 132, Train Loss: 0.1214, Val Loss: 1.9005
Epoch 133, accuracy: 0.5710
Epoch 134, accuracy: 0.5710
Epoch 134, Train Loss: 0.1445, Val Loss: 1.9005
Epoch 135, accuracy: 0.5710
Epoch 136, accuracy: 0.5710
Epoch 136, Train Loss: 0.1305, Val Loss: 1.9005
Epoch 137, accuracy: 0.5710
Epoch 138, accuracy: 0.5710
Epoch 138, Train Loss: 0.1293, Val Loss: 1.9005
Epoch 139, accuracy: 0.5710
Epoch 140, accuracy: 0.5710
Epoch 140, Train Loss: 0.1150, Val Loss: 1.9005
Epoch 141, accuracy: 0.5710
Epoch 142, accuracy: 0.5710
Epoch 142, Train Loss: 0.1106, Val Loss: 1.9005
Epoch 143, accuracy: 0.5710
Epoch 144, accuracy: 0.5710
Epoch 144, Train Loss: 0.1256, Val Loss: 1.9005
Epoch 145, accuracy: 0.5710
Epoch 146, accuracy: 0.5710
Epoch 146, Train Loss: 0.1195, Val Loss: 1.9005
Epoch 147, accuracy: 0.5710
Epoch 148, accuracy: 0.5710
Epoch 148, Train Loss: 0.1321, Val Loss: 1.9005
Epoch 149, accuracy: 0.5710
Epoch 150, accuracy: 0.5710
Epoch 150, Train Loss: 0.1185, Val Loss: 1.9005
Epoch 151, accuracy: 0.5710
Epoch 152, accuracy: 0.5710
Epoch 152, Train Loss: 0.1091, Val Loss: 1.9005
Epoch 153, accuracy: 0.5710
Epoch 154, accuracy: 0.5710
Epoch 154, Train Loss: 0.1345, Val Loss: 1.9005
Epoch 155, accuracy: 0.5710
Epoch 156, accuracy: 0.5710
Epoch 156, Train Loss: 0.1301, Val Loss: 1.9005
Epoch 157, accuracy: 0.5710
Epoch 158, accuracy: 0.5710
Epoch 158, Train Loss: 0.1273, Val Loss: 1.9005
Epoch 159, accuracy: 0.5710
Epoch 160, accuracy: 0.5710
Epoch 160, Train Loss: 0.1454, Val Loss: 1.9005
Epoch 161, accuracy: 0.5710
Epoch 162, accuracy: 0.5710
Epoch 162, Train Loss: 0.1289, Val Loss: 1.9005
Epoch 163, accuracy: 0.5710
Epoch 164, accuracy: 0.5710
Epoch 164, Train Loss: 0.1381, Val Loss: 1.9005
Epoch 165, accuracy: 0.5710
Epoch 166, accuracy: 0.5710
Epoch 166, Train Loss: 0.1384, Val Loss: 1.9005
Epoch 167, accuracy: 0.5710
Epoch 168, accuracy: 0.5710
Epoch 168, Train Loss: 0.1168, Val Loss: 1.9005
Epoch 169, accuracy: 0.5710
Epoch 170, accuracy: 0.5710
Epoch 170, Train Loss: 0.1176, Val Loss: 1.9005
Epoch 171, accuracy: 0.5710
Epoch 172, accuracy: 0.5710
Epoch 172, Train Loss: 0.1086, Val Loss: 1.9005
Epoch 173, accuracy: 0.5710
Epoch 174, accuracy: 0.5710
Epoch 174, Train Loss: 0.1414, Val Loss: 1.9005
Epoch 175, accuracy: 0.5710
Epoch 176, accuracy: 0.5710
Epoch 176, Train Loss: 0.1316, Val Loss: 1.9005
Epoch 177, accuracy: 0.5710
Epoch 178, accuracy: 0.5710
Epoch 178, Train Loss: 0.1093, Val Loss: 1.9005
Epoch 179, accuracy: 0.5710
Epoch 180, accuracy: 0.5710
Epoch 180, Train Loss: 0.1192, Val Loss: 1.9005
Epoch 181, accuracy: 0.5710
Epoch 182, accuracy: 0.5710
Epoch 182, Train Loss: 0.1278, Val Loss: 1.9005
Epoch 183, accuracy: 0.5710
Epoch 184, accuracy: 0.5710
Epoch 184, Train Loss: 0.2031, Val Loss: 1.9005
Epoch 185, accuracy: 0.5710
Epoch 186, accuracy: 0.5710
Epoch 186, Train Loss: 0.1379, Val Loss: 1.9005
Epoch 187, accuracy: 0.5710
Epoch 188, accuracy: 0.5710
Epoch 188, Train Loss: 0.2210, Val Loss: 1.9005
Epoch 189, accuracy: 0.5710
Epoch 190, accuracy: 0.5710
Epoch 190, Train Loss: 0.1694, Val Loss: 1.9005
Epoch 191, accuracy: 0.5710
Epoch 192, accuracy: 0.5710
Epoch 192, Train Loss: 0.1282, Val Loss: 1.9005
Epoch 193, accuracy: 0.5710
Epoch 194, accuracy: 0.5710
Epoch 194, Train Loss: 0.1432, Val Loss: 1.9005
Epoch 195, accuracy: 0.5710
Epoch 196, accuracy: 0.5710
Epoch 196, Train Loss: 0.1205, Val Loss: 1.9004
Epoch 197, accuracy: 0.5710
Epoch 198, accuracy: 0.5710
Epoch 198, Train Loss: 0.1340, Val Loss: 1.9004
Epoch 199, accuracy: 0.5710
Loaded best model with val_loss = 1.0415109395980835
test :accuracy 0.6590, f1_macro: 0.5582, f1_micro: 0.6590, auc: 0.8786
Training GAT with 7 layers...
可训练参数: 2175646_GAT
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.8264
Epoch 0, accuracy: 0.2310
Epoch 0, Train Loss: 1.7889, Val Loss: 1.8264
✅ Epoch 1: New best model saved with val_loss = 1.7750
Epoch 1, accuracy: 0.2710
✅ Epoch 2: New best model saved with val_loss = 1.6994
Epoch 2, accuracy: 0.3500
Epoch 2, Train Loss: 1.7448, Val Loss: 1.6994
✅ Epoch 3: New best model saved with val_loss = 1.5082
Epoch 3, accuracy: 0.3740
Epoch 4, accuracy: 0.3390
Epoch 4, Train Loss: 1.2797, Val Loss: 1.5118
✅ Epoch 5: New best model saved with val_loss = 1.4466
Epoch 5, accuracy: 0.4930
✅ Epoch 6: New best model saved with val_loss = 1.2585
Epoch 6, accuracy: 0.6020
Epoch 6, Train Loss: 1.2166, Val Loss: 1.2585
✅ Epoch 7: New best model saved with val_loss = 1.2155
Epoch 7, accuracy: 0.6040
Epoch 8, accuracy: 0.5040
Epoch 8, Train Loss: 0.7174, Val Loss: 1.3409
Epoch 9, accuracy: 0.5690
Epoch 10, accuracy: 0.6050
Epoch 10, Train Loss: 0.3791, Val Loss: 1.7539
Epoch 11, accuracy: 0.6110
Epoch 12, accuracy: 0.6030
Epoch 12, Train Loss: 0.2096, Val Loss: 2.8102
Epoch 13, accuracy: 0.5750
Epoch 14, accuracy: 0.5820
Epoch 14, Train Loss: 0.1652, Val Loss: 3.1544
Epoch 15, accuracy: 0.5880
Epoch 16, accuracy: 0.6110
Epoch 16, Train Loss: 0.1226, Val Loss: 3.1012
Epoch 17, accuracy: 0.6220
Epoch 18, accuracy: 0.6240
Epoch 18, Train Loss: 0.1036, Val Loss: 3.0920
Epoch 19, accuracy: 0.6240
Epoch 20, accuracy: 0.6240
Epoch 20, Train Loss: 0.1214, Val Loss: 3.1066
Epoch 21, accuracy: 0.6240
Epoch 22, accuracy: 0.6230
Epoch 22, Train Loss: 0.1238, Val Loss: 3.1081
Epoch 23, accuracy: 0.6230
Epoch 24, accuracy: 0.6230
Epoch 24, Train Loss: 0.1109, Val Loss: 3.1120
Epoch 25, accuracy: 0.6230
Epoch 26, accuracy: 0.6230
Epoch 26, Train Loss: 0.1308, Val Loss: 3.1146
Epoch 27, accuracy: 0.6230
Epoch 28, accuracy: 0.6230
Epoch 28, Train Loss: 0.1340, Val Loss: 3.1152
Epoch 29, accuracy: 0.6230
Epoch 30, accuracy: 0.6230
Epoch 30, Train Loss: 0.0884, Val Loss: 3.1159
Epoch 31, accuracy: 0.6220
Epoch 32, accuracy: 0.6220
Epoch 32, Train Loss: 0.1017, Val Loss: 3.1162
Epoch 33, accuracy: 0.6220
Epoch 34, accuracy: 0.6220
Epoch 34, Train Loss: 0.0970, Val Loss: 3.1163
Epoch 35, accuracy: 0.6220
Epoch 36, accuracy: 0.6220
Epoch 36, Train Loss: 0.1266, Val Loss: 3.1163
Epoch 37, accuracy: 0.6220
Epoch 38, accuracy: 0.6220
Epoch 38, Train Loss: 0.0817, Val Loss: 3.1163
Epoch 39, accuracy: 0.6220
Epoch 40, accuracy: 0.6220
Epoch 40, Train Loss: 0.1508, Val Loss: 3.1163
Epoch 41, accuracy: 0.6220
Epoch 42, accuracy: 0.6220
Epoch 42, Train Loss: 0.1170, Val Loss: 3.1164
Epoch 43, accuracy: 0.6220
Epoch 44, accuracy: 0.6220
Epoch 44, Train Loss: 0.1476, Val Loss: 3.1164
Epoch 45, accuracy: 0.6220
Epoch 46, accuracy: 0.6220
Epoch 46, Train Loss: 0.1229, Val Loss: 3.1164
Epoch 47, accuracy: 0.6220
Epoch 48, accuracy: 0.6220
Epoch 48, Train Loss: 0.0976, Val Loss: 3.1164
Epoch 49, accuracy: 0.6220
Epoch 50, accuracy: 0.6220
Epoch 50, Train Loss: 0.1066, Val Loss: 3.1164
Epoch 51, accuracy: 0.6220
Epoch 52, accuracy: 0.6220
Epoch 52, Train Loss: 0.1246, Val Loss: 3.1164
Epoch 53, accuracy: 0.6220
Epoch 54, accuracy: 0.6220
Epoch 54, Train Loss: 0.0882, Val Loss: 3.1164
Epoch 55, accuracy: 0.6220
Epoch 56, accuracy: 0.6220
Epoch 56, Train Loss: 0.0885, Val Loss: 3.1164
Epoch 57, accuracy: 0.6220
Epoch 58, accuracy: 0.6220
Epoch 58, Train Loss: 0.0829, Val Loss: 3.1164
Epoch 59, accuracy: 0.6220
Epoch 60, accuracy: 0.6220
Epoch 60, Train Loss: 0.0820, Val Loss: 3.1164
Epoch 61, accuracy: 0.6220
Epoch 62, accuracy: 0.6220
Epoch 62, Train Loss: 0.0980, Val Loss: 3.1164
Epoch 63, accuracy: 0.6220
Epoch 64, accuracy: 0.6220
Epoch 64, Train Loss: 0.0862, Val Loss: 3.1164
Epoch 65, accuracy: 0.6220
Epoch 66, accuracy: 0.6220
Epoch 66, Train Loss: 0.1499, Val Loss: 3.1164
Epoch 67, accuracy: 0.6220
Epoch 68, accuracy: 0.6220
Epoch 68, Train Loss: 0.1091, Val Loss: 3.1164
Epoch 69, accuracy: 0.6220
Epoch 70, accuracy: 0.6220
Epoch 70, Train Loss: 0.1522, Val Loss: 3.1164
Epoch 71, accuracy: 0.6220
Epoch 72, accuracy: 0.6220
Epoch 72, Train Loss: 0.1159, Val Loss: 3.1164
Epoch 73, accuracy: 0.6220
Epoch 74, accuracy: 0.6220
Epoch 74, Train Loss: 0.1076, Val Loss: 3.1164
Epoch 75, accuracy: 0.6220
Epoch 76, accuracy: 0.6220
Epoch 76, Train Loss: 0.1219, Val Loss: 3.1164
Epoch 77, accuracy: 0.6220
Epoch 78, accuracy: 0.6220
Epoch 78, Train Loss: 0.0967, Val Loss: 3.1164
Epoch 79, accuracy: 0.6220
Epoch 80, accuracy: 0.6220
Epoch 80, Train Loss: 0.1124, Val Loss: 3.1164
Epoch 81, accuracy: 0.6220
Epoch 82, accuracy: 0.6220
Epoch 82, Train Loss: 0.0944, Val Loss: 3.1164
Epoch 83, accuracy: 0.6220
Epoch 84, accuracy: 0.6220
Epoch 84, Train Loss: 0.1066, Val Loss: 3.1164
Epoch 85, accuracy: 0.6220
Epoch 86, accuracy: 0.6220
Epoch 86, Train Loss: 0.1087, Val Loss: 3.1164
Epoch 87, accuracy: 0.6220
Epoch 88, accuracy: 0.6220
Epoch 88, Train Loss: 0.0923, Val Loss: 3.1164
Epoch 89, accuracy: 0.6220
Epoch 90, accuracy: 0.6220
Epoch 90, Train Loss: 0.0878, Val Loss: 3.1164
Epoch 91, accuracy: 0.6220
Epoch 92, accuracy: 0.6220
Epoch 92, Train Loss: 0.0925, Val Loss: 3.1164
Epoch 93, accuracy: 0.6220
Epoch 94, accuracy: 0.6220
Epoch 94, Train Loss: 0.1454, Val Loss: 3.1164
Epoch 95, accuracy: 0.6220
Epoch 96, accuracy: 0.6220
Epoch 96, Train Loss: 0.1109, Val Loss: 3.1164
Epoch 97, accuracy: 0.6220
Epoch 98, accuracy: 0.6220
Epoch 98, Train Loss: 0.1143, Val Loss: 3.1164
Epoch 99, accuracy: 0.6220
Epoch 100, accuracy: 0.6220
Epoch 100, Train Loss: 0.1205, Val Loss: 3.1164
Epoch 101, accuracy: 0.6220
Epoch 102, accuracy: 0.6220
Epoch 102, Train Loss: 0.1150, Val Loss: 3.1164
Epoch 103, accuracy: 0.6220
Epoch 104, accuracy: 0.6220
Epoch 104, Train Loss: 0.1112, Val Loss: 3.1164
Epoch 105, accuracy: 0.6220
Epoch 106, accuracy: 0.6220
Epoch 106, Train Loss: 0.0653, Val Loss: 3.1164
Epoch 107, accuracy: 0.6220
Epoch 108, accuracy: 0.6220
Epoch 108, Train Loss: 0.0884, Val Loss: 3.1164
Epoch 109, accuracy: 0.6220
Epoch 110, accuracy: 0.6220
Epoch 110, Train Loss: 0.0921, Val Loss: 3.1164
Epoch 111, accuracy: 0.6220
Epoch 112, accuracy: 0.6220
Epoch 112, Train Loss: 0.1046, Val Loss: 3.1164
Epoch 113, accuracy: 0.6220
Epoch 114, accuracy: 0.6220
Epoch 114, Train Loss: 0.1090, Val Loss: 3.1164
Epoch 115, accuracy: 0.6220
Epoch 116, accuracy: 0.6220
Epoch 116, Train Loss: 0.1010, Val Loss: 3.1164
Epoch 117, accuracy: 0.6220
Epoch 118, accuracy: 0.6220
Epoch 118, Train Loss: 0.1395, Val Loss: 3.1164
Epoch 119, accuracy: 0.6220
Epoch 120, accuracy: 0.6220
Epoch 120, Train Loss: 0.0774, Val Loss: 3.1164
Epoch 121, accuracy: 0.6220
Epoch 122, accuracy: 0.6220
Epoch 122, Train Loss: 0.0803, Val Loss: 3.1164
Epoch 123, accuracy: 0.6220
Epoch 124, accuracy: 0.6220
Epoch 124, Train Loss: 0.0920, Val Loss: 3.1164
Epoch 125, accuracy: 0.6220
Epoch 126, accuracy: 0.6220
Epoch 126, Train Loss: 0.1030, Val Loss: 3.1164
Epoch 127, accuracy: 0.6220
Epoch 128, accuracy: 0.6220
Epoch 128, Train Loss: 0.1207, Val Loss: 3.1164
Epoch 129, accuracy: 0.6220
Epoch 130, accuracy: 0.6220
Epoch 130, Train Loss: 0.1042, Val Loss: 3.1164
Epoch 131, accuracy: 0.6220
Epoch 132, accuracy: 0.6220
Epoch 132, Train Loss: 0.1289, Val Loss: 3.1164
Epoch 133, accuracy: 0.6220
Epoch 134, accuracy: 0.6220
Epoch 134, Train Loss: 0.1385, Val Loss: 3.1164
Epoch 135, accuracy: 0.6220
Epoch 136, accuracy: 0.6220
Epoch 136, Train Loss: 0.1063, Val Loss: 3.1164
Epoch 137, accuracy: 0.6220
Epoch 138, accuracy: 0.6220
Epoch 138, Train Loss: 0.0881, Val Loss: 3.1164
Epoch 139, accuracy: 0.6220
Epoch 140, accuracy: 0.6220
Epoch 140, Train Loss: 0.0856, Val Loss: 3.1164
Epoch 141, accuracy: 0.6220
Epoch 142, accuracy: 0.6220
Epoch 142, Train Loss: 0.0930, Val Loss: 3.1164
Epoch 143, accuracy: 0.6220
Epoch 144, accuracy: 0.6220
Epoch 144, Train Loss: 0.1040, Val Loss: 3.1164
Epoch 145, accuracy: 0.6220
Epoch 146, accuracy: 0.6220
Epoch 146, Train Loss: 0.1445, Val Loss: 3.1164
Epoch 147, accuracy: 0.6220
Epoch 148, accuracy: 0.6220
Epoch 148, Train Loss: 0.1065, Val Loss: 3.1164
Epoch 149, accuracy: 0.6220
Epoch 150, accuracy: 0.6220
Epoch 150, Train Loss: 0.0921, Val Loss: 3.1164
Epoch 151, accuracy: 0.6220
Epoch 152, accuracy: 0.6220
Epoch 152, Train Loss: 0.0895, Val Loss: 3.1164
Epoch 153, accuracy: 0.6220
Epoch 154, accuracy: 0.6220
Epoch 154, Train Loss: 0.1176, Val Loss: 3.1164
Epoch 155, accuracy: 0.6220
Epoch 156, accuracy: 0.6220
Epoch 156, Train Loss: 0.1854, Val Loss: 3.1164
Epoch 157, accuracy: 0.6220
Epoch 158, accuracy: 0.6220
Epoch 158, Train Loss: 0.1566, Val Loss: 3.1164
Epoch 159, accuracy: 0.6220
Epoch 160, accuracy: 0.6220
Epoch 160, Train Loss: 0.1128, Val Loss: 3.1164
Epoch 161, accuracy: 0.6220
Epoch 162, accuracy: 0.6220
Epoch 162, Train Loss: 0.0871, Val Loss: 3.1164
Epoch 163, accuracy: 0.6220
Epoch 164, accuracy: 0.6220
Epoch 164, Train Loss: 0.1100, Val Loss: 3.1164
Epoch 165, accuracy: 0.6220
Epoch 166, accuracy: 0.6220
Epoch 166, Train Loss: 0.1154, Val Loss: 3.1164
Epoch 167, accuracy: 0.6220
Epoch 168, accuracy: 0.6220
Epoch 168, Train Loss: 0.0918, Val Loss: 3.1164
Epoch 169, accuracy: 0.6220
Epoch 170, accuracy: 0.6220
Epoch 170, Train Loss: 0.0707, Val Loss: 3.1164
Epoch 171, accuracy: 0.6220
Epoch 172, accuracy: 0.6220
Epoch 172, Train Loss: 0.1687, Val Loss: 3.1164
Epoch 173, accuracy: 0.6220
Epoch 174, accuracy: 0.6220
Epoch 174, Train Loss: 0.0985, Val Loss: 3.1164
Epoch 175, accuracy: 0.6220
Epoch 176, accuracy: 0.6220
Epoch 176, Train Loss: 0.1635, Val Loss: 3.1164
Epoch 177, accuracy: 0.6220
Epoch 178, accuracy: 0.6220
Epoch 178, Train Loss: 0.1199, Val Loss: 3.1164
Epoch 179, accuracy: 0.6220
Epoch 180, accuracy: 0.6220
Epoch 180, Train Loss: 0.1100, Val Loss: 3.1164
Epoch 181, accuracy: 0.6220
Epoch 182, accuracy: 0.6220
Epoch 182, Train Loss: 0.1151, Val Loss: 3.1164
Epoch 183, accuracy: 0.6220
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 184, accuracy: 0.6220
Epoch 184, Train Loss: 0.1231, Val Loss: 3.1164
Epoch 185, accuracy: 0.6220
Epoch 186, accuracy: 0.6220
Epoch 186, Train Loss: 0.0875, Val Loss: 3.1164
Epoch 187, accuracy: 0.6220
Epoch 188, accuracy: 0.6220
Epoch 188, Train Loss: 0.1215, Val Loss: 3.1164
Epoch 189, accuracy: 0.6220
Epoch 190, accuracy: 0.6220
Epoch 190, Train Loss: 0.1031, Val Loss: 3.1164
Epoch 191, accuracy: 0.6220
Epoch 192, accuracy: 0.6220
Epoch 192, Train Loss: 0.1095, Val Loss: 3.1164
Epoch 193, accuracy: 0.6220
Epoch 194, accuracy: 0.6220
Epoch 194, Train Loss: 0.1371, Val Loss: 3.1164
Epoch 195, accuracy: 0.6220
Epoch 196, accuracy: 0.6220
Epoch 196, Train Loss: 0.0893, Val Loss: 3.1164
Epoch 197, accuracy: 0.6220
Epoch 198, accuracy: 0.6220
Epoch 198, Train Loss: 0.1117, Val Loss: 3.1164
Epoch 199, accuracy: 0.6220
Loaded best model with val_loss = 1.2154971361160278
test :accuracy 0.6040, f1_macro: 0.5225, f1_micro: 0.6040, auc: 0.8657
Training mamba3 with 3 layers...
可训练参数: 1568702_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.7978
Epoch 0, accuracy: 0.1890
Epoch 0, Train Loss: 1.9143, Val Loss: 1.7978
Epoch 1, accuracy: 0.2590
✅ Epoch 2: New best model saved with val_loss = 1.5810
Epoch 2, accuracy: 0.3380
Epoch 2, Train Loss: 1.9349, Val Loss: 1.5810
✅ Epoch 3: New best model saved with val_loss = 1.4453
Epoch 3, accuracy: 0.4940
Epoch 4, accuracy: 0.5020
Epoch 4, Train Loss: 0.8885, Val Loss: 1.4582
Epoch 5, accuracy: 0.5230
✅ Epoch 6: New best model saved with val_loss = 1.3566
Epoch 6, accuracy: 0.5920
Epoch 6, Train Loss: 0.5430, Val Loss: 1.3566
✅ Epoch 7: New best model saved with val_loss = 1.2961
Epoch 7, accuracy: 0.6260
✅ Epoch 8: New best model saved with val_loss = 1.2871
Epoch 8, accuracy: 0.6290
Epoch 8, Train Loss: 0.4005, Val Loss: 1.2871
Epoch 9, accuracy: 0.6260
Epoch 10, accuracy: 0.6090
Epoch 10, Train Loss: 0.3258, Val Loss: 1.4966
Epoch 11, accuracy: 0.6050
Epoch 12, accuracy: 0.6140
Epoch 12, Train Loss: 0.2285, Val Loss: 1.5520
Epoch 13, accuracy: 0.6180
Epoch 14, accuracy: 0.6200
Epoch 14, Train Loss: 0.2376, Val Loss: 1.5965
Epoch 15, accuracy: 0.6190
Epoch 16, accuracy: 0.6160
Epoch 16, Train Loss: 0.1905, Val Loss: 1.6083
Epoch 17, accuracy: 0.6160
Epoch 18, accuracy: 0.6150
Epoch 18, Train Loss: 0.1763, Val Loss: 1.6213
Epoch 19, accuracy: 0.6170
Epoch 20, accuracy: 0.6150
Epoch 20, Train Loss: 0.1528, Val Loss: 1.6366
Epoch 21, accuracy: 0.6150
Epoch 22, accuracy: 0.6150
Epoch 22, Train Loss: 0.1717, Val Loss: 1.6383
Epoch 23, accuracy: 0.6150
Epoch 24, accuracy: 0.6150
Epoch 24, Train Loss: 0.1285, Val Loss: 1.6398
Epoch 25, accuracy: 0.6150
Epoch 26, accuracy: 0.6150
Epoch 26, Train Loss: 0.2241, Val Loss: 1.6414
Epoch 27, accuracy: 0.6150
Epoch 28, accuracy: 0.6150
Epoch 28, Train Loss: 0.1636, Val Loss: 1.6416
Epoch 29, accuracy: 0.6150
Epoch 30, accuracy: 0.6150
Epoch 30, Train Loss: 0.1569, Val Loss: 1.6418
Epoch 31, accuracy: 0.6150
Epoch 32, accuracy: 0.6150
Epoch 32, Train Loss: 0.1973, Val Loss: 1.6418
Epoch 33, accuracy: 0.6150
Epoch 34, accuracy: 0.6150
Epoch 34, Train Loss: 0.1243, Val Loss: 1.6418
Epoch 35, accuracy: 0.6150
Epoch 36, accuracy: 0.6150
Epoch 36, Train Loss: 0.1373, Val Loss: 1.6418
Epoch 37, accuracy: 0.6150
Epoch 38, accuracy: 0.6150
Epoch 38, Train Loss: 0.1699, Val Loss: 1.6418
Epoch 39, accuracy: 0.6150
Epoch 40, accuracy: 0.6150
Epoch 40, Train Loss: 0.1375, Val Loss: 1.6418
Epoch 41, accuracy: 0.6150
Epoch 42, accuracy: 0.6150
Epoch 42, Train Loss: 0.1308, Val Loss: 1.6418
Epoch 43, accuracy: 0.6150
Epoch 44, accuracy: 0.6150
Epoch 44, Train Loss: 0.1693, Val Loss: 1.6418
Epoch 45, accuracy: 0.6150
Epoch 46, accuracy: 0.6150
Epoch 46, Train Loss: 0.1319, Val Loss: 1.6418
Epoch 47, accuracy: 0.6150
Epoch 48, accuracy: 0.6150
Epoch 48, Train Loss: 0.1596, Val Loss: 1.6418
Epoch 49, accuracy: 0.6150
Epoch 50, accuracy: 0.6150
Epoch 50, Train Loss: 0.0961, Val Loss: 1.6418
Epoch 51, accuracy: 0.6150
Epoch 52, accuracy: 0.6150
Epoch 52, Train Loss: 0.1321, Val Loss: 1.6418
Epoch 53, accuracy: 0.6150
Epoch 54, accuracy: 0.6150
Epoch 54, Train Loss: 0.1258, Val Loss: 1.6418
Epoch 55, accuracy: 0.6150
Epoch 56, accuracy: 0.6150
Epoch 56, Train Loss: 0.1095, Val Loss: 1.6418
Epoch 57, accuracy: 0.6150
Epoch 58, accuracy: 0.6150
Epoch 58, Train Loss: 0.1665, Val Loss: 1.6418
Epoch 59, accuracy: 0.6150
Epoch 60, accuracy: 0.6150
Epoch 60, Train Loss: 0.1584, Val Loss: 1.6418
Epoch 61, accuracy: 0.6150
Epoch 62, accuracy: 0.6150
Epoch 62, Train Loss: 0.1458, Val Loss: 1.6418
Epoch 63, accuracy: 0.6150
Epoch 64, accuracy: 0.6150
Epoch 64, Train Loss: 0.1697, Val Loss: 1.6418
Epoch 65, accuracy: 0.6150
Epoch 66, accuracy: 0.6150
Epoch 66, Train Loss: 0.1766, Val Loss: 1.6418
Epoch 67, accuracy: 0.6150
Epoch 68, accuracy: 0.6150
Epoch 68, Train Loss: 0.1107, Val Loss: 1.6418
Epoch 69, accuracy: 0.6150
Epoch 70, accuracy: 0.6150
Epoch 70, Train Loss: 0.1279, Val Loss: 1.6418
Epoch 71, accuracy: 0.6150
Epoch 72, accuracy: 0.6150
Epoch 72, Train Loss: 0.1663, Val Loss: 1.6418
Epoch 73, accuracy: 0.6150
Epoch 74, accuracy: 0.6150
Epoch 74, Train Loss: 0.1738, Val Loss: 1.6418
Epoch 75, accuracy: 0.6150
Epoch 76, accuracy: 0.6150
Epoch 76, Train Loss: 0.1454, Val Loss: 1.6418
Epoch 77, accuracy: 0.6150
Epoch 78, accuracy: 0.6150
Epoch 78, Train Loss: 0.1346, Val Loss: 1.6418
Epoch 79, accuracy: 0.6150
Epoch 80, accuracy: 0.6150
Epoch 80, Train Loss: 0.1754, Val Loss: 1.6418
Epoch 81, accuracy: 0.6150
Epoch 82, accuracy: 0.6150
Epoch 82, Train Loss: 0.2115, Val Loss: 1.6418
Epoch 83, accuracy: 0.6150
Epoch 84, accuracy: 0.6150
Epoch 84, Train Loss: 0.1560, Val Loss: 1.6418
Epoch 85, accuracy: 0.6150
Epoch 86, accuracy: 0.6150
Epoch 86, Train Loss: 0.0808, Val Loss: 1.6418
Epoch 87, accuracy: 0.6150
Epoch 88, accuracy: 0.6150
Epoch 88, Train Loss: 0.1849, Val Loss: 1.6418
Epoch 89, accuracy: 0.6150
Epoch 90, accuracy: 0.6150
Epoch 90, Train Loss: 0.1440, Val Loss: 1.6418
Epoch 91, accuracy: 0.6150
Epoch 92, accuracy: 0.6150
Epoch 92, Train Loss: 0.1069, Val Loss: 1.6418
Epoch 93, accuracy: 0.6150
Epoch 94, accuracy: 0.6150
Epoch 94, Train Loss: 0.1510, Val Loss: 1.6418
Epoch 95, accuracy: 0.6150
Epoch 96, accuracy: 0.6150
Epoch 96, Train Loss: 0.2296, Val Loss: 1.6418
Epoch 97, accuracy: 0.6150
Epoch 98, accuracy: 0.6150
Epoch 98, Train Loss: 0.1670, Val Loss: 1.6418
Epoch 99, accuracy: 0.6150
Epoch 100, accuracy: 0.6150
Epoch 100, Train Loss: 0.1530, Val Loss: 1.6418
Epoch 101, accuracy: 0.6150
Epoch 102, accuracy: 0.6150
Epoch 102, Train Loss: 0.1660, Val Loss: 1.6418
Epoch 103, accuracy: 0.6150
Epoch 104, accuracy: 0.6150
Epoch 104, Train Loss: 0.1596, Val Loss: 1.6418
Epoch 105, accuracy: 0.6150
Epoch 106, accuracy: 0.6150
Epoch 106, Train Loss: 0.1166, Val Loss: 1.6418
Epoch 107, accuracy: 0.6150
Epoch 108, accuracy: 0.6150
Epoch 108, Train Loss: 0.1271, Val Loss: 1.6418
Epoch 109, accuracy: 0.6150
Epoch 110, accuracy: 0.6150
Epoch 110, Train Loss: 0.1292, Val Loss: 1.6418
Epoch 111, accuracy: 0.6150
Epoch 112, accuracy: 0.6150
Epoch 112, Train Loss: 0.1206, Val Loss: 1.6418
Epoch 113, accuracy: 0.6150
Epoch 114, accuracy: 0.6150
Epoch 114, Train Loss: 0.1504, Val Loss: 1.6418
Epoch 115, accuracy: 0.6150
Epoch 116, accuracy: 0.6150
Epoch 116, Train Loss: 0.1507, Val Loss: 1.6418
Epoch 117, accuracy: 0.6150
Epoch 118, accuracy: 0.6150
Epoch 118, Train Loss: 0.1271, Val Loss: 1.6418
Epoch 119, accuracy: 0.6150
Epoch 120, accuracy: 0.6150
Epoch 120, Train Loss: 0.1456, Val Loss: 1.6418
Epoch 121, accuracy: 0.6150
Epoch 122, accuracy: 0.6150
Epoch 122, Train Loss: 0.1472, Val Loss: 1.6418
Epoch 123, accuracy: 0.6150
Epoch 124, accuracy: 0.6150
Epoch 124, Train Loss: 0.1094, Val Loss: 1.6418
Epoch 125, accuracy: 0.6150
Epoch 126, accuracy: 0.6150
Epoch 126, Train Loss: 0.1400, Val Loss: 1.6418
Epoch 127, accuracy: 0.6150
Epoch 128, accuracy: 0.6150
Epoch 128, Train Loss: 0.1505, Val Loss: 1.6418
Epoch 129, accuracy: 0.6150
Epoch 130, accuracy: 0.6150
Epoch 130, Train Loss: 0.1603, Val Loss: 1.6418
Epoch 131, accuracy: 0.6150
Epoch 132, accuracy: 0.6150
Epoch 132, Train Loss: 0.1897, Val Loss: 1.6418
Epoch 133, accuracy: 0.6150
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 134, accuracy: 0.6150
Epoch 134, Train Loss: 0.1522, Val Loss: 1.6418
Epoch 135, accuracy: 0.6150
Epoch 136, accuracy: 0.6150
Epoch 136, Train Loss: 0.1223, Val Loss: 1.6418
Epoch 137, accuracy: 0.6150
Epoch 138, accuracy: 0.6150
Epoch 138, Train Loss: 0.1497, Val Loss: 1.6418
Epoch 139, accuracy: 0.6150
Epoch 140, accuracy: 0.6150
Epoch 140, Train Loss: 0.2082, Val Loss: 1.6418
Epoch 141, accuracy: 0.6150
Epoch 142, accuracy: 0.6150
Epoch 142, Train Loss: 0.1354, Val Loss: 1.6418
Epoch 143, accuracy: 0.6150
Epoch 144, accuracy: 0.6150
Epoch 144, Train Loss: 0.1189, Val Loss: 1.6418
Epoch 145, accuracy: 0.6150
Epoch 146, accuracy: 0.6150
Epoch 146, Train Loss: 0.1376, Val Loss: 1.6418
Epoch 147, accuracy: 0.6150
Epoch 148, accuracy: 0.6150
Epoch 148, Train Loss: 0.0971, Val Loss: 1.6418
Epoch 149, accuracy: 0.6150
Epoch 150, accuracy: 0.6150
Epoch 150, Train Loss: 0.1430, Val Loss: 1.6418
Epoch 151, accuracy: 0.6150
Epoch 152, accuracy: 0.6150
Epoch 152, Train Loss: 0.1122, Val Loss: 1.6418
Epoch 153, accuracy: 0.6150
Epoch 154, accuracy: 0.6150
Epoch 154, Train Loss: 0.2303, Val Loss: 1.6418
Epoch 155, accuracy: 0.6150
Epoch 156, accuracy: 0.6150
Epoch 156, Train Loss: 0.1336, Val Loss: 1.6418
Epoch 157, accuracy: 0.6150
Epoch 158, accuracy: 0.6150
Epoch 158, Train Loss: 0.2071, Val Loss: 1.6418
Epoch 159, accuracy: 0.6150
Epoch 160, accuracy: 0.6150
Epoch 160, Train Loss: 0.1146, Val Loss: 1.6418
Epoch 161, accuracy: 0.6150
Epoch 162, accuracy: 0.6150
Epoch 162, Train Loss: 0.1719, Val Loss: 1.6418
Epoch 163, accuracy: 0.6150
Epoch 164, accuracy: 0.6150
Epoch 164, Train Loss: 0.1458, Val Loss: 1.6418
Epoch 165, accuracy: 0.6150
Epoch 166, accuracy: 0.6150
Epoch 166, Train Loss: 0.1708, Val Loss: 1.6418
Epoch 167, accuracy: 0.6150
Epoch 168, accuracy: 0.6150
Epoch 168, Train Loss: 0.2033, Val Loss: 1.6418
Epoch 169, accuracy: 0.6150
Epoch 170, accuracy: 0.6150
Epoch 170, Train Loss: 0.1381, Val Loss: 1.6418
Epoch 171, accuracy: 0.6150
Epoch 172, accuracy: 0.6150
Epoch 172, Train Loss: 0.1741, Val Loss: 1.6418
Epoch 173, accuracy: 0.6150
Epoch 174, accuracy: 0.6150
Epoch 174, Train Loss: 0.0995, Val Loss: 1.6418
Epoch 175, accuracy: 0.6150
Epoch 176, accuracy: 0.6150
Epoch 176, Train Loss: 0.1337, Val Loss: 1.6418
Epoch 177, accuracy: 0.6150
Epoch 178, accuracy: 0.6150
Epoch 178, Train Loss: 0.1802, Val Loss: 1.6418
Epoch 179, accuracy: 0.6150
Epoch 180, accuracy: 0.6150
Epoch 180, Train Loss: 0.1126, Val Loss: 1.6418
Epoch 181, accuracy: 0.6150
Epoch 182, accuracy: 0.6150
Epoch 182, Train Loss: 0.1351, Val Loss: 1.6418
Epoch 183, accuracy: 0.6150
Epoch 184, accuracy: 0.6150
Epoch 184, Train Loss: 0.1733, Val Loss: 1.6418
Epoch 185, accuracy: 0.6150
Epoch 186, accuracy: 0.6150
Epoch 186, Train Loss: 0.1615, Val Loss: 1.6418
Epoch 187, accuracy: 0.6150
Epoch 188, accuracy: 0.6150
Epoch 188, Train Loss: 0.1556, Val Loss: 1.6418
Epoch 189, accuracy: 0.6150
Epoch 190, accuracy: 0.6150
Epoch 190, Train Loss: 0.1334, Val Loss: 1.6418
Epoch 191, accuracy: 0.6150
Epoch 192, accuracy: 0.6150
Epoch 192, Train Loss: 0.1274, Val Loss: 1.6418
Epoch 193, accuracy: 0.6150
Epoch 194, accuracy: 0.6150
Epoch 194, Train Loss: 0.1210, Val Loss: 1.6418
Epoch 195, accuracy: 0.6150
Epoch 196, accuracy: 0.6150
Epoch 196, Train Loss: 0.0959, Val Loss: 1.6418
Epoch 197, accuracy: 0.6150
Epoch 198, accuracy: 0.6150
Epoch 198, Train Loss: 0.1809, Val Loss: 1.6418
Epoch 199, accuracy: 0.6150
Loaded best model with val_loss = 1.2871065139770508
test :accuracy 0.6290, f1_macro: 0.6049, f1_micro: 0.6290, auc: 0.8638
Training mamba3 with 4 layers...
可训练参数: 1651646_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.4392
Epoch 0, accuracy: 0.4510
Epoch 0, Train Loss: 1.8739, Val Loss: 1.4392
✅ Epoch 1: New best model saved with val_loss = 1.2170
Epoch 1, accuracy: 0.5720
✅ Epoch 2: New best model saved with val_loss = 1.1424
Epoch 2, accuracy: 0.5980
Epoch 2, Train Loss: 0.9319, Val Loss: 1.1424
✅ Epoch 3: New best model saved with val_loss = 1.1284
Epoch 3, accuracy: 0.6210
Epoch 4, accuracy: 0.6330
Epoch 4, Train Loss: 0.4720, Val Loss: 1.1428
Epoch 5, accuracy: 0.6240
Epoch 6, accuracy: 0.6330
Epoch 6, Train Loss: 0.3827, Val Loss: 1.2832
Epoch 7, accuracy: 0.6220
Epoch 8, accuracy: 0.6220
Epoch 8, Train Loss: 0.3361, Val Loss: 1.4466
Epoch 9, accuracy: 0.6350
Epoch 10, accuracy: 0.6350
Epoch 10, Train Loss: 0.2780, Val Loss: 1.5486
Epoch 11, accuracy: 0.6370
Epoch 12, accuracy: 0.6420
Epoch 12, Train Loss: 0.3380, Val Loss: 1.5377
Epoch 13, accuracy: 0.6420
Epoch 14, accuracy: 0.6430
Epoch 14, Train Loss: 0.3148, Val Loss: 1.5285
Epoch 15, accuracy: 0.6430
Epoch 16, accuracy: 0.6430
Epoch 16, Train Loss: 0.2279, Val Loss: 1.5304
Epoch 17, accuracy: 0.6440
Epoch 18, accuracy: 0.6440
Epoch 18, Train Loss: 0.2018, Val Loss: 1.5315
Epoch 19, accuracy: 0.6460
Epoch 20, accuracy: 0.6450
Epoch 20, Train Loss: 0.2023, Val Loss: 1.5332
Epoch 21, accuracy: 0.6450
Epoch 22, accuracy: 0.6450
Epoch 22, Train Loss: 0.1945, Val Loss: 1.5341
Epoch 23, accuracy: 0.6450
Epoch 24, accuracy: 0.6450
Epoch 24, Train Loss: 0.1595, Val Loss: 1.5344
Epoch 25, accuracy: 0.6450
Epoch 26, accuracy: 0.6450
Epoch 26, Train Loss: 0.2127, Val Loss: 1.5346
Epoch 27, accuracy: 0.6450
Epoch 28, accuracy: 0.6450
Epoch 28, Train Loss: 0.2203, Val Loss: 1.5347
Epoch 29, accuracy: 0.6450
Epoch 30, accuracy: 0.6450
Epoch 30, Train Loss: 0.2098, Val Loss: 1.5347
Epoch 31, accuracy: 0.6450
Epoch 32, accuracy: 0.6450
Epoch 32, Train Loss: 0.1936, Val Loss: 1.5347
Epoch 33, accuracy: 0.6450
Epoch 34, accuracy: 0.6450
Epoch 34, Train Loss: 0.1836, Val Loss: 1.5347
Epoch 35, accuracy: 0.6450
Epoch 36, accuracy: 0.6450
Epoch 36, Train Loss: 0.2552, Val Loss: 1.5347
Epoch 37, accuracy: 0.6450
Epoch 38, accuracy: 0.6450
Epoch 38, Train Loss: 0.2378, Val Loss: 1.5347
Epoch 39, accuracy: 0.6450
Epoch 40, accuracy: 0.6450
Epoch 40, Train Loss: 0.2909, Val Loss: 1.5347
Epoch 41, accuracy: 0.6450
Epoch 42, accuracy: 0.6450
Epoch 42, Train Loss: 0.1999, Val Loss: 1.5347
Epoch 43, accuracy: 0.6450
Epoch 44, accuracy: 0.6450
Epoch 44, Train Loss: 0.2383, Val Loss: 1.5347
Epoch 45, accuracy: 0.6450
Epoch 46, accuracy: 0.6450
Epoch 46, Train Loss: 0.1700, Val Loss: 1.5347
Epoch 47, accuracy: 0.6450
Epoch 48, accuracy: 0.6450
Epoch 48, Train Loss: 0.1628, Val Loss: 1.5347
Epoch 49, accuracy: 0.6450
Epoch 50, accuracy: 0.6450
Epoch 50, Train Loss: 0.2964, Val Loss: 1.5347
Epoch 51, accuracy: 0.6450
Epoch 52, accuracy: 0.6450
Epoch 52, Train Loss: 0.1926, Val Loss: 1.5347
Epoch 53, accuracy: 0.6450
Epoch 54, accuracy: 0.6450
Epoch 54, Train Loss: 0.1760, Val Loss: 1.5347
Epoch 55, accuracy: 0.6450
Epoch 56, accuracy: 0.6450
Epoch 56, Train Loss: 0.1993, Val Loss: 1.5347
Epoch 57, accuracy: 0.6450
Epoch 58, accuracy: 0.6450
Epoch 58, Train Loss: 0.2315, Val Loss: 1.5347
Epoch 59, accuracy: 0.6450
Epoch 60, accuracy: 0.6450
Epoch 60, Train Loss: 0.2421, Val Loss: 1.5347
Epoch 61, accuracy: 0.6450
Epoch 62, accuracy: 0.6450
Epoch 62, Train Loss: 0.2120, Val Loss: 1.5347
Epoch 63, accuracy: 0.6450
Epoch 64, accuracy: 0.6450
Epoch 64, Train Loss: 0.2008, Val Loss: 1.5347
Epoch 65, accuracy: 0.6450
Epoch 66, accuracy: 0.6450
Epoch 66, Train Loss: 0.2458, Val Loss: 1.5347
Epoch 67, accuracy: 0.6450
Epoch 68, accuracy: 0.6450
Epoch 68, Train Loss: 0.2108, Val Loss: 1.5347
Epoch 69, accuracy: 0.6450
Epoch 70, accuracy: 0.6450
Epoch 70, Train Loss: 0.1944, Val Loss: 1.5347
Epoch 71, accuracy: 0.6450
Epoch 72, accuracy: 0.6450
Epoch 72, Train Loss: 0.2262, Val Loss: 1.5347
Epoch 73, accuracy: 0.6450
Epoch 74, accuracy: 0.6450
Epoch 74, Train Loss: 0.2794, Val Loss: 1.5347
Epoch 75, accuracy: 0.6450
Epoch 76, accuracy: 0.6450
Epoch 76, Train Loss: 0.1500, Val Loss: 1.5347
Epoch 77, accuracy: 0.6450
Epoch 78, accuracy: 0.6450
Epoch 78, Train Loss: 0.1785, Val Loss: 1.5347
Epoch 79, accuracy: 0.6450
Epoch 80, accuracy: 0.6450
Epoch 80, Train Loss: 0.1915, Val Loss: 1.5347
Epoch 81, accuracy: 0.6450
Epoch 82, accuracy: 0.6450
Epoch 82, Train Loss: 0.2098, Val Loss: 1.5347
Epoch 83, accuracy: 0.6450
Epoch 84, accuracy: 0.6450
Epoch 84, Train Loss: 0.2071, Val Loss: 1.5347
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 85, accuracy: 0.6450
Epoch 86, accuracy: 0.6450
Epoch 86, Train Loss: 0.2368, Val Loss: 1.5347
Epoch 87, accuracy: 0.6450
Epoch 88, accuracy: 0.6450
Epoch 88, Train Loss: 0.2035, Val Loss: 1.5347
Epoch 89, accuracy: 0.6450
Epoch 90, accuracy: 0.6450
Epoch 90, Train Loss: 0.2167, Val Loss: 1.5347
Epoch 91, accuracy: 0.6450
Epoch 92, accuracy: 0.6450
Epoch 92, Train Loss: 0.2616, Val Loss: 1.5347
Epoch 93, accuracy: 0.6450
Epoch 94, accuracy: 0.6450
Epoch 94, Train Loss: 0.1789, Val Loss: 1.5347
Epoch 95, accuracy: 0.6450
Epoch 96, accuracy: 0.6450
Epoch 96, Train Loss: 0.2333, Val Loss: 1.5347
Epoch 97, accuracy: 0.6450
Epoch 98, accuracy: 0.6450
Epoch 98, Train Loss: 0.2398, Val Loss: 1.5347
Epoch 99, accuracy: 0.6450
Epoch 100, accuracy: 0.6450
Epoch 100, Train Loss: 0.1924, Val Loss: 1.5347
Epoch 101, accuracy: 0.6450
Epoch 102, accuracy: 0.6450
Epoch 102, Train Loss: 0.2443, Val Loss: 1.5347
Epoch 103, accuracy: 0.6450
Epoch 104, accuracy: 0.6450
Epoch 104, Train Loss: 0.2089, Val Loss: 1.5347
Epoch 105, accuracy: 0.6450
Epoch 106, accuracy: 0.6450
Epoch 106, Train Loss: 0.2010, Val Loss: 1.5347
Epoch 107, accuracy: 0.6450
Epoch 108, accuracy: 0.6450
Epoch 108, Train Loss: 0.2178, Val Loss: 1.5347
Epoch 109, accuracy: 0.6450
Epoch 110, accuracy: 0.6450
Epoch 110, Train Loss: 0.1573, Val Loss: 1.5347
Epoch 111, accuracy: 0.6450
Epoch 112, accuracy: 0.6450
Epoch 112, Train Loss: 0.2183, Val Loss: 1.5347
Epoch 113, accuracy: 0.6450
Epoch 114, accuracy: 0.6450
Epoch 114, Train Loss: 0.1754, Val Loss: 1.5347
Epoch 115, accuracy: 0.6450
Epoch 116, accuracy: 0.6450
Epoch 116, Train Loss: 0.2306, Val Loss: 1.5347
Epoch 117, accuracy: 0.6450
Epoch 118, accuracy: 0.6450
Epoch 118, Train Loss: 0.2403, Val Loss: 1.5347
Epoch 119, accuracy: 0.6450
Epoch 120, accuracy: 0.6450
Epoch 120, Train Loss: 0.1895, Val Loss: 1.5347
Epoch 121, accuracy: 0.6450
Epoch 122, accuracy: 0.6450
Epoch 122, Train Loss: 0.2857, Val Loss: 1.5347
Epoch 123, accuracy: 0.6450
Epoch 124, accuracy: 0.6450
Epoch 124, Train Loss: 0.2811, Val Loss: 1.5347
Epoch 125, accuracy: 0.6450
Epoch 126, accuracy: 0.6450
Epoch 126, Train Loss: 0.1831, Val Loss: 1.5347
Epoch 127, accuracy: 0.6450
Epoch 128, accuracy: 0.6450
Epoch 128, Train Loss: 0.2378, Val Loss: 1.5347
Epoch 129, accuracy: 0.6450
Epoch 130, accuracy: 0.6450
Epoch 130, Train Loss: 0.1742, Val Loss: 1.5347
Epoch 131, accuracy: 0.6450
Epoch 132, accuracy: 0.6450
Epoch 132, Train Loss: 0.1840, Val Loss: 1.5347
Epoch 133, accuracy: 0.6450
Epoch 134, accuracy: 0.6450
Epoch 134, Train Loss: 0.2157, Val Loss: 1.5347
Epoch 135, accuracy: 0.6450
Epoch 136, accuracy: 0.6450
Epoch 136, Train Loss: 0.2500, Val Loss: 1.5347
Epoch 137, accuracy: 0.6450
Epoch 138, accuracy: 0.6450
Epoch 138, Train Loss: 0.2097, Val Loss: 1.5347
Epoch 139, accuracy: 0.6450
Epoch 140, accuracy: 0.6450
Epoch 140, Train Loss: 0.2867, Val Loss: 1.5347
Epoch 141, accuracy: 0.6450
Epoch 142, accuracy: 0.6450
Epoch 142, Train Loss: 0.1790, Val Loss: 1.5347
Epoch 143, accuracy: 0.6450
Epoch 144, accuracy: 0.6450
Epoch 144, Train Loss: 0.1889, Val Loss: 1.5347
Epoch 145, accuracy: 0.6450
Epoch 146, accuracy: 0.6450
Epoch 146, Train Loss: 0.2591, Val Loss: 1.5347
Epoch 147, accuracy: 0.6450
Epoch 148, accuracy: 0.6450
Epoch 148, Train Loss: 0.1781, Val Loss: 1.5347
Epoch 149, accuracy: 0.6450
Epoch 150, accuracy: 0.6450
Epoch 150, Train Loss: 0.2489, Val Loss: 1.5347
Epoch 151, accuracy: 0.6450
Epoch 152, accuracy: 0.6450
Epoch 152, Train Loss: 0.1613, Val Loss: 1.5347
Epoch 153, accuracy: 0.6450
Epoch 154, accuracy: 0.6450
Epoch 154, Train Loss: 0.2221, Val Loss: 1.5347
Epoch 155, accuracy: 0.6450
Epoch 156, accuracy: 0.6450
Epoch 156, Train Loss: 0.2227, Val Loss: 1.5347
Epoch 157, accuracy: 0.6450
Epoch 158, accuracy: 0.6450
Epoch 158, Train Loss: 0.1667, Val Loss: 1.5347
Epoch 159, accuracy: 0.6450
Epoch 160, accuracy: 0.6450
Epoch 160, Train Loss: 0.2096, Val Loss: 1.5347
Epoch 161, accuracy: 0.6450
Epoch 162, accuracy: 0.6450
Epoch 162, Train Loss: 0.1585, Val Loss: 1.5347
Epoch 163, accuracy: 0.6450
Epoch 164, accuracy: 0.6450
Epoch 164, Train Loss: 0.1981, Val Loss: 1.5347
Epoch 165, accuracy: 0.6450
Epoch 166, accuracy: 0.6450
Epoch 166, Train Loss: 0.1595, Val Loss: 1.5347
Epoch 167, accuracy: 0.6450
Epoch 168, accuracy: 0.6450
Epoch 168, Train Loss: 0.2378, Val Loss: 1.5347
Epoch 169, accuracy: 0.6450
Epoch 170, accuracy: 0.6450
Epoch 170, Train Loss: 0.2747, Val Loss: 1.5347
Epoch 171, accuracy: 0.6450
Epoch 172, accuracy: 0.6450
Epoch 172, Train Loss: 0.1810, Val Loss: 1.5347
Epoch 173, accuracy: 0.6450
Epoch 174, accuracy: 0.6450
Epoch 174, Train Loss: 0.2528, Val Loss: 1.5347
Epoch 175, accuracy: 0.6450
Epoch 176, accuracy: 0.6450
Epoch 176, Train Loss: 0.3406, Val Loss: 1.5347
Epoch 177, accuracy: 0.6450
Epoch 178, accuracy: 0.6450
Epoch 178, Train Loss: 0.2165, Val Loss: 1.5347
Epoch 179, accuracy: 0.6450
Epoch 180, accuracy: 0.6450
Epoch 180, Train Loss: 0.2510, Val Loss: 1.5347
Epoch 181, accuracy: 0.6450
Epoch 182, accuracy: 0.6450
Epoch 182, Train Loss: 0.2885, Val Loss: 1.5347
Epoch 183, accuracy: 0.6450
Epoch 184, accuracy: 0.6450
Epoch 184, Train Loss: 0.2110, Val Loss: 1.5347
Epoch 185, accuracy: 0.6450
Epoch 186, accuracy: 0.6450
Epoch 186, Train Loss: 0.1705, Val Loss: 1.5347
Epoch 187, accuracy: 0.6450
Epoch 188, accuracy: 0.6450
Epoch 188, Train Loss: 0.3016, Val Loss: 1.5347
Epoch 189, accuracy: 0.6450
Epoch 190, accuracy: 0.6450
Epoch 190, Train Loss: 0.2625, Val Loss: 1.5347
Epoch 191, accuracy: 0.6450
Epoch 192, accuracy: 0.6450
Epoch 192, Train Loss: 0.2276, Val Loss: 1.5347
Epoch 193, accuracy: 0.6450
Epoch 194, accuracy: 0.6450
Epoch 194, Train Loss: 0.2145, Val Loss: 1.5348
Epoch 195, accuracy: 0.6450
Epoch 196, accuracy: 0.6450
Epoch 196, Train Loss: 0.2331, Val Loss: 1.5348
Epoch 197, accuracy: 0.6450
Epoch 198, accuracy: 0.6450
Epoch 198, Train Loss: 0.1751, Val Loss: 1.5348
Epoch 199, accuracy: 0.6450
Loaded best model with val_loss = 1.1284222602844238
test :accuracy 0.6210, f1_macro: 0.5930, f1_micro: 0.6210, auc: 0.8551
Training mamba3 with 5 layers...
可训练参数: 1734590_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.4679
Epoch 0, accuracy: 0.4170
Epoch 0, Train Loss: 1.9420, Val Loss: 1.4679
Epoch 1, accuracy: 0.4350
✅ Epoch 2: New best model saved with val_loss = 1.3971
Epoch 2, accuracy: 0.5600
Epoch 2, Train Loss: 1.1940, Val Loss: 1.3971
✅ Epoch 3: New best model saved with val_loss = 1.1459
Epoch 3, accuracy: 0.6240
✅ Epoch 4: New best model saved with val_loss = 1.1232
Epoch 4, accuracy: 0.5980
Epoch 4, Train Loss: 0.9144, Val Loss: 1.1232
Epoch 5, accuracy: 0.5830
✅ Epoch 6: New best model saved with val_loss = 1.1085
Epoch 6, accuracy: 0.6300
Epoch 6, Train Loss: 0.7569, Val Loss: 1.1085
✅ Epoch 7: New best model saved with val_loss = 1.1081
Epoch 7, accuracy: 0.6380
Epoch 8, accuracy: 0.6330
Epoch 8, Train Loss: 0.4330, Val Loss: 1.2069
Epoch 9, accuracy: 0.6520
Epoch 10, accuracy: 0.6610
Epoch 10, Train Loss: 0.5272, Val Loss: 1.1787
Epoch 11, accuracy: 0.6520
Epoch 12, accuracy: 0.6720
Epoch 12, Train Loss: 0.4749, Val Loss: 1.1914
Epoch 13, accuracy: 0.6650
Epoch 14, accuracy: 0.6660
Epoch 14, Train Loss: 0.4779, Val Loss: 1.2418
Epoch 15, accuracy: 0.6640
Epoch 16, accuracy: 0.6630
Epoch 16, Train Loss: 0.3610, Val Loss: 1.2503
Epoch 17, accuracy: 0.6590
Epoch 18, accuracy: 0.6600
Epoch 18, Train Loss: 0.3219, Val Loss: 1.2577
Epoch 19, accuracy: 0.6590
Epoch 20, accuracy: 0.6590
Epoch 20, Train Loss: 0.3435, Val Loss: 1.2609
Epoch 21, accuracy: 0.6590
Epoch 22, accuracy: 0.6590
Epoch 22, Train Loss: 0.3185, Val Loss: 1.2613
Epoch 23, accuracy: 0.6590
Epoch 24, accuracy: 0.6590
Epoch 24, Train Loss: 0.2720, Val Loss: 1.2617
Epoch 25, accuracy: 0.6590
Epoch 26, accuracy: 0.6590
Epoch 26, Train Loss: 0.3546, Val Loss: 1.2619
Epoch 27, accuracy: 0.6590
Epoch 28, accuracy: 0.6590
Epoch 28, Train Loss: 0.3490, Val Loss: 1.2619
Epoch 29, accuracy: 0.6590
Epoch 30, accuracy: 0.6590
Epoch 30, Train Loss: 0.2959, Val Loss: 1.2619
Epoch 31, accuracy: 0.6590
Epoch 32, accuracy: 0.6590
Epoch 32, Train Loss: 0.3017, Val Loss: 1.2619
Epoch 33, accuracy: 0.6590
Epoch 34, accuracy: 0.6590
Epoch 34, Train Loss: 0.3534, Val Loss: 1.2619
Epoch 35, accuracy: 0.6590
Epoch 36, accuracy: 0.6590
Epoch 36, Train Loss: 0.2960, Val Loss: 1.2619
Epoch 37, accuracy: 0.6590
Epoch 38, accuracy: 0.6590
Epoch 38, Train Loss: 0.3458, Val Loss: 1.2619
Epoch 39, accuracy: 0.6590
Epoch 40, accuracy: 0.6590
Epoch 40, Train Loss: 0.3455, Val Loss: 1.2619
Epoch 41, accuracy: 0.6590
Epoch 42, accuracy: 0.6590
Epoch 42, Train Loss: 0.3031, Val Loss: 1.2619
Epoch 43, accuracy: 0.6590
Epoch 44, accuracy: 0.6590
Epoch 44, Train Loss: 0.3280, Val Loss: 1.2619
Epoch 45, accuracy: 0.6590
Epoch 46, accuracy: 0.6590
Epoch 46, Train Loss: 0.3746, Val Loss: 1.2619
Epoch 47, accuracy: 0.6590
Epoch 48, accuracy: 0.6590
Epoch 48, Train Loss: 0.3621, Val Loss: 1.2619
Epoch 49, accuracy: 0.6590
Epoch 50, accuracy: 0.6590
Epoch 50, Train Loss: 0.4000, Val Loss: 1.2619
Epoch 51, accuracy: 0.6590
Epoch 52, accuracy: 0.6590
Epoch 52, Train Loss: 0.3945, Val Loss: 1.2619
Epoch 53, accuracy: 0.6590
Epoch 54, accuracy: 0.6590
Epoch 54, Train Loss: 0.3937, Val Loss: 1.2619
Epoch 55, accuracy: 0.6590
Epoch 56, accuracy: 0.6590
Epoch 56, Train Loss: 0.2591, Val Loss: 1.2619
Epoch 57, accuracy: 0.6590
Epoch 58, accuracy: 0.6590
Epoch 58, Train Loss: 0.3050, Val Loss: 1.2619
Epoch 59, accuracy: 0.6590
Epoch 60, accuracy: 0.6590
Epoch 60, Train Loss: 0.2811, Val Loss: 1.2619
Epoch 61, accuracy: 0.6590
Epoch 62, accuracy: 0.6590
Epoch 62, Train Loss: 0.3023, Val Loss: 1.2619
Epoch 63, accuracy: 0.6590
Epoch 64, accuracy: 0.6590
Epoch 64, Train Loss: 0.3308, Val Loss: 1.2619
Epoch 65, accuracy: 0.6590
Epoch 66, accuracy: 0.6590
Epoch 66, Train Loss: 0.3766, Val Loss: 1.2619
Epoch 67, accuracy: 0.6590
Epoch 68, accuracy: 0.6590
Epoch 68, Train Loss: 0.2917, Val Loss: 1.2619
Epoch 69, accuracy: 0.6590
Epoch 70, accuracy: 0.6590
Epoch 70, Train Loss: 0.2981, Val Loss: 1.2619
Epoch 71, accuracy: 0.6590
Epoch 72, accuracy: 0.6590
Epoch 72, Train Loss: 0.3085, Val Loss: 1.2619
Epoch 73, accuracy: 0.6590
Epoch 74, accuracy: 0.6590
Epoch 74, Train Loss: 0.2580, Val Loss: 1.2619
Epoch 75, accuracy: 0.6590
Epoch 76, accuracy: 0.6590
Epoch 76, Train Loss: 0.3074, Val Loss: 1.2619
Epoch 77, accuracy: 0.6590
Epoch 78, accuracy: 0.6590
Epoch 78, Train Loss: 0.2605, Val Loss: 1.2619
Epoch 79, accuracy: 0.6590
Epoch 80, accuracy: 0.6590
Epoch 80, Train Loss: 0.3159, Val Loss: 1.2619
Epoch 81, accuracy: 0.6590
Epoch 82, accuracy: 0.6590
Epoch 82, Train Loss: 0.4120, Val Loss: 1.2619
Epoch 83, accuracy: 0.6590
Epoch 84, accuracy: 0.6590
Epoch 84, Train Loss: 0.2925, Val Loss: 1.2619
Epoch 85, accuracy: 0.6590
Epoch 86, accuracy: 0.6590
Epoch 86, Train Loss: 0.3959, Val Loss: 1.2619
Epoch 87, accuracy: 0.6590
Epoch 88, accuracy: 0.6590
Epoch 88, Train Loss: 0.2743, Val Loss: 1.2619
Epoch 89, accuracy: 0.6590
Epoch 90, accuracy: 0.6590
Epoch 90, Train Loss: 0.3248, Val Loss: 1.2619
Epoch 91, accuracy: 0.6590
Epoch 92, accuracy: 0.6590
Epoch 92, Train Loss: 0.2657, Val Loss: 1.2619
Epoch 93, accuracy: 0.6590
Epoch 94, accuracy: 0.6590
Epoch 94, Train Loss: 0.2366, Val Loss: 1.2619
Epoch 95, accuracy: 0.6590
Epoch 96, accuracy: 0.6590
Epoch 96, Train Loss: 0.3856, Val Loss: 1.2619
Epoch 97, accuracy: 0.6590
Epoch 98, accuracy: 0.6590
Epoch 98, Train Loss: 0.2969, Val Loss: 1.2619
Epoch 99, accuracy: 0.6590
Epoch 100, accuracy: 0.6590
Epoch 100, Train Loss: 0.3113, Val Loss: 1.2619
Epoch 101, accuracy: 0.6590
Epoch 102, accuracy: 0.6590
Epoch 102, Train Loss: 0.3823, Val Loss: 1.2619
Epoch 103, accuracy: 0.6590
Epoch 104, accuracy: 0.6590
Epoch 104, Train Loss: 0.2785, Val Loss: 1.2619
Epoch 105, accuracy: 0.6590
Epoch 106, accuracy: 0.6590
Epoch 106, Train Loss: 0.3463, Val Loss: 1.2619
Epoch 107, accuracy: 0.6590
Epoch 108, accuracy: 0.6590
Epoch 108, Train Loss: 0.2677, Val Loss: 1.2619
Epoch 109, accuracy: 0.6590
Epoch 110, accuracy: 0.6590
Epoch 110, Train Loss: 0.2902, Val Loss: 1.2619
Epoch 111, accuracy: 0.6590
Epoch 112, accuracy: 0.6590
Epoch 112, Train Loss: 0.2671, Val Loss: 1.2619
Epoch 113, accuracy: 0.6590
Epoch 114, accuracy: 0.6590
Epoch 114, Train Loss: 0.3175, Val Loss: 1.2619
Epoch 115, accuracy: 0.6590
Epoch 116, accuracy: 0.6590
Epoch 116, Train Loss: 0.2896, Val Loss: 1.2619
Epoch 117, accuracy: 0.6590
Epoch 118, accuracy: 0.6590
Epoch 118, Train Loss: 0.3807, Val Loss: 1.2619
Epoch 119, accuracy: 0.6590
Epoch 120, accuracy: 0.6590
Epoch 120, Train Loss: 0.2997, Val Loss: 1.2619
Epoch 121, accuracy: 0.6590
Epoch 122, accuracy: 0.6590
Epoch 122, Train Loss: 0.3151, Val Loss: 1.2619
Epoch 123, accuracy: 0.6590
Epoch 124, accuracy: 0.6590
Epoch 124, Train Loss: 0.2626, Val Loss: 1.2619
Epoch 125, accuracy: 0.6590
Epoch 126, accuracy: 0.6590
Epoch 126, Train Loss: 0.3049, Val Loss: 1.2619
Epoch 127, accuracy: 0.6590
Epoch 128, accuracy: 0.6590
Epoch 128, Train Loss: 0.3757, Val Loss: 1.2619
Epoch 129, accuracy: 0.6590
Epoch 130, accuracy: 0.6590
Epoch 130, Train Loss: 0.2960, Val Loss: 1.2619
Epoch 131, accuracy: 0.6590
Epoch 132, accuracy: 0.6590
Epoch 132, Train Loss: 0.3204, Val Loss: 1.2619
Epoch 133, accuracy: 0.6590
Epoch 134, accuracy: 0.6590
Epoch 134, Train Loss: 0.3288, Val Loss: 1.2619
Epoch 135, accuracy: 0.6590
Epoch 136, accuracy: 0.6590
Epoch 136, Train Loss: 0.2930, Val Loss: 1.2619
Epoch 137, accuracy: 0.6590
Epoch 138, accuracy: 0.6590
Epoch 138, Train Loss: 0.3222, Val Loss: 1.2619
Epoch 139, accuracy: 0.6590
Epoch 140, accuracy: 0.6590
Epoch 140, Train Loss: 0.2931, Val Loss: 1.2619
Epoch 141, accuracy: 0.6590
Epoch 142, accuracy: 0.6590
Epoch 142, Train Loss: 0.3211, Val Loss: 1.2619
Epoch 143, accuracy: 0.6590
Epoch 144, accuracy: 0.6590
Epoch 144, Train Loss: 0.1765, Val Loss: 1.2619
Epoch 145, accuracy: 0.6590
Epoch 146, accuracy: 0.6590
Epoch 146, Train Loss: 0.4099, Val Loss: 1.2619
Epoch 147, accuracy: 0.6590
Epoch 148, accuracy: 0.6590
Epoch 148, Train Loss: 0.3346, Val Loss: 1.2619
Epoch 149, accuracy: 0.6590
Epoch 150, accuracy: 0.6590
Epoch 150, Train Loss: 0.3902, Val Loss: 1.2619
Epoch 151, accuracy: 0.6590
Epoch 152, accuracy: 0.6590
Epoch 152, Train Loss: 0.2366, Val Loss: 1.2619
Epoch 153, accuracy: 0.6590
Epoch 154, accuracy: 0.6590
Epoch 154, Train Loss: 0.2853, Val Loss: 1.2619
Epoch 155, accuracy: 0.6590
Epoch 156, accuracy: 0.6590
Epoch 156, Train Loss: 0.3453, Val Loss: 1.2619
Epoch 157, accuracy: 0.6590
Epoch 158, accuracy: 0.6590
Epoch 158, Train Loss: 0.3864, Val Loss: 1.2619
Epoch 159, accuracy: 0.6590
Epoch 160, accuracy: 0.6590
Epoch 160, Train Loss: 0.2565, Val Loss: 1.2619
Epoch 161, accuracy: 0.6590
Epoch 162, accuracy: 0.6590
Epoch 162, Train Loss: 0.3422, Val Loss: 1.2619
Epoch 163, accuracy: 0.6590
Epoch 164, accuracy: 0.6590
Epoch 164, Train Loss: 0.2591, Val Loss: 1.2619
Epoch 165, accuracy: 0.6590
Epoch 166, accuracy: 0.6590
Epoch 166, Train Loss: 0.3277, Val Loss: 1.2619
Epoch 167, accuracy: 0.6590
Epoch 168, accuracy: 0.6590
Epoch 168, Train Loss: 0.2575, Val Loss: 1.2619
Epoch 169, accuracy: 0.6590
Epoch 170, accuracy: 0.6590
Epoch 170, Train Loss: 0.2102, Val Loss: 1.2619
Epoch 171, accuracy: 0.6590
Epoch 172, accuracy: 0.6590
Epoch 172, Train Loss: 0.3160, Val Loss: 1.2619
Epoch 173, accuracy: 0.6590
Epoch 174, accuracy: 0.6590
Epoch 174, Train Loss: 0.3608, Val Loss: 1.2619
Epoch 175, accuracy: 0.6590
Epoch 176, accuracy: 0.6590
Epoch 176, Train Loss: 0.2864, Val Loss: 1.2619
Epoch 177, accuracy: 0.6590
Epoch 178, accuracy: 0.6590
Epoch 178, Train Loss: 0.2140, Val Loss: 1.2619
Epoch 179, accuracy: 0.6590
Epoch 180, accuracy: 0.6590
Epoch 180, Train Loss: 0.2802, Val Loss: 1.2619
Epoch 181, accuracy: 0.6590
Epoch 182, accuracy: 0.6590
Epoch 182, Train Loss: 0.2942, Val Loss: 1.2619
Epoch 183, accuracy: 0.6590
Epoch 184, accuracy: 0.6590
Epoch 184, Train Loss: 0.3406, Val Loss: 1.2619
Epoch 185, accuracy: 0.6590
Epoch 186, accuracy: 0.6590
Epoch 186, Train Loss: 0.2728, Val Loss: 1.2619
Epoch 187, accuracy: 0.6590
Epoch 188, accuracy: 0.6590
Epoch 188, Train Loss: 0.2889, Val Loss: 1.2619
Epoch 189, accuracy: 0.6590
Epoch 190, accuracy: 0.6590
Epoch 190, Train Loss: 0.3331, Val Loss: 1.2619
Epoch 191, accuracy: 0.6590
Epoch 192, accuracy: 0.6590
Epoch 192, Train Loss: 0.3168, Val Loss: 1.2619/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))

Epoch 193, accuracy: 0.6590
Epoch 194, accuracy: 0.6590
Epoch 194, Train Loss: 0.2778, Val Loss: 1.2619
Epoch 195, accuracy: 0.6590
Epoch 196, accuracy: 0.6590
Epoch 196, Train Loss: 0.3478, Val Loss: 1.2619
Epoch 197, accuracy: 0.6590
Epoch 198, accuracy: 0.6590
Epoch 198, Train Loss: 0.3164, Val Loss: 1.2619
Epoch 199, accuracy: 0.6590
Loaded best model with val_loss = 1.1081172227859497
test :accuracy 0.6380, f1_macro: 0.6116, f1_micro: 0.6380, auc: 0.8714
Training mamba3 with 6 layers...
可训练参数: 1817534_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.6269
Epoch 0, accuracy: 0.2870
Epoch 0, Train Loss: 1.8631, Val Loss: 1.6269
Epoch 1, accuracy: 0.2830
✅ Epoch 2: New best model saved with val_loss = 1.2034
Epoch 2, accuracy: 0.5360
Epoch 2, Train Loss: 1.5324, Val Loss: 1.2034
✅ Epoch 3: New best model saved with val_loss = 1.1919
Epoch 3, accuracy: 0.5850
Epoch 4, accuracy: 0.5650
Epoch 4, Train Loss: 0.8533, Val Loss: 1.2432
Epoch 5, accuracy: 0.6000
✅ Epoch 6: New best model saved with val_loss = 1.0878
Epoch 6, accuracy: 0.6490
Epoch 6, Train Loss: 0.6469, Val Loss: 1.0878
✅ Epoch 7: New best model saved with val_loss = 1.0748
Epoch 7, accuracy: 0.6480
Epoch 8, accuracy: 0.6460
Epoch 8, Train Loss: 0.4472, Val Loss: 1.1222
Epoch 9, accuracy: 0.6430
Epoch 10, accuracy: 0.6390
Epoch 10, Train Loss: 0.3818, Val Loss: 1.3084
Epoch 11, accuracy: 0.6300
Epoch 12, accuracy: 0.6350
Epoch 12, Train Loss: 0.3048, Val Loss: 1.5586
Epoch 13, accuracy: 0.6340
Epoch 14, accuracy: 0.6340
Epoch 14, Train Loss: 0.2292, Val Loss: 1.5834
Epoch 15, accuracy: 0.6340
Epoch 16, accuracy: 0.6370
Epoch 16, Train Loss: 0.2136, Val Loss: 1.5843
Epoch 17, accuracy: 0.6400
Epoch 18, accuracy: 0.6420
Epoch 18, Train Loss: 0.1937, Val Loss: 1.5798
Epoch 19, accuracy: 0.6430
Epoch 20, accuracy: 0.6420
Epoch 20, Train Loss: 0.2469, Val Loss: 1.5774
Epoch 21, accuracy: 0.6430
Epoch 22, accuracy: 0.6430
Epoch 22, Train Loss: 0.2099, Val Loss: 1.5772
Epoch 23, accuracy: 0.6430
Epoch 24, accuracy: 0.6420
Epoch 24, Train Loss: 0.2303, Val Loss: 1.5766
Epoch 25, accuracy: 0.6420
Epoch 26, accuracy: 0.6430
Epoch 26, Train Loss: 0.2407, Val Loss: 1.5763
Epoch 27, accuracy: 0.6430
Epoch 28, accuracy: 0.6430
Epoch 28, Train Loss: 0.3232, Val Loss: 1.5763
Epoch 29, accuracy: 0.6430
Epoch 30, accuracy: 0.6430
Epoch 30, Train Loss: 0.2061, Val Loss: 1.5762
Epoch 31, accuracy: 0.6430
Epoch 32, accuracy: 0.6430
Epoch 32, Train Loss: 0.1735, Val Loss: 1.5761
Epoch 33, accuracy: 0.6430
Epoch 34, accuracy: 0.6430
Epoch 34, Train Loss: 0.2739, Val Loss: 1.5761
Epoch 35, accuracy: 0.6430
Epoch 36, accuracy: 0.6430
Epoch 36, Train Loss: 0.2248, Val Loss: 1.5761
Epoch 37, accuracy: 0.6430
Epoch 38, accuracy: 0.6430
Epoch 38, Train Loss: 0.2079, Val Loss: 1.5761
Epoch 39, accuracy: 0.6430
Epoch 40, accuracy: 0.6430
Epoch 40, Train Loss: 0.2100, Val Loss: 1.5761
Epoch 41, accuracy: 0.6430
Epoch 42, accuracy: 0.6430
Epoch 42, Train Loss: 0.1942, Val Loss: 1.5761
Epoch 43, accuracy: 0.6430
Epoch 44, accuracy: 0.6430
Epoch 44, Train Loss: 0.3181, Val Loss: 1.5761
Epoch 45, accuracy: 0.6430
Epoch 46, accuracy: 0.6430
Epoch 46, Train Loss: 0.2277, Val Loss: 1.5761
Epoch 47, accuracy: 0.6430
Epoch 48, accuracy: 0.6430
Epoch 48, Train Loss: 0.2675, Val Loss: 1.5761
Epoch 49, accuracy: 0.6430
Epoch 50, accuracy: 0.6430
Epoch 50, Train Loss: 0.3356, Val Loss: 1.5761
Epoch 51, accuracy: 0.6430
Epoch 52, accuracy: 0.6430
Epoch 52, Train Loss: 0.2838, Val Loss: 1.5761
Epoch 53, accuracy: 0.6430
Epoch 54, accuracy: 0.6430
Epoch 54, Train Loss: 0.2801, Val Loss: 1.5761
Epoch 55, accuracy: 0.6430
Epoch 56, accuracy: 0.6430
Epoch 56, Train Loss: 0.3018, Val Loss: 1.5761
Epoch 57, accuracy: 0.6430
Epoch 58, accuracy: 0.6430
Epoch 58, Train Loss: 0.2234, Val Loss: 1.5761
Epoch 59, accuracy: 0.6430
Epoch 60, accuracy: 0.6430
Epoch 60, Train Loss: 0.1563, Val Loss: 1.5761
Epoch 61, accuracy: 0.6430
Epoch 62, accuracy: 0.6430
Epoch 62, Train Loss: 0.2216, Val Loss: 1.5761
Epoch 63, accuracy: 0.6430
Epoch 64, accuracy: 0.6430
Epoch 64, Train Loss: 0.4001, Val Loss: 1.5761
Epoch 65, accuracy: 0.6430
Epoch 66, accuracy: 0.6430
Epoch 66, Train Loss: 0.2965, Val Loss: 1.5761
Epoch 67, accuracy: 0.6430
Epoch 68, accuracy: 0.6430
Epoch 68, Train Loss: 0.2596, Val Loss: 1.5761
Epoch 69, accuracy: 0.6430
Epoch 70, accuracy: 0.6430
Epoch 70, Train Loss: 0.2652, Val Loss: 1.5761
Epoch 71, accuracy: 0.6430
Epoch 72, accuracy: 0.6430
Epoch 72, Train Loss: 0.2643, Val Loss: 1.5761
Epoch 73, accuracy: 0.6430
Epoch 74, accuracy: 0.6430
Epoch 74, Train Loss: 0.2259, Val Loss: 1.5761
Epoch 75, accuracy: 0.6430
Epoch 76, accuracy: 0.6430
Epoch 76, Train Loss: 0.2779, Val Loss: 1.5761
Epoch 77, accuracy: 0.6430
Epoch 78, accuracy: 0.6430
Epoch 78, Train Loss: 0.2837, Val Loss: 1.5761
Epoch 79, accuracy: 0.6430
Epoch 80, accuracy: 0.6430
Epoch 80, Train Loss: 0.2143, Val Loss: 1.5761
Epoch 81, accuracy: 0.6430
Epoch 82, accuracy: 0.6430
Epoch 82, Train Loss: 0.1918, Val Loss: 1.5761
Epoch 83, accuracy: 0.6430
Epoch 84, accuracy: 0.6430
Epoch 84, Train Loss: 0.2903, Val Loss: 1.5761
Epoch 85, accuracy: 0.6430
Epoch 86, accuracy: 0.6430
Epoch 86, Train Loss: 0.2445, Val Loss: 1.5761
Epoch 87, accuracy: 0.6430
Epoch 88, accuracy: 0.6430
Epoch 88, Train Loss: 0.1899, Val Loss: 1.5761
Epoch 89, accuracy: 0.6430
Epoch 90, accuracy: 0.6430
Epoch 90, Train Loss: 0.3097, Val Loss: 1.5761
Epoch 91, accuracy: 0.6430
Epoch 92, accuracy: 0.6430
Epoch 92, Train Loss: 0.2903, Val Loss: 1.5761
Epoch 93, accuracy: 0.6430
Epoch 94, accuracy: 0.6430
Epoch 94, Train Loss: 0.2557, Val Loss: 1.5761
Epoch 95, accuracy: 0.6430
Epoch 96, accuracy: 0.6430
Epoch 96, Train Loss: 0.2469, Val Loss: 1.5761
Epoch 97, accuracy: 0.6430
Epoch 98, accuracy: 0.6430
Epoch 98, Train Loss: 0.2652, Val Loss: 1.5761
Epoch 99, accuracy: 0.6430
Epoch 100, accuracy: 0.6430
Epoch 100, Train Loss: 0.1984, Val Loss: 1.5761
Epoch 101, accuracy: 0.6430
Epoch 102, accuracy: 0.6430
Epoch 102, Train Loss: 0.2497, Val Loss: 1.5761
Epoch 103, accuracy: 0.6430
Epoch 104, accuracy: 0.6430
Epoch 104, Train Loss: 0.2881, Val Loss: 1.5761
Epoch 105, accuracy: 0.6430
Epoch 106, accuracy: 0.6430
Epoch 106, Train Loss: 0.2357, Val Loss: 1.5761
Epoch 107, accuracy: 0.6430
Epoch 108, accuracy: 0.6430
Epoch 108, Train Loss: 0.1678, Val Loss: 1.5761
Epoch 109, accuracy: 0.6430
Epoch 110, accuracy: 0.6430
Epoch 110, Train Loss: 0.2456, Val Loss: 1.5761
Epoch 111, accuracy: 0.6430
Epoch 112, accuracy: 0.6430
Epoch 112, Train Loss: 0.2804, Val Loss: 1.5761
Epoch 113, accuracy: 0.6430
Epoch 114, accuracy: 0.6430
Epoch 114, Train Loss: 0.2411, Val Loss: 1.5761
Epoch 115, accuracy: 0.6430
Epoch 116, accuracy: 0.6430
Epoch 116, Train Loss: 0.2259, Val Loss: 1.5761
Epoch 117, accuracy: 0.6430
Epoch 118, accuracy: 0.6430
Epoch 118, Train Loss: 0.1701, Val Loss: 1.5761
Epoch 119, accuracy: 0.6430
Epoch 120, accuracy: 0.6430
Epoch 120, Train Loss: 0.2121, Val Loss: 1.5761
Epoch 121, accuracy: 0.6430
Epoch 122, accuracy: 0.6430
Epoch 122, Train Loss: 0.2536, Val Loss: 1.5761
Epoch 123, accuracy: 0.6430
Epoch 124, accuracy: 0.6430
Epoch 124, Train Loss: 0.2123, Val Loss: 1.5761
Epoch 125, accuracy: 0.6430
Epoch 126, accuracy: 0.6430
Epoch 126, Train Loss: 0.3300, Val Loss: 1.5761
Epoch 127, accuracy: 0.6430
Epoch 128, accuracy: 0.6430
Epoch 128, Train Loss: 0.2402, Val Loss: 1.5761
Epoch 129, accuracy: 0.6430
Epoch 130, accuracy: 0.6430
Epoch 130, Train Loss: 0.3342, Val Loss: 1.5761
Epoch 131, accuracy: 0.6430
Epoch 132, accuracy: 0.6430
Epoch 132, Train Loss: 0.2754, Val Loss: 1.5761
Epoch 133, accuracy: 0.6430
Epoch 134, accuracy: 0.6430
Epoch 134, Train Loss: 0.2490, Val Loss: 1.5761
Epoch 135, accuracy: 0.6430
Epoch 136, accuracy: 0.6430
Epoch 136, Train Loss: 0.2410, Val Loss: 1.5761
Epoch 137, accuracy: 0.6430
Epoch 138, accuracy: 0.6430
Epoch 138, Train Loss: 0.4038, Val Loss: 1.5761
Epoch 139, accuracy: 0.6430
Epoch 140, accuracy: 0.6430
Epoch 140, Train Loss: 0.2658, Val Loss: 1.5761
Epoch 141, accuracy: 0.6430
Epoch 142, accuracy: 0.6430
Epoch 142, Train Loss: 0.2585, Val Loss: 1.5761
Epoch 143, accuracy: 0.6430
Epoch 144, accuracy: 0.6430
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 144, Train Loss: 0.2641, Val Loss: 1.5761
Epoch 145, accuracy: 0.6430
Epoch 146, accuracy: 0.6430
Epoch 146, Train Loss: 0.2902, Val Loss: 1.5761
Epoch 147, accuracy: 0.6430
Epoch 148, accuracy: 0.6430
Epoch 148, Train Loss: 0.1993, Val Loss: 1.5761
Epoch 149, accuracy: 0.6430
Epoch 150, accuracy: 0.6430
Epoch 150, Train Loss: 0.2258, Val Loss: 1.5761
Epoch 151, accuracy: 0.6430
Epoch 152, accuracy: 0.6430
Epoch 152, Train Loss: 0.2350, Val Loss: 1.5761
Epoch 153, accuracy: 0.6430
Epoch 154, accuracy: 0.6430
Epoch 154, Train Loss: 0.2227, Val Loss: 1.5761
Epoch 155, accuracy: 0.6430
Epoch 156, accuracy: 0.6430
Epoch 156, Train Loss: 0.2416, Val Loss: 1.5761
Epoch 157, accuracy: 0.6430
Epoch 158, accuracy: 0.6430
Epoch 158, Train Loss: 0.3390, Val Loss: 1.5761
Epoch 159, accuracy: 0.6430
Epoch 160, accuracy: 0.6430
Epoch 160, Train Loss: 0.2683, Val Loss: 1.5761
Epoch 161, accuracy: 0.6430
Epoch 162, accuracy: 0.6430
Epoch 162, Train Loss: 0.3207, Val Loss: 1.5761
Epoch 163, accuracy: 0.6430
Epoch 164, accuracy: 0.6430
Epoch 164, Train Loss: 0.2813, Val Loss: 1.5761
Epoch 165, accuracy: 0.6430
Epoch 166, accuracy: 0.6430
Epoch 166, Train Loss: 0.2271, Val Loss: 1.5761
Epoch 167, accuracy: 0.6430
Epoch 168, accuracy: 0.6430
Epoch 168, Train Loss: 0.3118, Val Loss: 1.5761
Epoch 169, accuracy: 0.6430
Epoch 170, accuracy: 0.6430
Epoch 170, Train Loss: 0.2443, Val Loss: 1.5761
Epoch 171, accuracy: 0.6430
Epoch 172, accuracy: 0.6430
Epoch 172, Train Loss: 0.2697, Val Loss: 1.5761
Epoch 173, accuracy: 0.6430
Epoch 174, accuracy: 0.6430
Epoch 174, Train Loss: 0.2771, Val Loss: 1.5761
Epoch 175, accuracy: 0.6430
Epoch 176, accuracy: 0.6430
Epoch 176, Train Loss: 0.2876, Val Loss: 1.5761
Epoch 177, accuracy: 0.6430
Epoch 178, accuracy: 0.6430
Epoch 178, Train Loss: 0.3107, Val Loss: 1.5761
Epoch 179, accuracy: 0.6430
Epoch 180, accuracy: 0.6430
Epoch 180, Train Loss: 0.2573, Val Loss: 1.5761
Epoch 181, accuracy: 0.6430
Epoch 182, accuracy: 0.6430
Epoch 182, Train Loss: 0.2106, Val Loss: 1.5761
Epoch 183, accuracy: 0.6430
Epoch 184, accuracy: 0.6430
Epoch 184, Train Loss: 0.2613, Val Loss: 1.5761
Epoch 185, accuracy: 0.6430
Epoch 186, accuracy: 0.6430
Epoch 186, Train Loss: 0.2503, Val Loss: 1.5761
Epoch 187, accuracy: 0.6430
Epoch 188, accuracy: 0.6430
Epoch 188, Train Loss: 0.2717, Val Loss: 1.5761
Epoch 189, accuracy: 0.6430
Epoch 190, accuracy: 0.6430
Epoch 190, Train Loss: 0.2706, Val Loss: 1.5761
Epoch 191, accuracy: 0.6430
Epoch 192, accuracy: 0.6430
Epoch 192, Train Loss: 0.1902, Val Loss: 1.5761
Epoch 193, accuracy: 0.6430
Epoch 194, accuracy: 0.6430
Epoch 194, Train Loss: 0.3012, Val Loss: 1.5761
Epoch 195, accuracy: 0.6430
Epoch 196, accuracy: 0.6430
Epoch 196, Train Loss: 0.2506, Val Loss: 1.5761
Epoch 197, accuracy: 0.6430
Epoch 198, accuracy: 0.6430
Epoch 198, Train Loss: 0.2638, Val Loss: 1.5761
Epoch 199, accuracy: 0.6430
Loaded best model with val_loss = 1.0748282670974731
test :accuracy 0.6480, f1_macro: 0.6002, f1_micro: 0.6480, auc: 0.8603
Training mamba3 with 7 layers...
可训练参数: 1900478_mamba3
不可训练参数: 0
✅ Epoch 0: New best model saved with val_loss = 1.5079
Epoch 0, accuracy: 0.3900
Epoch 0, Train Loss: 1.9576, Val Loss: 1.5079
Epoch 1, accuracy: 0.3770
✅ Epoch 2: New best model saved with val_loss = 1.4093
Epoch 2, accuracy: 0.3930
Epoch 2, Train Loss: 1.2142, Val Loss: 1.4093
✅ Epoch 3: New best model saved with val_loss = 1.2907
Epoch 3, accuracy: 0.5000
Epoch 4, accuracy: 0.6110
Epoch 4, Train Loss: 0.8854, Val Loss: 1.3522
Epoch 5, accuracy: 0.5770
Epoch 6, accuracy: 0.5960
Epoch 6, Train Loss: 0.8072, Val Loss: 1.3054
Epoch 7, accuracy: 0.6010
Epoch 8, accuracy: 0.5900
Epoch 8, Train Loss: 0.7848, Val Loss: 1.3652
Epoch 9, accuracy: 0.5580
Epoch 10, accuracy: 0.5580
Epoch 10, Train Loss: 0.6551, Val Loss: 1.4028
Epoch 11, accuracy: 0.5640
Epoch 12, accuracy: 0.5690
Epoch 12, Train Loss: 0.6551, Val Loss: 1.3939
Epoch 13, accuracy: 0.5750
Epoch 14, accuracy: 0.5800
Epoch 14, Train Loss: 0.5674, Val Loss: 1.3760
Epoch 15, accuracy: 0.5950
Epoch 16, accuracy: 0.5950
Epoch 16, Train Loss: 0.5450, Val Loss: 1.3663
Epoch 17, accuracy: 0.5970
Epoch 18, accuracy: 0.5970
Epoch 18, Train Loss: 0.6126, Val Loss: 1.3645
Epoch 19, accuracy: 0.5970
Epoch 20, accuracy: 0.5970
Epoch 20, Train Loss: 0.5635, Val Loss: 1.3627
Epoch 21, accuracy: 0.5980
Epoch 22, accuracy: 0.5980
Epoch 22, Train Loss: 0.5571, Val Loss: 1.3618
Epoch 23, accuracy: 0.5990
Epoch 24, accuracy: 0.5990
Epoch 24, Train Loss: 0.6479, Val Loss: 1.3616
Epoch 25, accuracy: 0.5990
Epoch 26, accuracy: 0.5990
Epoch 26, Train Loss: 0.4822, Val Loss: 1.3614
Epoch 27, accuracy: 0.5990
Epoch 28, accuracy: 0.5990
Epoch 28, Train Loss: 0.4886, Val Loss: 1.3614
Epoch 29, accuracy: 0.5990
Epoch 30, accuracy: 0.5990
Epoch 30, Train Loss: 0.5394, Val Loss: 1.3613
Epoch 31, accuracy: 0.5990
Epoch 32, accuracy: 0.5990
Epoch 32, Train Loss: 0.5249, Val Loss: 1.3613
Epoch 33, accuracy: 0.5990
Epoch 34, accuracy: 0.5990
Epoch 34, Train Loss: 0.5604, Val Loss: 1.3613
Epoch 35, accuracy: 0.5990
Epoch 36, accuracy: 0.5990
Epoch 36, Train Loss: 0.5139, Val Loss: 1.3613
Epoch 37, accuracy: 0.5990
Epoch 38, accuracy: 0.5990
Epoch 38, Train Loss: 0.5310, Val Loss: 1.3613
Epoch 39, accuracy: 0.5990
Epoch 40, accuracy: 0.5990
Epoch 40, Train Loss: 0.5068, Val Loss: 1.3613
Epoch 41, accuracy: 0.5990
Epoch 42, accuracy: 0.5990
Epoch 42, Train Loss: 0.5978, Val Loss: 1.3613
Epoch 43, accuracy: 0.5990
Epoch 44, accuracy: 0.5990
Epoch 44, Train Loss: 0.5556, Val Loss: 1.3613
Epoch 45, accuracy: 0.5990
Epoch 46, accuracy: 0.5990
Epoch 46, Train Loss: 0.5683, Val Loss: 1.3613
Epoch 47, accuracy: 0.5990
Epoch 48, accuracy: 0.5990
Epoch 48, Train Loss: 0.6043, Val Loss: 1.3613
Epoch 49, accuracy: 0.5990
Epoch 50, accuracy: 0.5990
Epoch 50, Train Loss: 0.5078, Val Loss: 1.3613
Epoch 51, accuracy: 0.5990
Epoch 52, accuracy: 0.5990
Epoch 52, Train Loss: 0.5656, Val Loss: 1.3613
Epoch 53, accuracy: 0.5990
Epoch 54, accuracy: 0.5990
Epoch 54, Train Loss: 0.4577, Val Loss: 1.3613
Epoch 55, accuracy: 0.5990
Epoch 56, accuracy: 0.5990
Epoch 56, Train Loss: 0.5390, Val Loss: 1.3613
Epoch 57, accuracy: 0.5990
Epoch 58, accuracy: 0.5990
Epoch 58, Train Loss: 0.3987, Val Loss: 1.3613
Epoch 59, accuracy: 0.5990
Epoch 60, accuracy: 0.5990
Epoch 60, Train Loss: 0.4742, Val Loss: 1.3613
Epoch 61, accuracy: 0.5990
Epoch 62, accuracy: 0.5990
Epoch 62, Train Loss: 0.5143, Val Loss: 1.3613
Epoch 63, accuracy: 0.5990
Epoch 64, accuracy: 0.5990
Epoch 64, Train Loss: 0.5844, Val Loss: 1.3613
Epoch 65, accuracy: 0.5990
Epoch 66, accuracy: 0.5990
Epoch 66, Train Loss: 0.4926, Val Loss: 1.3613
Epoch 67, accuracy: 0.5990
Epoch 68, accuracy: 0.5990
Epoch 68, Train Loss: 0.5942, Val Loss: 1.3613
Epoch 69, accuracy: 0.5990
Epoch 70, accuracy: 0.5990
Epoch 70, Train Loss: 0.5509, Val Loss: 1.3613
Epoch 71, accuracy: 0.5990
Epoch 72, accuracy: 0.5990
Epoch 72, Train Loss: 0.6056, Val Loss: 1.3613
Epoch 73, accuracy: 0.5990
Epoch 74, accuracy: 0.5990
Epoch 74, Train Loss: 0.5990, Val Loss: 1.3613
Epoch 75, accuracy: 0.5990
Epoch 76, accuracy: 0.5990
Epoch 76, Train Loss: 0.5597, Val Loss: 1.3613
Epoch 77, accuracy: 0.5990
Epoch 78, accuracy: 0.5990
Epoch 78, Train Loss: 0.4974, Val Loss: 1.3613
Epoch 79, accuracy: 0.5990
Epoch 80, accuracy: 0.5990
Epoch 80, Train Loss: 0.4723, Val Loss: 1.3613
Epoch 81, accuracy: 0.5990
Epoch 82, accuracy: 0.5990
Epoch 82, Train Loss: 0.5058, Val Loss: 1.3613
Epoch 83, accuracy: 0.5990
Epoch 84, accuracy: 0.5990
Epoch 84, Train Loss: 0.6272, Val Loss: 1.3613
Epoch 85, accuracy: 0.5990
Epoch 86, accuracy: 0.5990
Epoch 86, Train Loss: 0.5556, Val Loss: 1.3613
Epoch 87, accuracy: 0.5990
Epoch 88, accuracy: 0.5990
Epoch 88, Train Loss: 0.5951, Val Loss: 1.3613
Epoch 89, accuracy: 0.5990
Epoch 90, accuracy: 0.5990
Epoch 90, Train Loss: 0.4740, Val Loss: 1.3613
Epoch 91, accuracy: 0.5990
Epoch 92, accuracy: 0.5990
Epoch 92, Train Loss: 0.5080, Val Loss: 1.3613
Epoch 93, accuracy: 0.5990
Epoch 94, accuracy: 0.5990
Epoch 94, Train Loss: 0.5594, Val Loss: 1.3613
Epoch 95, accuracy: 0.5990
Epoch 96, accuracy: 0.5990
Epoch 96, Train Loss: 0.5489, Val Loss: 1.3613
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
/root/miniconda3/lib/python3.12/site-packages/torch_geometric/sampler/neighbor_sampler.py:61: UserWarning: Using 'NeighborSampler' without a 'pyg-lib' installation is deprecated and will be removed soon. Please install 'pyg-lib' for accelerated neighborhood sampling
  warnings.warn(f"Using '{self.__class__.__name__}' without a "
Epoch 97, accuracy: 0.5990
Epoch 98, accuracy: 0.5990
Epoch 98, Train Loss: 0.5184, Val Loss: 1.3613
Epoch 99, accuracy: 0.5990
Epoch 100, accuracy: 0.5990
Epoch 100, Train Loss: 0.6229, Val Loss: 1.3613
Epoch 101, accuracy: 0.5990
Epoch 102, accuracy: 0.5990
Epoch 102, Train Loss: 0.6039, Val Loss: 1.3613
Epoch 103, accuracy: 0.5990
Epoch 104, accuracy: 0.5990
Epoch 104, Train Loss: 0.5305, Val Loss: 1.3613
Epoch 105, accuracy: 0.5990
Epoch 106, accuracy: 0.5990
Epoch 106, Train Loss: 0.5981, Val Loss: 1.3613
Epoch 107, accuracy: 0.5990
Epoch 108, accuracy: 0.5990
Epoch 108, Train Loss: 0.5483, Val Loss: 1.3613
Epoch 109, accuracy: 0.5990
Epoch 110, accuracy: 0.5990
Epoch 110, Train Loss: 0.4977, Val Loss: 1.3613
Epoch 111, accuracy: 0.5990
Epoch 112, accuracy: 0.5990
Epoch 112, Train Loss: 0.5175, Val Loss: 1.3613
Epoch 113, accuracy: 0.5990
Epoch 114, accuracy: 0.5990
Epoch 114, Train Loss: 0.4520, Val Loss: 1.3613
Epoch 115, accuracy: 0.5990
Epoch 116, accuracy: 0.5990
Epoch 116, Train Loss: 0.5561, Val Loss: 1.3613
Epoch 117, accuracy: 0.5990
Epoch 118, accuracy: 0.5990
Epoch 118, Train Loss: 0.5415, Val Loss: 1.3613
Epoch 119, accuracy: 0.5990
Epoch 120, accuracy: 0.5990
Epoch 120, Train Loss: 0.5921, Val Loss: 1.3613
Epoch 121, accuracy: 0.5990
Epoch 122, accuracy: 0.5990
Epoch 122, Train Loss: 0.5926, Val Loss: 1.3613
Epoch 123, accuracy: 0.5990
Epoch 124, accuracy: 0.5990
Epoch 124, Train Loss: 0.5089, Val Loss: 1.3613
Epoch 125, accuracy: 0.5990
Epoch 126, accuracy: 0.5990
Epoch 126, Train Loss: 0.5707, Val Loss: 1.3613
Epoch 127, accuracy: 0.5990
Epoch 128, accuracy: 0.5990
Epoch 128, Train Loss: 0.5265, Val Loss: 1.3613
Epoch 129, accuracy: 0.5990
Epoch 130, accuracy: 0.5990
Epoch 130, Train Loss: 0.5354, Val Loss: 1.3613
Epoch 131, accuracy: 0.5990
Epoch 132, accuracy: 0.5990
Epoch 132, Train Loss: 0.6172, Val Loss: 1.3613
Epoch 133, accuracy: 0.5990
Epoch 134, accuracy: 0.5990
Epoch 134, Train Loss: 0.6143, Val Loss: 1.3613
Epoch 135, accuracy: 0.5990
Epoch 136, accuracy: 0.5990
Epoch 136, Train Loss: 0.6009, Val Loss: 1.3613
Epoch 137, accuracy: 0.5990
Epoch 138, accuracy: 0.5990
Epoch 138, Train Loss: 0.6259, Val Loss: 1.3613
Epoch 139, accuracy: 0.5990
Epoch 140, accuracy: 0.5990
Epoch 140, Train Loss: 0.5435, Val Loss: 1.3613
Epoch 141, accuracy: 0.5990
Epoch 142, accuracy: 0.5990
Epoch 142, Train Loss: 0.5197, Val Loss: 1.3613
Epoch 143, accuracy: 0.5990
Epoch 144, accuracy: 0.5990
Epoch 144, Train Loss: 0.5379, Val Loss: 1.3613
Epoch 145, accuracy: 0.5990
Epoch 146, accuracy: 0.5990
Epoch 146, Train Loss: 0.5663, Val Loss: 1.3613
Epoch 147, accuracy: 0.5990
Epoch 148, accuracy: 0.5990
Epoch 148, Train Loss: 0.5113, Val Loss: 1.3613
Epoch 149, accuracy: 0.5990
Epoch 150, accuracy: 0.5990
Epoch 150, Train Loss: 0.4947, Val Loss: 1.3613
Epoch 151, accuracy: 0.5990
Epoch 152, accuracy: 0.5990
Epoch 152, Train Loss: 0.4518, Val Loss: 1.3613
Epoch 153, accuracy: 0.5990
Epoch 154, accuracy: 0.5990
Epoch 154, Train Loss: 0.5287, Val Loss: 1.3613
Epoch 155, accuracy: 0.5990
Epoch 156, accuracy: 0.5990
Epoch 156, Train Loss: 0.5051, Val Loss: 1.3613
Epoch 157, accuracy: 0.5990
Epoch 158, accuracy: 0.5990
Epoch 158, Train Loss: 0.5257, Val Loss: 1.3613
Epoch 159, accuracy: 0.5990
Epoch 160, accuracy: 0.5990
Epoch 160, Train Loss: 0.5056, Val Loss: 1.3613
Epoch 161, accuracy: 0.5990
Epoch 162, accuracy: 0.5990
Epoch 162, Train Loss: 0.4957, Val Loss: 1.3613
Epoch 163, accuracy: 0.5990
Epoch 164, accuracy: 0.5990
Epoch 164, Train Loss: 0.5205, Val Loss: 1.3613
Epoch 165, accuracy: 0.5990
Epoch 166, accuracy: 0.5990
Epoch 166, Train Loss: 0.5543, Val Loss: 1.3613
Epoch 167, accuracy: 0.5990
Epoch 168, accuracy: 0.5990
Epoch 168, Train Loss: 0.5395, Val Loss: 1.3613
Epoch 169, accuracy: 0.5990
Epoch 170, accuracy: 0.5990
Epoch 170, Train Loss: 0.5766, Val Loss: 1.3613
Epoch 171, accuracy: 0.5990
Epoch 172, accuracy: 0.5990
Epoch 172, Train Loss: 0.5381, Val Loss: 1.3613
Epoch 173, accuracy: 0.5990
Epoch 174, accuracy: 0.5990
Epoch 174, Train Loss: 0.4819, Val Loss: 1.3613
Epoch 175, accuracy: 0.5990
Epoch 176, accuracy: 0.5990
Epoch 176, Train Loss: 0.5325, Val Loss: 1.3613
Epoch 177, accuracy: 0.5990
Epoch 178, accuracy: 0.5990
Epoch 178, Train Loss: 0.5161, Val Loss: 1.3613
Epoch 179, accuracy: 0.5990
Epoch 180, accuracy: 0.5990
Epoch 180, Train Loss: 0.5491, Val Loss: 1.3613
Epoch 181, accuracy: 0.5990
Epoch 182, accuracy: 0.5990
Epoch 182, Train Loss: 0.5532, Val Loss: 1.3613
Epoch 183, accuracy: 0.5990
Epoch 184, accuracy: 0.5990
Epoch 184, Train Loss: 0.5316, Val Loss: 1.3613
Epoch 185, accuracy: 0.5990
Epoch 186, accuracy: 0.5990
Epoch 186, Train Loss: 0.5223, Val Loss: 1.3613
Epoch 187, accuracy: 0.5990
Epoch 188, accuracy: 0.5990
Epoch 188, Train Loss: 0.5188, Val Loss: 1.3613
Epoch 189, accuracy: 0.5990
Epoch 190, accuracy: 0.5990
Epoch 190, Train Loss: 0.4751, Val Loss: 1.3613
Epoch 191, accuracy: 0.5990
Epoch 192, accuracy: 0.5990
Epoch 192, Train Loss: 0.5014, Val Loss: 1.3613
Epoch 193, accuracy: 0.5990
Epoch 194, accuracy: 0.5990
Epoch 194, Train Loss: 0.5429, Val Loss: 1.3613
Epoch 195, accuracy: 0.5990
Epoch 196, accuracy: 0.5990
Epoch 196, Train Loss: 0.6024, Val Loss: 1.3613
Epoch 197, accuracy: 0.5990
Epoch 198, accuracy: 0.5990
Epoch 198, Train Loss: 0.5595, Val Loss: 1.3613
Epoch 199, accuracy: 0.5990
Loaded best model with val_loss = 1.2906618118286133
test :accuracy 0.5000, f1_macro: 0.4559, f1_micro: 0.5000, auc: 0.8238
Final Results: {'GAT_3_Citeseer': np.float64(0.684), 'GAT_4_Citeseer': np.float64(0.695), 'GAT_5_Citeseer': np.float64(0.678), 'GAT_6_Citeseer': np.float64(0.659), 'GAT_7_Citeseer': np.float64(0.604), 'mamba3_3_Citeseer': np.float64(0.629), 'mamba3_4_Citeseer': np.float64(0.621), 'mamba3_5_Citeseer': np.float64(0.638), 'mamba3_6_Citeseer': np.float64(0.648), 'mamba3_7_Citeseer': np.float64(0.5)} ['1578142_GAT_0', '1727518_GAT_0', '1876894_GAT_0', '2026270_GAT_0', '2175646_GAT_0', '1568702_mamba3_0', '1651646_mamba3_0', '1734590_mamba3_0', '1817534_mamba3_0', '1900478_mamba3_0']
GAT_3_Citeseer: Accuracy = 0.6987 ± 0.0137
GAT_4_Citeseer: Accuracy = 0.6953 ± 0.0006
GAT_5_Citeseer: Accuracy = 0.6660 ± 0.0217
GAT_6_Citeseer: Accuracy = 0.6483 ± 0.0193
GAT_7_Citeseer: Accuracy = 0.5730 ± 0.0554
mamba3_3_Citeseer: Accuracy = 0.6253 ± 0.0546
mamba3_4_Citeseer: Accuracy = 0.6247 ± 0.0307
mamba3_5_Citeseer: Accuracy = 0.6450 ± 0.0089
mamba3_6_Citeseer: Accuracy = 0.6447 ± 0.0222
mamba3_7_Citeseer: Accuracy = 0.5753 ± 0.0653
========== Running baseline 1/3 ==========
Training GAT with 3 layers...
可训练参数: 345487_GAT
不可训练参数: 0
batch size: (921, 921)
✅ Epoch 0: New best model saved with val_loss = 1.0831
Epoch 0, accuracy: 0.5405
Epoch 0, Train Loss: 1.1000, Val Loss: 1.0831
batch size: (906, 906)
✅ Epoch 1: New best model saved with val_loss = 1.0509
Epoch 1, accuracy: 0.5933
batch size: (917, 917)
✅ Epoch 2: New best model saved with val_loss = 0.9919
Epoch 2, accuracy: 0.7159
Epoch 2, Train Loss: 1.0267, Val Loss: 0.9919
batch size: (882, 882)
✅ Epoch 3: New best model saved with val_loss = 0.9038
Epoch 3, accuracy: 0.7399
batch size: (893, 893)
✅ Epoch 4: New best model saved with val_loss = 0.7981
Epoch 4, accuracy: 0.7354
Epoch 4, Train Loss: 0.8106, Val Loss: 0.7981
batch size: (902, 902)
✅ Epoch 5: New best model saved with val_loss = 0.7067
Epoch 5, accuracy: 0.7347
batch size: (897, 897)
✅ Epoch 6: New best model saved with val_loss = 0.6354
Epoch 6, accuracy: 0.7355
Epoch 6, Train Loss: 0.5125, Val Loss: 0.6354
batch size: (886, 886)
✅ Epoch 7: New best model saved with val_loss = 0.5937
Epoch 7, accuracy: 0.7412
batch size: (921, 921)
Epoch 8, accuracy: 0.7327
Epoch 8, Train Loss: 0.2845, Val Loss: 0.5977
batch size: (894, 894)
Epoch 9, accuracy: 0.7341
batch size: (907, 907)
Epoch 10, accuracy: 0.7192
Epoch 10, Train Loss: 0.1490, Val Loss: 0.6777
batch size: (883, 883)
Epoch 11, accuracy: 0.7200
batch size: (902, 902)
Epoch 12, accuracy: 0.7213
Epoch 12, Train Loss: 0.0680, Val Loss: 0.7395
batch size: (891, 891)
Epoch 13, accuracy: 0.7256
batch size: (902, 902)
Epoch 14, accuracy: 0.7264
Epoch 14, Train Loss: 0.0503, Val Loss: 0.7761
batch size: (914, 914)
Epoch 15, accuracy: 0.7238
batch size: (887, 887)
Epoch 16, accuracy: 0.7244
Epoch 16, Train Loss: 0.0673, Val Loss: 0.7752
batch size: (910, 910)
Epoch 17, accuracy: 0.7267
batch size: (915, 915)
Epoch 18, accuracy: 0.7238
Epoch 18, Train Loss: 0.0525, Val Loss: 0.8402
batch size: (909, 909)
Epoch 19, accuracy: 0.7269
batch size: (885, 885)
Epoch 20, accuracy: 0.7261
Epoch 20, Train Loss: 0.0219, Val Loss: 0.8463
batch size: (891, 891)
Epoch 21, accuracy: 0.7262
batch size: (914, 914)
Epoch 22, accuracy: 0.7264
Epoch 22, Train Loss: 0.0477, Val Loss: 0.8369
batch size: (894, 894)
Epoch 23, accuracy: 0.7267
batch size: (899, 899)
Epoch 24, accuracy: 0.7266
Epoch 24, Train Loss: 0.0528, Val Loss: 0.8399
batch size: (886, 886)
Epoch 25, accuracy: 0.7269
batch size: (893, 893)
Epoch 26, accuracy: 0.7252
Epoch 26, Train Loss: 0.0291, Val Loss: 0.8840
batch size: (893, 893)
Epoch 27, accuracy: 0.7242
batch size: (912, 912)
Epoch 28, accuracy: 0.7270
Epoch 28, Train Loss: 0.0400, Val Loss: 0.8794
batch size: (882, 882)
Epoch 29, accuracy: 0.7257
batch size: (906, 906)
Epoch 30, accuracy: 0.7241
Epoch 30, Train Loss: 0.0464, Val Loss: 0.8445
batch size: (893, 893)
Epoch 31, accuracy: 0.7255
batch size: (893, 893)
Epoch 32, accuracy: 0.7248
Epoch 32, Train Loss: 0.0341, Val Loss: 0.8630
batch size: (887, 887)
Epoch 33, accuracy: 0.7265
batch size: (909, 909)
Epoch 34, accuracy: 0.7243
Epoch 34, Train Loss: 0.0366, Val Loss: 0.8406
batch size: (901, 901)
Epoch 35, accuracy: 0.7245
batch size: (898, 898)
Epoch 36, accuracy: 0.7242
Epoch 36, Train Loss: 0.0800, Val Loss: 0.8402
batch size: (899, 899)
Epoch 37, accuracy: 0.7259
batch size: (883, 883)
Epoch 38, accuracy: 0.7269
Epoch 38, Train Loss: 0.0211, Val Loss: 0.8159
batch size: (896, 896)
Epoch 39, accuracy: 0.7260
batch size: (893, 893)
Epoch 40, accuracy: 0.7245
Epoch 40, Train Loss: 0.0226, Val Loss: 0.8874
batch size: (926, 926)
Epoch 41, accuracy: 0.7270
batch size: (900, 900)
Epoch 42, accuracy: 0.7251
Epoch 42, Train Loss: 0.0393, Val Loss: 0.8455
batch size: (904, 904)
Epoch 43, accuracy: 0.7280
batch size: (905, 905)
Epoch 44, accuracy: 0.7238
Epoch 44, Train Loss: 0.0395, Val Loss: 0.8696
batch size: (896, 896)
Epoch 45, accuracy: 0.7237
batch size: (879, 879)
Epoch 46, accuracy: 0.7244
Epoch 46, Train Loss: 0.0375, Val Loss: 0.9133
batch size: (909, 909)
Epoch 47, accuracy: 0.7266
batch size: (903, 903)
Epoch 48, accuracy: 0.7252
Epoch 48, Train Loss: 0.0606, Val Loss: 0.9051
batch size: (881, 881)
Epoch 49, accuracy: 0.7248
batch size: (903, 903)
Epoch 50, accuracy: 0.7260
Epoch 50, Train Loss: 0.0244, Val Loss: 0.8315
batch size: (889, 889)
Epoch 51, accuracy: 0.7246
batch size: (911, 911)
Epoch 52, accuracy: 0.7241
Epoch 52, Train Loss: 0.0251, Val Loss: 0.8751
batch size: (894, 894)
Epoch 53, accuracy: 0.7256
batch size: (906, 906)
Epoch 54, accuracy: 0.7228
Epoch 54, Train Loss: 0.0422, Val Loss: 0.8639
batch size: (907, 907)
Epoch 55, accuracy: 0.7261
batch size: (895, 895)
Epoch 56, accuracy: 0.7235
Epoch 56, Train Loss: 0.0538, Val Loss: 0.8209
batch size: (901, 901)
Epoch 57, accuracy: 0.7242
batch size: (908, 908)
Epoch 58, accuracy: 0.7283
Epoch 58, Train Loss: 0.0507, Val Loss: 0.8637
batch size: (905, 905)
Epoch 59, accuracy: 0.7245
batch size: (905, 905)
Epoch 60, accuracy: 0.7259
Epoch 60, Train Loss: 0.0368, Val Loss: 0.8708
batch size: (901, 901)
Epoch 61, accuracy: 0.7257
batch size: (897, 897)
Epoch 62, accuracy: 0.7255
Epoch 62, Train Loss: 0.0416, Val Loss: 0.8644
batch size: (894, 894)
Epoch 63, accuracy: 0.7251
batch size: (888, 888)
Epoch 64, accuracy: 0.7248
Epoch 64, Train Loss: 0.0318, Val Loss: 0.8577
batch size: (894, 894)
Epoch 65, accuracy: 0.7241
batch size: (900, 900)
Epoch 66, accuracy: 0.7250
Epoch 66, Train Loss: 0.0290, Val Loss: 0.8732
batch size: (901, 901)
Epoch 67, accuracy: 0.7247
batch size: (903, 903)
Epoch 68, accuracy: 0.7236
Epoch 68, Train Loss: 0.0243, Val Loss: 0.8602
batch size: (892, 892)
Epoch 69, accuracy: 0.7269
batch size: (926, 926)
Epoch 70, accuracy: 0.7256
Epoch 70, Train Loss: 0.0440, Val Loss: 0.8479
batch size: (897, 897)
Epoch 71, accuracy: 0.7229
batch size: (888, 888)
Epoch 72, accuracy: 0.7264
Epoch 72, Train Loss: 0.0694, Val Loss: 0.8681
batch size: (913, 913)
Epoch 73, accuracy: 0.7275
batch size: (911, 911)
Epoch 74, accuracy: 0.7248
Epoch 74, Train Loss: 0.0724, Val Loss: 0.8387
batch size: (892, 892)
Epoch 75, accuracy: 0.7254
batch size: (903, 903)
Epoch 76, accuracy: 0.7251
Epoch 76, Train Loss: 0.0382, Val Loss: 0.8340
batch size: (885, 885)
Epoch 77, accuracy: 0.7239
batch size: (892, 892)
Epoch 78, accuracy: 0.7255
Epoch 78, Train Loss: 0.0392, Val Loss: 0.8448
batch size: (898, 898)
Epoch 79, accuracy: 0.7224
batch size: (891, 891)
Epoch 80, accuracy: 0.7235
Epoch 80, Train Loss: 0.0209, Val Loss: 0.8739
batch size: (896, 896)
Epoch 81, accuracy: 0.7267
batch size: (896, 896)
Epoch 82, accuracy: 0.7241
Epoch 82, Train Loss: 0.0540, Val Loss: 0.8669
batch size: (907, 907)
Epoch 83, accuracy: 0.7230
batch size: (908, 908)
Epoch 84, accuracy: 0.7265
Epoch 84, Train Loss: 0.0256, Val Loss: 0.8734
batch size: (885, 885)
Epoch 85, accuracy: 0.7265
batch size: (897, 897)
Epoch 86, accuracy: 0.7240
Epoch 86, Train Loss: 0.0435, Val Loss: 0.8494
batch size: (889, 889)
Epoch 87, accuracy: 0.7269
batch size: (915, 915)
Epoch 88, accuracy: 0.7259
Epoch 88, Train Loss: 0.0361, Val Loss: 0.8713
batch size: (911, 911)
Epoch 89, accuracy: 0.7250
batch size: (904, 904)
Epoch 90, accuracy: 0.7255
Epoch 90, Train Loss: 0.0467, Val Loss: 0.8866
batch size: (888, 888)
Epoch 91, accuracy: 0.7236
batch size: (883, 883)
Epoch 92, accuracy: 0.7256
Epoch 92, Train Loss: 0.0245, Val Loss: 0.8893
batch size: (890, 890)
Epoch 93, accuracy: 0.7254
batch size: (894, 894)
Epoch 94, accuracy: 0.7245
Epoch 94, Train Loss: 0.0825, Val Loss: 0.8535
batch size: (902, 902)
Epoch 95, accuracy: 0.7227
batch size: (902, 902)
Epoch 96, accuracy: 0.7255
Epoch 96, Train Loss: 0.0227, Val Loss: 0.8628
batch size: (889, 889)
Epoch 97, accuracy: 0.7247
batch size: (910, 910)
Epoch 98, accuracy: 0.7242
Epoch 98, Train Loss: 0.0298, Val Loss: 0.8689
batch size: (904, 904)
Epoch 99, accuracy: 0.7261
batch size: (894, 894)
Epoch 100, accuracy: 0.7259
Epoch 100, Train Loss: 0.0525, Val Loss: 0.8524
batch size: (898, 898)
Epoch 101, accuracy: 0.7262
batch size: (899, 899)
Epoch 102, accuracy: 0.7268
Epoch 102, Train Loss: 0.0329, Val Loss: 0.8348
batch size: (917, 917)
Epoch 103, accuracy: 0.7261
batch size: (893, 893)
Epoch 104, accuracy: 0.7260
Epoch 104, Train Loss: 0.0407, Val Loss: 0.8417
batch size: (892, 892)
Epoch 105, accuracy: 0.7263
batch size: (912, 912)
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 106, accuracy: 0.7240
Epoch 106, Train Loss: 0.0354, Val Loss: 0.8802
batch size: (904, 904)
Epoch 107, accuracy: 0.7249
batch size: (880, 880)
Epoch 108, accuracy: 0.7269
Epoch 108, Train Loss: 0.0525, Val Loss: 0.8697
batch size: (906, 906)
Epoch 109, accuracy: 0.7230
batch size: (899, 899)
Epoch 110, accuracy: 0.7241
Epoch 110, Train Loss: 0.0378, Val Loss: 0.8710
batch size: (894, 894)
Epoch 111, accuracy: 0.7251
batch size: (887, 887)
Epoch 112, accuracy: 0.7261
Epoch 112, Train Loss: 0.0270, Val Loss: 0.8720
batch size: (911, 911)
Epoch 113, accuracy: 0.7254
batch size: (916, 916)
Epoch 114, accuracy: 0.7257
Epoch 114, Train Loss: 0.0371, Val Loss: 0.8302
batch size: (891, 891)
Epoch 115, accuracy: 0.7237
batch size: (903, 903)
Epoch 116, accuracy: 0.7246
Epoch 116, Train Loss: 0.0354, Val Loss: 0.9156
batch size: (897, 897)
Epoch 117, accuracy: 0.7270
batch size: (902, 902)
Epoch 118, accuracy: 0.7245
Epoch 118, Train Loss: 0.0657, Val Loss: 0.8821
batch size: (902, 902)
Epoch 119, accuracy: 0.7272
batch size: (908, 908)
Epoch 120, accuracy: 0.7244
Epoch 120, Train Loss: 0.0345, Val Loss: 0.8473
batch size: (886, 886)
Epoch 121, accuracy: 0.7271
batch size: (923, 923)
Epoch 122, accuracy: 0.7257
Epoch 122, Train Loss: 0.0720, Val Loss: 0.8569
batch size: (904, 904)
Epoch 123, accuracy: 0.7265
batch size: (902, 902)
Epoch 124, accuracy: 0.7283
Epoch 124, Train Loss: 0.0261, Val Loss: 0.8503
batch size: (900, 900)
Epoch 125, accuracy: 0.7270
batch size: (897, 897)
Epoch 126, accuracy: 0.7256
Epoch 126, Train Loss: 0.0183, Val Loss: 0.8701
batch size: (913, 913)
Epoch 127, accuracy: 0.7244
batch size: (909, 909)
Epoch 128, accuracy: 0.7259
Epoch 128, Train Loss: 0.0379, Val Loss: 0.8684
batch size: (894, 894)
Epoch 129, accuracy: 0.7282
batch size: (869, 869)
Epoch 130, accuracy: 0.7245
Epoch 130, Train Loss: 0.0747, Val Loss: 0.8775
batch size: (908, 908)
Epoch 131, accuracy: 0.7255
batch size: (895, 895)
Epoch 132, accuracy: 0.7265
Epoch 132, Train Loss: 0.0321, Val Loss: 0.8509
batch size: (909, 909)
Epoch 133, accuracy: 0.7252
batch size: (895, 895)
Epoch 134, accuracy: 0.7245
Epoch 134, Train Loss: 0.0482, Val Loss: 0.8393
batch size: (896, 896)
Epoch 135, accuracy: 0.7256
batch size: (890, 890)
Epoch 136, accuracy: 0.7256
Epoch 136, Train Loss: 0.0589, Val Loss: 0.8691
batch size: (903, 903)
Epoch 137, accuracy: 0.7249
batch size: (900, 900)
Epoch 138, accuracy: 0.7270
Epoch 138, Train Loss: 0.1049, Val Loss: 0.9080
batch size: (918, 918)
Epoch 139, accuracy: 0.7248
batch size: (915, 915)
Epoch 140, accuracy: 0.7241
Epoch 140, Train Loss: 0.0442, Val Loss: 0.8608
batch size: (893, 893)
Epoch 141, accuracy: 0.7254
batch size: (889, 889)
Epoch 142, accuracy: 0.7242
Epoch 142, Train Loss: 0.0513, Val Loss: 0.8672
batch size: (921, 921)
Epoch 143, accuracy: 0.7253
batch size: (891, 891)
Epoch 144, accuracy: 0.7242
Epoch 144, Train Loss: 0.0600, Val Loss: 0.8037
batch size: (876, 876)
Epoch 145, accuracy: 0.7244
batch size: (916, 916)
Epoch 146, accuracy: 0.7245
Epoch 146, Train Loss: 0.0210, Val Loss: 0.8577
batch size: (897, 897)
Epoch 147, accuracy: 0.7269
batch size: (897, 897)
Epoch 148, accuracy: 0.7247
Epoch 148, Train Loss: 0.0636, Val Loss: 0.8273
batch size: (905, 905)
Epoch 149, accuracy: 0.7262
batch size: (886, 886)
Epoch 150, accuracy: 0.7262
Epoch 150, Train Loss: 0.0828, Val Loss: 0.8982
batch size: (911, 911)
Epoch 151, accuracy: 0.7261
batch size: (896, 896)
Epoch 152, accuracy: 0.7242
Epoch 152, Train Loss: 0.0748, Val Loss: 0.8865
batch size: (900, 900)
Epoch 153, accuracy: 0.7250
batch size: (901, 901)
Epoch 154, accuracy: 0.7246
Epoch 154, Train Loss: 0.0471, Val Loss: 0.8548
batch size: (890, 890)
Epoch 155, accuracy: 0.7254
batch size: (899, 899)
Epoch 156, accuracy: 0.7273
Epoch 156, Train Loss: 0.0857, Val Loss: 0.8382
batch size: (908, 908)
Epoch 157, accuracy: 0.7265
batch size: (919, 919)
Epoch 158, accuracy: 0.7261
Epoch 158, Train Loss: 0.0296, Val Loss: 0.8441
batch size: (912, 912)
Epoch 159, accuracy: 0.7244
batch size: (896, 896)
Epoch 160, accuracy: 0.7271
Epoch 160, Train Loss: 0.0488, Val Loss: 0.8695
batch size: (904, 904)
Epoch 161, accuracy: 0.7242
batch size: (883, 883)
Epoch 162, accuracy: 0.7248
Epoch 162, Train Loss: 0.0231, Val Loss: 0.8693
batch size: (894, 894)
Epoch 163, accuracy: 0.7243
batch size: (916, 916)
Epoch 164, accuracy: 0.7258
Epoch 164, Train Loss: 0.0179, Val Loss: 0.8842
batch size: (904, 904)
Epoch 165, accuracy: 0.7231
batch size: (906, 906)
Epoch 166, accuracy: 0.7267
Epoch 166, Train Loss: 0.0261, Val Loss: 0.8552
batch size: (898, 898)
Epoch 167, accuracy: 0.7258
batch size: (915, 915)
Epoch 168, accuracy: 0.7255
Epoch 168, Train Loss: 0.0617, Val Loss: 0.8305
batch size: (904, 904)
Epoch 169, accuracy: 0.7252
batch size: (902, 902)
Epoch 170, accuracy: 0.7245
Epoch 170, Train Loss: 0.0661, Val Loss: 0.8423
batch size: (894, 894)
Epoch 171, accuracy: 0.7239
batch size: (899, 899)
Epoch 172, accuracy: 0.7245
Epoch 172, Train Loss: 0.0313, Val Loss: 0.8411
batch size: (882, 882)
Epoch 173, accuracy: 0.7252
batch size: (896, 896)
Epoch 174, accuracy: 0.7235
Epoch 174, Train Loss: 0.0435, Val Loss: 0.8532
batch size: (909, 909)
Epoch 175, accuracy: 0.7271
batch size: (877, 877)
Epoch 176, accuracy: 0.7260
Epoch 176, Train Loss: 0.0230, Val Loss: 0.8736
batch size: (892, 892)
Epoch 177, accuracy: 0.7240
batch size: (900, 900)
Epoch 178, accuracy: 0.7257
Epoch 178, Train Loss: 0.0320, Val Loss: 0.8412
batch size: (886, 886)
Epoch 179, accuracy: 0.7268
batch size: (890, 890)
Epoch 180, accuracy: 0.7240
Epoch 180, Train Loss: 0.0584, Val Loss: 0.8451
batch size: (893, 893)
Epoch 181, accuracy: 0.7258
batch size: (868, 868)
Epoch 182, accuracy: 0.7271
Epoch 182, Train Loss: 0.0195, Val Loss: 0.8179
batch size: (909, 909)
Epoch 183, accuracy: 0.7256
batch size: (917, 917)
Epoch 184, accuracy: 0.7267
Epoch 184, Train Loss: 0.0559, Val Loss: 0.8542
batch size: (903, 903)
Epoch 185, accuracy: 0.7251
batch size: (911, 911)
Epoch 186, accuracy: 0.7261
Epoch 186, Train Loss: 0.0514, Val Loss: 0.8687
batch size: (888, 888)
Epoch 187, accuracy: 0.7243
batch size: (894, 894)
Epoch 188, accuracy: 0.7257
Epoch 188, Train Loss: 0.0435, Val Loss: 0.8960
batch size: (913, 913)
Epoch 189, accuracy: 0.7251
batch size: (902, 902)
Epoch 190, accuracy: 0.7257
Epoch 190, Train Loss: 0.0493, Val Loss: 0.8935
batch size: (885, 885)
Epoch 191, accuracy: 0.7253
batch size: (905, 905)
Epoch 192, accuracy: 0.7261
Epoch 192, Train Loss: 0.0308, Val Loss: 0.8627
batch size: (908, 908)
Epoch 193, accuracy: 0.7270
batch size: (904, 904)
Epoch 194, accuracy: 0.7259
Epoch 194, Train Loss: 0.0469, Val Loss: 0.8773
batch size: (901, 901)
Epoch 195, accuracy: 0.7270
batch size: (898, 898)
Epoch 196, accuracy: 0.7249
Epoch 196, Train Loss: 0.0390, Val Loss: 0.8940
batch size: (913, 913)
Epoch 197, accuracy: 0.7227
batch size: (886, 886)
Epoch 198, accuracy: 0.7246
Epoch 198, Train Loss: 0.0282, Val Loss: 0.8816
batch size: (899, 899)
Epoch 199, accuracy: 0.7242
Loaded best model with val_loss = 0.5937276482582092
test :accuracy 0.7367, f1_macro: 0.7343, f1_micro: 0.7367, auc: 0.8914
Training GAT with 4 layers...
可训练参数: 494479_GAT
不可训练参数: 0
batch size: (904, 904)
✅ Epoch 0: New best model saved with val_loss = 1.0927
Epoch 0, accuracy: 0.3866
Epoch 0, Train Loss: 1.0978, Val Loss: 1.0927
batch size: (910, 910)
✅ Epoch 1: New best model saved with val_loss = 1.0636
Epoch 1, accuracy: 0.6419
batch size: (878, 878)
✅ Epoch 2: New best model saved with val_loss = 0.9916
Epoch 2, accuracy: 0.7047
Epoch 2, Train Loss: 1.0423, Val Loss: 0.9916
batch size: (891, 891)
✅ Epoch 3: New best model saved with val_loss = 0.8584
Epoch 3, accuracy: 0.7042
batch size: (895, 895)
✅ Epoch 4: New best model saved with val_loss = 0.7125
Epoch 4, accuracy: 0.7048
Epoch 4, Train Loss: 0.7314, Val Loss: 0.7125
batch size: (901, 901)
✅ Epoch 5: New best model saved with val_loss = 0.6522
Epoch 5, accuracy: 0.7316
batch size: (916, 916)
Epoch 6, accuracy: 0.6830
Epoch 6, Train Loss: 0.3373, Val Loss: 0.7214
batch size: (887, 887)
Epoch 7, accuracy: 0.6490
batch size: (878, 878)
Epoch 8, accuracy: 0.6983
Epoch 8, Train Loss: 0.4751, Val Loss: 0.8500
batch size: (891, 891)
Epoch 9, accuracy: 0.6265
batch size: (898, 898)
Epoch 10, accuracy: 0.6950
Epoch 10, Train Loss: 0.3765, Val Loss: 0.8692
batch size: (910, 910)
Epoch 11, accuracy: 0.7138
batch size: (883, 883)
Epoch 12, accuracy: 0.7166
Epoch 12, Train Loss: 0.1386, Val Loss: 1.0674
batch size: (907, 907)
Epoch 13, accuracy: 0.7181
batch size: (906, 906)
Epoch 14, accuracy: 0.7287
Epoch 14, Train Loss: 0.0718, Val Loss: 1.0058
batch size: (903, 903)
Epoch 15, accuracy: 0.7315
batch size: (884, 884)
Epoch 16, accuracy: 0.7340
Epoch 16, Train Loss: 0.0861, Val Loss: 0.9044
batch size: (908, 908)
Epoch 17, accuracy: 0.7356
batch size: (892, 892)
Epoch 18, accuracy: 0.7390
Epoch 18, Train Loss: 0.0576, Val Loss: 0.9082
batch size: (895, 895)
Epoch 19, accuracy: 0.7378
batch size: (914, 914)
Epoch 20, accuracy: 0.7338
Epoch 20, Train Loss: 0.0630, Val Loss: 0.9104
batch size: (889, 889)
Epoch 21, accuracy: 0.7342
batch size: (898, 898)
Epoch 22, accuracy: 0.7335
Epoch 22, Train Loss: 0.0964, Val Loss: 0.8697
batch size: (908, 908)
Epoch 23, accuracy: 0.7319
batch size: (905, 905)
Epoch 24, accuracy: 0.7341
Epoch 24, Train Loss: 0.0660, Val Loss: 0.8753
batch size: (904, 904)
Epoch 25, accuracy: 0.7342
batch size: (886, 886)
Epoch 26, accuracy: 0.7323
Epoch 26, Train Loss: 0.1146, Val Loss: 0.9242
batch size: (898, 898)
Epoch 27, accuracy: 0.7328
batch size: (910, 910)
Epoch 28, accuracy: 0.7345
Epoch 28, Train Loss: 0.0720, Val Loss: 0.8767
batch size: (887, 887)
Epoch 29, accuracy: 0.7330
batch size: (903, 903)
Epoch 30, accuracy: 0.7333
Epoch 30, Train Loss: 0.0586, Val Loss: 0.8901
batch size: (902, 902)
Epoch 31, accuracy: 0.7319
batch size: (900, 900)
Epoch 32, accuracy: 0.7332
Epoch 32, Train Loss: 0.0524, Val Loss: 0.8325
batch size: (909, 909)
Epoch 33, accuracy: 0.7333
batch size: (902, 902)
Epoch 34, accuracy: 0.7325
Epoch 34, Train Loss: 0.0751, Val Loss: 0.9271
batch size: (903, 903)
Epoch 35, accuracy: 0.7355
batch size: (878, 878)
Epoch 36, accuracy: 0.7333
Epoch 36, Train Loss: 0.0889, Val Loss: 0.8933
batch size: (888, 888)
Epoch 37, accuracy: 0.7345
batch size: (908, 908)
Epoch 38, accuracy: 0.7359
Epoch 38, Train Loss: 0.0656, Val Loss: 0.8716
batch size: (912, 912)
Epoch 39, accuracy: 0.7306
batch size: (907, 907)
Epoch 40, accuracy: 0.7336
Epoch 40, Train Loss: 0.0514, Val Loss: 0.9235
batch size: (898, 898)
Epoch 41, accuracy: 0.7343
batch size: (883, 883)
Epoch 42, accuracy: 0.7337
Epoch 42, Train Loss: 0.0637, Val Loss: 0.8622
batch size: (895, 895)
Epoch 43, accuracy: 0.7329
batch size: (893, 893)
Epoch 44, accuracy: 0.7314
Epoch 44, Train Loss: 0.0666, Val Loss: 0.9049
batch size: (880, 880)
Epoch 45, accuracy: 0.7345
batch size: (916, 916)
Epoch 46, accuracy: 0.7326
Epoch 46, Train Loss: 0.0948, Val Loss: 0.8772
batch size: (894, 894)
Epoch 47, accuracy: 0.7347
batch size: (897, 897)
Epoch 48, accuracy: 0.7314
Epoch 48, Train Loss: 0.0528, Val Loss: 0.9134
batch size: (884, 884)
Epoch 49, accuracy: 0.7326
batch size: (909, 909)
Epoch 50, accuracy: 0.7330
Epoch 50, Train Loss: 0.0694, Val Loss: 0.9131
batch size: (901, 901)
Epoch 51, accuracy: 0.7344
batch size: (907, 907)
Epoch 52, accuracy: 0.7312
Epoch 52, Train Loss: 0.0441, Val Loss: 0.9096
batch size: (904, 904)
Epoch 53, accuracy: 0.7327
batch size: (905, 905)
Epoch 54, accuracy: 0.7299
Epoch 54, Train Loss: 0.0455, Val Loss: 0.8841
batch size: (894, 894)
Epoch 55, accuracy: 0.7349
batch size: (915, 915)
Epoch 56, accuracy: 0.7301
Epoch 56, Train Loss: 0.0500, Val Loss: 0.8722
batch size: (922, 922)
Epoch 57, accuracy: 0.7311
batch size: (910, 910)
Epoch 58, accuracy: 0.7344
Epoch 58, Train Loss: 0.0687, Val Loss: 0.8742
batch size: (893, 893)
Epoch 59, accuracy: 0.7368
batch size: (897, 897)
Epoch 60, accuracy: 0.7324
Epoch 60, Train Loss: 0.0688, Val Loss: 0.8696
batch size: (896, 896)
Epoch 61, accuracy: 0.7318
batch size: (905, 905)
Epoch 62, accuracy: 0.7332
Epoch 62, Train Loss: 0.0693, Val Loss: 0.9120
batch size: (909, 909)
Epoch 63, accuracy: 0.7328
batch size: (905, 905)
Epoch 64, accuracy: 0.7334
Epoch 64, Train Loss: 0.0583, Val Loss: 0.8558
batch size: (888, 888)
Epoch 65, accuracy: 0.7340
batch size: (897, 897)
Epoch 66, accuracy: 0.7345
Epoch 66, Train Loss: 0.0508, Val Loss: 0.8933
batch size: (908, 908)
Epoch 67, accuracy: 0.7343
batch size: (898, 898)
Epoch 68, accuracy: 0.7321
Epoch 68, Train Loss: 0.0602, Val Loss: 0.9161
batch size: (881, 881)
Epoch 69, accuracy: 0.7327
batch size: (903, 903)
Epoch 70, accuracy: 0.7350
Epoch 70, Train Loss: 0.0918, Val Loss: 0.8663
batch size: (904, 904)
Epoch 71, accuracy: 0.7331
batch size: (890, 890)
Epoch 72, accuracy: 0.7356
Epoch 72, Train Loss: 0.0347, Val Loss: 0.8747
batch size: (926, 926)
Epoch 73, accuracy: 0.7317
batch size: (898, 898)
Epoch 74, accuracy: 0.7350
Epoch 74, Train Loss: 0.0840, Val Loss: 0.8549
batch size: (886, 886)
Epoch 75, accuracy: 0.7346
batch size: (884, 884)
Epoch 76, accuracy: 0.7363
Epoch 76, Train Loss: 0.0583, Val Loss: 0.9443
batch size: (881, 881)
Epoch 77, accuracy: 0.7331
batch size: (902, 902)
Epoch 78, accuracy: 0.7325
Epoch 78, Train Loss: 0.0635, Val Loss: 0.8709
batch size: (885, 885)
Epoch 79, accuracy: 0.7341
batch size: (910, 910)
Epoch 80, accuracy: 0.7333
Epoch 80, Train Loss: 0.0921, Val Loss: 0.8487
batch size: (911, 911)
Epoch 81, accuracy: 0.7335
batch size: (919, 919)
Epoch 82, accuracy: 0.7331
Epoch 82, Train Loss: 0.1003, Val Loss: 0.8854
batch size: (898, 898)
Epoch 83, accuracy: 0.7337
batch size: (905, 905)
Epoch 84, accuracy: 0.7323
Epoch 84, Train Loss: 0.0363, Val Loss: 0.9016
batch size: (907, 907)
Epoch 85, accuracy: 0.7338
batch size: (910, 910)
Epoch 86, accuracy: 0.7321
Epoch 86, Train Loss: 0.0560, Val Loss: 0.8864
batch size: (918, 918)
Epoch 87, accuracy: 0.7314
batch size: (904, 904)
Epoch 88, accuracy: 0.7317
Epoch 88, Train Loss: 0.0757, Val Loss: 0.9240
batch size: (906, 906)
Epoch 89, accuracy: 0.7324
batch size: (894, 894)
Epoch 90, accuracy: 0.7338
Epoch 90, Train Loss: 0.0509, Val Loss: 0.8937
batch size: (907, 907)
Epoch 91, accuracy: 0.7329
batch size: (916, 916)
Epoch 92, accuracy: 0.7340
Epoch 92, Train Loss: 0.0899, Val Loss: 0.8732
batch size: (906, 906)
Epoch 93, accuracy: 0.7349
batch size: (907, 907)
Epoch 94, accuracy: 0.7327
Epoch 94, Train Loss: 0.0629, Val Loss: 0.8906
batch size: (914, 914)
Epoch 95, accuracy: 0.7345
batch size: (903, 903)
Epoch 96, accuracy: 0.7324
Epoch 96, Train Loss: 0.1084, Val Loss: 0.8819
batch size: (879, 879)
Epoch 97, accuracy: 0.7335
batch size: (909, 909)
Epoch 98, accuracy: 0.7355
Epoch 98, Train Loss: 0.0767, Val Loss: 0.9053
batch size: (894, 894)
Epoch 99, accuracy: 0.7322
batch size: (884, 884)
Epoch 100, accuracy: 0.7327
Epoch 100, Train Loss: 0.0668, Val Loss: 0.9089
batch size: (927, 927)
Epoch 101, accuracy: 0.7326
batch size: (916, 916)
Epoch 102, accuracy: 0.7337
Epoch 102, Train Loss: 0.0803, Val Loss: 0.9004
batch size: (898, 898)
Epoch 103, accuracy: 0.7318
batch size: (897, 897)
Epoch 104, accuracy: 0.7347
Epoch 104, Train Loss: 0.0376, Val Loss: 0.8438
batch size: (886, 886)
Epoch 105, accuracy: 0.7323
batch size: (876, 876)
Epoch 106, accuracy: 0.7323
Epoch 106, Train Loss: 0.0506, Val Loss: 0.9118
batch size: (903, 903)
Epoch 107, accuracy: 0.7317
batch size: (881, 881)
Epoch 108, accuracy: 0.7339
Epoch 108, Train Loss: 0.0777, Val Loss: 0.9083
batch size: (917, 917)
Epoch 109, accuracy: 0.7316
batch size: (906, 906)
Epoch 110, accuracy: 0.7330
Epoch 110, Train Loss: 0.0594, Val Loss: 0.8552
batch size: (900, 900)
Epoch 111, accuracy: 0.7346
batch size: (911, 911)
Epoch 112, accuracy: 0.7316
Epoch 112, Train Loss: 0.0676, Val Loss: 0.9098
batch size: (893, 893)
Epoch 113, accuracy: 0.7339
batch size: (884, 884)
Epoch 114, accuracy: 0.7340
Epoch 114, Train Loss: 0.0578, Val Loss: 0.9143
batch size: (893, 893)
Epoch 115, accuracy: 0.7312
batch size: (895, 895)
Epoch 116, accuracy: 0.7312
Epoch 116, Train Loss: 0.0986, Val Loss: 0.9052
batch size: (919, 919)
Epoch 117, accuracy: 0.7351
batch size: (894, 894)
Epoch 118, accuracy: 0.7333
Epoch 118, Train Loss: 0.0470, Val Loss: 0.8789
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
batch size: (910, 910)
Epoch 119, accuracy: 0.7353
batch size: (889, 889)
Epoch 120, accuracy: 0.7338
Epoch 120, Train Loss: 0.0747, Val Loss: 0.8749
batch size: (919, 919)
Epoch 121, accuracy: 0.7363
batch size: (902, 902)
Epoch 122, accuracy: 0.7351
Epoch 122, Train Loss: 0.0919, Val Loss: 0.9423
batch size: (891, 891)
Epoch 123, accuracy: 0.7338
batch size: (904, 904)
Epoch 124, accuracy: 0.7332
Epoch 124, Train Loss: 0.1137, Val Loss: 0.9091
batch size: (919, 919)
Epoch 125, accuracy: 0.7334
batch size: (900, 900)
Epoch 126, accuracy: 0.7318
Epoch 126, Train Loss: 0.0830, Val Loss: 0.8859
batch size: (897, 897)
Epoch 127, accuracy: 0.7336
batch size: (903, 903)
Epoch 128, accuracy: 0.7345
Epoch 128, Train Loss: 0.0614, Val Loss: 0.8578
batch size: (912, 912)
Epoch 129, accuracy: 0.7337
batch size: (899, 899)
Epoch 130, accuracy: 0.7338
Epoch 130, Train Loss: 0.0413, Val Loss: 0.9197
batch size: (885, 885)
Epoch 131, accuracy: 0.7315
batch size: (888, 888)
Epoch 132, accuracy: 0.7344
Epoch 132, Train Loss: 0.1021, Val Loss: 0.9067
batch size: (901, 901)
Epoch 133, accuracy: 0.7313
batch size: (906, 906)
Epoch 134, accuracy: 0.7344
Epoch 134, Train Loss: 0.0913, Val Loss: 0.9090
batch size: (889, 889)
Epoch 135, accuracy: 0.7335
batch size: (895, 895)
Epoch 136, accuracy: 0.7327
Epoch 136, Train Loss: 0.0959, Val Loss: 0.8832
batch size: (880, 880)
Epoch 137, accuracy: 0.7314
batch size: (907, 907)
Epoch 138, accuracy: 0.7320
Epoch 138, Train Loss: 0.0832, Val Loss: 0.8863
batch size: (925, 925)
Epoch 139, accuracy: 0.7321
batch size: (900, 900)
Epoch 140, accuracy: 0.7324
Epoch 140, Train Loss: 0.0675, Val Loss: 0.8585
batch size: (902, 902)
Epoch 141, accuracy: 0.7331
batch size: (901, 901)
Epoch 142, accuracy: 0.7332
Epoch 142, Train Loss: 0.0380, Val Loss: 0.8856
batch size: (888, 888)
Epoch 143, accuracy: 0.7336
batch size: (885, 885)
Epoch 144, accuracy: 0.7345
Epoch 144, Train Loss: 0.0928, Val Loss: 0.8723
batch size: (908, 908)
Epoch 145, accuracy: 0.7333
batch size: (909, 909)
Epoch 146, accuracy: 0.7347
Epoch 146, Train Loss: 0.0812, Val Loss: 0.8851
batch size: (910, 910)
Epoch 147, accuracy: 0.7342
batch size: (898, 898)
Epoch 148, accuracy: 0.7342
Epoch 148, Train Loss: 0.0894, Val Loss: 0.8878
batch size: (902, 902)
Epoch 149, accuracy: 0.7316
batch size: (899, 899)
Epoch 150, accuracy: 0.7332
Epoch 150, Train Loss: 0.0427, Val Loss: 0.8810
batch size: (900, 900)
Epoch 151, accuracy: 0.7343
batch size: (902, 902)
Epoch 152, accuracy: 0.7344
Epoch 152, Train Loss: 0.0554, Val Loss: 0.8693
batch size: (878, 878)
Epoch 153, accuracy: 0.7331
batch size: (896, 896)
Epoch 154, accuracy: 0.7332
Epoch 154, Train Loss: 0.0692, Val Loss: 0.8928
batch size: (890, 890)
Epoch 155, accuracy: 0.7352
batch size: (905, 905)
Epoch 156, accuracy: 0.7329
Epoch 156, Train Loss: 0.0655, Val Loss: 0.9107
batch size: (892, 892)
Epoch 157, accuracy: 0.7333
batch size: (900, 900)
Epoch 158, accuracy: 0.7314
Epoch 158, Train Loss: 0.0365, Val Loss: 0.8447
batch size: (905, 905)
Epoch 159, accuracy: 0.7334
batch size: (893, 893)
Epoch 160, accuracy: 0.7331
Epoch 160, Train Loss: 0.0608, Val Loss: 0.8681
batch size: (905, 905)
Epoch 161, accuracy: 0.7353
batch size: (897, 897)
Epoch 162, accuracy: 0.7337
Epoch 162, Train Loss: 0.0625, Val Loss: 0.8840
batch size: (920, 920)
Epoch 163, accuracy: 0.7332
batch size: (908, 908)
Epoch 164, accuracy: 0.7332
Epoch 164, Train Loss: 0.1070, Val Loss: 0.8796
batch size: (906, 906)
Epoch 165, accuracy: 0.7335
batch size: (918, 918)
Epoch 166, accuracy: 0.7350
Epoch 166, Train Loss: 0.0499, Val Loss: 0.9132
batch size: (907, 907)
Epoch 167, accuracy: 0.7345
batch size: (898, 898)
Epoch 168, accuracy: 0.7314
Epoch 168, Train Loss: 0.0412, Val Loss: 0.8890
batch size: (895, 895)
Epoch 169, accuracy: 0.7321
batch size: (910, 910)
Epoch 170, accuracy: 0.7319
Epoch 170, Train Loss: 0.1040, Val Loss: 0.9292
batch size: (894, 894)
Epoch 171, accuracy: 0.7327
batch size: (897, 897)
Epoch 172, accuracy: 0.7342
Epoch 172, Train Loss: 0.0507, Val Loss: 0.9404
batch size: (904, 904)
Epoch 173, accuracy: 0.7301
batch size: (883, 883)
Epoch 174, accuracy: 0.7334
Epoch 174, Train Loss: 0.0384, Val Loss: 0.9036
batch size: (899, 899)
Epoch 175, accuracy: 0.7351
batch size: (885, 885)
Epoch 176, accuracy: 0.7315
Epoch 176, Train Loss: 0.1146, Val Loss: 0.8858
batch size: (896, 896)
Epoch 177, accuracy: 0.7332
batch size: (906, 906)
Epoch 178, accuracy: 0.7338
Epoch 178, Train Loss: 0.0446, Val Loss: 0.9010
batch size: (895, 895)
Epoch 179, accuracy: 0.7343
batch size: (893, 893)
Epoch 180, accuracy: 0.7325
Epoch 180, Train Loss: 0.0776, Val Loss: 0.9474
batch size: (899, 899)
Epoch 181, accuracy: 0.7359
batch size: (898, 898)
Epoch 182, accuracy: 0.7347
Epoch 182, Train Loss: 0.0603, Val Loss: 0.8877
batch size: (881, 881)
Epoch 183, accuracy: 0.7337
batch size: (920, 920)
Epoch 184, accuracy: 0.7346
Epoch 184, Train Loss: 0.0580, Val Loss: 0.8597
batch size: (906, 906)
Epoch 185, accuracy: 0.7347
batch size: (900, 900)
Epoch 186, accuracy: 0.7321
Epoch 186, Train Loss: 0.0969, Val Loss: 0.8920
batch size: (900, 900)
Epoch 187, accuracy: 0.7315
batch size: (910, 910)
Epoch 188, accuracy: 0.7325
Epoch 188, Train Loss: 0.0796, Val Loss: 0.8774
batch size: (911, 911)
Epoch 189, accuracy: 0.7342
batch size: (900, 900)
Epoch 190, accuracy: 0.7318
Epoch 190, Train Loss: 0.0561, Val Loss: 0.9208
batch size: (926, 926)
Epoch 191, accuracy: 0.7334
batch size: (894, 894)
Epoch 192, accuracy: 0.7349
Epoch 192, Train Loss: 0.0367, Val Loss: 0.8530
batch size: (906, 906)
Epoch 193, accuracy: 0.7343
batch size: (900, 900)
Epoch 194, accuracy: 0.7341
Epoch 194, Train Loss: 0.0553, Val Loss: 0.8651
batch size: (883, 883)
Epoch 195, accuracy: 0.7357
batch size: (897, 897)
Epoch 196, accuracy: 0.7331
Epoch 196, Train Loss: 0.0508, Val Loss: 0.8906
batch size: (887, 887)
Epoch 197, accuracy: 0.7337
batch size: (908, 908)
Epoch 198, accuracy: 0.7327
Epoch 198, Train Loss: 0.0556, Val Loss: 0.8717
batch size: (898, 898)
Epoch 199, accuracy: 0.7336
Loaded best model with val_loss = 0.6522256135940552
test :accuracy 0.7282, f1_macro: 0.7313, f1_micro: 0.7282, auc: 0.8806
Training GAT with 5 layers...
可训练参数: 643471_GAT
不可训练参数: 0
batch size: (892, 892)
✅ Epoch 0: New best model saved with val_loss = 1.1041
Epoch 0, accuracy: 0.1679
Epoch 0, Train Loss: 1.0982, Val Loss: 1.1041
batch size: (927, 927)
✅ Epoch 1: New best model saved with val_loss = 1.0802
Epoch 1, accuracy: 0.5324
batch size: (903, 903)
✅ Epoch 2: New best model saved with val_loss = 1.0350
Epoch 2, accuracy: 0.5079
Epoch 2, Train Loss: 1.0679, Val Loss: 1.0350
batch size: (902, 902)
✅ Epoch 3: New best model saved with val_loss = 0.8575
Epoch 3, accuracy: 0.6319
batch size: (894, 894)
✅ Epoch 4: New best model saved with val_loss = 0.8381
Epoch 4, accuracy: 0.6550
Epoch 4, Train Loss: 0.7883, Val Loss: 0.8381
batch size: (915, 915)
Epoch 5, accuracy: 0.5673
batch size: (885, 885)
✅ Epoch 6: New best model saved with val_loss = 0.7611
Epoch 6, accuracy: 0.6994
Epoch 6, Train Loss: 0.7911, Val Loss: 0.7611
batch size: (915, 915)
Epoch 7, accuracy: 0.6309
batch size: (894, 894)
Epoch 8, accuracy: 0.6993
Epoch 8, Train Loss: 0.7004, Val Loss: 0.7688
batch size: (890, 890)
✅ Epoch 9: New best model saved with val_loss = 0.7051
Epoch 9, accuracy: 0.7173
batch size: (896, 896)
Epoch 10, accuracy: 0.7321
Epoch 10, Train Loss: 0.2962, Val Loss: 0.7789
batch size: (904, 904)
Epoch 11, accuracy: 0.7405
batch size: (905, 905)
✅ Epoch 12: New best model saved with val_loss = 0.6813
Epoch 12, accuracy: 0.7272
Epoch 12, Train Loss: 0.2909, Val Loss: 0.6813
batch size: (890, 890)
Epoch 13, accuracy: 0.6820
batch size: (894, 894)
Epoch 14, accuracy: 0.6768
Epoch 14, Train Loss: 0.2242, Val Loss: 0.8825
batch size: (907, 907)
Epoch 15, accuracy: 0.6943
batch size: (890, 890)
Epoch 16, accuracy: 0.7142
Epoch 16, Train Loss: 0.2083, Val Loss: 0.8102
batch size: (902, 902)
Epoch 17, accuracy: 0.7276
batch size: (883, 883)
Epoch 18, accuracy: 0.7332
Epoch 18, Train Loss: 0.0531, Val Loss: 0.7768
batch size: (913, 913)
Epoch 19, accuracy: 0.7322
batch size: (891, 891)
Epoch 20, accuracy: 0.7304
Epoch 20, Train Loss: 0.0615, Val Loss: 0.8645
batch size: (909, 909)
Epoch 21, accuracy: 0.7304
batch size: (887, 887)
Epoch 22, accuracy: 0.7289
Epoch 22, Train Loss: 0.0735, Val Loss: 0.8266
batch size: (894, 894)
Epoch 23, accuracy: 0.7310
batch size: (887, 887)
Epoch 24, accuracy: 0.7292
Epoch 24, Train Loss: 0.0870, Val Loss: 0.8042
batch size: (910, 910)
Epoch 25, accuracy: 0.7281
batch size: (912, 912)
Epoch 26, accuracy: 0.7254
Epoch 26, Train Loss: 0.0710, Val Loss: 0.7566
batch size: (911, 911)
Epoch 27, accuracy: 0.7275
batch size: (915, 915)
Epoch 28, accuracy: 0.7260
Epoch 28, Train Loss: 0.0554, Val Loss: 0.7768
batch size: (914, 914)
Epoch 29, accuracy: 0.7258
batch size: (911, 911)
Epoch 30, accuracy: 0.7238
Epoch 30, Train Loss: 0.0236, Val Loss: 0.7892
batch size: (901, 901)
Epoch 31, accuracy: 0.7255
batch size: (906, 906)
Epoch 32, accuracy: 0.7253
Epoch 32, Train Loss: 0.0719, Val Loss: 0.8467
batch size: (886, 886)
Epoch 33, accuracy: 0.7272
batch size: (910, 910)
Epoch 34, accuracy: 0.7256
Epoch 34, Train Loss: 0.0978, Val Loss: 0.7792
batch size: (908, 908)
Epoch 35, accuracy: 0.7273
batch size: (902, 902)
Epoch 36, accuracy: 0.7282
Epoch 36, Train Loss: 0.0770, Val Loss: 0.8145
batch size: (884, 884)
Epoch 37, accuracy: 0.7250
batch size: (908, 908)
Epoch 38, accuracy: 0.7246
Epoch 38, Train Loss: 0.0758, Val Loss: 0.8011
batch size: (916, 916)
Epoch 39, accuracy: 0.7257
batch size: (897, 897)
Epoch 40, accuracy: 0.7247
Epoch 40, Train Loss: 0.0831, Val Loss: 0.8456
batch size: (894, 894)
Epoch 41, accuracy: 0.7255
batch size: (890, 890)
Epoch 42, accuracy: 0.7260
Epoch 42, Train Loss: 0.0418, Val Loss: 0.7530
batch size: (890, 890)
Epoch 43, accuracy: 0.7247
batch size: (902, 902)
Epoch 44, accuracy: 0.7270
Epoch 44, Train Loss: 0.0401, Val Loss: 0.8313
batch size: (876, 876)
Epoch 45, accuracy: 0.7241
batch size: (897, 897)
Epoch 46, accuracy: 0.7273
Epoch 46, Train Loss: 0.0486, Val Loss: 0.8070
batch size: (913, 913)
Epoch 47, accuracy: 0.7275
batch size: (900, 900)
Epoch 48, accuracy: 0.7265
Epoch 48, Train Loss: 0.0372, Val Loss: 0.8304
batch size: (889, 889)
Epoch 49, accuracy: 0.7268
batch size: (914, 914)
Epoch 50, accuracy: 0.7265
Epoch 50, Train Loss: 0.0456, Val Loss: 0.7664
batch size: (881, 881)
Epoch 51, accuracy: 0.7257
batch size: (906, 906)
Epoch 52, accuracy: 0.7247
Epoch 52, Train Loss: 0.0604, Val Loss: 0.7948
batch size: (887, 887)
Epoch 53, accuracy: 0.7248
batch size: (889, 889)
Epoch 54, accuracy: 0.7241
Epoch 54, Train Loss: 0.0453, Val Loss: 0.7978
batch size: (909, 909)
Epoch 55, accuracy: 0.7262
batch size: (913, 913)
Epoch 56, accuracy: 0.7255
Epoch 56, Train Loss: 0.0843, Val Loss: 0.8290
batch size: (921, 921)
Epoch 57, accuracy: 0.7252
batch size: (914, 914)
Epoch 58, accuracy: 0.7252
Epoch 58, Train Loss: 0.0610, Val Loss: 0.7970
batch size: (900, 900)
Epoch 59, accuracy: 0.7261
batch size: (902, 902)
Epoch 60, accuracy: 0.7249
Epoch 60, Train Loss: 0.1249, Val Loss: 0.8067
batch size: (892, 892)
Epoch 61, accuracy: 0.7261
batch size: (890, 890)
Epoch 62, accuracy: 0.7248
Epoch 62, Train Loss: 0.0379, Val Loss: 0.7995
batch size: (910, 910)
Epoch 63, accuracy: 0.7236
batch size: (882, 882)
Epoch 64, accuracy: 0.7231
Epoch 64, Train Loss: 0.0714, Val Loss: 0.7995
batch size: (884, 884)
Epoch 65, accuracy: 0.7256
batch size: (910, 910)
Epoch 66, accuracy: 0.7264
Epoch 66, Train Loss: 0.0450, Val Loss: 0.8399
batch size: (918, 918)
Epoch 67, accuracy: 0.7240
batch size: (908, 908)
Epoch 68, accuracy: 0.7252
Epoch 68, Train Loss: 0.0508, Val Loss: 0.8240
batch size: (895, 895)
Epoch 69, accuracy: 0.7255
batch size: (903, 903)
Epoch 70, accuracy: 0.7241
Epoch 70, Train Loss: 0.0354, Val Loss: 0.7958
batch size: (903, 903)
Epoch 71, accuracy: 0.7260
batch size: (887, 887)
Epoch 72, accuracy: 0.7245
Epoch 72, Train Loss: 0.0572, Val Loss: 0.8370
batch size: (878, 878)
Epoch 73, accuracy: 0.7269
batch size: (903, 903)
Epoch 74, accuracy: 0.7276
Epoch 74, Train Loss: 0.0504, Val Loss: 0.8167
batch size: (922, 922)
Epoch 75, accuracy: 0.7250
batch size: (890, 890)
Epoch 76, accuracy: 0.7247
Epoch 76, Train Loss: 0.0624, Val Loss: 0.8110
batch size: (914, 914)
Epoch 77, accuracy: 0.7251
batch size: (897, 897)
Epoch 78, accuracy: 0.7264
Epoch 78, Train Loss: 0.0303, Val Loss: 0.7574
batch size: (882, 882)
Epoch 79, accuracy: 0.7252
batch size: (884, 884)
Epoch 80, accuracy: 0.7261
Epoch 80, Train Loss: 0.0756, Val Loss: 0.8190
batch size: (901, 901)
Epoch 81, accuracy: 0.7235
batch size: (905, 905)
Epoch 82, accuracy: 0.7246
Epoch 82, Train Loss: 0.0446, Val Loss: 0.8347
batch size: (887, 887)
Epoch 83, accuracy: 0.7232
batch size: (896, 896)
Epoch 84, accuracy: 0.7272
Epoch 84, Train Loss: 0.0603, Val Loss: 0.8407
batch size: (894, 894)
Epoch 85, accuracy: 0.7282
batch size: (897, 897)
Epoch 86, accuracy: 0.7245
Epoch 86, Train Loss: 0.0253, Val Loss: 0.8212
batch size: (891, 891)
Epoch 87, accuracy: 0.7244
batch size: (883, 883)
Epoch 88, accuracy: 0.7256
Epoch 88, Train Loss: 0.0416, Val Loss: 0.7770
batch size: (889, 889)
Epoch 89, accuracy: 0.7265
batch size: (906, 906)
Epoch 90, accuracy: 0.7257
Epoch 90, Train Loss: 0.0571, Val Loss: 0.8228
batch size: (884, 884)
Epoch 91, accuracy: 0.7261
batch size: (897, 897)
Epoch 92, accuracy: 0.7259
Epoch 92, Train Loss: 0.0490, Val Loss: 0.7898
batch size: (899, 899)
Epoch 93, accuracy: 0.7221
batch size: (893, 893)
Epoch 94, accuracy: 0.7250
Epoch 94, Train Loss: 0.0284, Val Loss: 0.8033
batch size: (900, 900)
Epoch 95, accuracy: 0.7264
batch size: (912, 912)
Epoch 96, accuracy: 0.7245
Epoch 96, Train Loss: 0.0378, Val Loss: 0.7895
batch size: (888, 888)
Epoch 97, accuracy: 0.7246
batch size: (887, 887)
Epoch 98, accuracy: 0.7230
Epoch 98, Train Loss: 0.0792, Val Loss: 0.7962
batch size: (909, 909)
Epoch 99, accuracy: 0.7250
batch size: (891, 891)
Epoch 100, accuracy: 0.7252
Epoch 100, Train Loss: 0.0546, Val Loss: 0.8045
batch size: (895, 895)
Epoch 101, accuracy: 0.7240
batch size: (906, 906)
Epoch 102, accuracy: 0.7276
Epoch 102, Train Loss: 0.0370, Val Loss: 0.8049
batch size: (880, 880)
Epoch 103, accuracy: 0.7250
batch size: (896, 896)
Epoch 104, accuracy: 0.7226
Epoch 104, Train Loss: 0.0452, Val Loss: 0.7710
batch size: (920, 920)
Epoch 105, accuracy: 0.7279
batch size: (902, 902)
Epoch 106, accuracy: 0.7255
Epoch 106, Train Loss: 0.0629, Val Loss: 0.7980
batch size: (922, 922)
Epoch 107, accuracy: 0.7259
batch size: (905, 905)
Epoch 108, accuracy: 0.7276
Epoch 108, Train Loss: 0.0553, Val Loss: 0.8420
batch size: (911, 911)
Epoch 109, accuracy: 0.7240
batch size: (907, 907)
Epoch 110, accuracy: 0.7255
Epoch 110, Train Loss: 0.0814, Val Loss: 0.7866
batch size: (898, 898)
Epoch 111, accuracy: 0.7256
batch size: (894, 894)
Epoch 112, accuracy: 0.7242
Epoch 112, Train Loss: 0.0462, Val Loss: 0.8140
batch size: (907, 907)
Epoch 113, accuracy: 0.7254
batch size: (904, 904)
Epoch 114, accuracy: 0.7272
Epoch 114, Train Loss: 0.0382, Val Loss: 0.7833
batch size: (909, 909)
Epoch 115, accuracy: 0.7251
batch size: (895, 895)
Epoch 116, accuracy: 0.7261
Epoch 116, Train Loss: 0.0261, Val Loss: 0.7920
batch size: (901, 901)
Epoch 117, accuracy: 0.7275
batch size: (903, 903)
Epoch 118, accuracy: 0.7259
Epoch 118, Train Loss: 0.0772, Val Loss: 0.8516
batch size: (891, 891)
Epoch 119, accuracy: 0.7267
batch size: (906, 906)
Epoch 120, accuracy: 0.7275
Epoch 120, Train Loss: 0.0488, Val Loss: 0.8017
batch size: (889, 889)
Epoch 121, accuracy: 0.7272
batch size: (907, 907)
Epoch 122, accuracy: 0.7275
Epoch 122, Train Loss: 0.0562, Val Loss: 0.7903
batch size: (904, 904)
Epoch 123, accuracy: 0.7262
batch size: (894, 894)
Epoch 124, accuracy: 0.7243
Epoch 124, Train Loss: 0.1033, Val Loss: 0.8012
batch size: (905, 905)
Epoch 125, accuracy: 0.7247
batch size: (910, 910)
Epoch 126, accuracy: 0.7231
Epoch 126, Train Loss: 0.0747, Val Loss: 0.8303
batch size: (889, 889)
Epoch 127, accuracy: 0.7249
batch size: (923, 923)
Epoch 128, accuracy: 0.7255
Epoch 128, Train Loss: 0.0568, Val Loss: 0.7975
batch size: (918, 918)
Epoch 129, accuracy: 0.7248
batch size: (888, 888)
Epoch 130, accuracy: 0.7261
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 130, Train Loss: 0.0486, Val Loss: 0.8120
batch size: (881, 881)
Epoch 131, accuracy: 0.7260
batch size: (915, 915)
Epoch 132, accuracy: 0.7254
Epoch 132, Train Loss: 0.0620, Val Loss: 0.8229
batch size: (896, 896)
Epoch 133, accuracy: 0.7234
batch size: (894, 894)
Epoch 134, accuracy: 0.7257
Epoch 134, Train Loss: 0.0439, Val Loss: 0.8259
batch size: (916, 916)
Epoch 135, accuracy: 0.7253
batch size: (900, 900)
Epoch 136, accuracy: 0.7242
Epoch 136, Train Loss: 0.0441, Val Loss: 0.7569
batch size: (886, 886)
Epoch 137, accuracy: 0.7261
batch size: (896, 896)
Epoch 138, accuracy: 0.7251
Epoch 138, Train Loss: 0.0906, Val Loss: 0.8307
batch size: (902, 902)
Epoch 139, accuracy: 0.7240
batch size: (903, 903)
Epoch 140, accuracy: 0.7238
Epoch 140, Train Loss: 0.0738, Val Loss: 0.7749
batch size: (896, 896)
Epoch 141, accuracy: 0.7268
batch size: (887, 887)
Epoch 142, accuracy: 0.7228
Epoch 142, Train Loss: 0.0767, Val Loss: 0.8062
batch size: (896, 896)
Epoch 143, accuracy: 0.7263
batch size: (893, 893)
Epoch 144, accuracy: 0.7244
Epoch 144, Train Loss: 0.0380, Val Loss: 0.7974
batch size: (885, 885)
Epoch 145, accuracy: 0.7255
batch size: (904, 904)
Epoch 146, accuracy: 0.7240
Epoch 146, Train Loss: 0.1284, Val Loss: 0.8197
batch size: (909, 909)
Epoch 147, accuracy: 0.7223
batch size: (900, 900)
Epoch 148, accuracy: 0.7242
Epoch 148, Train Loss: 0.0533, Val Loss: 0.8019
batch size: (897, 897)
Epoch 149, accuracy: 0.7235
batch size: (901, 901)
Epoch 150, accuracy: 0.7265
Epoch 150, Train Loss: 0.0905, Val Loss: 0.8343
batch size: (894, 894)
Epoch 151, accuracy: 0.7235
batch size: (917, 917)
Epoch 152, accuracy: 0.7253
Epoch 152, Train Loss: 0.0351, Val Loss: 0.8153
batch size: (897, 897)
Epoch 153, accuracy: 0.7256
batch size: (927, 927)
Epoch 154, accuracy: 0.7245
Epoch 154, Train Loss: 0.0525, Val Loss: 0.8318
batch size: (906, 906)
Epoch 155, accuracy: 0.7249
batch size: (893, 893)
Epoch 156, accuracy: 0.7265
Epoch 156, Train Loss: 0.1350, Val Loss: 0.8398
batch size: (895, 895)
Epoch 157, accuracy: 0.7274
batch size: (918, 918)
Epoch 158, accuracy: 0.7243
Epoch 158, Train Loss: 0.0719, Val Loss: 0.8598
batch size: (899, 899)
Epoch 159, accuracy: 0.7231
batch size: (908, 908)
Epoch 160, accuracy: 0.7280
Epoch 160, Train Loss: 0.0217, Val Loss: 0.8363
batch size: (897, 897)
Epoch 161, accuracy: 0.7273
batch size: (881, 881)
Epoch 162, accuracy: 0.7225
Epoch 162, Train Loss: 0.0313, Val Loss: 0.7953
batch size: (902, 902)
Epoch 163, accuracy: 0.7261
batch size: (903, 903)
Epoch 164, accuracy: 0.7243
Epoch 164, Train Loss: 0.0667, Val Loss: 0.8407
batch size: (902, 902)
Epoch 165, accuracy: 0.7251
batch size: (914, 914)
Epoch 166, accuracy: 0.7273
Epoch 166, Train Loss: 0.1372, Val Loss: 0.8130
batch size: (893, 893)
Epoch 167, accuracy: 0.7255
batch size: (896, 896)
Epoch 168, accuracy: 0.7262
Epoch 168, Train Loss: 0.0477, Val Loss: 0.8198
batch size: (904, 904)
Epoch 169, accuracy: 0.7265
batch size: (890, 890)
Epoch 170, accuracy: 0.7244
Epoch 170, Train Loss: 0.0881, Val Loss: 0.8212
batch size: (896, 896)
Epoch 171, accuracy: 0.7272
batch size: (898, 898)
Epoch 172, accuracy: 0.7237
Epoch 172, Train Loss: 0.0772, Val Loss: 0.8175
batch size: (892, 892)
Epoch 173, accuracy: 0.7265
batch size: (891, 891)
Epoch 174, accuracy: 0.7250
Epoch 174, Train Loss: 0.0659, Val Loss: 0.8408
batch size: (899, 899)
Epoch 175, accuracy: 0.7245
batch size: (892, 892)
Epoch 176, accuracy: 0.7262
Epoch 176, Train Loss: 0.0592, Val Loss: 0.8269
batch size: (894, 894)
Epoch 177, accuracy: 0.7249
batch size: (901, 901)
Epoch 178, accuracy: 0.7255
Epoch 178, Train Loss: 0.0771, Val Loss: 0.8040
batch size: (873, 873)
Epoch 179, accuracy: 0.7270
batch size: (909, 909)
Epoch 180, accuracy: 0.7256
Epoch 180, Train Loss: 0.0560, Val Loss: 0.8241
batch size: (898, 898)
Epoch 181, accuracy: 0.7244
batch size: (906, 906)
Epoch 182, accuracy: 0.7252
Epoch 182, Train Loss: 0.0364, Val Loss: 0.8644
batch size: (883, 883)
Epoch 183, accuracy: 0.7251
batch size: (904, 904)
Epoch 184, accuracy: 0.7264
Epoch 184, Train Loss: 0.0715, Val Loss: 0.7729
batch size: (902, 902)
Epoch 185, accuracy: 0.7251
batch size: (918, 918)
Epoch 186, accuracy: 0.7256
Epoch 186, Train Loss: 0.0512, Val Loss: 0.7808
batch size: (899, 899)
Epoch 187, accuracy: 0.7253
batch size: (889, 889)
Epoch 188, accuracy: 0.7261
Epoch 188, Train Loss: 0.0458, Val Loss: 0.7826
batch size: (887, 887)
Epoch 189, accuracy: 0.7242
batch size: (908, 908)
Epoch 190, accuracy: 0.7257
Epoch 190, Train Loss: 0.0743, Val Loss: 0.8012
batch size: (909, 909)
Epoch 191, accuracy: 0.7259
batch size: (899, 899)
Epoch 192, accuracy: 0.7244
Epoch 192, Train Loss: 0.0225, Val Loss: 0.7976
batch size: (920, 920)
Epoch 193, accuracy: 0.7244
batch size: (905, 905)
Epoch 194, accuracy: 0.7236
Epoch 194, Train Loss: 0.0760, Val Loss: 0.8252
batch size: (901, 901)
Epoch 195, accuracy: 0.7271
batch size: (891, 891)
Epoch 196, accuracy: 0.7242
Epoch 196, Train Loss: 0.0477, Val Loss: 0.7793
batch size: (898, 898)
Epoch 197, accuracy: 0.7263
batch size: (903, 903)
Epoch 198, accuracy: 0.7248
Epoch 198, Train Loss: 0.0335, Val Loss: 0.7715
batch size: (899, 899)
Epoch 199, accuracy: 0.7253
Loaded best model with val_loss = 0.6812991499900818
test :accuracy 0.7275, f1_macro: 0.7257, f1_micro: 0.7275, auc: 0.8827
Training GAT with 6 layers...
可训练参数: 792463_GAT
不可训练参数: 0
batch size: (881, 881)
✅ Epoch 0: New best model saved with val_loss = 1.0996
Epoch 0, accuracy: 0.4581
Epoch 0, Train Loss: 1.0984, Val Loss: 1.0996
batch size: (886, 886)
Epoch 1, accuracy: 0.3124
batch size: (900, 900)
✅ Epoch 2: New best model saved with val_loss = 1.0879
Epoch 2, accuracy: 0.2192
Epoch 2, Train Loss: 1.0888, Val Loss: 1.0879
batch size: (905, 905)
✅ Epoch 3: New best model saved with val_loss = 1.0172
Epoch 3, accuracy: 0.5582
batch size: (892, 892)
✅ Epoch 4: New best model saved with val_loss = 0.8701
Epoch 4, accuracy: 0.6896
Epoch 4, Train Loss: 0.9773, Val Loss: 0.8701
batch size: (890, 890)
✅ Epoch 5: New best model saved with val_loss = 0.8117
Epoch 5, accuracy: 0.6584
batch size: (901, 901)
Epoch 6, accuracy: 0.5080
Epoch 6, Train Loss: 0.6538, Val Loss: 1.6298
batch size: (881, 881)
Epoch 7, accuracy: 0.4440
batch size: (889, 889)
✅ Epoch 8: New best model saved with val_loss = 0.7103
Epoch 8, accuracy: 0.7121
Epoch 8, Train Loss: 1.1331, Val Loss: 0.7103
batch size: (891, 891)
Epoch 9, accuracy: 0.6457
batch size: (905, 905)
Epoch 10, accuracy: 0.5734
Epoch 10, Train Loss: 0.5233, Val Loss: 1.0515
batch size: (917, 917)
Epoch 11, accuracy: 0.5791
batch size: (896, 896)
Epoch 12, accuracy: 0.6293
Epoch 12, Train Loss: 0.5866, Val Loss: 0.8020
batch size: (888, 888)
Epoch 13, accuracy: 0.6914
batch size: (886, 886)
Epoch 14, accuracy: 0.7244
Epoch 14, Train Loss: 0.5138, Val Loss: 0.7412
batch size: (894, 894)
Epoch 15, accuracy: 0.7252
batch size: (905, 905)
Epoch 16, accuracy: 0.7243
Epoch 16, Train Loss: 0.5289, Val Loss: 0.7409
batch size: (894, 894)
Epoch 17, accuracy: 0.7234
batch size: (913, 913)
Epoch 18, accuracy: 0.7268
Epoch 18, Train Loss: 0.5073, Val Loss: 0.7352
batch size: (902, 902)
Epoch 19, accuracy: 0.7234
batch size: (917, 917)
Epoch 20, accuracy: 0.7241
Epoch 20, Train Loss: 0.4772, Val Loss: 0.7217
batch size: (912, 912)
Epoch 21, accuracy: 0.7252
batch size: (900, 900)
Epoch 22, accuracy: 0.7218
Epoch 22, Train Loss: 0.4753, Val Loss: 0.7362
batch size: (883, 883)
Epoch 23, accuracy: 0.7257
batch size: (914, 914)
Epoch 24, accuracy: 0.7198
Epoch 24, Train Loss: 0.4430, Val Loss: 0.7285
batch size: (894, 894)
Epoch 25, accuracy: 0.7236
batch size: (897, 897)
Epoch 26, accuracy: 0.7223
Epoch 26, Train Loss: 0.4663, Val Loss: 0.7367
batch size: (917, 917)
Epoch 27, accuracy: 0.7230
batch size: (904, 904)
Epoch 28, accuracy: 0.7221
Epoch 28, Train Loss: 0.4698, Val Loss: 0.7391
batch size: (907, 907)
Epoch 29, accuracy: 0.7253
batch size: (917, 917)
Epoch 30, accuracy: 0.7235
Epoch 30, Train Loss: 0.4673, Val Loss: 0.7153
batch size: (900, 900)
Epoch 31, accuracy: 0.7225
batch size: (910, 910)
Epoch 32, accuracy: 0.7231
Epoch 32, Train Loss: 0.4447, Val Loss: 0.7449
batch size: (910, 910)
Epoch 33, accuracy: 0.7235
batch size: (893, 893)
Epoch 34, accuracy: 0.7213
Epoch 34, Train Loss: 0.4713, Val Loss: 0.7384
batch size: (888, 888)
Epoch 35, accuracy: 0.7228
batch size: (911, 911)
Epoch 36, accuracy: 0.7230
Epoch 36, Train Loss: 0.4680, Val Loss: 0.7412
batch size: (883, 883)
Epoch 37, accuracy: 0.7235
batch size: (891, 891)
Epoch 38, accuracy: 0.7231
Epoch 38, Train Loss: 0.4644, Val Loss: 0.7199
batch size: (877, 877)
Epoch 39, accuracy: 0.7238
batch size: (888, 888)
Epoch 40, accuracy: 0.7217
Epoch 40, Train Loss: 0.4411, Val Loss: 0.7238
batch size: (909, 909)
Epoch 41, accuracy: 0.7256
batch size: (906, 906)
Epoch 42, accuracy: 0.7218
Epoch 42, Train Loss: 0.4570, Val Loss: 0.7297
batch size: (902, 902)
Epoch 43, accuracy: 0.7213
batch size: (904, 904)
Epoch 44, accuracy: 0.7215
Epoch 44, Train Loss: 0.4389, Val Loss: 0.7128
batch size: (921, 921)
Epoch 45, accuracy: 0.7248
batch size: (905, 905)
Epoch 46, accuracy: 0.7222
Epoch 46, Train Loss: 0.4616, Val Loss: 0.7337
batch size: (910, 910)
Epoch 47, accuracy: 0.7237
batch size: (871, 871)
Epoch 48, accuracy: 0.7224
Epoch 48, Train Loss: 0.4644, Val Loss: 0.7315
batch size: (898, 898)
Epoch 49, accuracy: 0.7218
batch size: (875, 875)
Epoch 50, accuracy: 0.7218
Epoch 50, Train Loss: 0.4558, Val Loss: 0.7198
batch size: (885, 885)
Epoch 51, accuracy: 0.7219
batch size: (915, 915)
Epoch 52, accuracy: 0.7243
Epoch 52, Train Loss: 0.4509, Val Loss: 0.7249
batch size: (889, 889)
Epoch 53, accuracy: 0.7236
batch size: (891, 891)
Epoch 54, accuracy: 0.7240
Epoch 54, Train Loss: 0.4648, Val Loss: 0.7193
batch size: (913, 913)
Epoch 55, accuracy: 0.7217
batch size: (919, 919)
Epoch 56, accuracy: 0.7225
Epoch 56, Train Loss: 0.4723, Val Loss: 0.7262
batch size: (899, 899)
Epoch 57, accuracy: 0.7224
batch size: (894, 894)
Epoch 58, accuracy: 0.7229
Epoch 58, Train Loss: 0.4572, Val Loss: 0.7249
batch size: (881, 881)
Epoch 59, accuracy: 0.7249
batch size: (893, 893)
Epoch 60, accuracy: 0.7235
Epoch 60, Train Loss: 0.4545, Val Loss: 0.7246
batch size: (908, 908)
Epoch 61, accuracy: 0.7262
batch size: (885, 885)
Epoch 62, accuracy: 0.7232
Epoch 62, Train Loss: 0.4535, Val Loss: 0.7238
batch size: (886, 886)
Epoch 63, accuracy: 0.7229
batch size: (913, 913)
Epoch 64, accuracy: 0.7199
Epoch 64, Train Loss: 0.4410, Val Loss: 0.7216
batch size: (895, 895)
Epoch 65, accuracy: 0.7219
batch size: (910, 910)
Epoch 66, accuracy: 0.7220
Epoch 66, Train Loss: 0.4689, Val Loss: 0.7239
batch size: (894, 894)
✅ Epoch 67: New best model saved with val_loss = 0.7097
Epoch 67, accuracy: 0.7225
batch size: (927, 927)
Epoch 68, accuracy: 0.7220
Epoch 68, Train Loss: 0.4639, Val Loss: 0.7200
batch size: (907, 907)
Epoch 69, accuracy: 0.7249
batch size: (907, 907)
Epoch 70, accuracy: 0.7249
Epoch 70, Train Loss: 0.4357, Val Loss: 0.7356
batch size: (902, 902)
Epoch 71, accuracy: 0.7229
batch size: (909, 909)
Epoch 72, accuracy: 0.7229
Epoch 72, Train Loss: 0.4396, Val Loss: 0.7117
batch size: (905, 905)
Epoch 73, accuracy: 0.7221
batch size: (875, 875)
Epoch 74, accuracy: 0.7212
Epoch 74, Train Loss: 0.4470, Val Loss: 0.7305
batch size: (902, 902)
Epoch 75, accuracy: 0.7238
batch size: (893, 893)
Epoch 76, accuracy: 0.7205
Epoch 76, Train Loss: 0.4572, Val Loss: 0.7288
batch size: (897, 897)
Epoch 77, accuracy: 0.7237
batch size: (872, 872)
Epoch 78, accuracy: 0.7238
Epoch 78, Train Loss: 0.4651, Val Loss: 0.7259
batch size: (899, 899)
Epoch 79, accuracy: 0.7251
batch size: (902, 902)
Epoch 80, accuracy: 0.7225
Epoch 80, Train Loss: 0.4591, Val Loss: 0.7138
batch size: (906, 906)
Epoch 81, accuracy: 0.7253
batch size: (920, 920)
Epoch 82, accuracy: 0.7223
Epoch 82, Train Loss: 0.4851, Val Loss: 0.7242
batch size: (888, 888)
Epoch 83, accuracy: 0.7207
batch size: (887, 887)
Epoch 84, accuracy: 0.7225
Epoch 84, Train Loss: 0.4589, Val Loss: 0.7226
batch size: (917, 917)
Epoch 85, accuracy: 0.7227
batch size: (885, 885)
Epoch 86, accuracy: 0.7226
Epoch 86, Train Loss: 0.4411, Val Loss: 0.7210
batch size: (904, 904)
Epoch 87, accuracy: 0.7224
batch size: (903, 903)
Epoch 88, accuracy: 0.7237
Epoch 88, Train Loss: 0.4453, Val Loss: 0.7267
batch size: (902, 902)
Epoch 89, accuracy: 0.7218
batch size: (894, 894)
Epoch 90, accuracy: 0.7240
Epoch 90, Train Loss: 0.4498, Val Loss: 0.7217
batch size: (888, 888)
Epoch 91, accuracy: 0.7246
batch size: (916, 916)
Epoch 92, accuracy: 0.7240
Epoch 92, Train Loss: 0.4572, Val Loss: 0.7320
batch size: (886, 886)
Epoch 93, accuracy: 0.7240
batch size: (879, 879)
Epoch 94, accuracy: 0.7205
Epoch 94, Train Loss: 0.4879, Val Loss: 0.7240
batch size: (899, 899)
Epoch 95, accuracy: 0.7228
batch size: (886, 886)
Epoch 96, accuracy: 0.7239
Epoch 96, Train Loss: 0.4617, Val Loss: 0.7222
batch size: (914, 914)
Epoch 97, accuracy: 0.7232
batch size: (914, 914)
Epoch 98, accuracy: 0.7238
Epoch 98, Train Loss: 0.4400, Val Loss: 0.7284
batch size: (897, 897)
Epoch 99, accuracy: 0.7229
batch size: (888, 888)
Epoch 100, accuracy: 0.7225
Epoch 100, Train Loss: 0.4822, Val Loss: 0.7252
batch size: (901, 901)
Epoch 101, accuracy: 0.7240
batch size: (883, 883)
Epoch 102, accuracy: 0.7194
Epoch 102, Train Loss: 0.4863, Val Loss: 0.7174
batch size: (913, 913)
Epoch 103, accuracy: 0.7242
batch size: (889, 889)
Epoch 104, accuracy: 0.7207
Epoch 104, Train Loss: 0.4733, Val Loss: 0.7293
batch size: (906, 906)
Epoch 105, accuracy: 0.7216
batch size: (899, 899)
Epoch 106, accuracy: 0.7227
Epoch 106, Train Loss: 0.4951, Val Loss: 0.7258
batch size: (904, 904)
Epoch 107, accuracy: 0.7216
batch size: (893, 893)
Epoch 108, accuracy: 0.7221
Epoch 108, Train Loss: 0.4768, Val Loss: 0.7279
batch size: (908, 908)
Epoch 109, accuracy: 0.7232
batch size: (892, 892)
Epoch 110, accuracy: 0.7235
Epoch 110, Train Loss: 0.4459, Val Loss: 0.7275
batch size: (920, 920)
Epoch 111, accuracy: 0.7233
batch size: (907, 907)
Epoch 112, accuracy: 0.7217
Epoch 112, Train Loss: 0.4716, Val Loss: 0.7219
batch size: (899, 899)
Epoch 113, accuracy: 0.7242
batch size: (904, 904)
Epoch 114, accuracy: 0.7230
Epoch 114, Train Loss: 0.4467, Val Loss: 0.7316
batch size: (905, 905)
Epoch 115, accuracy: 0.7218
batch size: (891, 891)
Epoch 116, accuracy: 0.7226
Epoch 116, Train Loss: 0.4821, Val Loss: 0.7129
batch size: (896, 896)
Epoch 117, accuracy: 0.7228
batch size: (906, 906)
Epoch 118, accuracy: 0.7230
Epoch 118, Train Loss: 0.4799, Val Loss: 0.7161
batch size: (887, 887)
Epoch 119, accuracy: 0.7224
batch size: (905, 905)
Epoch 120, accuracy: 0.7243
Epoch 120, Train Loss: 0.4316, Val Loss: 0.7213
batch size: (900, 900)
Epoch 121, accuracy: 0.7215
batch size: (905, 905)
Epoch 122, accuracy: 0.7256
Epoch 122, Train Loss: 0.4730, Val Loss: 0.7201
batch size: (911, 911)
Epoch 123, accuracy: 0.7225
batch size: (892, 892)
Epoch 124, accuracy: 0.7224
Epoch 124, Train Loss: 0.4592, Val Loss: 0.7198
batch size: (912, 912)
Epoch 125, accuracy: 0.7228
batch size: (888, 888)
Epoch 126, accuracy: 0.7228
Epoch 126, Train Loss: 0.4612, Val Loss: 0.7199
batch size: (892, 892)
Epoch 127, accuracy: 0.7254
batch size: (886, 886)
Epoch 128, accuracy: 0.7219
Epoch 128, Train Loss: 0.4399, Val Loss: 0.7370
batch size: (911, 911)
Epoch 129, accuracy: 0.7241
batch size: (913, 913)
Epoch 130, accuracy: 0.7246
Epoch 130, Train Loss: 0.4652, Val Loss: 0.7254
batch size: (893, 893)
Epoch 131, accuracy: 0.7232
batch size: (907, 907)
Epoch 132, accuracy: 0.7249
Epoch 132, Train Loss: 0.4531, Val Loss: 0.7256
batch size: (907, 907)
Epoch 133, accuracy: 0.7231
batch size: (900, 900)
Epoch 134, accuracy: 0.7252
Epoch 134, Train Loss: 0.4620, Val Loss: 0.7250
batch size: (895, 895)
Epoch 135, accuracy: 0.7226
batch size: (912, 912)
Epoch 136, accuracy: 0.7225
Epoch 136, Train Loss: 0.4574, Val Loss: 0.7259
batch size: (910, 910)
Epoch 137, accuracy: 0.7215
batch size: (905, 905)
Epoch 138, accuracy: 0.7200
Epoch 138, Train Loss: 0.4436, Val Loss: 0.7269
batch size: (906, 906)
Epoch 139, accuracy: 0.7234
batch size: (903, 903)
Epoch 140, accuracy: 0.7203
Epoch 140, Train Loss: 0.4581, Val Loss: 0.7261
batch size: (898, 898)
Epoch 141, accuracy: 0.7206
batch size: (882, 882)
Epoch 142, accuracy: 0.7214
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 142, Train Loss: 0.4622, Val Loss: 0.7259
batch size: (912, 912)
Epoch 143, accuracy: 0.7235
batch size: (900, 900)
Epoch 144, accuracy: 0.7228
Epoch 144, Train Loss: 0.4399, Val Loss: 0.7146
batch size: (902, 902)
Epoch 145, accuracy: 0.7229
batch size: (911, 911)
Epoch 146, accuracy: 0.7231
Epoch 146, Train Loss: 0.4470, Val Loss: 0.7193
batch size: (905, 905)
Epoch 147, accuracy: 0.7233
batch size: (930, 930)
Epoch 148, accuracy: 0.7214
Epoch 148, Train Loss: 0.4690, Val Loss: 0.7170
batch size: (907, 907)
Epoch 149, accuracy: 0.7242
batch size: (888, 888)
Epoch 150, accuracy: 0.7220
Epoch 150, Train Loss: 0.4764, Val Loss: 0.7277
batch size: (926, 926)
Epoch 151, accuracy: 0.7255
batch size: (903, 903)
Epoch 152, accuracy: 0.7239
Epoch 152, Train Loss: 0.4579, Val Loss: 0.7287
batch size: (896, 896)
Epoch 153, accuracy: 0.7218
batch size: (905, 905)
Epoch 154, accuracy: 0.7219
Epoch 154, Train Loss: 0.4692, Val Loss: 0.7300
batch size: (904, 904)
Epoch 155, accuracy: 0.7207
batch size: (912, 912)
Epoch 156, accuracy: 0.7257
Epoch 156, Train Loss: 0.4603, Val Loss: 0.7235
batch size: (917, 917)
Epoch 157, accuracy: 0.7252
batch size: (902, 902)
Epoch 158, accuracy: 0.7234
Epoch 158, Train Loss: 0.4623, Val Loss: 0.7289
batch size: (901, 901)
Epoch 159, accuracy: 0.7208
batch size: (907, 907)
Epoch 160, accuracy: 0.7233
Epoch 160, Train Loss: 0.4493, Val Loss: 0.7300
batch size: (886, 886)
Epoch 161, accuracy: 0.7229
batch size: (901, 901)
Epoch 162, accuracy: 0.7219
Epoch 162, Train Loss: 0.4655, Val Loss: 0.7283
batch size: (893, 893)
Epoch 163, accuracy: 0.7211
batch size: (907, 907)
Epoch 164, accuracy: 0.7231
Epoch 164, Train Loss: 0.4482, Val Loss: 0.7201
batch size: (871, 871)
Epoch 165, accuracy: 0.7232
batch size: (890, 890)
Epoch 166, accuracy: 0.7227
Epoch 166, Train Loss: 0.4466, Val Loss: 0.7245
batch size: (886, 886)
Epoch 167, accuracy: 0.7228
batch size: (884, 884)
Epoch 168, accuracy: 0.7217
Epoch 168, Train Loss: 0.4553, Val Loss: 0.7118
batch size: (907, 907)
Epoch 169, accuracy: 0.7232
batch size: (893, 893)
Epoch 170, accuracy: 0.7216
Epoch 170, Train Loss: 0.4632, Val Loss: 0.7270
batch size: (903, 903)
Epoch 171, accuracy: 0.7245
batch size: (902, 902)
Epoch 172, accuracy: 0.7223
Epoch 172, Train Loss: 0.4685, Val Loss: 0.7314
batch size: (905, 905)
Epoch 173, accuracy: 0.7237
batch size: (900, 900)
Epoch 174, accuracy: 0.7236
Epoch 174, Train Loss: 0.4373, Val Loss: 0.7295
batch size: (899, 899)
Epoch 175, accuracy: 0.7216
batch size: (904, 904)
Epoch 176, accuracy: 0.7225
Epoch 176, Train Loss: 0.4443, Val Loss: 0.7163
batch size: (884, 884)
Epoch 177, accuracy: 0.7243
batch size: (893, 893)
Epoch 178, accuracy: 0.7219
Epoch 178, Train Loss: 0.4579, Val Loss: 0.7321
batch size: (914, 914)
Epoch 179, accuracy: 0.7246
batch size: (902, 902)
Epoch 180, accuracy: 0.7229
Epoch 180, Train Loss: 0.4650, Val Loss: 0.7386
batch size: (908, 908)
Epoch 181, accuracy: 0.7239
batch size: (894, 894)
Epoch 182, accuracy: 0.7221
Epoch 182, Train Loss: 0.4585, Val Loss: 0.7309
batch size: (894, 894)
Epoch 183, accuracy: 0.7226
batch size: (894, 894)
Epoch 184, accuracy: 0.7226
Epoch 184, Train Loss: 0.4649, Val Loss: 0.7343
batch size: (909, 909)
Epoch 185, accuracy: 0.7220
batch size: (898, 898)
Epoch 186, accuracy: 0.7229
Epoch 186, Train Loss: 0.4844, Val Loss: 0.7326
batch size: (898, 898)
Epoch 187, accuracy: 0.7239
batch size: (900, 900)
Epoch 188, accuracy: 0.7207
Epoch 188, Train Loss: 0.4697, Val Loss: 0.7334
batch size: (892, 892)
Epoch 189, accuracy: 0.7219
batch size: (901, 901)
Epoch 190, accuracy: 0.7232
Epoch 190, Train Loss: 0.4564, Val Loss: 0.7233
batch size: (892, 892)
Epoch 191, accuracy: 0.7229
batch size: (900, 900)
Epoch 192, accuracy: 0.7225
Epoch 192, Train Loss: 0.4728, Val Loss: 0.7098
batch size: (892, 892)
Epoch 193, accuracy: 0.7264
batch size: (893, 893)
Epoch 194, accuracy: 0.7248
Epoch 194, Train Loss: 0.4674, Val Loss: 0.7300
batch size: (894, 894)
Epoch 195, accuracy: 0.7224
batch size: (893, 893)
Epoch 196, accuracy: 0.7229
Epoch 196, Train Loss: 0.4558, Val Loss: 0.7282
batch size: (908, 908)
Epoch 197, accuracy: 0.7251
batch size: (906, 906)
Epoch 198, accuracy: 0.7246
Epoch 198, Train Loss: 0.4587, Val Loss: 0.7253
batch size: (878, 878)
Epoch 199, accuracy: 0.7223
Loaded best model with val_loss = 0.709733247756958
test :accuracy 0.7216, f1_macro: 0.7163, f1_micro: 0.7216, auc: 0.8661
Training GAT with 7 layers...
可训练参数: 941455_GAT
不可训练参数: 0
batch size: (895, 895)
✅ Epoch 0: New best model saved with val_loss = 1.0946
Epoch 0, accuracy: 0.4588
Epoch 0, Train Loss: 1.0995, Val Loss: 1.0946
batch size: (893, 893)
Epoch 1, accuracy: 0.3539
batch size: (889, 889)
Epoch 2, accuracy: 0.5997
Epoch 2, Train Loss: 1.0974, Val Loss: 1.0948
batch size: (877, 877)
✅ Epoch 3: New best model saved with val_loss = 1.0876
Epoch 3, accuracy: 0.4508
batch size: (897, 897)
Epoch 4, accuracy: 0.1691
Epoch 4, Train Loss: 1.0895, Val Loss: 1.1007
batch size: (897, 897)
✅ Epoch 5: New best model saved with val_loss = 1.0140
Epoch 5, accuracy: 0.5439
batch size: (894, 894)
✅ Epoch 6: New best model saved with val_loss = 0.9855
Epoch 6, accuracy: 0.5801
Epoch 6, Train Loss: 1.0236, Val Loss: 0.9855
batch size: (894, 894)
Epoch 7, accuracy: 0.5098
batch size: (897, 897)
Epoch 8, accuracy: 0.4274
Epoch 8, Train Loss: 1.0092, Val Loss: 1.2880
batch size: (882, 882)
✅ Epoch 9: New best model saved with val_loss = 0.9223
Epoch 9, accuracy: 0.4927
batch size: (900, 900)
✅ Epoch 10: New best model saved with val_loss = 0.8368
Epoch 10, accuracy: 0.5739
Epoch 10, Train Loss: 0.7005, Val Loss: 0.8368
batch size: (896, 896)
✅ Epoch 11: New best model saved with val_loss = 0.7803
Epoch 11, accuracy: 0.6195
batch size: (913, 913)
Epoch 12, accuracy: 0.5503
Epoch 12, Train Loss: 0.6415, Val Loss: 0.8200
batch size: (893, 893)
Epoch 13, accuracy: 0.5473
batch size: (897, 897)
Epoch 14, accuracy: 0.5791
Epoch 14, Train Loss: 0.5751, Val Loss: 0.8668
batch size: (904, 904)
✅ Epoch 15: New best model saved with val_loss = 0.7608
Epoch 15, accuracy: 0.7057
batch size: (903, 903)
✅ Epoch 16: New best model saved with val_loss = 0.6997
Epoch 16, accuracy: 0.7166
Epoch 16, Train Loss: 0.4978, Val Loss: 0.6997
batch size: (883, 883)
✅ Epoch 17: New best model saved with val_loss = 0.6599
Epoch 17, accuracy: 0.7194
batch size: (905, 905)
Epoch 18, accuracy: 0.7230
Epoch 18, Train Loss: 0.3396, Val Loss: 0.6841
batch size: (909, 909)
Epoch 19, accuracy: 0.7222
batch size: (899, 899)
Epoch 20, accuracy: 0.6725
Epoch 20, Train Loss: 0.2079, Val Loss: 1.2922
batch size: (900, 900)
Epoch 21, accuracy: 0.7149
batch size: (903, 903)
Epoch 22, accuracy: 0.7076
Epoch 22, Train Loss: 0.1489, Val Loss: 1.2128
batch size: (893, 893)
Epoch 23, accuracy: 0.7125
batch size: (909, 909)
Epoch 24, accuracy: 0.7104
Epoch 24, Train Loss: 0.0658, Val Loss: 1.0799
batch size: (895, 895)
Epoch 25, accuracy: 0.7075
batch size: (907, 907)
Epoch 26, accuracy: 0.7086
Epoch 26, Train Loss: 0.1006, Val Loss: 1.1518
batch size: (904, 904)
Epoch 27, accuracy: 0.7051
batch size: (893, 893)
Epoch 28, accuracy: 0.7023
Epoch 28, Train Loss: 0.0546, Val Loss: 1.1409
batch size: (891, 891)
Epoch 29, accuracy: 0.7014
batch size: (919, 919)
Epoch 30, accuracy: 0.7024
Epoch 30, Train Loss: 0.0441, Val Loss: 1.1574
batch size: (898, 898)
Epoch 31, accuracy: 0.7033
batch size: (906, 906)
Epoch 32, accuracy: 0.7038
Epoch 32, Train Loss: 0.0307, Val Loss: 1.2104
batch size: (911, 911)
Epoch 33, accuracy: 0.7025
batch size: (908, 908)
Epoch 34, accuracy: 0.7008
Epoch 34, Train Loss: 0.0793, Val Loss: 1.2089
batch size: (900, 900)
Epoch 35, accuracy: 0.7018
batch size: (921, 921)
Epoch 36, accuracy: 0.7001
Epoch 36, Train Loss: 0.0492, Val Loss: 1.1775
batch size: (923, 923)
Epoch 37, accuracy: 0.7035
batch size: (912, 912)
Epoch 38, accuracy: 0.7014
Epoch 38, Train Loss: 0.1151, Val Loss: 1.0366
batch size: (901, 901)
Epoch 39, accuracy: 0.7029
batch size: (898, 898)
Epoch 40, accuracy: 0.6995
Epoch 40, Train Loss: 0.0364, Val Loss: 1.1148
batch size: (886, 886)
Epoch 41, accuracy: 0.7023
batch size: (899, 899)
Epoch 42, accuracy: 0.7026
Epoch 42, Train Loss: 0.0509, Val Loss: 1.1162
batch size: (905, 905)
Epoch 43, accuracy: 0.7016
batch size: (897, 897)
Epoch 44, accuracy: 0.7020
Epoch 44, Train Loss: 0.1009, Val Loss: 1.1230
batch size: (887, 887)
Epoch 45, accuracy: 0.6985
batch size: (915, 915)
Epoch 46, accuracy: 0.7002
Epoch 46, Train Loss: 0.1772, Val Loss: 1.0906
batch size: (889, 889)
Epoch 47, accuracy: 0.6990
batch size: (908, 908)
Epoch 48, accuracy: 0.7032
Epoch 48, Train Loss: 0.0234, Val Loss: 1.1867
batch size: (882, 882)
Epoch 49, accuracy: 0.7043
batch size: (902, 902)
Epoch 50, accuracy: 0.7005
Epoch 50, Train Loss: 0.1335, Val Loss: 1.2477
batch size: (900, 900)
Epoch 51, accuracy: 0.7015
batch size: (890, 890)
Epoch 52, accuracy: 0.7008
Epoch 52, Train Loss: 0.0499, Val Loss: 1.0660
batch size: (910, 910)
Epoch 53, accuracy: 0.7029
batch size: (899, 899)
Epoch 54, accuracy: 0.7008
Epoch 54, Train Loss: 0.0465, Val Loss: 1.1364
batch size: (888, 888)
Epoch 55, accuracy: 0.6999
batch size: (913, 913)
Epoch 56, accuracy: 0.7037
Epoch 56, Train Loss: 0.0395, Val Loss: 1.1662
batch size: (903, 903)
Epoch 57, accuracy: 0.7001
batch size: (907, 907)
Epoch 58, accuracy: 0.6979
Epoch 58, Train Loss: 0.1258, Val Loss: 1.1510
batch size: (903, 903)
Epoch 59, accuracy: 0.7004
batch size: (906, 906)
Epoch 60, accuracy: 0.6999
Epoch 60, Train Loss: 0.0155, Val Loss: 1.1015
batch size: (901, 901)
Epoch 61, accuracy: 0.7020
batch size: (897, 897)
Epoch 62, accuracy: 0.7013
Epoch 62, Train Loss: 0.0393, Val Loss: 1.2642
batch size: (921, 921)
Epoch 63, accuracy: 0.7018
batch size: (897, 897)
Epoch 64, accuracy: 0.6985
Epoch 64, Train Loss: 0.0448, Val Loss: 1.1822
batch size: (913, 913)
Epoch 65, accuracy: 0.7033
batch size: (904, 904)
Epoch 66, accuracy: 0.7001
Epoch 66, Train Loss: 0.0795, Val Loss: 1.1082
batch size: (886, 886)
Epoch 67, accuracy: 0.7024
batch size: (898, 898)
Epoch 68, accuracy: 0.7048
Epoch 68, Train Loss: 0.2512, Val Loss: 1.1573
batch size: (886, 886)
Epoch 69, accuracy: 0.7018
batch size: (891, 891)
Epoch 70, accuracy: 0.6996
Epoch 70, Train Loss: 0.0935, Val Loss: 1.1265
batch size: (901, 901)
Epoch 71, accuracy: 0.7026
batch size: (910, 910)
Epoch 72, accuracy: 0.7009
Epoch 72, Train Loss: 0.0652, Val Loss: 1.1522
batch size: (898, 898)
Epoch 73, accuracy: 0.7016
batch size: (893, 893)
Epoch 74, accuracy: 0.7029
Epoch 74, Train Loss: 0.0409, Val Loss: 1.0737
batch size: (898, 898)
Epoch 75, accuracy: 0.6988
batch size: (918, 918)
Epoch 76, accuracy: 0.7030
Epoch 76, Train Loss: 0.1782, Val Loss: 1.1593
batch size: (893, 893)
Epoch 77, accuracy: 0.7035
batch size: (890, 890)
Epoch 78, accuracy: 0.7041
Epoch 78, Train Loss: 0.0312, Val Loss: 1.1023
batch size: (892, 892)
Epoch 79, accuracy: 0.6996
batch size: (897, 897)
Epoch 80, accuracy: 0.7000
Epoch 80, Train Loss: 0.0557, Val Loss: 1.1725
batch size: (902, 902)
Epoch 81, accuracy: 0.7028
batch size: (909, 909)
Epoch 82, accuracy: 0.7006
Epoch 82, Train Loss: 0.0352, Val Loss: 1.1473
batch size: (894, 894)
Epoch 83, accuracy: 0.7002
batch size: (898, 898)
Epoch 84, accuracy: 0.7008
Epoch 84, Train Loss: 0.0494, Val Loss: 1.1259
batch size: (888, 888)
Epoch 85, accuracy: 0.7007
batch size: (884, 884)
Epoch 86, accuracy: 0.7013
Epoch 86, Train Loss: 0.1249, Val Loss: 1.1408
batch size: (885, 885)
Epoch 87, accuracy: 0.7020
batch size: (904, 904)
Epoch 88, accuracy: 0.7008
Epoch 88, Train Loss: 0.0178, Val Loss: 1.1924
batch size: (885, 885)
Epoch 89, accuracy: 0.7018
batch size: (907, 907)
Epoch 90, accuracy: 0.6997
Epoch 90, Train Loss: 0.0958, Val Loss: 1.0650
batch size: (912, 912)
Epoch 91, accuracy: 0.6997
batch size: (903, 903)
Epoch 92, accuracy: 0.7018
Epoch 92, Train Loss: 0.1240, Val Loss: 1.1095
batch size: (894, 894)
Epoch 93, accuracy: 0.7030
batch size: (895, 895)
Epoch 94, accuracy: 0.7011
Epoch 94, Train Loss: 0.0385, Val Loss: 1.1161
batch size: (909, 909)
Epoch 95, accuracy: 0.6980
batch size: (907, 907)
Epoch 96, accuracy: 0.7010
Epoch 96, Train Loss: 0.0316, Val Loss: 1.1017
batch size: (908, 908)
Epoch 97, accuracy: 0.7028
batch size: (897, 897)
Epoch 98, accuracy: 0.6997
Epoch 98, Train Loss: 0.0411, Val Loss: 1.1680
batch size: (894, 894)
Epoch 99, accuracy: 0.7012
batch size: (895, 895)
Epoch 100, accuracy: 0.6995
Epoch 100, Train Loss: 0.1081, Val Loss: 1.1510
batch size: (893, 893)
Epoch 101, accuracy: 0.7037
batch size: (902, 902)
Epoch 102, accuracy: 0.7031
Epoch 102, Train Loss: 0.0317, Val Loss: 1.0924
batch size: (889, 889)
Epoch 103, accuracy: 0.7025
batch size: (897, 897)
Epoch 104, accuracy: 0.7015
Epoch 104, Train Loss: 0.1451, Val Loss: 1.1196
batch size: (875, 875)
Epoch 105, accuracy: 0.7019
batch size: (894, 894)
Epoch 106, accuracy: 0.6991
Epoch 106, Train Loss: 0.0823, Val Loss: 1.1274
batch size: (901, 901)
Epoch 107, accuracy: 0.6995
batch size: (889, 889)
Epoch 108, accuracy: 0.7022
Epoch 108, Train Loss: 0.0866, Val Loss: 1.1367
batch size: (894, 894)
Epoch 109, accuracy: 0.7007
batch size: (902, 902)
Epoch 110, accuracy: 0.7020
Epoch 110, Train Loss: 0.0739, Val Loss: 1.1255
batch size: (901, 901)
Epoch 111, accuracy: 0.7003
batch size: (892, 892)
Epoch 112, accuracy: 0.7018
Epoch 112, Train Loss: 0.0260, Val Loss: 1.2068
batch size: (894, 894)
Epoch 113, accuracy: 0.7010
batch size: (903, 903)
Epoch 114, accuracy: 0.7022
Epoch 114, Train Loss: 0.0267, Val Loss: 1.0871
batch size: (884, 884)
Epoch 115, accuracy: 0.7006
batch size: (892, 892)
Epoch 116, accuracy: 0.7027
Epoch 116, Train Loss: 0.1656, Val Loss: 1.0806
batch size: (888, 888)
Epoch 117, accuracy: 0.7008
batch size: (916, 916)
Epoch 118, accuracy: 0.7017
Epoch 118, Train Loss: 0.0312, Val Loss: 1.1341
batch size: (906, 906)
Epoch 119, accuracy: 0.7040
batch size: (884, 884)
Epoch 120, accuracy: 0.7009
Epoch 120, Train Loss: 0.0665, Val Loss: 1.1232
batch size: (897, 897)
Epoch 121, accuracy: 0.6989
batch size: (897, 897)
Epoch 122, accuracy: 0.7030
Epoch 122, Train Loss: 0.0194, Val Loss: 1.1632
batch size: (895, 895)
Epoch 123, accuracy: 0.6987
batch size: (905, 905)
Epoch 124, accuracy: 0.7010
Epoch 124, Train Loss: 0.1178, Val Loss: 1.2073
batch size: (913, 913)
Epoch 125, accuracy: 0.6999
batch size: (892, 892)
Epoch 126, accuracy: 0.7000
Epoch 126, Train Loss: 0.1652, Val Loss: 1.0878
batch size: (899, 899)
Epoch 127, accuracy: 0.7015
batch size: (877, 877)
Epoch 128, accuracy: 0.7005
Epoch 128, Train Loss: 0.0478, Val Loss: 1.1238
batch size: (898, 898)
Epoch 129, accuracy: 0.7004
batch size: (898, 898)
Epoch 130, accuracy: 0.7005
Epoch 130, Train Loss: 0.0453, Val Loss: 1.1452
batch size: (889, 889)
Epoch 131, accuracy: 0.7014
batch size: (886, 886)
Epoch 132, accuracy: 0.7040
Epoch 132, Train Loss: 0.0187, Val Loss: 1.1375
batch size: (901, 901)
Epoch 133, accuracy: 0.7033
batch size: (895, 895)
Epoch 134, accuracy: 0.7008
Epoch 134, Train Loss: 0.0580, Val Loss: 1.1917
batch size: (902, 902)
Epoch 135, accuracy: 0.6994
batch size: (894, 894)
Epoch 136, accuracy: 0.7000
Epoch 136, Train Loss: 0.0720, Val Loss: 1.0952
batch size: (898, 898)
Epoch 137, accuracy: 0.7019
batch size: (894, 894)
Epoch 138, accuracy: 0.7012
Epoch 138, Train Loss: 0.0230, Val Loss: 1.1528
batch size: (913, 913)
Epoch 139, accuracy: 0.7027
batch size: (893, 893)
Epoch 140, accuracy: 0.7015
Epoch 140, Train Loss: 0.1573, Val Loss: 1.1427
batch size: (896, 896)
Epoch 141, accuracy: 0.7012
batch size: (884, 884)
Epoch 142, accuracy: 0.7013
Epoch 142, Train Loss: 0.0343, Val Loss: 1.1101
batch size: (899, 899)
Epoch 143, accuracy: 0.7006
batch size: (900, 900)
Epoch 144, accuracy: 0.7002
Epoch 144, Train Loss: 0.0347, Val Loss: 1.0575
batch size: (891, 891)
Epoch 145, accuracy: 0.7026
batch size: (891, 891)
Epoch 146, accuracy: 0.7009
Epoch 146, Train Loss: 0.2565, Val Loss: 1.1741
batch size: (900, 900)
Epoch 147, accuracy: 0.6994
batch size: (898, 898)
Epoch 148, accuracy: 0.7024
Epoch 148, Train Loss: 0.0464, Val Loss: 1.2156
batch size: (875, 875)
Epoch 149, accuracy: 0.7007
batch size: (906, 906)
Epoch 150, accuracy: 0.7011
Epoch 150, Train Loss: 0.0896, Val Loss: 1.0754
batch size: (890, 890)
Epoch 151, accuracy: 0.7012
batch size: (893, 893)
Epoch 152, accuracy: 0.7020
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 152, Train Loss: 0.1458, Val Loss: 1.2003
batch size: (902, 902)
Epoch 153, accuracy: 0.7030
batch size: (902, 902)
Epoch 154, accuracy: 0.7011
Epoch 154, Train Loss: 0.0197, Val Loss: 1.1283
batch size: (898, 898)
Epoch 155, accuracy: 0.7030
batch size: (911, 911)
Epoch 156, accuracy: 0.7000
Epoch 156, Train Loss: 0.0435, Val Loss: 1.0594
batch size: (909, 909)
Epoch 157, accuracy: 0.7031
batch size: (898, 898)
Epoch 158, accuracy: 0.7011
Epoch 158, Train Loss: 0.0379, Val Loss: 1.1722
batch size: (902, 902)
Epoch 159, accuracy: 0.7014
batch size: (911, 911)
Epoch 160, accuracy: 0.6995
Epoch 160, Train Loss: 0.0863, Val Loss: 1.1651
batch size: (908, 908)
Epoch 161, accuracy: 0.7002
batch size: (906, 906)
Epoch 162, accuracy: 0.7027
Epoch 162, Train Loss: 0.0599, Val Loss: 1.1218
batch size: (881, 881)
Epoch 163, accuracy: 0.7012
batch size: (898, 898)
Epoch 164, accuracy: 0.7022
Epoch 164, Train Loss: 0.1113, Val Loss: 1.1113
batch size: (904, 904)
Epoch 165, accuracy: 0.7005
batch size: (889, 889)
Epoch 166, accuracy: 0.7025
Epoch 166, Train Loss: 0.1093, Val Loss: 1.1459
batch size: (890, 890)
Epoch 167, accuracy: 0.7024
batch size: (891, 891)
Epoch 168, accuracy: 0.7022
Epoch 168, Train Loss: 0.0936, Val Loss: 1.1758
batch size: (887, 887)
Epoch 169, accuracy: 0.7008
batch size: (905, 905)
Epoch 170, accuracy: 0.7020
Epoch 170, Train Loss: 0.0482, Val Loss: 1.1359
batch size: (875, 875)
Epoch 171, accuracy: 0.6992
batch size: (905, 905)
Epoch 172, accuracy: 0.7021
Epoch 172, Train Loss: 0.0318, Val Loss: 1.1166
batch size: (892, 892)
Epoch 173, accuracy: 0.7011
batch size: (902, 902)
Epoch 174, accuracy: 0.6996
Epoch 174, Train Loss: 0.0553, Val Loss: 1.0557
batch size: (889, 889)
Epoch 175, accuracy: 0.7006
batch size: (882, 882)
Epoch 176, accuracy: 0.7012
Epoch 176, Train Loss: 0.0417, Val Loss: 1.1557
batch size: (906, 906)
Epoch 177, accuracy: 0.7005
batch size: (906, 906)
Epoch 178, accuracy: 0.6998
Epoch 178, Train Loss: 0.0510, Val Loss: 1.1597
batch size: (896, 896)
Epoch 179, accuracy: 0.6981
batch size: (899, 899)
Epoch 180, accuracy: 0.7013
Epoch 180, Train Loss: 0.1881, Val Loss: 1.0920
batch size: (896, 896)
Epoch 181, accuracy: 0.7023
batch size: (914, 914)
Epoch 182, accuracy: 0.7016
Epoch 182, Train Loss: 0.0216, Val Loss: 1.1744
batch size: (913, 913)
Epoch 183, accuracy: 0.7003
batch size: (889, 889)
Epoch 184, accuracy: 0.7033
Epoch 184, Train Loss: 0.0494, Val Loss: 1.1481
batch size: (892, 892)
Epoch 185, accuracy: 0.7033
batch size: (910, 910)
Epoch 186, accuracy: 0.6990
Epoch 186, Train Loss: 0.0327, Val Loss: 1.1248
batch size: (907, 907)
Epoch 187, accuracy: 0.7016
batch size: (897, 897)
Epoch 188, accuracy: 0.7010
Epoch 188, Train Loss: 0.0241, Val Loss: 1.1187
batch size: (897, 897)
Epoch 189, accuracy: 0.7043
batch size: (897, 897)
Epoch 190, accuracy: 0.7018
Epoch 190, Train Loss: 0.2652, Val Loss: 1.1143
batch size: (910, 910)
Epoch 191, accuracy: 0.7016
batch size: (902, 902)
Epoch 192, accuracy: 0.7025
Epoch 192, Train Loss: 0.0534, Val Loss: 1.1428
batch size: (891, 891)
Epoch 193, accuracy: 0.7023
batch size: (917, 917)
Epoch 194, accuracy: 0.7020
Epoch 194, Train Loss: 0.0929, Val Loss: 1.1559
batch size: (897, 897)
Epoch 195, accuracy: 0.7030
batch size: (917, 917)
Epoch 196, accuracy: 0.7002
Epoch 196, Train Loss: 0.0720, Val Loss: 1.0554
batch size: (893, 893)
Epoch 197, accuracy: 0.7017
batch size: (901, 901)
Epoch 198, accuracy: 0.7006
Epoch 198, Train Loss: 0.0868, Val Loss: 1.1364
batch size: (910, 910)
Epoch 199, accuracy: 0.7012
Loaded best model with val_loss = 0.6599308848381042
test :accuracy 0.7157, f1_macro: 0.7131, f1_micro: 0.7157, auc: 0.8809
Training mamba3 with 3 layers...
可训练参数: 643445_mamba3
不可训练参数: 0
batch size: (894, 894)
✅ Epoch 0: New best model saved with val_loss = 0.9453
Epoch 0, accuracy: 0.4555
Epoch 0, Train Loss: 1.1139, Val Loss: 0.9453
batch size: (902, 902)
Epoch 1, accuracy: 0.2021
batch size: (898, 898)
Epoch 2, accuracy: 0.4147
Epoch 2, Train Loss: 1.6779, Val Loss: 1.1500
batch size: (901, 901)
✅ Epoch 3: New best model saved with val_loss = 0.8070
Epoch 3, accuracy: 0.5828
batch size: (900, 900)
Epoch 4, accuracy: 0.5467
Epoch 4, Train Loss: 0.7628, Val Loss: 0.8765
batch size: (891, 891)
✅ Epoch 5: New best model saved with val_loss = 0.7484
Epoch 5, accuracy: 0.5999
batch size: (911, 911)
✅ Epoch 6: New best model saved with val_loss = 0.7435
Epoch 6, accuracy: 0.6293
Epoch 6, Train Loss: 0.5170, Val Loss: 0.7435
batch size: (912, 912)
✅ Epoch 7: New best model saved with val_loss = 0.7369
Epoch 7, accuracy: 0.6423
batch size: (910, 910)
✅ Epoch 8: New best model saved with val_loss = 0.7028
Epoch 8, accuracy: 0.6447
Epoch 8, Train Loss: 0.4840, Val Loss: 0.7028
batch size: (920, 920)
✅ Epoch 9: New best model saved with val_loss = 0.6454
Epoch 9, accuracy: 0.6431
batch size: (910, 910)
✅ Epoch 10: New best model saved with val_loss = 0.6070
Epoch 10, accuracy: 0.6315
Epoch 10, Train Loss: 0.3802, Val Loss: 0.6070
batch size: (904, 904)
Epoch 11, accuracy: 0.6113
batch size: (899, 899)
Epoch 12, accuracy: 0.5986
Epoch 12, Train Loss: 0.4331, Val Loss: 0.6986
batch size: (902, 902)
Epoch 13, accuracy: 0.5961
batch size: (885, 885)
Epoch 14, accuracy: 0.6229
Epoch 14, Train Loss: 0.3520, Val Loss: 0.7322
batch size: (895, 895)
Epoch 15, accuracy: 0.6607
batch size: (892, 892)
Epoch 16, accuracy: 0.6857
Epoch 16, Train Loss: 0.2589, Val Loss: 0.6352
batch size: (909, 909)
Epoch 17, accuracy: 0.6906
batch size: (895, 895)
Epoch 18, accuracy: 0.6908
Epoch 18, Train Loss: 0.2511, Val Loss: 0.6433
batch size: (882, 882)
Epoch 19, accuracy: 0.6941
batch size: (917, 917)
Epoch 20, accuracy: 0.6935
Epoch 20, Train Loss: 0.2349, Val Loss: 0.6411
batch size: (900, 900)
Epoch 21, accuracy: 0.6925
batch size: (907, 907)
Epoch 22, accuracy: 0.6952
Epoch 22, Train Loss: 0.2773, Val Loss: 0.6393
batch size: (908, 908)
Epoch 23, accuracy: 0.6925
batch size: (901, 901)
Epoch 24, accuracy: 0.6929
Epoch 24, Train Loss: 0.1643, Val Loss: 0.6643
batch size: (889, 889)
Epoch 25, accuracy: 0.6932
batch size: (919, 919)
Epoch 26, accuracy: 0.6949
Epoch 26, Train Loss: 0.2722, Val Loss: 0.6467
batch size: (924, 924)
Epoch 27, accuracy: 0.6945
batch size: (891, 891)
Epoch 28, accuracy: 0.6922
Epoch 28, Train Loss: 0.2759, Val Loss: 0.6417
batch size: (904, 904)
Epoch 29, accuracy: 0.6930
batch size: (907, 907)
Epoch 30, accuracy: 0.6931
Epoch 30, Train Loss: 0.2794, Val Loss: 0.6684
batch size: (894, 894)
Epoch 31, accuracy: 0.6937
batch size: (912, 912)
Epoch 32, accuracy: 0.6969
Epoch 32, Train Loss: 0.1866, Val Loss: 0.6826
batch size: (903, 903)
Epoch 33, accuracy: 0.6942
batch size: (897, 897)
Epoch 34, accuracy: 0.6934
Epoch 34, Train Loss: 0.2129, Val Loss: 0.6446
batch size: (895, 895)
Epoch 35, accuracy: 0.6947
batch size: (901, 901)
Epoch 36, accuracy: 0.6927
Epoch 36, Train Loss: 0.1812, Val Loss: 0.6664
batch size: (899, 899)
Epoch 37, accuracy: 0.6938
batch size: (915, 915)
Epoch 38, accuracy: 0.6947
Epoch 38, Train Loss: 0.2052, Val Loss: 0.6521
batch size: (891, 891)
Epoch 39, accuracy: 0.6927
batch size: (904, 904)
Epoch 40, accuracy: 0.6938
Epoch 40, Train Loss: 0.2473, Val Loss: 0.6359
batch size: (919, 919)
Epoch 41, accuracy: 0.6952
batch size: (897, 897)
Epoch 42, accuracy: 0.6937
Epoch 42, Train Loss: 0.1528, Val Loss: 0.6779
batch size: (907, 907)
Epoch 43, accuracy: 0.6940
batch size: (908, 908)
Epoch 44, accuracy: 0.6939
Epoch 44, Train Loss: 0.2217, Val Loss: 0.6376
batch size: (904, 904)
Epoch 45, accuracy: 0.6951
batch size: (900, 900)
Epoch 46, accuracy: 0.6931
Epoch 46, Train Loss: 0.2213, Val Loss: 0.6299
batch size: (915, 915)
Epoch 47, accuracy: 0.6914
batch size: (914, 914)
Epoch 48, accuracy: 0.6922
Epoch 48, Train Loss: 0.1854, Val Loss: 0.6601
batch size: (896, 896)
Epoch 49, accuracy: 0.6944
batch size: (888, 888)
Epoch 50, accuracy: 0.6951
Epoch 50, Train Loss: 0.1412, Val Loss: 0.6463
batch size: (884, 884)
Epoch 51, accuracy: 0.6942
batch size: (896, 896)
Epoch 52, accuracy: 0.6935
Epoch 52, Train Loss: 0.2021, Val Loss: 0.6496
batch size: (913, 913)
Epoch 53, accuracy: 0.6926
batch size: (888, 888)
Epoch 54, accuracy: 0.6929
Epoch 54, Train Loss: 0.2227, Val Loss: 0.6570
batch size: (910, 910)
Epoch 55, accuracy: 0.6910
batch size: (879, 879)
Epoch 56, accuracy: 0.6927
Epoch 56, Train Loss: 0.2836, Val Loss: 0.6670
batch size: (887, 887)
Epoch 57, accuracy: 0.6955
batch size: (892, 892)
Epoch 58, accuracy: 0.6947
Epoch 58, Train Loss: 0.2075, Val Loss: 0.6554
batch size: (895, 895)
Epoch 59, accuracy: 0.6959
batch size: (910, 910)
Epoch 60, accuracy: 0.6936
Epoch 60, Train Loss: 0.1732, Val Loss: 0.6548
batch size: (902, 902)
Epoch 61, accuracy: 0.6950
batch size: (898, 898)
Epoch 62, accuracy: 0.6921
Epoch 62, Train Loss: 0.2646, Val Loss: 0.6602
batch size: (891, 891)
Epoch 63, accuracy: 0.6913
batch size: (893, 893)
Epoch 64, accuracy: 0.6938
Epoch 64, Train Loss: 0.1674, Val Loss: 0.6342
batch size: (905, 905)
Epoch 65, accuracy: 0.6944
batch size: (889, 889)
Epoch 66, accuracy: 0.6918
Epoch 66, Train Loss: 0.1410, Val Loss: 0.6558
batch size: (891, 891)
Epoch 67, accuracy: 0.6946
batch size: (914, 914)
Epoch 68, accuracy: 0.6912
Epoch 68, Train Loss: 0.3216, Val Loss: 0.6591
batch size: (899, 899)
Epoch 69, accuracy: 0.6943
batch size: (910, 910)
Epoch 70, accuracy: 0.6922
Epoch 70, Train Loss: 0.2607, Val Loss: 0.6639
batch size: (897, 897)
Epoch 71, accuracy: 0.6926
batch size: (891, 891)
Epoch 72, accuracy: 0.6924
Epoch 72, Train Loss: 0.1598, Val Loss: 0.6337
batch size: (907, 907)
Epoch 73, accuracy: 0.6950
batch size: (912, 912)
Epoch 74, accuracy: 0.6937
Epoch 74, Train Loss: 0.2248, Val Loss: 0.6454
batch size: (903, 903)
Epoch 75, accuracy: 0.6940
batch size: (921, 921)
Epoch 76, accuracy: 0.6927
Epoch 76, Train Loss: 0.1677, Val Loss: 0.6602
batch size: (908, 908)
Epoch 77, accuracy: 0.6940
batch size: (878, 878)
Epoch 78, accuracy: 0.6929
Epoch 78, Train Loss: 0.1395, Val Loss: 0.6555
batch size: (910, 910)
Epoch 79, accuracy: 0.6920
batch size: (911, 911)
Epoch 80, accuracy: 0.6924
Epoch 80, Train Loss: 0.3038, Val Loss: 0.6554
batch size: (881, 881)
Epoch 81, accuracy: 0.6927
batch size: (910, 910)
Epoch 82, accuracy: 0.6935
Epoch 82, Train Loss: 0.2357, Val Loss: 0.6523
batch size: (902, 902)
Epoch 83, accuracy: 0.6943
batch size: (886, 886)
Epoch 84, accuracy: 0.6939
Epoch 84, Train Loss: 0.2499, Val Loss: 0.6523
batch size: (902, 902)
Epoch 85, accuracy: 0.6935
batch size: (891, 891)
Epoch 86, accuracy: 0.6930
Epoch 86, Train Loss: 0.2383, Val Loss: 0.6416
batch size: (916, 916)
Epoch 87, accuracy: 0.6938
batch size: (910, 910)
Epoch 88, accuracy: 0.6944
Epoch 88, Train Loss: 0.1807, Val Loss: 0.6537
batch size: (899, 899)
Epoch 89, accuracy: 0.6946
batch size: (904, 904)
Epoch 90, accuracy: 0.6950
Epoch 90, Train Loss: 0.1917, Val Loss: 0.6451
batch size: (894, 894)
Epoch 91, accuracy: 0.6945
batch size: (886, 886)
Epoch 92, accuracy: 0.6911
Epoch 92, Train Loss: 0.2472, Val Loss: 0.6513
batch size: (901, 901)
Epoch 93, accuracy: 0.6940
batch size: (913, 913)
Epoch 94, accuracy: 0.6923
Epoch 94, Train Loss: 0.1928, Val Loss: 0.6549
batch size: (917, 917)
Epoch 95, accuracy: 0.6948
batch size: (907, 907)
Epoch 96, accuracy: 0.6915
Epoch 96, Train Loss: 0.2144, Val Loss: 0.6608
batch size: (887, 887)
Epoch 97, accuracy: 0.6945
batch size: (915, 915)
Epoch 98, accuracy: 0.6954
Epoch 98, Train Loss: 0.2929, Val Loss: 0.6741
batch size: (880, 880)
Epoch 99, accuracy: 0.6930
batch size: (904, 904)
Epoch 100, accuracy: 0.6926
Epoch 100, Train Loss: 0.1510, Val Loss: 0.6550
batch size: (905, 905)
Epoch 101, accuracy: 0.6938
batch size: (914, 914)
Epoch 102, accuracy: 0.6926
Epoch 102, Train Loss: 0.1322, Val Loss: 0.6493
batch size: (907, 907)
Epoch 103, accuracy: 0.6921
batch size: (891, 891)
Epoch 104, accuracy: 0.6934
Epoch 104, Train Loss: 0.1838, Val Loss: 0.6601
batch size: (904, 904)
Epoch 105, accuracy: 0.6948
batch size: (899, 899)
Epoch 106, accuracy: 0.6937
Epoch 106, Train Loss: 0.1284, Val Loss: 0.6730
batch size: (893, 893)
Epoch 107, accuracy: 0.6937
batch size: (896, 896)
Epoch 108, accuracy: 0.6924
Epoch 108, Train Loss: 0.1287, Val Loss: 0.6394
batch size: (878, 878)
Epoch 109, accuracy: 0.6926
batch size: (883, 883)
Epoch 110, accuracy: 0.6931
Epoch 110, Train Loss: 0.1898, Val Loss: 0.6610
batch size: (912, 912)
Epoch 111, accuracy: 0.6939
batch size: (910, 910)
Epoch 112, accuracy: 0.6944
Epoch 112, Train Loss: 0.3262, Val Loss: 0.6535
batch size: (892, 892)
Epoch 113, accuracy: 0.6934
batch size: (886, 886)
Epoch 114, accuracy: 0.6934
Epoch 114, Train Loss: 0.1501, Val Loss: 0.6605
batch size: (906, 906)
Epoch 115, accuracy: 0.6937
batch size: (900, 900)
Epoch 116, accuracy: 0.6921
Epoch 116, Train Loss: 0.1978, Val Loss: 0.6490
batch size: (907, 907)
Epoch 117, accuracy: 0.6922
batch size: (889, 889)
Epoch 118, accuracy: 0.6926
Epoch 118, Train Loss: 0.1355, Val Loss: 0.6651
batch size: (894, 894)
Epoch 119, accuracy: 0.6956
batch size: (893, 893)
Epoch 120, accuracy: 0.6945
Epoch 120, Train Loss: 0.3473, Val Loss: 0.6489
batch size: (897, 897)
Epoch 121, accuracy: 0.6934
batch size: (900, 900)
Epoch 122, accuracy: 0.6906
Epoch 122, Train Loss: 0.2734, Val Loss: 0.6368
batch size: (876, 876)
Epoch 123, accuracy: 0.6928
batch size: (896, 896)
Epoch 124, accuracy: 0.6927
Epoch 124, Train Loss: 0.2154, Val Loss: 0.6561
batch size: (898, 898)
Epoch 125, accuracy: 0.6924
batch size: (900, 900)
Epoch 126, accuracy: 0.6941
Epoch 126, Train Loss: 0.1540, Val Loss: 0.6770
batch size: (910, 910)
Epoch 127, accuracy: 0.6918
batch size: (908, 908)
Epoch 128, accuracy: 0.6935
Epoch 128, Train Loss: 0.2122, Val Loss: 0.6598
batch size: (913, 913)
Epoch 129, accuracy: 0.6941
batch size: (902, 902)
Epoch 130, accuracy: 0.6926
Epoch 130, Train Loss: 0.1689, Val Loss: 0.6476
batch size: (907, 907)
Epoch 131, accuracy: 0.6914
batch size: (906, 906)
Epoch 132, accuracy: 0.6940
Epoch 132, Train Loss: 0.1990, Val Loss: 0.6469
batch size: (921, 921)
Epoch 133, accuracy: 0.6934
batch size: (897, 897)
Epoch 134, accuracy: 0.6947
Epoch 134, Train Loss: 0.1947, Val Loss: 0.6589
batch size: (901, 901)
Epoch 135, accuracy: 0.6930
batch size: (899, 899)
Epoch 136, accuracy: 0.6943
Epoch 136, Train Loss: 0.2184, Val Loss: 0.6559
batch size: (881, 881)
Epoch 137, accuracy: 0.6948
batch size: (901, 901)
Epoch 138, accuracy: 0.6930
Epoch 138, Train Loss: 0.2261, Val Loss: 0.6580
batch size: (911, 911)
Epoch 139, accuracy: 0.6941
batch size: (898, 898)
Epoch 140, accuracy: 0.6924
Epoch 140, Train Loss: 0.2353, Val Loss: 0.6544
batch size: (912, 912)
Epoch 141, accuracy: 0.6936
batch size: (887, 887)
Epoch 142, accuracy: 0.6932
Epoch 142, Train Loss: 0.3436, Val Loss: 0.6614
batch size: (921, 921)
Epoch 143, accuracy: 0.6949
batch size: (907, 907)
Epoch 144, accuracy: 0.6920
Epoch 144, Train Loss: 0.2236, Val Loss: 0.6284
batch size: (921, 921)
Epoch 145, accuracy: 0.6920
batch size: (892, 892)
Epoch 146, accuracy: 0.6955
Epoch 146, Train Loss: 0.2124, Val Loss: 0.6346
batch size: (901, 901)
Epoch 147, accuracy: 0.6933
batch size: (898, 898)
Epoch 148, accuracy: 0.6931
Epoch 148, Train Loss: 0.2985, Val Loss: 0.6513
batch size: (890, 890)
Epoch 149, accuracy: 0.6939
batch size: (914, 914)
Epoch 150, accuracy: 0.6922
Epoch 150, Train Loss: 0.2887, Val Loss: 0.6587
batch size: (901, 901)
Epoch 151, accuracy: 0.6936
batch size: (894, 894)
Epoch 152, accuracy: 0.6912
Epoch 152, Train Loss: 0.2228, Val Loss: 0.6631
batch size: (910, 910)
Epoch 153, accuracy: 0.6917
batch size: (904, 904)
Epoch 154, accuracy: 0.6936
Epoch 154, Train Loss: 0.1637, Val Loss: 0.6501
batch size: (892, 892)
Epoch 155, accuracy: 0.6922
batch size: (889, 889)
Epoch 156, accuracy: 0.6930
Epoch 156, Train Loss: 0.2634, Val Loss: 0.6464
batch size: (901, 901)
Epoch 157, accuracy: 0.6917
batch size: (885, 885)
Epoch 158, accuracy: 0.6939
Epoch 158, Train Loss: 0.1857, Val Loss: 0.6597
batch size: (906, 906)
Epoch 159, accuracy: 0.6930
batch size: (903, 903)
Epoch 160, accuracy: 0.6917
Epoch 160, Train Loss: 0.2430, Val Loss: 0.6565
batch size: (886, 886)
Epoch 161, accuracy: 0.6954
batch size: (905, 905)
Epoch 162, accuracy: 0.6925
Epoch 162, Train Loss: 0.2022, Val Loss: 0.6493
batch size: (905, 905)
Epoch 163, accuracy: 0.6945
batch size: (911, 911)
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 164, accuracy: 0.6930
Epoch 164, Train Loss: 0.2116, Val Loss: 0.6345
batch size: (907, 907)
Epoch 165, accuracy: 0.6936
batch size: (901, 901)
Epoch 166, accuracy: 0.6937
Epoch 166, Train Loss: 0.2120, Val Loss: 0.6438
batch size: (895, 895)
Epoch 167, accuracy: 0.6944
batch size: (918, 918)
Epoch 168, accuracy: 0.6929
Epoch 168, Train Loss: 0.2752, Val Loss: 0.6556
batch size: (884, 884)
Epoch 169, accuracy: 0.6933
batch size: (903, 903)
Epoch 170, accuracy: 0.6942
Epoch 170, Train Loss: 0.1897, Val Loss: 0.6636
batch size: (896, 896)
Epoch 171, accuracy: 0.6939
batch size: (890, 890)
Epoch 172, accuracy: 0.6920
Epoch 172, Train Loss: 0.3248, Val Loss: 0.6472
batch size: (875, 875)
Epoch 173, accuracy: 0.6952
batch size: (921, 921)
Epoch 174, accuracy: 0.6930
Epoch 174, Train Loss: 0.2820, Val Loss: 0.6526
batch size: (905, 905)
Epoch 175, accuracy: 0.6949
batch size: (885, 885)
Epoch 176, accuracy: 0.6925
Epoch 176, Train Loss: 0.3146, Val Loss: 0.6404
batch size: (907, 907)
Epoch 177, accuracy: 0.6938
batch size: (913, 913)
Epoch 178, accuracy: 0.6928
Epoch 178, Train Loss: 0.2738, Val Loss: 0.6664
batch size: (906, 906)
Epoch 179, accuracy: 0.6946
batch size: (896, 896)
Epoch 180, accuracy: 0.6937
Epoch 180, Train Loss: 0.2412, Val Loss: 0.6489
batch size: (902, 902)
Epoch 181, accuracy: 0.6937
batch size: (892, 892)
Epoch 182, accuracy: 0.6947
Epoch 182, Train Loss: 0.2080, Val Loss: 0.6398
batch size: (884, 884)
Epoch 183, accuracy: 0.6930
batch size: (910, 910)
Epoch 184, accuracy: 0.6916
Epoch 184, Train Loss: 0.3367, Val Loss: 0.6600
batch size: (905, 905)
Epoch 185, accuracy: 0.6947
batch size: (883, 883)
Epoch 186, accuracy: 0.6932
Epoch 186, Train Loss: 0.1892, Val Loss: 0.6570
batch size: (886, 886)
Epoch 187, accuracy: 0.6926
batch size: (893, 893)
Epoch 188, accuracy: 0.6919
Epoch 188, Train Loss: 0.2064, Val Loss: 0.6464
batch size: (906, 906)
Epoch 189, accuracy: 0.6936
batch size: (892, 892)
Epoch 190, accuracy: 0.6924
Epoch 190, Train Loss: 0.2080, Val Loss: 0.6731
batch size: (903, 903)
Epoch 191, accuracy: 0.6936
batch size: (882, 882)
Epoch 192, accuracy: 0.6934
Epoch 192, Train Loss: 0.2297, Val Loss: 0.6451
batch size: (910, 910)
Epoch 193, accuracy: 0.6917
batch size: (902, 902)
Epoch 194, accuracy: 0.6936
Epoch 194, Train Loss: 0.1799, Val Loss: 0.6264
batch size: (902, 902)
Epoch 195, accuracy: 0.6927
batch size: (894, 894)
Epoch 196, accuracy: 0.6919
Epoch 196, Train Loss: 0.3071, Val Loss: 0.6368
batch size: (896, 896)
Epoch 197, accuracy: 0.6938
batch size: (883, 883)
Epoch 198, accuracy: 0.6944
Epoch 198, Train Loss: 0.1793, Val Loss: 0.6619
batch size: (900, 900)
Epoch 199, accuracy: 0.6949
Loaded best model with val_loss = 0.6070412397384644
test :accuracy 0.6328, f1_macro: 0.6337, f1_micro: 0.6328, auc: 0.8332
Training mamba3 with 4 layers...
可训练参数: 726005_mamba3
不可训练参数: 0
batch size: (905, 905)
✅ Epoch 0: New best model saved with val_loss = 1.1380
Epoch 0, accuracy: 0.4788
Epoch 0, Train Loss: 1.1196, Val Loss: 1.1380
batch size: (907, 907)
Epoch 1, accuracy: 0.1719
batch size: (908, 908)
✅ Epoch 2: New best model saved with val_loss = 0.8448
Epoch 2, accuracy: 0.5971
Epoch 2, Train Loss: 1.6372, Val Loss: 0.8448
batch size: (898, 898)
✅ Epoch 3: New best model saved with val_loss = 0.7578
Epoch 3, accuracy: 0.6625
batch size: (897, 897)
Epoch 4, accuracy: 0.6081
Epoch 4, Train Loss: 0.7176, Val Loss: 0.7685
batch size: (892, 892)
✅ Epoch 5: New best model saved with val_loss = 0.7203
Epoch 5, accuracy: 0.5838
batch size: (896, 896)
✅ Epoch 6: New best model saved with val_loss = 0.6320
Epoch 6, accuracy: 0.6213
Epoch 6, Train Loss: 0.6870, Val Loss: 0.6320
batch size: (903, 903)
✅ Epoch 7: New best model saved with val_loss = 0.6117
Epoch 7, accuracy: 0.6703
batch size: (892, 892)
Epoch 8, accuracy: 0.6734
Epoch 8, Train Loss: 0.5675, Val Loss: 0.6348
batch size: (891, 891)
Epoch 9, accuracy: 0.6645
batch size: (914, 914)
Epoch 10, accuracy: 0.6561
Epoch 10, Train Loss: 0.5887, Val Loss: 0.6541
batch size: (857, 857)
Epoch 11, accuracy: 0.6490
batch size: (907, 907)
Epoch 12, accuracy: 0.6364
Epoch 12, Train Loss: 0.4479, Val Loss: 0.6560
batch size: (876, 876)
Epoch 13, accuracy: 0.6300
batch size: (892, 892)
Epoch 14, accuracy: 0.6292
Epoch 14, Train Loss: 0.4668, Val Loss: 0.6692
batch size: (922, 922)
Epoch 15, accuracy: 0.6365
batch size: (889, 889)
Epoch 16, accuracy: 0.6382
Epoch 16, Train Loss: 0.3404, Val Loss: 0.6688
batch size: (908, 908)
Epoch 17, accuracy: 0.6378
batch size: (886, 886)
Epoch 18, accuracy: 0.6414
Epoch 18, Train Loss: 0.4261, Val Loss: 0.6648
batch size: (917, 917)
Epoch 19, accuracy: 0.6436
batch size: (877, 877)
Epoch 20, accuracy: 0.6422
Epoch 20, Train Loss: 0.4451, Val Loss: 0.6632
batch size: (902, 902)
Epoch 21, accuracy: 0.6423
batch size: (916, 916)
Epoch 22, accuracy: 0.6461
Epoch 22, Train Loss: 0.3663, Val Loss: 0.6588
batch size: (906, 906)
Epoch 23, accuracy: 0.6459
batch size: (908, 908)
Epoch 24, accuracy: 0.6441
Epoch 24, Train Loss: 0.4511, Val Loss: 0.6573
batch size: (919, 919)
Epoch 25, accuracy: 0.6458
batch size: (914, 914)
Epoch 26, accuracy: 0.6472
Epoch 26, Train Loss: 0.4183, Val Loss: 0.6682
batch size: (898, 898)
Epoch 27, accuracy: 0.6455
batch size: (911, 911)
Epoch 28, accuracy: 0.6456
Epoch 28, Train Loss: 0.4439, Val Loss: 0.6571
batch size: (907, 907)
Epoch 29, accuracy: 0.6472
batch size: (889, 889)
Epoch 30, accuracy: 0.6460
Epoch 30, Train Loss: 0.3336, Val Loss: 0.6670
batch size: (903, 903)
Epoch 31, accuracy: 0.6475
batch size: (904, 904)
Epoch 32, accuracy: 0.6456
Epoch 32, Train Loss: 0.3803, Val Loss: 0.6572
batch size: (901, 901)
Epoch 33, accuracy: 0.6463
batch size: (914, 914)
Epoch 34, accuracy: 0.6468
Epoch 34, Train Loss: 0.3869, Val Loss: 0.6541
batch size: (912, 912)
Epoch 35, accuracy: 0.6466
batch size: (920, 920)
Epoch 36, accuracy: 0.6500
Epoch 36, Train Loss: 0.3893, Val Loss: 0.6628
batch size: (888, 888)
Epoch 37, accuracy: 0.6483
batch size: (886, 886)
Epoch 38, accuracy: 0.6461
Epoch 38, Train Loss: 0.4201, Val Loss: 0.6658
batch size: (903, 903)
Epoch 39, accuracy: 0.6474
batch size: (907, 907)
Epoch 40, accuracy: 0.6458
Epoch 40, Train Loss: 0.4105, Val Loss: 0.6508
batch size: (902, 902)
Epoch 41, accuracy: 0.6476
batch size: (893, 893)
Epoch 42, accuracy: 0.6454
Epoch 42, Train Loss: 0.3747, Val Loss: 0.6578
batch size: (900, 900)
Epoch 43, accuracy: 0.6441
batch size: (910, 910)
Epoch 44, accuracy: 0.6488
Epoch 44, Train Loss: 0.3046, Val Loss: 0.6656
batch size: (916, 916)
Epoch 45, accuracy: 0.6459
batch size: (917, 917)
Epoch 46, accuracy: 0.6491
Epoch 46, Train Loss: 0.3988, Val Loss: 0.6629
batch size: (910, 910)
Epoch 47, accuracy: 0.6486
batch size: (893, 893)
Epoch 48, accuracy: 0.6480
Epoch 48, Train Loss: 0.4366, Val Loss: 0.6523
batch size: (902, 902)
Epoch 49, accuracy: 0.6452
batch size: (899, 899)
Epoch 50, accuracy: 0.6457
Epoch 50, Train Loss: 0.3673, Val Loss: 0.6598
batch size: (913, 913)
Epoch 51, accuracy: 0.6487
batch size: (896, 896)
Epoch 52, accuracy: 0.6459
Epoch 52, Train Loss: 0.4403, Val Loss: 0.6500
batch size: (886, 886)
Epoch 53, accuracy: 0.6455
batch size: (897, 897)
Epoch 54, accuracy: 0.6475
Epoch 54, Train Loss: 0.3295, Val Loss: 0.6621
batch size: (894, 894)
Epoch 55, accuracy: 0.6483
batch size: (900, 900)
Epoch 56, accuracy: 0.6464
Epoch 56, Train Loss: 0.3168, Val Loss: 0.6631
batch size: (920, 920)
Epoch 57, accuracy: 0.6468
batch size: (894, 894)
Epoch 58, accuracy: 0.6470
Epoch 58, Train Loss: 0.3480, Val Loss: 0.6610
batch size: (906, 906)
Epoch 59, accuracy: 0.6480
batch size: (907, 907)
Epoch 60, accuracy: 0.6484
Epoch 60, Train Loss: 0.4580, Val Loss: 0.6485
batch size: (890, 890)
Epoch 61, accuracy: 0.6483
batch size: (919, 919)
Epoch 62, accuracy: 0.6447
Epoch 62, Train Loss: 0.4266, Val Loss: 0.6670
batch size: (901, 901)
Epoch 63, accuracy: 0.6485
batch size: (899, 899)
Epoch 64, accuracy: 0.6455
Epoch 64, Train Loss: 0.3946, Val Loss: 0.6607
batch size: (895, 895)
Epoch 65, accuracy: 0.6459
batch size: (877, 877)
Epoch 66, accuracy: 0.6469
Epoch 66, Train Loss: 0.4127, Val Loss: 0.6631
batch size: (907, 907)
Epoch 67, accuracy: 0.6471
batch size: (916, 916)
Epoch 68, accuracy: 0.6478
Epoch 68, Train Loss: 0.4484, Val Loss: 0.6619
batch size: (917, 917)
Epoch 69, accuracy: 0.6465
batch size: (910, 910)
Epoch 70, accuracy: 0.6475
Epoch 70, Train Loss: 0.3854, Val Loss: 0.6729
batch size: (880, 880)
Epoch 71, accuracy: 0.6451
batch size: (916, 916)
Epoch 72, accuracy: 0.6471
Epoch 72, Train Loss: 0.3733, Val Loss: 0.6612
batch size: (880, 880)
Epoch 73, accuracy: 0.6467
batch size: (901, 901)
Epoch 74, accuracy: 0.6462
Epoch 74, Train Loss: 0.5258, Val Loss: 0.6700
batch size: (912, 912)
Epoch 75, accuracy: 0.6483
batch size: (908, 908)
Epoch 76, accuracy: 0.6443
Epoch 76, Train Loss: 0.4450, Val Loss: 0.6579
batch size: (893, 893)
Epoch 77, accuracy: 0.6456
batch size: (907, 907)
Epoch 78, accuracy: 0.6471
Epoch 78, Train Loss: 0.3464, Val Loss: 0.6535
batch size: (882, 882)
Epoch 79, accuracy: 0.6471
batch size: (903, 903)
Epoch 80, accuracy: 0.6486
Epoch 80, Train Loss: 0.4785, Val Loss: 0.6586
batch size: (888, 888)
Epoch 81, accuracy: 0.6490
batch size: (907, 907)
Epoch 82, accuracy: 0.6475
Epoch 82, Train Loss: 0.3409, Val Loss: 0.6711
batch size: (910, 910)
Epoch 83, accuracy: 0.6477
batch size: (907, 907)
Epoch 84, accuracy: 0.6456
Epoch 84, Train Loss: 0.4484, Val Loss: 0.6467
batch size: (905, 905)
Epoch 85, accuracy: 0.6468
batch size: (896, 896)
Epoch 86, accuracy: 0.6486
Epoch 86, Train Loss: 0.4473, Val Loss: 0.6630
batch size: (900, 900)
Epoch 87, accuracy: 0.6482
batch size: (897, 897)
Epoch 88, accuracy: 0.6456
Epoch 88, Train Loss: 0.3601, Val Loss: 0.6586
batch size: (897, 897)
Epoch 89, accuracy: 0.6466
batch size: (914, 914)
Epoch 90, accuracy: 0.6484
Epoch 90, Train Loss: 0.4613, Val Loss: 0.6592
batch size: (900, 900)
Epoch 91, accuracy: 0.6493
batch size: (893, 893)
Epoch 92, accuracy: 0.6485
Epoch 92, Train Loss: 0.3746, Val Loss: 0.6552
batch size: (904, 904)
Epoch 93, accuracy: 0.6463
batch size: (888, 888)
Epoch 94, accuracy: 0.6465
Epoch 94, Train Loss: 0.3248, Val Loss: 0.6585
batch size: (886, 886)
Epoch 95, accuracy: 0.6465
batch size: (898, 898)
Epoch 96, accuracy: 0.6460
Epoch 96, Train Loss: 0.4319, Val Loss: 0.6628
batch size: (895, 895)
Epoch 97, accuracy: 0.6465
batch size: (903, 903)
Epoch 98, accuracy: 0.6456
Epoch 98, Train Loss: 0.4316, Val Loss: 0.6646
batch size: (905, 905)
Epoch 99, accuracy: 0.6466
batch size: (890, 890)
Epoch 100, accuracy: 0.6457
Epoch 100, Train Loss: 0.4048, Val Loss: 0.6782
batch size: (890, 890)
Epoch 101, accuracy: 0.6458
batch size: (894, 894)
Epoch 102, accuracy: 0.6483
Epoch 102, Train Loss: 0.3216, Val Loss: 0.6610
batch size: (911, 911)
Epoch 103, accuracy: 0.6471
batch size: (906, 906)
Epoch 104, accuracy: 0.6458
Epoch 104, Train Loss: 0.4990, Val Loss: 0.6652
batch size: (909, 909)
Epoch 105, accuracy: 0.6471
batch size: (916, 916)
Epoch 106, accuracy: 0.6464
Epoch 106, Train Loss: 0.4108, Val Loss: 0.6556
batch size: (898, 898)
Epoch 107, accuracy: 0.6452
batch size: (894, 894)
Epoch 108, accuracy: 0.6481
Epoch 108, Train Loss: 0.3472, Val Loss: 0.6550
batch size: (898, 898)
Epoch 109, accuracy: 0.6453
batch size: (903, 903)
Epoch 110, accuracy: 0.6476
Epoch 110, Train Loss: 0.3762, Val Loss: 0.6590
batch size: (886, 886)
Epoch 111, accuracy: 0.6468
batch size: (881, 881)
Epoch 112, accuracy: 0.6472
Epoch 112, Train Loss: 0.3993, Val Loss: 0.6531
batch size: (880, 880)
Epoch 113, accuracy: 0.6474
batch size: (889, 889)
Epoch 114, accuracy: 0.6448
Epoch 114, Train Loss: 0.3629, Val Loss: 0.6569
batch size: (895, 895)
Epoch 115, accuracy: 0.6434
batch size: (908, 908)
Epoch 116, accuracy: 0.6471
Epoch 116, Train Loss: 0.3380, Val Loss: 0.6636
batch size: (899, 899)
Epoch 117, accuracy: 0.6464
batch size: (899, 899)
Epoch 118, accuracy: 0.6453
Epoch 118, Train Loss: 0.4263, Val Loss: 0.6579
batch size: (903, 903)
Epoch 119, accuracy: 0.6454
batch size: (903, 903)
Epoch 120, accuracy: 0.6430
Epoch 120, Train Loss: 0.3960, Val Loss: 0.6570
batch size: (899, 899)
Epoch 121, accuracy: 0.6467
batch size: (891, 891)
Epoch 122, accuracy: 0.6474
Epoch 122, Train Loss: 0.4148, Val Loss: 0.6627
batch size: (884, 884)
Epoch 123, accuracy: 0.6460
batch size: (880, 880)
Epoch 124, accuracy: 0.6468
Epoch 124, Train Loss: 0.3538, Val Loss: 0.6546
batch size: (907, 907)
Epoch 125, accuracy: 0.6483
batch size: (915, 915)
Epoch 126, accuracy: 0.6471
Epoch 126, Train Loss: 0.4533, Val Loss: 0.6620
batch size: (909, 909)
Epoch 127, accuracy: 0.6457
batch size: (909, 909)
Epoch 128, accuracy: 0.6453
Epoch 128, Train Loss: 0.5157, Val Loss: 0.6694
batch size: (904, 904)
Epoch 129, accuracy: 0.6462
batch size: (906, 906)
Epoch 130, accuracy: 0.6483
Epoch 130, Train Loss: 0.4130, Val Loss: 0.6605
batch size: (897, 897)
Epoch 131, accuracy: 0.6475
batch size: (900, 900)
Epoch 132, accuracy: 0.6452
Epoch 132, Train Loss: 0.4301, Val Loss: 0.6601
batch size: (906, 906)
Epoch 133, accuracy: 0.6471
batch size: (907, 907)
Epoch 134, accuracy: 0.6456
Epoch 134, Train Loss: 0.4212, Val Loss: 0.6552
batch size: (889, 889)
Epoch 135, accuracy: 0.6449
batch size: (923, 923)
Epoch 136, accuracy: 0.6462
Epoch 136, Train Loss: 0.4430, Val Loss: 0.6652
batch size: (912, 912)
Epoch 137, accuracy: 0.6451
batch size: (898, 898)
Epoch 138, accuracy: 0.6453
Epoch 138, Train Loss: 0.3817, Val Loss: 0.6672
batch size: (903, 903)
Epoch 139, accuracy: 0.6482
batch size: (925, 925)
Epoch 140, accuracy: 0.6461
Epoch 140, Train Loss: 0.4342, Val Loss: 0.6584
batch size: (900, 900)
Epoch 141, accuracy: 0.6472
batch size: (917, 917)
Epoch 142, accuracy: 0.6462
Epoch 142, Train Loss: 0.4204, Val Loss: 0.6518
batch size: (895, 895)
Epoch 143, accuracy: 0.6451
batch size: (917, 917)
Epoch 144, accuracy: 0.6471
Epoch 144, Train Loss: 0.3873, Val Loss: 0.6516
batch size: (901, 901)
Epoch 145, accuracy: 0.6495
batch size: (886, 886)
Epoch 146, accuracy: 0.6474
Epoch 146, Train Loss: 0.5074, Val Loss: 0.6619
batch size: (914, 914)
Epoch 147, accuracy: 0.6445
batch size: (903, 903)
Epoch 148, accuracy: 0.6451
Epoch 148, Train Loss: 0.4852, Val Loss: 0.6585
batch size: (906, 906)
Epoch 149, accuracy: 0.6449
batch size: (891, 891)
Epoch 150, accuracy: 0.6446
Epoch 150, Train Loss: 0.3682, Val Loss: 0.6505
batch size: (876, 876)
Epoch 151, accuracy: 0.6455
batch size: (897, 897)
Epoch 152, accuracy: 0.6488
Epoch 152, Train Loss: 0.3863, Val Loss: 0.6639
batch size: (893, 893)
Epoch 153, accuracy: 0.6476
batch size: (897, 897)
Epoch 154, accuracy: 0.6465
Epoch 154, Train Loss: 0.5094, Val Loss: 0.6669
batch size: (899, 899)
Epoch 155, accuracy: 0.6464
batch size: (880, 880)
Epoch 156, accuracy: 0.6452
Epoch 156, Train Loss: 0.3470, Val Loss: 0.6571
batch size: (887, 887)
Epoch 157, accuracy: 0.6445
batch size: (910, 910)
Epoch 158, accuracy: 0.6459
Epoch 158, Train Loss: 0.3811, Val Loss: 0.6658
batch size: (905, 905)
Epoch 159, accuracy: 0.6460
batch size: (901, 901)
Epoch 160, accuracy: 0.6452
Epoch 160, Train Loss: 0.4397, Val Loss: 0.6566
batch size: (915, 915)
Epoch 161, accuracy: 0.6471
batch size: (901, 901)
Epoch 162, accuracy: 0.6481
Epoch 162, Train Loss: 0.3152, Val Loss: 0.6546
batch size: (885, 885)
Epoch 163, accuracy: 0.6472
batch size: (905, 905)
Epoch 164, accuracy: 0.6459
Epoch 164, Train Loss: 0.4592, Val Loss: 0.6586
batch size: (923, 923)
Epoch 165, accuracy: 0.6468
batch size: (904, 904)
Epoch 166, accuracy: 0.6495
Epoch 166, Train Loss: 0.3731, Val Loss: 0.6673
batch size: (897, 897)
Epoch 167, accuracy: 0.6457
batch size: (886, 886)
Epoch 168, accuracy: 0.6469
Epoch 168, Train Loss: 0.4555, Val Loss: 0.6553
batch size: (889, 889)
Epoch 169, accuracy: 0.6458
batch size: (908, 908)
Epoch 170, accuracy: 0.6477
Epoch 170, Train Loss: 0.4593, Val Loss: 0.6552
batch size: (898, 898)
Epoch 171, accuracy: 0.6465
batch size: (907, 907)
Epoch 172, accuracy: 0.6446
Epoch 172, Train Loss: 0.4348, Val Loss: 0.6590
batch size: (904, 904)
Epoch 173, accuracy: 0.6480
batch size: (904, 904)
Epoch 174, accuracy: 0.6474
Epoch 174, Train Loss: 0.4265, Val Loss: 0.6583
batch size: (918, 918)
Epoch 175, accuracy: 0.6466
batch size: (888, 888)
Epoch 176, accuracy: 0.6492
Epoch 176, Train Loss: 0.4886, Val Loss: 0.6703
batch size: /root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
(897, 897)
Epoch 177, accuracy: 0.6448
batch size: (918, 918)
Epoch 178, accuracy: 0.6490
Epoch 178, Train Loss: 0.3507, Val Loss: 0.6657
batch size: (906, 906)
Epoch 179, accuracy: 0.6483
batch size: (893, 893)
Epoch 180, accuracy: 0.6478
Epoch 180, Train Loss: 0.4340, Val Loss: 0.6582
batch size: (869, 869)
Epoch 181, accuracy: 0.6461
batch size: (901, 901)
Epoch 182, accuracy: 0.6470
Epoch 182, Train Loss: 0.3851, Val Loss: 0.6633
batch size: (907, 907)
Epoch 183, accuracy: 0.6479
batch size: (900, 900)
Epoch 184, accuracy: 0.6482
Epoch 184, Train Loss: 0.3925, Val Loss: 0.6636
batch size: (898, 898)
Epoch 185, accuracy: 0.6472
batch size: (882, 882)
Epoch 186, accuracy: 0.6466
Epoch 186, Train Loss: 0.4191, Val Loss: 0.6584
batch size: (927, 927)
Epoch 187, accuracy: 0.6451
batch size: (914, 914)
Epoch 188, accuracy: 0.6449
Epoch 188, Train Loss: 0.4305, Val Loss: 0.6547
batch size: (902, 902)
Epoch 189, accuracy: 0.6475
batch size: (910, 910)
Epoch 190, accuracy: 0.6460
Epoch 190, Train Loss: 0.4094, Val Loss: 0.6576
batch size: (891, 891)
Epoch 191, accuracy: 0.6467
batch size: (894, 894)
Epoch 192, accuracy: 0.6467
Epoch 192, Train Loss: 0.4105, Val Loss: 0.6595
batch size: (912, 912)
Epoch 193, accuracy: 0.6477
batch size: (902, 902)
Epoch 194, accuracy: 0.6461
Epoch 194, Train Loss: 0.4219, Val Loss: 0.6712
batch size: (896, 896)
Epoch 195, accuracy: 0.6481
batch size: (892, 892)
Epoch 196, accuracy: 0.6483
Epoch 196, Train Loss: 0.3925, Val Loss: 0.6547
batch size: (899, 899)
Epoch 197, accuracy: 0.6463
batch size: (912, 912)
Epoch 198, accuracy: 0.6450
Epoch 198, Train Loss: 0.3848, Val Loss: 0.6667
batch size: (904, 904)
Epoch 199, accuracy: 0.6477
Loaded best model with val_loss = 0.6116652488708496
test :accuracy 0.6703, f1_macro: 0.6784, f1_micro: 0.6703, auc: 0.8471
Training mamba3 with 5 layers...
可训练参数: 808565_mamba3
不可训练参数: 0
batch size: (895, 895)
✅ Epoch 0: New best model saved with val_loss = 2.2547
Epoch 0, accuracy: 0.4137
Epoch 0, Train Loss: 1.3407, Val Loss: 2.2547
batch size: (909, 909)
Epoch 1, accuracy: 0.1943
batch size: (890, 890)
✅ Epoch 2: New best model saved with val_loss = 1.7192
Epoch 2, accuracy: 0.3152
Epoch 2, Train Loss: 2.1291, Val Loss: 1.7192
batch size: (899, 899)
✅ Epoch 3: New best model saved with val_loss = 0.8833
Epoch 3, accuracy: 0.5020
batch size: (902, 902)
Epoch 4, accuracy: 0.4439
Epoch 4, Train Loss: 0.8992, Val Loss: 1.0601
batch size: (891, 891)
Epoch 5, accuracy: 0.5116
batch size: (919, 919)
✅ Epoch 6: New best model saved with val_loss = 0.8111
Epoch 6, accuracy: 0.5403
Epoch 6, Train Loss: 0.8742, Val Loss: 0.8111
batch size: (895, 895)
Epoch 7, accuracy: 0.3984
batch size: (897, 897)
Epoch 8, accuracy: 0.3382
Epoch 8, Train Loss: 0.8697, Val Loss: 1.0554
batch size: (902, 902)
Epoch 9, accuracy: 0.3896
batch size: (894, 894)
Epoch 10, accuracy: 0.4950
Epoch 10, Train Loss: 0.6510, Val Loss: 0.8756
batch size: (903, 903)
✅ Epoch 11: New best model saved with val_loss = 0.7358
Epoch 11, accuracy: 0.5863
batch size: (896, 896)
✅ Epoch 12: New best model saved with val_loss = 0.6639
Epoch 12, accuracy: 0.6321
Epoch 12, Train Loss: 0.5299, Val Loss: 0.6639
batch size: (903, 903)
✅ Epoch 13: New best model saved with val_loss = 0.6597
Epoch 13, accuracy: 0.6504
batch size: (925, 925)
Epoch 14, accuracy: 0.6490
Epoch 14, Train Loss: 0.5318, Val Loss: 0.6602
batch size: (897, 897)
Epoch 15, accuracy: 0.6328
batch size: (914, 914)
Epoch 16, accuracy: 0.6115
Epoch 16, Train Loss: 0.3791, Val Loss: 0.6842
batch size: (912, 912)
Epoch 17, accuracy: 0.5726
batch size: (899, 899)
Epoch 18, accuracy: 0.5333
Epoch 18, Train Loss: 0.4745, Val Loss: 0.8007
batch size: (915, 915)
Epoch 19, accuracy: 0.5126
batch size: (911, 911)
Epoch 20, accuracy: 0.5144
Epoch 20, Train Loss: 0.4604, Val Loss: 0.8459
batch size: (913, 913)
Epoch 21, accuracy: 0.5163
batch size: (895, 895)
Epoch 22, accuracy: 0.5218
Epoch 22, Train Loss: 0.4188, Val Loss: 0.8347
batch size: (891, 891)
Epoch 23, accuracy: 0.5287
batch size: (897, 897)
Epoch 24, accuracy: 0.5396
Epoch 24, Train Loss: 0.3691, Val Loss: 0.8233
batch size: (911, 911)
Epoch 25, accuracy: 0.5487
batch size: (900, 900)
Epoch 26, accuracy: 0.5486
Epoch 26, Train Loss: 0.4228, Val Loss: 0.8162
batch size: (897, 897)
Epoch 27, accuracy: 0.5482
batch size: (914, 914)
Epoch 28, accuracy: 0.5476
Epoch 28, Train Loss: 0.3981, Val Loss: 0.8081
batch size: (884, 884)
Epoch 29, accuracy: 0.5491
batch size: (898, 898)
Epoch 30, accuracy: 0.5505
Epoch 30, Train Loss: 0.4810, Val Loss: 0.8196
batch size: (886, 886)
Epoch 31, accuracy: 0.5535
batch size: (897, 897)
Epoch 32, accuracy: 0.5525
Epoch 32, Train Loss: 0.4097, Val Loss: 0.8193
batch size: (920, 920)
Epoch 33, accuracy: 0.5557
batch size: (922, 922)
Epoch 34, accuracy: 0.5536
Epoch 34, Train Loss: 0.3719, Val Loss: 0.8158
batch size: (902, 902)
Epoch 35, accuracy: 0.5545
batch size: (910, 910)
Epoch 36, accuracy: 0.5526
Epoch 36, Train Loss: 0.4587, Val Loss: 0.7877
batch size: (888, 888)
Epoch 37, accuracy: 0.5528
batch size: (898, 898)
Epoch 38, accuracy: 0.5536
Epoch 38, Train Loss: 0.4388, Val Loss: 0.8259
batch size: (916, 916)
Epoch 39, accuracy: 0.5525
batch size: (888, 888)
Epoch 40, accuracy: 0.5563
Epoch 40, Train Loss: 0.4992, Val Loss: 0.8255
batch size: (915, 915)
Epoch 41, accuracy: 0.5536
batch size: (886, 886)
Epoch 42, accuracy: 0.5548
Epoch 42, Train Loss: 0.4818, Val Loss: 0.7975
batch size: (896, 896)
Epoch 43, accuracy: 0.5545
batch size: (889, 889)
Epoch 44, accuracy: 0.5550
Epoch 44, Train Loss: 0.4636, Val Loss: 0.8175
batch size: (902, 902)
Epoch 45, accuracy: 0.5562
batch size: (900, 900)
Epoch 46, accuracy: 0.5509
Epoch 46, Train Loss: 0.2939, Val Loss: 0.8110
batch size: (901, 901)
Epoch 47, accuracy: 0.5511
batch size: (888, 888)
Epoch 48, accuracy: 0.5555
Epoch 48, Train Loss: 0.4396, Val Loss: 0.8165
batch size: (906, 906)
Epoch 49, accuracy: 0.5528
batch size: (901, 901)
Epoch 50, accuracy: 0.5548
Epoch 50, Train Loss: 0.4235, Val Loss: 0.8119
batch size: (911, 911)
Epoch 51, accuracy: 0.5540
batch size: (883, 883)
Epoch 52, accuracy: 0.5561
Epoch 52, Train Loss: 0.4771, Val Loss: 0.8001
batch size: (899, 899)
Epoch 53, accuracy: 0.5508
batch size: (900, 900)
Epoch 54, accuracy: 0.5548
Epoch 54, Train Loss: 0.3737, Val Loss: 0.7959
batch size: (896, 896)
Epoch 55, accuracy: 0.5541
batch size: (915, 915)
Epoch 56, accuracy: 0.5489
Epoch 56, Train Loss: 0.3809, Val Loss: 0.7985
batch size: (878, 878)
Epoch 57, accuracy: 0.5549
batch size: (877, 877)
Epoch 58, accuracy: 0.5514
Epoch 58, Train Loss: 0.4812, Val Loss: 0.7967
batch size: (914, 914)
Epoch 59, accuracy: 0.5534
batch size: (891, 891)
Epoch 60, accuracy: 0.5543
Epoch 60, Train Loss: 0.4560, Val Loss: 0.8131
batch size: (905, 905)
Epoch 61, accuracy: 0.5536
batch size: (903, 903)
Epoch 62, accuracy: 0.5545
Epoch 62, Train Loss: 0.3849, Val Loss: 0.8204
batch size: (888, 888)
Epoch 63, accuracy: 0.5516
batch size: (906, 906)
Epoch 64, accuracy: 0.5550
Epoch 64, Train Loss: 0.4131, Val Loss: 0.8127
batch size: (902, 902)
Epoch 65, accuracy: 0.5542
batch size: (889, 889)
Epoch 66, accuracy: 0.5555
Epoch 66, Train Loss: 0.3217, Val Loss: 0.8215
batch size: (909, 909)
Epoch 67, accuracy: 0.5539
batch size: (914, 914)
Epoch 68, accuracy: 0.5543
Epoch 68, Train Loss: 0.3616, Val Loss: 0.8127
batch size: (887, 887)
Epoch 69, accuracy: 0.5550
batch size: (901, 901)
Epoch 70, accuracy: 0.5531
Epoch 70, Train Loss: 0.4521, Val Loss: 0.8277
batch size: (894, 894)
Epoch 71, accuracy: 0.5514
batch size: (922, 922)
Epoch 72, accuracy: 0.5531
Epoch 72, Train Loss: 0.2898, Val Loss: 0.8081
batch size: (898, 898)
Epoch 73, accuracy: 0.5537
batch size: (889, 889)
Epoch 74, accuracy: 0.5543
Epoch 74, Train Loss: 0.3869, Val Loss: 0.8108
batch size: (895, 895)
Epoch 75, accuracy: 0.5534
batch size: (886, 886)
Epoch 76, accuracy: 0.5544
Epoch 76, Train Loss: 0.5066, Val Loss: 0.8133
batch size: (902, 902)
Epoch 77, accuracy: 0.5532
batch size: (892, 892)
Epoch 78, accuracy: 0.5559
Epoch 78, Train Loss: 0.5546, Val Loss: 0.8251
batch size: (885, 885)
Epoch 79, accuracy: 0.5528
batch size: (907, 907)
Epoch 80, accuracy: 0.5521
Epoch 80, Train Loss: 0.4152, Val Loss: 0.8030
batch size: (921, 921)
Epoch 81, accuracy: 0.5521
batch size: (912, 912)
Epoch 82, accuracy: 0.5560
Epoch 82, Train Loss: 0.4063, Val Loss: 0.8045
batch size: (892, 892)
Epoch 83, accuracy: 0.5534
batch size: (898, 898)
Epoch 84, accuracy: 0.5563
Epoch 84, Train Loss: 0.3106, Val Loss: 0.8028
batch size: (909, 909)
Epoch 85, accuracy: 0.5520
batch size: (887, 887)
Epoch 86, accuracy: 0.5531
Epoch 86, Train Loss: 0.3712, Val Loss: 0.7944
batch size: (897, 897)
Epoch 87, accuracy: 0.5556
batch size: (905, 905)
Epoch 88, accuracy: 0.5527
Epoch 88, Train Loss: 0.4274, Val Loss: 0.8101
batch size: (902, 902)
Epoch 89, accuracy: 0.5538
batch size: (888, 888)
Epoch 90, accuracy: 0.5548
Epoch 90, Train Loss: 0.4556, Val Loss: 0.8003
batch size: (874, 874)
Epoch 91, accuracy: 0.5537
batch size: (898, 898)
Epoch 92, accuracy: 0.5538
Epoch 92, Train Loss: 0.4470, Val Loss: 0.8080
batch size: (906, 906)
Epoch 93, accuracy: 0.5537
batch size: (911, 911)
Epoch 94, accuracy: 0.5537
Epoch 94, Train Loss: 0.3683, Val Loss: 0.8183
batch size: (890, 890)
Epoch 95, accuracy: 0.5551
batch size: (897, 897)
Epoch 96, accuracy: 0.5520
Epoch 96, Train Loss: 0.3268, Val Loss: 0.8042
batch size: (922, 922)
Epoch 97, accuracy: 0.5541
batch size: (905, 905)
Epoch 98, accuracy: 0.5557
Epoch 98, Train Loss: 0.3282, Val Loss: 0.8012
batch size: (896, 896)
Epoch 99, accuracy: 0.5521
batch size: (902, 902)
Epoch 100, accuracy: 0.5527
Epoch 100, Train Loss: 0.4293, Val Loss: 0.7995
batch size: (898, 898)
Epoch 101, accuracy: 0.5530
batch size: (903, 903)
Epoch 102, accuracy: 0.5517
Epoch 102, Train Loss: 0.4250, Val Loss: 0.8001
batch size: (905, 905)
Epoch 103, accuracy: 0.5544
batch size: (908, 908)
Epoch 104, accuracy: 0.5542
Epoch 104, Train Loss: 0.4316, Val Loss: 0.8092
batch size: (917, 917)
Epoch 105, accuracy: 0.5541
batch size: (901, 901)
Epoch 106, accuracy: 0.5544
Epoch 106, Train Loss: 0.2629, Val Loss: 0.7988
batch size: (889, 889)
Epoch 107, accuracy: 0.5532
batch size: (927, 927)
Epoch 108, accuracy: 0.5542
Epoch 108, Train Loss: 0.3954, Val Loss: 0.8136
batch size: (905, 905)
Epoch 109, accuracy: 0.5554
batch size: (889, 889)
Epoch 110, accuracy: 0.5548
Epoch 110, Train Loss: 0.4419, Val Loss: 0.8047
batch size: (904, 904)
Epoch 111, accuracy: 0.5544
batch size: (906, 906)
Epoch 112, accuracy: 0.5522
Epoch 112, Train Loss: 0.4194, Val Loss: 0.8260
batch size: (900, 900)
Epoch 113, accuracy: 0.5538
batch size: (894, 894)
Epoch 114, accuracy: 0.5544
Epoch 114, Train Loss: 0.3594, Val Loss: 0.8085
batch size: (885, 885)
Epoch 115, accuracy: 0.5545
batch size: (890, 890)
Epoch 116, accuracy: 0.5542
Epoch 116, Train Loss: 0.3706, Val Loss: 0.8103
batch size: (913, 913)
Epoch 117, accuracy: 0.5540
batch size: (907, 907)
Epoch 118, accuracy: 0.5545
Epoch 118, Train Loss: 0.3038, Val Loss: 0.8138
batch size: (900, 900)
Epoch 119, accuracy: 0.5549
batch size: (883, 883)
Epoch 120, accuracy: 0.5533
Epoch 120, Train Loss: 0.3700, Val Loss: 0.8193
batch size: (908, 908)
Epoch 121, accuracy: 0.5560
batch size: (895, 895)
Epoch 122, accuracy: 0.5530
Epoch 122, Train Loss: 0.4305, Val Loss: 0.8002
batch size: (875, 875)
Epoch 123, accuracy: 0.5544
batch size: (928, 928)
Epoch 124, accuracy: 0.5550
Epoch 124, Train Loss: 0.4513, Val Loss: 0.8010
batch size: (906, 906)
Epoch 125, accuracy: 0.5532
batch size: (898, 898)
Epoch 126, accuracy: 0.5541
Epoch 126, Train Loss: 0.4709, Val Loss: 0.8023
batch size: (907, 907)
Epoch 127, accuracy: 0.5542
batch size: (903, 903)
Epoch 128, accuracy: 0.5514
Epoch 128, Train Loss: 0.4352, Val Loss: 0.8180
batch size: (899, 899)
Epoch 129, accuracy: 0.5527
batch size: (903, 903)
Epoch 130, accuracy: 0.5525
Epoch 130, Train Loss: 0.3891, Val Loss: 0.8079
batch size: (879, 879)
Epoch 131, accuracy: 0.5535
batch size: (915, 915)
Epoch 132, accuracy: 0.5528
Epoch 132, Train Loss: 0.3918, Val Loss: 0.8061
batch size: (899, 899)
Epoch 133, accuracy: 0.5558
batch size: (897, 897)
Epoch 134, accuracy: 0.5549
Epoch 134, Train Loss: 0.3791, Val Loss: 0.8111
batch size: (896, 896)
Epoch 135, accuracy: 0.5540
batch size: (919, 919)
Epoch 136, accuracy: 0.5550
Epoch 136, Train Loss: 0.4309, Val Loss: 0.8235
batch size: (903, 903)
Epoch 137, accuracy: 0.5545
batch size: (916, 916)
Epoch 138, accuracy: 0.5517
Epoch 138, Train Loss: 0.4203, Val Loss: 0.7902
batch size: (897, 897)
Epoch 139, accuracy: 0.5555
batch size: (894, 894)
Epoch 140, accuracy: 0.5572
Epoch 140, Train Loss: 0.4420, Val Loss: 0.7931
batch size: (907, 907)
Epoch 141, accuracy: 0.5519
batch size: (915, 915)
Epoch 142, accuracy: 0.5554
Epoch 142, Train Loss: 0.3816, Val Loss: 0.8052
batch size: (907, 907)
Epoch 143, accuracy: 0.5568
batch size: (909, 909)
Epoch 144, accuracy: 0.5521
Epoch 144, Train Loss: 0.3498, Val Loss: 0.7974
batch size: (916, 916)
Epoch 145, accuracy: 0.5536
batch size: (907, 907)
Epoch 146, accuracy: 0.5547
Epoch 146, Train Loss: 0.3591, Val Loss: 0.8043
batch size: (907, 907)
Epoch 147, accuracy: 0.5551
batch size: (894, 894)
Epoch 148, accuracy: 0.5537
Epoch 148, Train Loss: 0.3969, Val Loss: 0.8204
batch size: (902, 902)
Epoch 149, accuracy: 0.5532
batch size: (897, 897)
Epoch 150, accuracy: 0.5539
Epoch 150, Train Loss: 0.3652, Val Loss: 0.8047
batch size: (880, 880)
Epoch 151, accuracy: 0.5534
batch size: (910, 910)
Epoch 152, accuracy: 0.5544
Epoch 152, Train Loss: 0.5241, Val Loss: 0.8122
batch size: (895, 895)
Epoch 153, accuracy: 0.5550
batch size: (902, 902)
Epoch 154, accuracy: 0.5560
Epoch 154, Train Loss: 0.4530, Val Loss: 0.7895
batch size: (914, 914)
Epoch 155, accuracy: 0.5552
batch size: (899, 899)
Epoch 156, accuracy: 0.5565
Epoch 156, Train Loss: 0.4092, Val Loss: 0.8127
batch size: (908, 908)
Epoch 157, accuracy: 0.5530
batch size: (899, 899)
Epoch 158, accuracy: 0.5523
Epoch 158, Train Loss: 0.3533, Val Loss: 0.8089
batch size: (895, 895)
Epoch 159, accuracy: 0.5538
batch size: (901, 901)
Epoch 160, accuracy: 0.5565
Epoch 160, Train Loss: 0.4188, Val Loss: 0.8180
batch size: (887, 887)
Epoch 161, accuracy: 0.5497
batch size: (904, 904)
Epoch 162, accuracy: 0.5558
Epoch 162, Train Loss: 0.4227, Val Loss: 0.8151
batch size: (917, 917)
Epoch 163, accuracy: 0.5529
batch size: (866, 866)
Epoch 164, accuracy: 0.5531
Epoch 164, Train Loss: 0.4572, Val Loss: 0.8111
batch size: (923, 923)
Epoch 165, accuracy: 0.5537
batch size: (900, 900)
Epoch 166, accuracy: 0.5564
Epoch 166, Train Loss: 0.4276, Val Loss: 0.8183
batch size: (886, 886)
Epoch 167, accuracy: 0.5518
batch size: (913, 913)
Epoch 168, accuracy: 0.5545
Epoch 168, Train Loss: 0.4087, Val Loss: 0.8143
batch size: (898, 898)
Epoch 169, accuracy: 0.5529
batch size: (898, 898)
Epoch 170, accuracy: 0.5554
Epoch 170, Train Loss: 0.2856, Val Loss: 0.8020
batch size: (915, 915)
Epoch 171, accuracy: 0.5538
batch size: (878, 878)
Epoch 172, accuracy: 0.5521
Epoch 172, Train Loss: 0.4790, Val Loss: 0.8229
batch size: (891, 891)
Epoch 173, accuracy: 0.5538
batch size: (912, 912)
Epoch 174, accuracy: 0.5565
Epoch 174, Train Loss: 0.4945, Val Loss: 0.8171
batch size: (900, 900)
Epoch 175, accuracy: 0.5538
batch size: (899, 899)
Epoch 176, accuracy: 0.5540
Epoch 176, Train Loss: 0.3294, Val Loss: 0.8058
batch size: (892, 892)
Epoch 177, accuracy: 0.5530
batch size: (898, 898)
Epoch 178, accuracy: 0.5532
Epoch 178, Train Loss: 0.3751, Val Loss: 0.8038
batch size: (892, 892)
Epoch 179, accuracy: 0.5547
batch size: (898, 898)
Epoch 180, accuracy: 0.5535
Epoch 180, Train Loss: 0.3468, Val Loss: 0.8076
batch size: (912, 912)
Epoch 181, accuracy: 0.5528
batch size: (902, 902)
Epoch 182, accuracy: 0.5550
Epoch 182, Train Loss: 0.4254, Val Loss: 0.8032
batch size: (895, 895)
Epoch 183, accuracy: 0.5538
batch size: (904, 904)
Epoch 184, accuracy: 0.5541
Epoch 184, Train Loss: 0.4484, Val Loss: 0.8025
batch size: (905, 905)
Epoch 185, accuracy: 0.5523
batch size: (919, 919)
Epoch 186, accuracy: 0.5541
Epoch 186, Train Loss: 0.3312, Val Loss: 0.8072
batch size: (886, 886)
Epoch 187, accuracy: 0.5552
batch size: (899, 899)
Epoch 188, accuracy: 0.5552
Epoch 188, Train Loss: 0.4929, Val Loss: 0.8006
batch size: (913, 913)
/root/./pipeline/pipeline-Copy1.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(best_model_path))
Epoch 189, accuracy: 0.5548
batch size: (907, 907)
Epoch 190, accuracy: 0.5539
Epoch 190, Train Loss: 0.4227, Val Loss: 0.8037
batch size: (910, 910)
Epoch 191, accuracy: 0.5544
batch size: (885, 885)
Epoch 192, accuracy: 0.5552
Epoch 192, Train Loss: 0.4010, Val Loss: 0.8195
batch size: (897, 897)
Epoch 193, accuracy: 0.5547
batch size: (891, 891)
Epoch 194, accuracy: 0.5537
Epoch 194, Train Loss: 0.4150, Val Loss: 0.8179
batch size: (897, 897)
Epoch 195, accuracy: 0.5545
batch size: (895, 895)
Epoch 196, accuracy: 0.5545
Epoch 196, Train Loss: 0.3698, Val Loss: 0.8119
batch size: (901, 901)
Epoch 197, accuracy: 0.5534
batch size: (909, 909)
Epoch 198, accuracy: 0.5546
Epoch 198, Train Loss: 0.4857, Val Loss: 0.8067
batch size: (896, 896)
Epoch 199, accuracy: 0.5551
Loaded best model with val_loss = 0.6596683859825134
test :accuracy 0.6478, f1_macro: 0.6512, f1_micro: 0.6478, auc: 0.8207
Training mamba3 with 6 layers...
可训练参数: 891125_mamba3
不可训练参数: 0
batch size: (905, 905)
✅ Epoch 0: New best model saved with val_loss = 0.7655
Epoch 0, accuracy: 0.5571
Epoch 0, Train Loss: 1.1638, Val Loss: 0.7655
batch size: (899, 899)
Epoch 1, accuracy: 0.5666
batch size: (885, 885)
✅ Epoch 2: New best model saved with val_loss = 0.6978
Epoch 2, accuracy: 0.6341
Epoch 2, Train Loss: 1.0720, Val Loss: 0.6978
batch size: (913, 913)
Epoch 3, accuracy: 0.5606
batch size: (900, 900)
Epoch 4, accuracy: 0.6636
Epoch 4, Train Loss: 0.7444, Val Loss: 0.8801
batch size: (899, 899)
Epoch 5, accuracy: 0.5968
batch size: (902, 902)
Epoch 6, accuracy: 0.6434
Epoch 6, Train Loss: 0.8609, Val Loss: 0.9416
batch size: (883, 883)
Epoch 7, accuracy: 0.6294
batch size: (907, 907)
Epoch 8, accuracy: 0.5697
Epoch 8, Train Loss: 0.3918, Val Loss: 0.8695
batch size: (900, 900)
Epoch 9, accuracy: 0.5660
batch size: (908, 908)
Epoch 10, accuracy: 0.5656
Epoch 10, Train Loss: 0.3905, Val Loss: 0.8806
batch size: (899, 899)
Epoch 11, accuracy: 0.5687
batch size: (907, 907)
Epoch 12, accuracy: 0.5718
Epoch 12, Train Loss: 0.3898, Val Loss: 0.8486
batch size: (906, 906)
Epoch 13, accuracy: 0.5751
batch size: (911, 911)
Epoch 14, accuracy: 0.5873
Epoch 14, Train Loss: 0.4640, Val Loss: 0.8474
batch size: (893, 893)
Epoch 15, accuracy: 0.5884
batch size: (882, 882)
Epoch 16, accuracy: 0.5910
Epoch 16, Train Loss: 0.3134, Val Loss: 0.8247
batch size: (908, 908)
Epoch 17, accuracy: 0.5921
batch size: (890, 890)
Epoch 18, accuracy: 0.5901
Epoch 18, Train Loss: 0.4395, Val Loss: 0.8155
batch size: (886, 886)
Epoch 19, accuracy: 0.5932
batch size: (889, 889)
Epoch 20, accuracy: 0.5932
Epoch 20, Train Loss: 0.3420, Val Loss: 0.8152
batch size: (930, 930)
Epoch 21, accuracy: 0.5929
batch size: (902, 902)
Epoch 22, accuracy: 0.5950
Epoch 22, Train Loss: 0.4467, Val Loss: 0.8074
batch size: (898, 898)
Epoch 23, accuracy: 0.5936
batch size: (900, 900)
Epoch 24, accuracy: 0.5935
Epoch 24, Train Loss: 0.4213, Val Loss: 0.7997
batch size: (900, 900)
Epoch 25, accuracy: 0.5936
batch size: (901, 901)
Epoch 26, accuracy: 0.5925
Epoch 26, Train Loss: 0.4234, Val Loss: 0.8009
batch size: (897, 897)
Epoch 27, accuracy: 0.5936
batch size: (901, 901)
Epoch 28, accuracy: 0.5929
Epoch 28, Train Loss: 0.3729, Val Loss: 0.7947
batch size: (897, 897)
Epoch 29, accuracy: 0.5929
batch size: (905, 905)
Epoch 30, accuracy: 0.5947
Epoch 30, Train Loss: 0.3446, Val Loss: 0.7870
batch size: (914, 914)
Epoch 31, accuracy: 0.5951
batch size: (895, 895)
Epoch 32, accuracy: 0.5945
Epoch 32, Train Loss: 0.4675, Val Loss: 0.7994
batch size: (907, 907)
Epoch 33, accuracy: 0.5938
batch size: (887, 887)
Epoch 34, accuracy: 0.5940
Epoch 34, Train Loss: 0.4250, Val Loss: 0.8122
batch size: (913, 913)
Epoch 35, accuracy: 0.5939
batch size: (909, 909)
Epoch 36, accuracy: 0.5919
Epoch 36, Train Loss: 0.4663, Val Loss: 0.8152
batch size: (893, 893)
Epoch 37, accuracy: 0.5947
batch size: (923, 923)
Epoch 38, accuracy: 0.5938
Epoch 38, Train Loss: 0.3676, Val Loss: 0.7909
batch size: (917, 917)
Epoch 39, accuracy: 0.5908
batch size: (901, 901)
Epoch 40, accuracy: 0.5929
Epoch 40, Train Loss: 0.3209, Val Loss: 0.8204
batch size: (895, 895)
Epoch 41, accuracy: 0.5925
batch size: (911, 911)
Epoch 42, accuracy: 0.5933
Epoch 42, Train Loss: 0.4080, Val Loss: 0.8164
batch size: (912, 912)
Epoch 43, accuracy: 0.5931
batch size: (922, 922)
Epoch 44, accuracy: 0.5935
Epoch 44, Train Loss: 0.3859, Val Loss: 0.8055
batch size: (908, 908)
Epoch 45, accuracy: 0.5916
batch size: (916, 916)
Epoch 46, accuracy: 0.5922
Epoch 46, Train Loss: 0.3184, Val Loss: 0.8050
batch size: (912, 912)
Epoch 47, accuracy: 0.5952
batch size: (896, 896)
Epoch 48, accuracy: 0.5938
Epoch 48, Train Loss: 0.4229, Val Loss: 0.8052
batch size: (894, 894)
Epoch 49, accuracy: 0.5938
batch size: (906, 906)
Epoch 50, accuracy: 0.5915
Epoch 50, Train Loss: 0.3932, Val Loss: 0.8020
batch size: (902, 902)
Epoch 51, accuracy: 0.5944
batch size: (915, 915)
Epoch 52, accuracy: 0.5916
Epoch 52, Train Loss: 0.3660, Val Loss: 0.7865
batch size: (907, 907)
Epoch 53, accuracy: 0.5930
batch size: (891, 891)
Epoch 54, accuracy: 0.5942
Epoch 54, Train Loss: 0.4667, Val Loss: 0.8104
batch size: (904, 904)
Epoch 55, accuracy: 0.5932
batch size: (920, 920)
Epoch 56, accuracy: 0.5901
Epoch 56, Train Loss: 0.4195, Val Loss: 0.8201
batch size: (878, 878)
Epoch 57, accuracy: 0.5931
batch size: (901, 901)
Epoch 58, accuracy: 0.5925
Epoch 58, Train Loss: 0.4853, Val Loss: 0.8069
batch size: (901, 901)
Epoch 59, accuracy: 0.5929
batch size: (892, 892)
Epoch 60, accuracy: 0.5945
Epoch 60, Train Loss: 0.3229, Val Loss: 0.8043
batch size: (898, 898)
Epoch 61, accuracy: 0.5926
batch size: (908, 908)
Epoch 62, accuracy: 0.5945
Epoch 62, Train Loss: 0.4357, Val Loss: 0.8217
batch size: (895, 895)
Epoch 63, accuracy: 0.5933
batch size: (903, 903)
Epoch 64, accuracy: 0.5950
Epoch 64, Train Loss: 0.5571, Val Loss: 0.7930
batch size: (897, 897)
Epoch 65, accuracy: 0.5933
batch size: (900, 900)
Epoch 66, accuracy: 0.5940
Epoch 66, Train Loss: 0.4443, Val Loss: 0.8002
batch size: (911, 911)
Epoch 67, accuracy: 0.5949
batch size: (884, 884)
Epoch 68, accuracy: 0.5948
Epoch 68, Train Loss: 0.3975, Val Loss: 0.7994
batch size: (891, 891)
Epoch 69, accuracy: 0.5954
batch size: (906, 906)
Epoch 70, accuracy: 0.5901
Epoch 70, Train Loss: 0.3328, Val Loss: 0.8085
batch size: (897, 897)
Epoch 71, accuracy: 0.5921
batch size: (921, 921)
Epoch 72, accuracy: 0.5925
Epoch 72, Train Loss: 0.3578, Val Loss: 0.8063
batch size: (904, 904)
Epoch 73, accuracy: 0.5900
batch size: (903, 903)
Epoch 74, accuracy: 0.5945
Epoch 74, Train Loss: 0.3397, Val Loss: 0.8167
batch size: (893, 893)
Epoch 75, accuracy: 0.5950
batch size: (905, 905)
Epoch 76, accuracy: 0.5934
Epoch 76, Train Loss: 0.4277, Val Loss: 0.7939
batch size: (900, 900)
Epoch 77, accuracy: 0.5952
batch size: (915, 915)
Epoch 78, accuracy: 0.5946
Epoch 78, Train Loss: 0.3150, Val Loss: 0.8023
batch size: (919, 919)
Epoch 79, accuracy: 0.5934
batch size: (893, 893)
Epoch 80, accuracy: 0.5942
Epoch 80, Train Loss: 0.4243, Val Loss: 0.7986
batch size: (899, 899)
Epoch 81, accuracy: 0.5945
batch size: (920, 920)
Epoch 82, accuracy: 0.5932
Epoch 82, Train Loss: 0.3622, Val Loss: 0.8261
batch size: (895, 895)
Epoch 83, accuracy: 0.5954
batch size: (879, 879)
Epoch 84, accuracy: 0.5943
Epoch 84, Train Loss: 0.3586, Val Loss: 0.8032
batch size: (906, 906)
Epoch 85, accuracy: 0.5927
batch size: (878, 878)
Epoch 86, accuracy: 0.5926
Epoch 86, Train Loss: 0.3885, Val Loss: 0.7989
batch size: (887, 887)
Epoch 87, accuracy: 0.5955
batch size: (909, 909)
Epoch 88, accuracy: 0.5938
Epoch 88, Train Loss: 0.3418, Val Loss: 0.7938
batch size: (905, 905)
Epoch 89, accuracy: 0.5935
batch size: (903, 903)
Epoch 90, accuracy: 0.5925
Epoch 90, Train Loss: 0.3094, Val Loss: 0.8104
batch size: (916, 916)
Epoch 91, accuracy: 0.5971
batch size: (884, 884)
Epoch 92, accuracy: 0.5946
Epoch 92, Train Loss: 0.3197, Val Loss: 0.8120
batch size: (895, 895)
Epoch 93, accuracy: 0.5933
batch size: (894, 894)
Epoch 94, accuracy: 0.5935
Epoch 94, Train Loss: 0.3383, Val Loss: 0.7837
batch size: (920, 920)
Epoch 95, accuracy: 0.5915
batch size: (903, 903)
Epoch 96, accuracy: 0.5937